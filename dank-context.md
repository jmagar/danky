This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2025-01-09T23:43:11.667Z

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
- Pay special attention to the Repository Description. These contain important context and guidelines specific to this project.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

- Line numbers have been added to the beginning of each line.

## Additional Info
### User Provided Header
# Danky AI Chatbot Codebase
This is a Next.js monorepo project using TypeScript, Drizzle, and MCP for AI interactions.

# Directory Structure
```
apps/
  web/
    .vscode/
      settings.json
    app/
      providers.tsx
    docs/
      ESLINT.md
    public/
      file-text.svg
      globe.svg
      next.svg
      turborepo-dark.svg
      turborepo-light.svg
      vercel.svg
      window.svg
    src/
      app/
        api/
          actions/
            chat/
              batch-operations.ts
              create-message.ts
              create-session.ts
              delete-session.ts
              index.ts
              list-messages.ts
              list-sessions.ts
              update-session.ts
            chat.ts
            mcp.ts
          chat/
            sessions/
              [sessionId]/
                messages/
                  route.ts
              route.ts
            route.ts
          routes/
            chat.ts
        chat/
          page.tsx
        error.tsx
        globals.css
        layout.tsx
        not-found.tsx
        page.module.css
        page.tsx
        providers.tsx
      components/
        chat/
          attachment-button.tsx
          chat-input.tsx
          chat-layout.tsx
          chat-messages.tsx
          message-content.tsx
          message.tsx
          notifications-popover.tsx
          README.md
          search.tsx
          session-list.tsx
          sidebar.tsx
          tools-dropdown.tsx
          types.ts
          user-nav.tsx
          utils.ts
        mcp/
          servers/
            server-card.tsx
            server-list.tsx
          tools/
            tool-card.tsx
            tool-list.tsx
          index.ts
          mcp-panel.tsx
          README.md
          tools-button.tsx
        sidebar/
          index.tsx
          sidebar-content.tsx
          sidebar-context.tsx
          sidebar-group.tsx
          sidebar-item.tsx
          sidebar-layout.tsx
          sidebar-menu-extras.tsx
          sidebar-menu-sub.tsx
          sidebar-menu.tsx
          sidebar-search.tsx
          sidebar-section.tsx
          sidebar-sections.tsx
          sidebar-toggle.tsx
          sidebar-trigger.tsx
          sidebar-types.ts
          sidebar.tsx
        theme/
          theme-provider.tsx
          theme-toggle.tsx
        ui/
          loading-spinner.tsx
        providers.tsx
      hooks/
        use-mobile.tsx
        use-toast.ts
      lib/
        actions/
          mcp-actions.ts
        config/
          mcp-config.ts
        db/
          chat/
            batch-sessions.ts
            batch.ts
          chat.ts
          transaction.ts
        services/
          init-chat-model.ts
          load-config.ts
          mcp-provider.ts
          mcp-service.ts
        stores/
          chat-store.ts
          mcp-store.ts
        validations/
          chat.ts
        errors.ts
        session.ts
        utils.ts
    .gitignore
    components.json
    eslint.config.js
    mcp-server-guide.md
    next.config.js
    package.json
    postcss.config.js
    README.md
    tailwind.config.js
    tsconfig.json
    types.d.ts
packages/
  db/
    drizzle/
      meta/
        _journal.json
        0000_snapshot.json
      0000_noisy_phil_sheldon.sql
      0001_chat_schema_improvements.sql
    src/
      schema/
        auth.ts
        cache.ts
        chat.ts
        index.ts
        vector.ts
      client.ts
      index.ts
      migrate.ts
      seed.ts
    drizzle.config.ts
    package.json
    README.md
    tsconfig.json
    tsup.config.ts
  eslint-config/
    base.js
    index.js
    next.js
    package.json
    react-internal.js
    README.md
  logger/
    src/
      index.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
    tsconfig.tsbuildinfo
    tsup.config.ts
  mcp/
    src/
      servers/
        mcp-server-langchain-tool.ts
      index.ts
      init-chat-model.ts
      load-config.ts
      logger.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
  schema/
    src/
      chat-batch.ts
      chat-session.ts
      chat.ts
      index.ts
      metadata.ts
      test-eslint.ts
      types.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
    tsup.config.ts
  typescript-config/
    base.json
    nextjs.json
    package.json
    react-library.json
  ui/
    packages/
      eslint-config/
        package.json
    src/
      components/
        accordion.tsx
        alert-dialog.tsx
        alert.tsx
        aspect-ratio.tsx
        avatar.tsx
        badge.tsx
        breadcrumb.tsx
        button.tsx
        calendar.tsx
        card.tsx
        carousel.tsx
        chart.tsx
        checkbox.tsx
        collapsible.tsx
        command.tsx
        context-menu.tsx
        dialog.tsx
        drawer.tsx
        dropdown-menu.tsx
        form.tsx
        hover-card.tsx
        icons.tsx
        input-otp.tsx
        input.tsx
        label.tsx
        loading-spinner.tsx
        menubar.tsx
        navigation-menu.tsx
        pagination.tsx
        popover.tsx
        progress.tsx
        radio-group.tsx
        resizable.tsx
        scroll-area.tsx
        select.tsx
        separator.tsx
        sheet.tsx
        skeleton.tsx
        slider.tsx
        sonner.tsx
        switch.tsx
        table.tsx
        tabs.tsx
        textarea.tsx
        toast.tsx
        toaster.tsx
        toggle-group.tsx
        toggle.tsx
        tooltip.tsx
      hooks/
        use-mobile.ts
        use-toast.ts
      lib/
        utils.ts
      styles/
        fonts.ts
        globals.css
      button.tsx
      card.tsx
      code.tsx
      index.ts
    turbo/
      generators/
        templates/
          component.hbs
        config.ts
    components.json
    eslint.config.js
    package.json
    README.md
    tailwind.config.js
    tsconfig.json
    tsup.config.ts
.env.example
.npmrc
ARCHITECTURE.md
package.json
pnpm-workspace.yaml
README.md
repomix.config.json
turbo.json
VERSION_REQUIREMENTS.md
```

# Files

## File: apps/web/.vscode/settings.json
```json
 1: {
 2:   "editor.codeActionsOnSave": {
 3:     "source.fixAll.eslint": true,
 4:     "source.organizeImports": false
 5:   },
 6:   "editor.defaultFormatter": "esbenp.prettier-vscode",
 7:   "editor.formatOnSave": true,
 8:   "editor.rulers": [80, 100],
 9:   "editor.tabSize": 2,
10:   "eslint.enable": true,
11:   "eslint.format.enable": true,
12:   "eslint.validate": [
13:     "javascript",
14:     "javascriptreact",
15:     "typescript",
16:     "typescriptreact"
17:   ],
18:   "files.associations": {
19:     "*.css": "tailwindcss"
20:   },
21:   "files.eol": "\n",
22:   "files.trimTrailingWhitespace": true,
23:   "typescript.preferences.importModuleSpecifier": "non-relative",
24:   "typescript.tsdk": "node_modules/typescript/lib",
25:   "typescript.enablePromptUseWorkspaceTsdk": true,
26:   "[javascript]": {
27:     "editor.defaultFormatter": "esbenp.prettier-vscode"
28:   },
29:   "[typescript]": {
30:     "editor.defaultFormatter": "esbenp.prettier-vscode"
31:   },
32:   "[typescriptreact]": {
33:     "editor.defaultFormatter": "esbenp.prettier-vscode"
34:   },
35:   "tailwindCSS.experimental.classRegex": [
36:     ["cva\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"],
37:     ["cn\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"]
38:   ],
39:   "tailwindCSS.includeLanguages": {
40:     "typescript": "javascript",
41:     "typescriptreact": "javascript"
42:   }
43: }
```

## File: apps/web/app/providers.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ThemeProvider } from 'next-themes'
 4: import { type PropsWithChildren } from 'react'
 5: 
 6: export function Providers({ children }: PropsWithChildren) {
 7:   return (
 8:     <ThemeProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:     >
14:       {children}
15:     </ThemeProvider>
16:   )
17: }
```

## File: apps/web/docs/ESLINT.md
```markdown
 1: # ESLint Configuration
 2: 
 3: This project uses ESLint 9 with the new flat config system for code quality and consistency.
 4: 
 5: ## Setup
 6: 
 7: The ESLint configuration is defined in `eslint.config.js` and uses the following key features:
 8: 
 9: - TypeScript support with strict type checking
10: - React and React Hooks rules
11: - Next.js specific rules
12: - Import organization and sorting
13: - Path alias resolution
14: 
15: ## Key Rules
16: 
17: ### TypeScript
18: - Enforces consistent type imports
19: - Prevents floating promises
20: - Disallows explicit `any`
21: - Warns about unused variables
22: - Enforces proper type inference
23: 
24: ### React
25: - Enforces key prop usage
26: - Prevents undefined JSX elements
27: - Warns about unused prop types
28: - Enforces proper hooks usage
29: 
30: ### Import Organization
31: - Prevents circular dependencies
32: - Enforces import sorting
33: - Groups imports by type
34: - Maintains consistent spacing
35: 
36: ## Scripts
37: 
38: ```bash
39: # Run ESLint
40: pnpm lint
41: 
42: # Fix auto-fixable issues
43: pnpm lint:fix
44: 
45: # Type check
46: pnpm type-check
47: ```
48: 
49: ## VSCode Integration
50: 
51: Install the ESLint extension and use the following workspace settings:
52: 
53: ```json
54: {
55:   "editor.codeActionsOnSave": {
56:     "source.fixAll.eslint": true
57:   },
58:   "editor.defaultFormatter": "esbenp.prettier-vscode",
59:   "editor.formatOnSave": true,
60:   "eslint.enable": true,
61:   "eslint.format.enable": true,
62:   "eslint.validate": [
63:     "javascript",
64:     "javascriptreact",
65:     "typescript",
66:     "typescriptreact"
67:   ]
68: }
69: ```
70: 
71: ## Path Aliases
72: 
73: The configuration supports the following path aliases:
74: - `@/*` - Points to src directory
75: - `@/lib/*` - Points to lib directory
76: - `@/components/*` - Points to components directory
77: - `@/app/*` - Points to app directory
78: - `@/hooks/*` - Points to hooks directory
79: - `@danky/ui` - Points to UI package
80: - `@danky/mcp` - Points to MCP package
```

## File: apps/web/public/file-text.svg
```
1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
2: <path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM13 13.5V6.5H9.5H8V5V1.5H3V13.5C3 14.0523 3.44772 14.5 4 14.5H12C12.5523 14.5 13 14.0523 13 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM5.13 5.00062H4.505V6.25062H5.13H6H6.625V5.00062H6H5.13ZM4.505 8H5.13H11H11.625V9.25H11H5.13H4.505V8ZM5.13 11H4.505V12.25H5.13H11H11.625V11H11H5.13Z" fill="#666666"/>
3: </svg>
```

## File: apps/web/public/globe.svg
```
 1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <g clip-path="url(#clip0_868_525)">
 3: <path fill-rule="evenodd" clip-rule="evenodd" d="M10.268 14.0934C11.9051 13.4838 13.2303 12.2333 13.9384 10.6469C13.1192 10.7941 12.2138 10.9111 11.2469 10.9925C11.0336 12.2005 10.695 13.2621 10.268 14.0934ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8.48347 14.4823C8.32384 14.494 8.16262 14.5 8 14.5C7.83738 14.5 7.67616 14.494 7.51654 14.4823C7.5132 14.4791 7.50984 14.4759 7.50647 14.4726C7.2415 14.2165 6.94578 13.7854 6.67032 13.1558C6.41594 12.5744 6.19979 11.8714 6.04101 11.0778C6.67605 11.1088 7.33104 11.125 8 11.125C8.66896 11.125 9.32395 11.1088 9.95899 11.0778C9.80021 11.8714 9.58406 12.5744 9.32968 13.1558C9.05422 13.7854 8.7585 14.2165 8.49353 14.4726C8.49016 14.4759 8.4868 14.4791 8.48347 14.4823ZM11.4187 9.72246C12.5137 9.62096 13.5116 9.47245 14.3724 9.28806C14.4561 8.87172 14.5 8.44099 14.5 8C14.5 7.55901 14.4561 7.12828 14.3724 6.71194C13.5116 6.52755 12.5137 6.37904 11.4187 6.27753C11.4719 6.83232 11.5 7.40867 11.5 8C11.5 8.59133 11.4719 9.16768 11.4187 9.72246ZM10.1525 6.18401C10.2157 6.75982 10.25 7.36805 10.25 8C10.25 8.63195 10.2157 9.24018 10.1525 9.81598C9.46123 9.85455 8.7409 9.875 8 9.875C7.25909 9.875 6.53877 9.85455 5.84749 9.81598C5.7843 9.24018 5.75 8.63195 5.75 8C5.75 7.36805 5.7843 6.75982 5.84749 6.18401C6.53877 6.14545 7.25909 6.125 8 6.125C8.74091 6.125 9.46123 6.14545 10.1525 6.18401ZM11.2469 5.00748C12.2138 5.08891 13.1191 5.20593 13.9384 5.35306C13.2303 3.7667 11.9051 2.51622 10.268 1.90662C10.695 2.73788 11.0336 3.79953 11.2469 5.00748ZM8.48347 1.51771C8.4868 1.52089 8.49016 1.52411 8.49353 1.52737C8.7585 1.78353 9.05422 2.21456 9.32968 2.84417C9.58406 3.42562 9.80021 4.12856 9.95899 4.92219C9.32395 4.89118 8.66896 4.875 8 4.875C7.33104 4.875 6.67605 4.89118 6.04101 4.92219C6.19978 4.12856 6.41594 3.42562 6.67032 2.84417C6.94578 2.21456 7.2415 1.78353 7.50647 1.52737C7.50984 1.52411 7.51319 1.52089 7.51653 1.51771C7.67615 1.50597 7.83738 1.5 8 1.5C8.16262 1.5 8.32384 1.50597 8.48347 1.51771ZM5.73202 1.90663C4.0949 2.51622 2.76975 3.7667 2.06159 5.35306C2.88085 5.20593 3.78617 5.08891 4.75309 5.00748C4.96639 3.79953 5.30497 2.73788 5.73202 1.90663ZM4.58133 6.27753C3.48633 6.37904 2.48837 6.52755 1.62761 6.71194C1.54392 7.12828 1.5 7.55901 1.5 8C1.5 8.44099 1.54392 8.87172 1.62761 9.28806C2.48837 9.47245 3.48633 9.62096 4.58133 9.72246C4.52807 9.16768 4.5 8.59133 4.5 8C4.5 7.40867 4.52807 6.83232 4.58133 6.27753ZM4.75309 10.9925C3.78617 10.9111 2.88085 10.7941 2.06159 10.6469C2.76975 12.2333 4.0949 13.4838 5.73202 14.0934C5.30497 13.2621 4.96639 12.2005 4.75309 10.9925Z" fill="#666666"/>
 4: </g>
 5: <defs>
 6: <clipPath id="clip0_868_525">
 7: <rect width="16" height="16" fill="white"/>
 8: </clipPath>
 9: </defs>
10: </svg>
```

## File: apps/web/public/next.svg
```
1: <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
```

## File: apps/web/public/turborepo-dark.svg
```
 1: <svg width="473" height="76" viewBox="0 0 473 76" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <path d="M130.998 30.6565V22.3773H91.0977V30.6565H106.16V58.1875H115.935V30.6565H130.998Z" fill="black"/>
 3: <path d="M153.542 58.7362C165.811 58.7362 172.544 52.5018 172.544 42.2275V22.3773H162.768V41.2799C162.768 47.0155 159.776 50.2574 153.542 50.2574C147.307 50.2574 144.315 47.0155 144.315 41.2799V22.3773H134.539V42.2275C134.539 52.5018 141.272 58.7362 153.542 58.7362Z" fill="black"/>
 4: <path d="M187.508 46.3173H197.234L204.914 58.1875H216.136L207.458 45.2699C212.346 43.5243 215.338 39.634 215.338 34.3473C215.338 26.6665 209.603 22.3773 200.874 22.3773H177.732V58.1875H187.508V46.3173ZM187.508 38.5867V30.5568H200.376C203.817 30.5568 205.712 32.053 205.712 34.5967C205.712 36.9907 203.817 38.5867 200.376 38.5867H187.508Z" fill="black"/>
 5: <path d="M219.887 58.1875H245.472C253.452 58.1875 258.041 54.397 258.041 48.0629C258.041 43.8235 255.348 40.9308 252.156 39.634C254.35 38.5867 257.043 36.0929 257.043 32.1528C257.043 25.8187 252.555 22.3773 244.625 22.3773H219.887V58.1875ZM229.263 36.3922V30.3074H243.627C246.32 30.3074 247.817 31.3548 247.817 33.3498C247.817 35.3448 246.32 36.3922 243.627 36.3922H229.263ZM229.263 43.7238H244.525C247.168 43.7238 248.615 45.0205 248.615 46.9657C248.615 48.9108 247.168 50.2075 244.525 50.2075H229.263V43.7238Z" fill="black"/>
 6: <path d="M281.942 21.7788C269.423 21.7788 260.396 29.6092 260.396 40.2824C260.396 50.9557 269.423 58.786 281.942 58.786C294.461 58.786 303.438 50.9557 303.438 40.2824C303.438 29.6092 294.461 21.7788 281.942 21.7788ZM281.942 30.2575C288.525 30.2575 293.463 34.1478 293.463 40.2824C293.463 46.417 288.525 50.3073 281.942 50.3073C275.359 50.3073 270.421 46.417 270.421 40.2824C270.421 34.1478 275.359 30.2575 281.942 30.2575Z" fill="black"/>
 7: <path d="M317.526 46.3173H327.251L334.932 58.1875H346.154L337.476 45.2699C342.364 43.5243 345.356 39.634 345.356 34.3473C345.356 26.6665 339.62 22.3773 330.892 22.3773H307.75V58.1875H317.526V46.3173ZM317.526 38.5867V30.5568H330.394C333.835 30.5568 335.73 32.053 335.73 34.5967C335.73 36.9907 333.835 38.5867 330.394 38.5867H317.526Z" fill="black"/>
 8: <path d="M349.904 22.3773V58.1875H384.717V49.9083H359.48V44.0729H381.874V35.9932H359.48V30.6565H384.717V22.3773H349.904Z" fill="black"/>
 9: <path d="M399.204 46.7662H412.221C420.95 46.7662 426.685 42.5767 426.685 34.5967C426.685 26.5668 420.95 22.3773 412.221 22.3773H389.428V58.1875H399.204V46.7662ZM399.204 38.6365V30.5568H411.673C415.164 30.5568 417.059 32.053 417.059 34.5967C417.059 37.0904 415.164 38.6365 411.673 38.6365H399.204Z" fill="black"/>
10: <path d="M450.948 21.7788C438.43 21.7788 429.402 29.6092 429.402 40.2824C429.402 50.9557 438.43 58.786 450.948 58.786C463.467 58.786 472.444 50.9557 472.444 40.2824C472.444 29.6092 463.467 21.7788 450.948 21.7788ZM450.948 30.2575C457.532 30.2575 462.469 34.1478 462.469 40.2824C462.469 46.417 457.532 50.3073 450.948 50.3073C444.365 50.3073 439.427 46.417 439.427 40.2824C439.427 34.1478 444.365 30.2575 450.948 30.2575Z" fill="black"/>
11: <path d="M38.5017 18.0956C27.2499 18.0956 18.0957 27.2498 18.0957 38.5016C18.0957 49.7534 27.2499 58.9076 38.5017 58.9076C49.7535 58.9076 58.9077 49.7534 58.9077 38.5016C58.9077 27.2498 49.7535 18.0956 38.5017 18.0956ZM38.5017 49.0618C32.6687 49.0618 27.9415 44.3346 27.9415 38.5016C27.9415 32.6686 32.6687 27.9414 38.5017 27.9414C44.3347 27.9414 49.0619 32.6686 49.0619 38.5016C49.0619 44.3346 44.3347 49.0618 38.5017 49.0618Z" fill="black"/>
12: <path fill-rule="evenodd" clip-rule="evenodd" d="M40.2115 14.744V7.125C56.7719 8.0104 69.9275 21.7208 69.9275 38.5016C69.9275 55.2824 56.7719 68.989 40.2115 69.8782V62.2592C52.5539 61.3776 62.3275 51.0644 62.3275 38.5016C62.3275 25.9388 52.5539 15.6256 40.2115 14.744ZM20.5048 54.0815C17.233 50.3043 15.124 45.4935 14.7478 40.2115H7.125C7.5202 47.6025 10.4766 54.3095 15.1088 59.4737L20.501 54.0815H20.5048ZM36.7916 69.8782V62.2592C31.5058 61.883 26.695 59.7778 22.9178 56.5022L17.5256 61.8944C22.6936 66.5304 29.4006 69.483 36.7878 69.8782H36.7916Z" fill="url(#paint0_linear_2028_278)"/>
13: <defs>
14: <linearGradient id="paint0_linear_2028_278" x1="41.443" y1="11.5372" x2="10.5567" y2="42.4236" gradientUnits="userSpaceOnUse">
15: <stop stop-color="#0096FF"/>
16: <stop offset="1" stop-color="#FF1E56"/>
17: </linearGradient>
18: </defs>
19: </svg>
```

## File: apps/web/public/turborepo-light.svg
```
 1: <svg width="473" height="76" viewBox="0 0 473 76" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <path d="M130.998 30.6566V22.3773H91.0977V30.6566H106.16V58.1876H115.935V30.6566H130.998Z" fill="white"/>
 3: <path d="M153.542 58.7362C165.811 58.7362 172.544 52.5018 172.544 42.2276V22.3773H162.768V41.2799C162.768 47.0156 159.776 50.2574 153.542 50.2574C147.307 50.2574 144.315 47.0156 144.315 41.2799V22.3773H134.539V42.2276C134.539 52.5018 141.272 58.7362 153.542 58.7362Z" fill="white"/>
 4: <path d="M187.508 46.3173H197.234L204.914 58.1876H216.136L207.458 45.2699C212.346 43.5243 215.338 39.6341 215.338 34.3473C215.338 26.6666 209.603 22.3773 200.874 22.3773H177.732V58.1876H187.508V46.3173ZM187.508 38.5867V30.5568H200.376C203.817 30.5568 205.712 32.0531 205.712 34.5967C205.712 36.9907 203.817 38.5867 200.376 38.5867H187.508Z" fill="white"/>
 5: <path d="M219.887 58.1876H245.472C253.452 58.1876 258.041 54.3971 258.041 48.0629C258.041 43.8236 255.348 40.9308 252.156 39.6341C254.35 38.5867 257.043 36.0929 257.043 32.1528C257.043 25.8187 252.555 22.3773 244.625 22.3773H219.887V58.1876ZM229.263 36.3922V30.3074H243.627C246.32 30.3074 247.817 31.3548 247.817 33.3498C247.817 35.3448 246.32 36.3922 243.627 36.3922H229.263ZM229.263 43.7238H244.525C247.168 43.7238 248.615 45.0206 248.615 46.9657C248.615 48.9108 247.168 50.2076 244.525 50.2076H229.263V43.7238Z" fill="white"/>
 6: <path d="M281.942 21.7788C269.423 21.7788 260.396 29.6092 260.396 40.2824C260.396 50.9557 269.423 58.7861 281.942 58.7861C294.461 58.7861 303.438 50.9557 303.438 40.2824C303.438 29.6092 294.461 21.7788 281.942 21.7788ZM281.942 30.2576C288.525 30.2576 293.463 34.1478 293.463 40.2824C293.463 46.4171 288.525 50.3073 281.942 50.3073C275.359 50.3073 270.421 46.4171 270.421 40.2824C270.421 34.1478 275.359 30.2576 281.942 30.2576Z" fill="white"/>
 7: <path d="M317.526 46.3173H327.251L334.932 58.1876H346.154L337.476 45.2699C342.364 43.5243 345.356 39.6341 345.356 34.3473C345.356 26.6666 339.62 22.3773 330.892 22.3773H307.75V58.1876H317.526V46.3173ZM317.526 38.5867V30.5568H330.394C333.835 30.5568 335.73 32.0531 335.73 34.5967C335.73 36.9907 333.835 38.5867 330.394 38.5867H317.526Z" fill="white"/>
 8: <path d="M349.904 22.3773V58.1876H384.717V49.9083H359.48V44.0729H381.874V35.9932H359.48V30.6566H384.717V22.3773H349.904Z" fill="white"/>
 9: <path d="M399.204 46.7662H412.221C420.95 46.7662 426.685 42.5767 426.685 34.5967C426.685 26.5668 420.95 22.3773 412.221 22.3773H389.428V58.1876H399.204V46.7662ZM399.204 38.6366V30.5568H411.673C415.164 30.5568 417.059 32.0531 417.059 34.5967C417.059 37.0904 415.164 38.6366 411.673 38.6366H399.204Z" fill="white"/>
10: <path d="M450.948 21.7788C438.43 21.7788 429.402 29.6092 429.402 40.2824C429.402 50.9557 438.43 58.7861 450.948 58.7861C463.467 58.7861 472.444 50.9557 472.444 40.2824C472.444 29.6092 463.467 21.7788 450.948 21.7788ZM450.948 30.2576C457.532 30.2576 462.469 34.1478 462.469 40.2824C462.469 46.4171 457.532 50.3073 450.948 50.3073C444.365 50.3073 439.427 46.4171 439.427 40.2824C439.427 34.1478 444.365 30.2576 450.948 30.2576Z" fill="white"/>
11: <path d="M38.5017 18.0956C27.2499 18.0956 18.0957 27.2498 18.0957 38.5016C18.0957 49.7534 27.2499 58.9076 38.5017 58.9076C49.7535 58.9076 58.9077 49.7534 58.9077 38.5016C58.9077 27.2498 49.7535 18.0956 38.5017 18.0956ZM38.5017 49.0618C32.6687 49.0618 27.9415 44.3346 27.9415 38.5016C27.9415 32.6686 32.6687 27.9414 38.5017 27.9414C44.3347 27.9414 49.0619 32.6686 49.0619 38.5016C49.0619 44.3346 44.3347 49.0618 38.5017 49.0618Z" fill="white"/>
12: <path fill-rule="evenodd" clip-rule="evenodd" d="M40.2115 14.744V7.125C56.7719 8.0104 69.9275 21.7208 69.9275 38.5016C69.9275 55.2824 56.7719 68.989 40.2115 69.8782V62.2592C52.5539 61.3776 62.3275 51.0644 62.3275 38.5016C62.3275 25.9388 52.5539 15.6256 40.2115 14.744ZM20.5048 54.0815C17.233 50.3043 15.124 45.4935 14.7478 40.2115H7.125C7.5202 47.6025 10.4766 54.3095 15.1088 59.4737L20.501 54.0815H20.5048ZM36.7916 69.8782V62.2592C31.5058 61.883 26.695 59.7778 22.9178 56.5022L17.5256 61.8944C22.6936 66.5304 29.4006 69.483 36.7878 69.8782H36.7916Z" fill="url(#paint0_linear_2028_477)"/>
13: <defs>
14: <linearGradient id="paint0_linear_2028_477" x1="41.443" y1="11.5372" x2="10.5567" y2="42.4236" gradientUnits="userSpaceOnUse">
15: <stop stop-color="#0096FF"/>
16: <stop offset="1" stop-color="#FF1E56"/>
17: </linearGradient>
18: </defs>
19: </svg>
```

## File: apps/web/public/vercel.svg
```
 1: <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <g clip-path="url(#clip0_977_547)">
 3: <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 3L18.5 17H2.5L10.5 3Z" fill="white"/>
 4: </g>
 5: <defs>
 6: <clipPath id="clip0_977_547">
 7: <rect width="16" height="16" fill="white" transform="translate(2.5 2)"/>
 8: </clipPath>
 9: </defs>
10: </svg>
```

## File: apps/web/public/window.svg
```
1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
2: <path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5H14.5V12.5C14.5 13.0523 14.0523 13.5 13.5 13.5H2.5C1.94772 13.5 1.5 13.0523 1.5 12.5V2.5ZM0 1H1.5H14.5H16V2.5V12.5C16 13.8807 14.8807 15 13.5 15H2.5C1.11929 15 0 13.8807 0 12.5V2.5V1ZM3.75 5.5C4.16421 5.5 4.5 5.16421 4.5 4.75C4.5 4.33579 4.16421 4 3.75 4C3.33579 4 3 4.33579 3 4.75C3 5.16421 3.33579 5.5 3.75 5.5ZM7 4.75C7 5.16421 6.66421 5.5 6.25 5.5C5.83579 5.5 5.5 5.16421 5.5 4.75C5.5 4.33579 5.83579 4 6.25 4C6.66421 4 7 4.33579 7 4.75ZM8.75 5.5C9.16421 5.5 9.5 5.16421 9.5 4.75C9.5 4.33579 9.16421 4 8.75 4C8.33579 4 8 4.33579 8 4.75C8 5.16421 8.33579 5.5 8.75 5.5Z" fill="#666666"/>
3: </svg>
```

## File: apps/web/src/app/api/actions/chat/batch-operations.ts
```typescript
  1: 'use server';
  2: 
  3: import { z } from 'zod';
  4: import {
  5:   batchDeleteSessionsRequestSchema,
  6:   batchDeleteSessionsResponseSchema,
  7:   batchRestoreSessionsRequestSchema,
  8:   batchRestoreSessionsResponseSchema,
  9:   batchArchiveSessionsRequestSchema,
 10:   batchArchiveSessionsResponseSchema,
 11:   batchUpdateSessionsRequestSchema,
 12:   batchUpdateSessionsResponseSchema,
 13:   batchDeleteMessagesRequestSchema,
 14:   batchDeleteMessagesResponseSchema,
 15:   batchRestoreMessagesRequestSchema,
 16:   batchRestoreMessagesResponseSchema,
 17:   batchCreateMessagesRequestSchema,
 18:   batchCreateMessagesResponseSchema,
 19: } from '@danky/schema';
 20: import {
 21:   batchDeleteSessions,
 22:   batchRestoreSessions,
 23:   batchArchiveSessions,
 24:   batchUpdateSessions,
 25: } from '@/lib/db/chat/batch-sessions';
 26: import {
 27:   batchDeleteMessages,
 28:   batchRestoreMessages,
 29:   batchCreateMessages,
 30: } from '@/lib/db/chat/batch';
 31: import { withUser } from '@/lib/session';
 32: import { withErrorHandling } from '@/lib/errors';
 33: 
 34: // Session batch operations
 35: async function batchDeleteSessionsHandler(
 36:   input: z.infer<typeof batchDeleteSessionsRequestSchema>
 37: ) {
 38:   return withUser(async (user) => {
 39:     // Delete sessions
 40:     const deleted = await batchDeleteSessions(input, user.id);
 41: 
 42:     // Return success response
 43:     return batchDeleteSessionsResponseSchema.parse({
 44:       success: true,
 45:       data: {
 46:         deletedCount: deleted.length,
 47:         deletedIds: deleted.map(s => s.id),
 48:       },
 49:     });
 50:   });
 51: }
 52: 
 53: async function batchRestoreSessionsHandler(
 54:   input: z.infer<typeof batchRestoreSessionsRequestSchema>
 55: ) {
 56:   return withUser(async (user) => {
 57:     // Restore sessions
 58:     const restored = await batchRestoreSessions(input, user.id);
 59: 
 60:     // Return success response
 61:     return batchRestoreSessionsResponseSchema.parse({
 62:       success: true,
 63:       data: {
 64:         restoredCount: restored.length,
 65:         restoredSessions: restored,
 66:       },
 67:     });
 68:   });
 69: }
 70: 
 71: async function batchArchiveSessionsHandler(
 72:   input: z.infer<typeof batchArchiveSessionsRequestSchema>
 73: ) {
 74:   return withUser(async (user) => {
 75:     // Archive/unarchive sessions
 76:     const updated = await batchArchiveSessions(input, user.id);
 77: 
 78:     // Return success response
 79:     return batchArchiveSessionsResponseSchema.parse({
 80:       success: true,
 81:       data: {
 82:         updatedCount: updated.length,
 83:         updatedIds: updated.map(s => s.id),
 84:       },
 85:     });
 86:   });
 87: }
 88: 
 89: async function batchUpdateSessionsHandler(
 90:   input: z.infer<typeof batchUpdateSessionsRequestSchema>
 91: ) {
 92:   return withUser(async (user) => {
 93:     // Update sessions
 94:     const updated = await batchUpdateSessions(input, user.id);
 95: 
 96:     // Return success response
 97:     return batchUpdateSessionsResponseSchema.parse({
 98:       success: true,
 99:       data: {
100:         updatedCount: updated.length,
101:         updatedSessions: updated,
102:       },
103:     });
104:   });
105: }
106: 
107: // Message batch operations
108: async function batchDeleteMessagesHandler(
109:   input: z.infer<typeof batchDeleteMessagesRequestSchema>
110: ) {
111:   return withUser(async (user) => {
112:     // Delete messages
113:     const deleted = await batchDeleteMessages(input, user.id);
114: 
115:     // Return success response
116:     return batchDeleteMessagesResponseSchema.parse({
117:       success: true,
118:       data: {
119:         deletedCount: deleted.length,
120:         deletedIds: deleted.map(m => m.id),
121:       },
122:     });
123:   });
124: }
125: 
126: async function batchRestoreMessagesHandler(
127:   input: z.infer<typeof batchRestoreMessagesRequestSchema>
128: ) {
129:   return withUser(async (user) => {
130:     // Restore messages
131:     const restored = await batchRestoreMessages(input, user.id);
132: 
133:     // Return success response
134:     return batchRestoreMessagesResponseSchema.parse({
135:       success: true,
136:       data: {
137:         restoredCount: restored.length,
138:         restoredIds: restored.map(m => m.id),
139:       },
140:     });
141:   });
142: }
143: 
144: async function batchCreateMessagesHandler(
145:   input: z.infer<typeof batchCreateMessagesRequestSchema>
146: ) {
147:   return withUser(async (user) => {
148:     // Create messages
149:     const messages = await batchCreateMessages(input, user.id);
150: 
151:     // Return success response
152:     return batchCreateMessagesResponseSchema.parse({
153:       success: true,
154:       data: {
155:         createdCount: messages.length,
156:         messages: messages.map(m => ({
157:           id: m.id,
158:           role: m.role,
159:           content: [{
160:             type: m.contentType,
161:             content: m.content,
162:             language: m.language,
163:           }],
164:           sessionId: m.conversationId,
165:           metadata: m.metadata,
166:           createdAt: m.createdAt,
167:           updatedAt: m.updatedAt,
168:         })),
169:       },
170:     });
171:   });
172: }
173: 
174: // Export wrapped handlers with error handling
175: export const batchDeleteChatSessions = withErrorHandling(
176:   batchDeleteSessionsHandler,
177:   batchDeleteSessionsResponseSchema,
178:   'batchDeleteSessions'
179: );
180: 
181: export const batchRestoreChatSessions = withErrorHandling(
182:   batchRestoreSessionsHandler,
183:   batchRestoreSessionsResponseSchema,
184:   'batchRestoreSessions'
185: );
186: 
187: export const batchArchiveChatSessions = withErrorHandling(
188:   batchArchiveSessionsHandler,
189:   batchArchiveSessionsResponseSchema,
190:   'batchArchiveSessions'
191: );
192: 
193: export const batchUpdateChatSessions = withErrorHandling(
194:   batchUpdateSessionsHandler,
195:   batchUpdateSessionsResponseSchema,
196:   'batchUpdateSessions'
197: );
198: 
199: export const batchDeleteChatMessages = withErrorHandling(
200:   batchDeleteMessagesHandler,
201:   batchDeleteMessagesResponseSchema,
202:   'batchDeleteMessages'
203: );
204: 
205: export const batchRestoreChatMessages = withErrorHandling(
206:   batchRestoreMessagesHandler,
207:   batchRestoreMessagesResponseSchema,
208:   'batchRestoreMessages'
209: );
210: 
211: export const batchCreateChatMessages = withErrorHandling(
212:   batchCreateMessagesHandler,
213:   batchCreateMessagesResponseSchema,
214:   'batchCreateMessages'
215: );
```

## File: apps/web/src/app/api/actions/chat/create-message.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { createMessageRequestSchema, createMessageResponseSchema } from '@danky/schema';
 5: import { createMessage } from '@/lib/db/chat';
 6: import { withUser } from '@/lib/session';
 7: import { withErrorHandling } from '@/lib/errors';
 8: 
 9: async function createMessageHandler(input: z.infer<typeof createMessageRequestSchema>) {
10:   return withUser(async (user) => {
11:     // Validate input
12:     const validatedInput = createMessageRequestSchema.parse(input);
13: 
14:     // Create message in database
15:     const message = await createMessage(validatedInput, user.id);
16: 
17:     // Transform message to match our schema
18:     const transformedMessage = {
19:       id: message.id,
20:       role: message.role,
21:       content: [{
22:         type: message.contentType,
23:         content: message.content,
24:         language: message.language,
25:       }],
26:       sessionId: message.conversationId,
27:       metadata: message.metadata,
28:       createdAt: message.createdAt,
29:       updatedAt: message.updatedAt,
30:     };
31: 
32:     // Return success response
33:     return createMessageResponseSchema.parse({
34:       success: true,
35:       data: transformedMessage,
36:     });
37:   });
38: }
39: 
40: // Export the wrapped handler with error handling
41: export const createChatMessage = withErrorHandling(
42:   createMessageHandler,
43:   createMessageResponseSchema,
44:   'createMessage'
45: );
```

## File: apps/web/src/app/api/actions/chat/create-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { createSessionRequestSchema, createSessionResponseSchema } from '@danky/schema';
 5: import { createSession } from '@/lib/db/chat';
 6: 
 7: export async function createChatSession(input: z.infer<typeof createSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = createSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Create session in database
16:     const session = await createSession(validatedInput, userId);
17: 
18:     // Transform session to match our schema
19:     const transformedSession = {
20:       id: session.id,
21:       name: session.title,
22:       modelId: input.modelId,
23:       metadata: session.metadata,
24:       createdAt: session.createdAt,
25:       updatedAt: session.updatedAt,
26:     };
27: 
28:     // Return success response
29:     return createSessionResponseSchema.parse({
30:       success: true,
31:       data: transformedSession,
32:     });
33:   } catch (error) {
34:     // Handle validation errors
35:     if (error instanceof z.ZodError) {
36:       return createSessionResponseSchema.parse({
37:         success: false,
38:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
39:       });
40:     }
41: 
42:     // Handle other errors
43:     console.error('Error creating session:', error);
44:     return createSessionResponseSchema.parse({
45:       success: false,
46:       error: 'Failed to create session',
47:     });
48:   }
49: }
```

## File: apps/web/src/app/api/actions/chat/delete-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { deleteSessionRequestSchema, deleteSessionResponseSchema } from '@danky/schema';
 5: import { deleteSession } from '@/lib/db/chat';
 6: 
 7: export async function deleteChatSession(input: z.infer<typeof deleteSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = deleteSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Delete session from database
16:     const session = await deleteSession(validatedInput, userId);
17: 
18:     if (!session) {
19:       return deleteSessionResponseSchema.parse({
20:         success: false,
21:         error: 'Session not found or you do not have permission to delete it',
22:       });
23:     }
24: 
25:     // Return success response
26:     return deleteSessionResponseSchema.parse({
27:       success: true,
28:       message: 'Session deleted successfully',
29:     });
30:   } catch (error) {
31:     // Handle validation errors
32:     if (error instanceof z.ZodError) {
33:       return deleteSessionResponseSchema.parse({
34:         success: false,
35:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
36:       });
37:     }
38: 
39:     // Handle other errors
40:     console.error('Error deleting session:', error);
41:     return deleteSessionResponseSchema.parse({
42:       success: false,
43:       error: 'Failed to delete session',
44:     });
45:   }
46: }
```

## File: apps/web/src/app/api/actions/chat/index.ts
```typescript
 1: // Message operations
 2: export { listMessages } from './list-messages';
 3: export { createChatMessage } from './create-message';
 4: 
 5: // Session operations
 6: export { createChatSession } from './create-session';
 7: export { listChatSessions } from './list-sessions';
 8: export { updateChatSession } from './update-session';
 9: export { deleteChatSession } from './delete-session';
10: 
11: // Batch operations
12: export {
13:   batchDeleteChatSessions,
14:   batchArchiveChatSessions,
15:   batchCreateChatMessages,
16: } from './batch-operations';
```

## File: apps/web/src/app/api/actions/chat/list-messages.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { listMessagesResponseSchema } from '@danky/schema';
 5: import { webListMessagesSchema } from '@/lib/validations/chat';
 6: import { getMessages } from '@/lib/db/chat';
 7: 
 8: export async function listMessages(input: z.infer<typeof webListMessagesSchema>) {
 9:   try {
10:     // Validate input
11:     const validatedInput = webListMessagesSchema.parse(input);
12: 
13:     // Query messages from database
14:     const { messages, pagination } = await getMessages(validatedInput);
15: 
16:     // Transform messages to match our schema
17:     const transformedMessages = messages.map(msg => ({
18:       id: msg.id,
19:       role: msg.role,
20:       content: [{
21:         type: 'text' as const,
22:         content: msg.content,
23:       }],
24:       sessionId: msg.conversationId,
25:       metadata: msg.metadata,
26:       createdAt: msg.createdAt,
27:       updatedAt: msg.updatedAt,
28:     }));
29: 
30:     // Return success response
31:     return listMessagesResponseSchema.parse({
32:       success: true,
33:       data: transformedMessages,
34:       pagination,
35:     });
36:   } catch (error) {
37:     // Handle validation errors
38:     if (error instanceof z.ZodError) {
39:       return listMessagesResponseSchema.parse({
40:         success: false,
41:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
42:       });
43:     }
44: 
45:     // Handle other errors
46:     console.error('Error listing messages:', error);
47:     return listMessagesResponseSchema.parse({
48:       success: false,
49:       error: 'Failed to list messages',
50:     });
51:   }
52: }
```

## File: apps/web/src/app/api/actions/chat/list-sessions.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { listSessionsRequestSchema, listSessionsResponseSchema } from '@danky/schema';
 5: import { getSessions } from '@/lib/db/chat';
 6: import { withUser } from '@/lib/session';
 7: import { withErrorHandling } from '@/lib/errors';
 8: 
 9: async function listChatSessionsHandler(input: z.infer<typeof listSessionsRequestSchema>) {
10:   return withUser(async (user) => {
11:     // Validate input
12:     const validatedInput = listSessionsRequestSchema.parse(input);
13: 
14:     // Get sessions from database
15:     const { sessions, pagination } = await getSessions(validatedInput, user.id);
16: 
17:     // Transform sessions to match our schema
18:     const transformedSessions = sessions.map(session => ({
19:       id: session.id,
20:       name: session.title,
21:       modelId: session.modelId,
22:       description: session.description ?? undefined,
23:       metadata: session.metadata,
24:       createdAt: session.createdAt,
25:       updatedAt: session.updatedAt,
26:     }));
27: 
28:     // Return success response
29:     return listSessionsResponseSchema.parse({
30:       success: true,
31:       data: transformedSessions,
32:       pagination,
33:     });
34:   });
35: }
36: 
37: // Export the wrapped handler with error handling
38: export const listChatSessions = withErrorHandling(
39:   listChatSessionsHandler,
40:   listSessionsResponseSchema,
41:   'listChatSessions'
42: );
```

## File: apps/web/src/app/api/actions/chat/update-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { updateSessionRequestSchema, updateSessionResponseSchema } from '@danky/schema';
 5: import { updateSession } from '@/lib/db/chat';
 6: 
 7: export async function updateChatSession(input: z.infer<typeof updateSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = updateSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Update session in database
16:     const session = await updateSession(validatedInput, userId);
17: 
18:     if (!session) {
19:       return updateSessionResponseSchema.parse({
20:         success: false,
21:         error: 'Session not found or you do not have permission to update it',
22:       });
23:     }
24: 
25:     // Transform session to match our schema
26:     const transformedSession = {
27:       id: session.id,
28:       name: session.title,
29:       modelId: session.metadata?.modelId ?? 'default-model',
30:       description: session.metadata?.description,
31:       metadata: session.metadata,
32:       createdAt: session.createdAt,
33:       updatedAt: session.updatedAt,
34:     };
35: 
36:     // Return success response
37:     return updateSessionResponseSchema.parse({
38:       success: true,
39:       data: transformedSession,
40:     });
41:   } catch (error) {
42:     // Handle validation errors
43:     if (error instanceof z.ZodError) {
44:       return updateSessionResponseSchema.parse({
45:         success: false,
46:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
47:       });
48:     }
49: 
50:     // Handle other errors
51:     console.error('Error updating session:', error);
52:     return updateSessionResponseSchema.parse({
53:       success: false,
54:       error: 'Failed to update session',
55:     });
56:   }
57: }
```

## File: apps/web/src/app/api/actions/chat.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { createMessageRequestSchema, createMessageResponseSchema } from '@danky/schema';
 5: import { webCreateMessageSchema } from '@/lib/validations/chat';
 6: 
 7: export async function createMessage(input: z.infer<typeof webCreateMessageSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = webCreateMessageSchema.parse(input);
11: 
12:     // TODO: Process message with AI provider
13:     // TODO: Save message to database
14:     
15:     // Return success response
16:     return createMessageResponseSchema.parse({
17:       success: true,
18:       data: {
19:         id: 'temp-id', // TODO: Replace with actual UUID
20:         role: validatedInput.role,
21:         content: validatedInput.content,
22:         sessionId: validatedInput.sessionId,
23:         metadata: validatedInput.metadata,
24:         createdAt: new Date(),
25:         updatedAt: new Date(),
26:       }
27:     });
28:   } catch (error) {
29:     // Handle validation errors
30:     if (error instanceof z.ZodError) {
31:       return createMessageResponseSchema.parse({
32:         success: false,
33:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
34:       });
35:     }
36: 
37:     // Handle other errors
38:     console.error('Error creating message:', error);
39:     return createMessageResponseSchema.parse({
40:       success: false,
41:       error: 'Failed to create message',
42:     });
43:   }
44: }
```

## File: apps/web/src/app/api/actions/mcp.ts
```typescript
 1: 'use server'
 2: 
 3: import { MCPService } from '@danky/mcp'
 4: 
 5: let mcpService: MCPService | null = null
 6: 
 7: async function getMCPService() {
 8:   if (!mcpService) {
 9:     mcpService = new MCPService()
10:     await mcpService.initialize()
11:   }
12:   return mcpService
13: }
14: 
15: export async function initialize() {
16:   try {
17:     const service = await getMCPService()
18:     return { success: true }
19:   } catch (error) {
20:     console.error('Failed to initialize MCP service:', error)
21:     return { success: false, error: error instanceof Error ? error.message : String(error) }
22:   }
23: }
24: 
25: export async function getStatus() {
26:   try {
27:     const service = await getMCPService()
28:     return { success: true, status: { isInitialized: true } }
29:   } catch (error) {
30:     console.error('Failed to get MCP service status:', error)
31:     return { success: false, error: error instanceof Error ? error.message : String(error) }
32:   }
33: }
34: 
35: export async function getTools() {
36:   try {
37:     const service = await getMCPService()
38:     return { success: true, tools: [] }
39:   } catch (error) {
40:     console.error('Failed to get MCP tools:', error)
41:     return { success: false, error: error instanceof Error ? error.message : String(error) }
42:   }
43: }
44: 
45: export async function processMessage(message: string) {
46:   try {
47:     const service = await getMCPService()
48:     const response = await service.processMessage(message)
49:     return { success: true, response }
50:   } catch (error) {
51:     console.error('Failed to process message:', error)
52:     return { success: false, error: error instanceof Error ? error.message : String(error) }
53:   }
54: }
55: 
56: export async function shutdown() {
57:   try {
58:     if (mcpService) {
59:       await mcpService.shutdown()
60:       mcpService = null
61:     }
62:     return { success: true }
63:   } catch (error) {
64:     console.error('Failed to shutdown MCP service:', error)
65:     return { success: false, error: error instanceof Error ? error.message : String(error) }
66:   }
67: }
```

## File: apps/web/src/app/api/chat/sessions/[sessionId]/messages/route.ts
```typescript
 1: import { type NextRequest } from 'next/server'
 2: import { z } from 'zod'
 3: 
 4: // Mock data for development
 5: const messages = [
 6:   {
 7:     id: "1",
 8:     content: "Hello!",
 9:     role: "user",
10:     timestamp: new Date().toISOString()
11:   }
12: ]
13: 
14: const sessionParamsSchema = z.object({
15:   sessionId: z.string()
16: })
17: 
18: type RouteContext = {
19:   params: Promise<{ sessionId: string }>
20: }
21: 
22: export async function GET(
23:   request: Request,
24:   context: RouteContext
25: ): Promise<Response> {
26:   try {
27:     const { sessionId } = await context.params
28:     sessionParamsSchema.parse({ sessionId })
29:     
30:     // Mock response for development
31:     return Response.json({ messages })
32:   } catch (error) {
33:     console.error("Error fetching messages:", error)
34:     if (error instanceof z.ZodError) {
35:       return Response.json(
36:         { error: "Invalid session ID", details: error.errors },
37:         { status: 400 }
38:       )
39:     }
40:     return Response.json(
41:       { error: "Failed to fetch messages" },
42:       { status: 500 }
43:     )
44:   }
45: }
46: 
47: const messageSchema = z.object({
48:   content: z.string(),
49:   role: z.enum(["user", "assistant"])
50: })
51: 
52: export async function POST(
53:   request: Request,
54:   context: RouteContext
55: ): Promise<Response> {
56:   try {
57:     const { sessionId } = await context.params
58:     sessionParamsSchema.parse({ sessionId })
59:     
60:     const body = await request.json()
61:     const message = messageSchema.parse(body)
62:     
63:     // Mock response for development
64:     return Response.json({
65:       message: {
66:         ...message,
67:         id: Math.random().toString(),
68:         timestamp: new Date().toISOString()
69:       }
70:     })
71:   } catch (error) {
72:     console.error("Error adding message:", error)
73:     if (error instanceof z.ZodError) {
74:       return Response.json(
75:         { error: "Invalid message", details: error.errors },
76:         { status: 400 }
77:       )
78:     }
79:     return Response.json(
80:       { error: "Failed to add message" },
81:       { status: 500 }
82:     )
83:   }
84: }
```

## File: apps/web/src/app/api/chat/sessions/route.ts
```typescript
 1: import { type NextRequest, NextResponse } from 'next/server'
 2: import { z } from 'zod'
 3: 
 4: // In-memory storage for development
 5: const sessions: Array<{
 6:   id: string
 7:   title: string
 8:   lastMessage: string
 9:   timestamp: Date
10: }> = [
11:   {
12:     id: "1",
13:     title: "General Chat",
14:     lastMessage: "Hello! How can I help you today?",
15:     timestamp: new Date()
16:   }
17: ]
18: 
19: const createSessionSchema = z.object({
20:   title: z.string(),
21:   lastMessage: z.string()
22: })
23: 
24: export async function GET(_request: NextRequest) {
25:   return NextResponse.json({ 
26:     sessions: sessions.map(session => ({
27:       ...session,
28:       timestamp: session.timestamp.toISOString()
29:     }))
30:   })
31: }
32: 
33: export async function POST(request: NextRequest) {
34:   try {
35:     const body = await request.json()
36:     const { title, lastMessage } = createSessionSchema.parse(body)
37:     
38:     const session = {
39:       id: Date.now().toString(),
40:       title,
41:       lastMessage,
42:       timestamp: new Date()
43:     }
44:     
45:     sessions.unshift(session)
46:     
47:     return NextResponse.json({ 
48:       sessionId: session.id,
49:       session: {
50:         ...session,
51:         timestamp: session.timestamp.toISOString()
52:       }
53:     })
54:   } catch (error) {
55:     console.error("Error creating session:", error)
56:     if (error instanceof z.ZodError) {
57:       return NextResponse.json(
58:         { error: "Invalid request", details: error.errors },
59:         { status: 400 }
60:       )
61:     }
62:     return NextResponse.json(
63:       { error: "Failed to create session" },
64:       { status: 500 }
65:     )
66:   }
67: }
```

## File: apps/web/src/app/api/chat/route.ts
```typescript
 1: import { NextResponse } from 'next/server'
 2: import { createLogger } from '@danky/mcp'
 3: import { MCPService } from '@danky/mcp'
 4: import path from 'path'
 5: 
 6: const logger = createLogger({ level: 'debug' })
 7: const mcpService = new MCPService({
 8:   configPath: path.join(process.cwd(), '../../mcp-config.json5'),
 9:   logger
10: })
11: 
12: export async function POST(request: Request) {
13:   try {
14:     const { message } = await request.json()
15:     
16:     if (!message || typeof message !== 'string') {
17:       logger.error('Invalid message format:', { message })
18:       return NextResponse.json(
19:         { error: 'Invalid message format' },
20:         { status: 400 }
21:       )
22:     }
23: 
24:     logger.debug('Processing message:', { message })
25:     const response = await mcpService.processMessage(message)
26:     logger.debug('Response:', { response })
27:     
28:     return NextResponse.json({ response })
29:   } catch (error) {
30:     logger.error('Error processing message:', {
31:       error: error instanceof Error ? {
32:         name: error.name,
33:         message: error.message,
34:         stack: error.stack
35:       } : String(error)
36:     })
37:     return NextResponse.json(
38:       { error: error instanceof Error ? error.message : String(error) },
39:       { status: 500 }
40:     )
41:   }
42: }
43: 
44: export async function GET() {
45:   try {
46:     logger.debug('Initializing MCP service')
47:     await mcpService.initialize()
48:     logger.debug('MCP service initialized')
49:     
50:     return NextResponse.json({ status: 'ready' })
51:   } catch (error) {
52:     logger.error('Error initializing chat:', {
53:       error: error instanceof Error ? {
54:         name: error.name,
55:         message: error.message,
56:         stack: error.stack
57:       } : String(error)
58:     })
59:     return NextResponse.json(
60:       { error: error instanceof Error ? error.message : String(error) },
61:       { status: 500 }
62:     )
63:   }
64: }
```

## File: apps/web/src/app/api/routes/chat.ts
```typescript
 1: import { NextRequest } from 'next/server';
 2: import {
 3:   createChatSession,
 4:   listChatSessions,
 5:   updateChatSession,
 6:   deleteChatSession,
 7:   batchDeleteChatSessions,
 8:   batchRestoreChatSessions,
 9:   batchArchiveChatSessions,
10:   batchUpdateChatSessions,
11:   batchDeleteChatMessages,
12:   batchRestoreChatMessages,
13:   batchCreateChatMessages,
14: } from '../actions/chat';
15: 
16: // Session routes
17: export async function POST(request: NextRequest) {
18:   const body = await request.json();
19:   return createChatSession(body);
20: }
21: 
22: export async function GET(request: NextRequest) {
23:   const searchParams = request.nextUrl.searchParams;
24:   const page = parseInt(searchParams.get('page') || '1', 10);
25:   const limit = parseInt(searchParams.get('limit') || '50', 10);
26:   const search = searchParams.get('search') || undefined;
27:   
28:   return listChatSessions({ page, limit, search });
29: }
30: 
31: // Session operations by ID
32: export async function PUT(request: NextRequest) {
33:   const body = await request.json();
34:   return updateChatSession(body);
35: }
36: 
37: export async function DELETE(request: NextRequest) {
38:   const searchParams = request.nextUrl.searchParams;
39:   const id = searchParams.get('id');
40:   
41:   if (!id) {
42:     return new Response('Missing session ID', { status: 400 });
43:   }
44:   
45:   return deleteChatSession({ id });
46: }
47: 
48: // Batch session operations
49: export async function POST_batch_delete(request: NextRequest) {
50:   const body = await request.json();
51:   return batchDeleteChatSessions(body);
52: }
53: 
54: export async function POST_batch_restore(request: NextRequest) {
55:   const body = await request.json();
56:   return batchRestoreChatSessions(body);
57: }
58: 
59: export async function POST_batch_archive(request: NextRequest) {
60:   const body = await request.json();
61:   return batchArchiveChatSessions(body);
62: }
63: 
64: export async function POST_batch_update(request: NextRequest) {
65:   const body = await request.json();
66:   return batchUpdateChatSessions(body);
67: }
68: 
69: // Batch message operations
70: export async function POST_batch_messages_delete(request: NextRequest) {
71:   const body = await request.json();
72:   return batchDeleteChatMessages(body);
73: }
74: 
75: export async function POST_batch_messages_restore(request: NextRequest) {
76:   const body = await request.json();
77:   return batchRestoreChatMessages(body);
78: }
79: 
80: export async function POST_batch_messages_create(request: NextRequest) {
81:   const body = await request.json();
82:   return batchCreateChatMessages(body);
83: }
```

## File: apps/web/src/app/chat/page.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect } from 'react'
 4: import { useChatStore } from '@/lib/stores/chat-store'
 5: import { ChatInput } from '@/components/chat/chat-input'
 6: import { ChatMessages } from '@/components/chat/chat-messages'
 7: import { LoadingSpinner } from '@/components/ui/loading-spinner'
 8: import { ChatLayout } from '@/components/chat/chat-layout'
 9: import { Sidebar } from '@/components/chat/sidebar'
10: import { type ChatSession, type Server } from '@/components/chat/types'
11: import { Alert, AlertDescription } from '@danky/ui'
12: import { AlertCircle } from 'lucide-react'
13: 
14: // Mock data for models - replace with real data later
15: const mockModels = [
16:   { id: 'gpt-4', name: 'GPT-4', isFavorite: true },
17:   { id: 'gpt-3.5', name: 'GPT-3.5', isFavorite: true },
18:   { id: 'claude-2', name: 'Claude 2', isFavorite: false },
19:   { id: 'llama-2', name: 'Llama 2', isFavorite: false },
20: ]
21: 
22: export default function ChatPage() {
23:   const { 
24:     messages, 
25:     isInitializing, 
26:     isProcessing, 
27:     error, 
28:     initialize, 
29:     clearError 
30:   } = useChatStore()
31: 
32:   useEffect(() => {
33:     void initialize();
34:   }, [initialize]);
35: 
36:   if (isInitializing) {
37:     return (
38:       <div className="h-full flex items-center justify-center">
39:         <LoadingSpinner />
40:       </div>
41:     )
42:   }
43: 
44:   return (
45:     <div className="h-full">
46:       <ChatLayout
47:         sidebar={
48:           <Sidebar
49:             models={mockModels}
50:             currentModel="claude-2"
51:             onModelSelect={() => {}}
52:             onToggleFavorite={() => {}}
53:             user={{
54:               name: "John Doe",
55:               email: "john@example.com",
56:               isAdmin: true,
57:             }}
58:           />
59:         }
60:       >
61:         <div className="flex h-full flex-col">
62:           {error && (
63:             <Alert variant="destructive" className="m-4">
64:               <AlertCircle className="h-4 w-4" />
65:               <AlertDescription>
66:                 {error}
67:                 <button 
68:                   onClick={clearError}
69:                   className="ml-2 underline hover:no-underline"
70:                 >
71:                   Dismiss
72:                 </button>
73:               </AlertDescription>
74:             </Alert>
75:           )}
76:           <div className="flex-1 overflow-y-auto p-4">
77:             <ChatMessages messages={messages} />
78:           </div>
79:           <div className="border-t p-4">
80:             <ChatInput 
81:               isProcessing={isProcessing}
82:               servers={[]}
83:               onToolSelect={() => {}}
84:             />
85:           </div>
86:         </div>
87:       </ChatLayout>
88:     </div>
89:   )
90: }
```

## File: apps/web/src/app/error.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect } from 'react'
 4: 
 5: export default function Error({
 6:   error,
 7:   reset,
 8: }: {
 9:   error: Error & { digest?: string }
10:   reset: () => void
11: }) {
12:   useEffect(() => {
13:     console.error('Error:', error)
14:   }, [error])
15: 
16:   return (
17:     <div className="flex flex-col items-center justify-center min-h-screen">
18:       <h2 className="text-2xl font-bold mb-4">Something went wrong!</h2>
19:       <button
20:         onClick={() => reset()}
21:         className="px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90"
22:       >
23:         Try again
24:       </button>
25:     </div>
26:   )
27: }
```

## File: apps/web/src/app/globals.css
```css
 1: @tailwind base;
 2: @tailwind components;
 3: @tailwind utilities;
 4: 
 5: @layer base {
 6:   :root {
 7:     --background: 0 0% 100%;
 8:     --foreground: 222.2 84% 4.9%;
 9: 
10:     --card: 0 0% 100%;
11:     --card-foreground: 222.2 84% 4.9%;
12: 
13:     --popover: 0 0% 100%;
14:     --popover-foreground: 222.2 84% 4.9%;
15: 
16:     --primary: 222.2 47.4% 11.2%;
17:     --primary-foreground: 210 40% 98%;
18: 
19:     --secondary: 210 40% 96.1%;
20:     --secondary-foreground: 222.2 47.4% 11.2%;
21: 
22:     --muted: 210 40% 96.1%;
23:     --muted-foreground: 215.4 16.3% 46.9%;
24: 
25:     --accent: 210 40% 96.1%;
26:     --accent-foreground: 222.2 47.4% 11.2%;
27: 
28:     --destructive: 0 84.2% 60.2%;
29:     --destructive-foreground: 210 40% 98%;
30: 
31:     --border: 214.3 31.8% 91.4%;
32:     --input: 214.3 31.8% 91.4%;
33:     --ring: 222.2 84% 4.9%;
34: 
35:     --radius: 0.5rem;
36: 
37:     /* Sidebar specific theme variables */
38:     --sidebar-background: 0 0% 98%;
39:     --sidebar-foreground: 240 5.3% 26.1%;
40:     --sidebar-primary: 240 5.9% 10%;
41:     --sidebar-primary-foreground: 0 0% 98%;
42:     --sidebar-accent: 240 4.8% 95.9%;
43:     --sidebar-accent-foreground: 240 5.9% 10%;
44:     --sidebar-border: 220 13% 91%;
45:     --sidebar-ring: 217.2 91.2% 59.8%;
46:   }
47: 
48:   .dark {
49:     --background: 222.2 84% 4.9%;
50:     --foreground: 210 40% 98%;
51: 
52:     --card: 222.2 84% 4.9%;
53:     --card-foreground: 210 40% 98%;
54: 
55:     --popover: 222.2 84% 4.9%;
56:     --popover-foreground: 210 40% 98%;
57: 
58:     --primary: 210 40% 98%;
59:     --primary-foreground: 222.2 47.4% 11.2%;
60: 
61:     --secondary: 217.2 32.6% 17.5%;
62:     --secondary-foreground: 210 40% 98%;
63: 
64:     --muted: 217.2 32.6% 17.5%;
65:     --muted-foreground: 215 20.2% 65.1%;
66: 
67:     --accent: 217.2 32.6% 17.5%;
68:     --accent-foreground: 210 40% 98%;
69: 
70:     --destructive: 0 62.8% 30.6%;
71:     --destructive-foreground: 210 40% 98%;
72: 
73:     --border: 217.2 32.6% 17.5%;
74:     --input: 217.2 32.6% 17.5%;
75:     --ring: 212.7 26.8% 83.9%;
76: 
77:     /* Sidebar specific dark theme variables */
78:     --sidebar-background: 240 5.9% 10%;
79:     --sidebar-foreground: 240 4.8% 95.9%;
80:     --sidebar-primary: 224.3 76.3% 48%;
81:     --sidebar-primary-foreground: 0 0% 100%;
82:     --sidebar-accent: 240 3.7% 15.9%;
83:     --sidebar-accent-foreground: 240 4.8% 95.9%;
84:     --sidebar-border: 240 3.7% 15.9%;
85:     --sidebar-ring: 217.2 91.2% 59.8%;
86:   }
87: }
88: 
89: @layer base {
90:   * {
91:     @apply border-border;
92:   }
93:   body {
94:     @apply bg-background text-foreground;
95:   }
96: }
```

## File: apps/web/src/app/layout.tsx
```typescript
 1: import { Noto_Sans } from "next/font/google"
 2: import { Metadata, Viewport } from "next"
 3: import { cn } from "@danky/ui"
 4: import { Providers } from "../components/providers"
 5: import "./globals.css"
 6: 
 7: const notoSans = Noto_Sans({
 8:   subsets: ["latin"],
 9:   weight: ["400", "500", "600", "700"],
10:   variable: "--font-sans",
11: })
12: 
13: export const metadata: Metadata = {
14:   title: 'Danky',
15:   description: 'AI-powered chat interface',
16: }
17: 
18: export const viewport: Viewport = {
19:   width: 'device-width',
20:   initialScale: 1,
21: }
22: 
23: export default function RootLayout({
24:   children,
25: }: {
26:   children: React.ReactNode
27: }) {
28:   return (
29:     <html lang="en" suppressHydrationWarning className="h-full">
30:       <head />
31:       <body 
32:         className={cn(
33:           notoSans.variable,
34:           "font-sans antialiased bg-background",
35:           "h-full w-full"
36:         )}
37:       >
38:         <Providers>
39:           {children}
40:         </Providers>
41:       </body>
42:     </html>
43:   )
44: }
```

## File: apps/web/src/app/not-found.tsx
```typescript
1: export default function NotFound() {
2:   return (
3:     <div className="flex flex-col items-center justify-center min-h-screen">
4:       <h2 className="text-2xl font-bold mb-4">404 - Page Not Found</h2>
5:       <p className="text-muted-foreground">The page you're looking for doesn't exist.</p>
6:     </div>
7:   )
8: }
```

## File: apps/web/src/app/page.module.css
```css
  1: .page {
  2:   --gray-rgb: 0, 0, 0;
  3:   --gray-alpha-200: rgba(var(--gray-rgb), 0.08);
  4:   --gray-alpha-100: rgba(var(--gray-rgb), 0.05);
  5: 
  6:   --button-primary-hover: #383838;
  7:   --button-secondary-hover: #f2f2f2;
  8: 
  9:   display: grid;
 10:   grid-template-rows: 20px 1fr 20px;
 11:   align-items: center;
 12:   justify-items: center;
 13:   min-height: 100svh;
 14:   padding: 80px;
 15:   gap: 64px;
 16:   font-synthesis: none;
 17: }
 18: 
 19: @media (prefers-color-scheme: dark) {
 20:   .page {
 21:     --gray-rgb: 255, 255, 255;
 22:     --gray-alpha-200: rgba(var(--gray-rgb), 0.145);
 23:     --gray-alpha-100: rgba(var(--gray-rgb), 0.06);
 24: 
 25:     --button-primary-hover: #ccc;
 26:     --button-secondary-hover: #1a1a1a;
 27:   }
 28: }
 29: 
 30: .main {
 31:   display: flex;
 32:   flex-direction: column;
 33:   gap: 32px;
 34:   grid-row-start: 2;
 35: }
 36: 
 37: .main ol {
 38:   font-family: var(--font-geist-mono);
 39:   padding-left: 0;
 40:   margin: 0;
 41:   font-size: 14px;
 42:   line-height: 24px;
 43:   letter-spacing: -0.01em;
 44:   list-style-position: inside;
 45: }
 46: 
 47: .main li:not(:last-of-type) {
 48:   margin-bottom: 8px;
 49: }
 50: 
 51: .main code {
 52:   font-family: inherit;
 53:   background: var(--gray-alpha-100);
 54:   padding: 2px 4px;
 55:   border-radius: 4px;
 56:   font-weight: 600;
 57: }
 58: 
 59: .ctas {
 60:   display: flex;
 61:   gap: 16px;
 62: }
 63: 
 64: .ctas a {
 65:   appearance: none;
 66:   border-radius: 128px;
 67:   height: 48px;
 68:   padding: 0 20px;
 69:   border: none;
 70:   font-family: var(--font-geist-sans);
 71:   border: 1px solid transparent;
 72:   transition: background 0.2s, color 0.2s, border-color 0.2s;
 73:   cursor: pointer;
 74:   display: flex;
 75:   align-items: center;
 76:   justify-content: center;
 77:   font-size: 16px;
 78:   line-height: 20px;
 79:   font-weight: 500;
 80: }
 81: 
 82: a.primary {
 83:   background: var(--foreground);
 84:   color: var(--background);
 85:   gap: 8px;
 86: }
 87: 
 88: a.secondary {
 89:   border-color: var(--gray-alpha-200);
 90:   min-width: 180px;
 91: }
 92: 
 93: button.secondary {
 94:   appearance: none;
 95:   border-radius: 128px;
 96:   height: 48px;
 97:   padding: 0 20px;
 98:   border: none;
 99:   font-family: var(--font-geist-sans);
100:   border: 1px solid transparent;
101:   transition: background 0.2s, color 0.2s, border-color 0.2s;
102:   cursor: pointer;
103:   display: flex;
104:   align-items: center;
105:   justify-content: center;
106:   font-size: 16px;
107:   line-height: 20px;
108:   font-weight: 500;
109:   background: transparent;
110:   border-color: var(--gray-alpha-200);
111:   min-width: 180px;
112: }
113: 
114: .footer {
115:   font-family: var(--font-geist-sans);
116:   grid-row-start: 3;
117:   display: flex;
118:   gap: 24px;
119: }
120: 
121: .footer a {
122:   display: flex;
123:   align-items: center;
124:   gap: 8px;
125: }
126: 
127: .footer img {
128:   flex-shrink: 0;
129: }
130: 
131: /* Enable hover only on non-touch devices */
132: @media (hover: hover) and (pointer: fine) {
133:   a.primary:hover {
134:     background: var(--button-primary-hover);
135:     border-color: transparent;
136:   }
137: 
138:   a.secondary:hover {
139:     background: var(--button-secondary-hover);
140:     border-color: transparent;
141:   }
142: 
143:   .footer a:hover {
144:     text-decoration: underline;
145:     text-underline-offset: 4px;
146:   }
147: }
148: 
149: @media (max-width: 600px) {
150:   .page {
151:     padding: 32px;
152:     padding-bottom: 80px;
153:   }
154: 
155:   .main {
156:     align-items: center;
157:   }
158: 
159:   .main ol {
160:     text-align: center;
161:   }
162: 
163:   .ctas {
164:     flex-direction: column;
165:   }
166: 
167:   .ctas a {
168:     font-size: 14px;
169:     height: 40px;
170:     padding: 0 16px;
171:   }
172: 
173:   a.secondary {
174:     min-width: auto;
175:   }
176: 
177:   .footer {
178:     flex-wrap: wrap;
179:     align-items: center;
180:     justify-content: center;
181:   }
182: }
183: 
184: @media (prefers-color-scheme: dark) {
185:   .logo {
186:     filter: invert();
187:   }
188: }
```

## File: apps/web/src/app/page.tsx
```typescript
1: import { redirect } from 'next/navigation'
2: 
3: export default function RootPage() {
4:   redirect('/chat')
5: }
```

## File: apps/web/src/app/providers.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ThemeProvider } from 'next-themes'
 4: import { type PropsWithChildren } from 'react'
 5: 
 6: export function Providers({ children }: PropsWithChildren) {
 7:   return (
 8:     <ThemeProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:     >
14:       {children}
15:     </ThemeProvider>
16:   )
17: }
```

## File: apps/web/src/components/chat/attachment-button.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import {
  5:   Button,
  6:   Dialog,
  7:   DialogContent,
  8:   DialogDescription,
  9:   DialogFooter,
 10:   DialogHeader,
 11:   DialogTitle,
 12:   DialogTrigger,
 13:   ScrollArea,
 14: } from "@danky/ui"
 15: import { Paperclip, File, Folder, X, Upload } from "lucide-react"
 16: 
 17: interface FilePreview {
 18:   name: string
 19:   size: number
 20:   type: string
 21: }
 22: 
 23: interface HTMLInputEvent extends Event {
 24:   target: HTMLInputElement & EventTarget;
 25: }
 26: 
 27: export function AttachmentButton() {
 28:   const [files, setFiles] = React.useState<FilePreview[]>([])
 29:   const [open, setOpen] = React.useState(false)
 30:   const fileInputRef = React.useRef<HTMLInputElement>(null)
 31:   const folderInputRef = React.useRef<HTMLInputElement>(null)
 32: 
 33:   const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
 34:     const selectedFiles = Array.from(e.target.files || []).map(file => ({
 35:       name: file.name,
 36:       size: file.size,
 37:       type: file.type
 38:     }))
 39:     setFiles(prev => [...prev, ...selectedFiles])
 40:   }
 41: 
 42:   const removeFile = (fileName: string) => {
 43:     setFiles(files.filter(file => file.name !== fileName))
 44:   }
 45: 
 46:   const handleUpload = () => {
 47:     // TODO: Implement file upload
 48:     console.log('Uploading files:', files)
 49:     setFiles([])
 50:     setOpen(false)
 51:   }
 52: 
 53:   const formatFileSize = (bytes: number) => {
 54:     if (bytes === 0) return '0 Bytes'
 55:     const k = 1024
 56:     const sizes = ['Bytes', 'KB', 'MB', 'GB']
 57:     const i = Math.floor(Math.log(bytes) / Math.log(k))
 58:     return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]
 59:   }
 60: 
 61:   return (
 62:     <Dialog open={open} onOpenChange={setOpen}>
 63:       <DialogTrigger asChild>
 64:         <Button variant="ghost" size="icon" className="h-8 w-8">
 65:           <Paperclip className="h-4 w-4" />
 66:           <span className="sr-only">Attach files</span>
 67:         </Button>
 68:       </DialogTrigger>
 69:       <DialogContent className="sm:max-w-[425px]">
 70:         <DialogHeader>
 71:           <DialogTitle>Attach Files</DialogTitle>
 72:           <DialogDescription>
 73:             Upload files or folders to share in the chat.
 74:           </DialogDescription>
 75:         </DialogHeader>
 76:         <div className="grid gap-4 py-4">
 77:           <div className="flex items-center gap-4">
 78:             <input
 79:               type="file"
 80:               ref={fileInputRef}
 81:               onChange={handleFileChange}
 82:               className="hidden"
 83:               multiple
 84:             />
 85:             <input
 86:               type="file"
 87:               ref={folderInputRef}
 88:               onChange={handleFileChange}
 89:               className="hidden"
 90:               {...{ webkitdirectory: "", directory: "" } as any}
 91:             />
 92:             <Button
 93:               variant="secondary"
 94:               onClick={() => fileInputRef.current?.click()}
 95:               className="flex-1"
 96:             >
 97:               <File className="mr-2 h-4 w-4" />
 98:               Choose Files
 99:             </Button>
100:             <Button
101:               variant="secondary"
102:               onClick={() => folderInputRef.current?.click()}
103:               className="flex-1"
104:             >
105:               <Folder className="mr-2 h-4 w-4" />
106:               Choose Folder
107:             </Button>
108:           </div>
109:           {files.length > 0 && (
110:             <ScrollArea className="h-[200px] w-full rounded-md border p-4">
111:               <div className="space-y-2">
112:                 {files.map((file) => (
113:                   <div
114:                     key={file.name}
115:                     className="flex items-center justify-between gap-2 rounded-lg border p-2 text-sm"
116:                   >
117:                     <div className="flex items-center gap-2 overflow-hidden">
118:                       <File className="h-4 w-4 flex-shrink-0" />
119:                       <span className="truncate">{file.name}</span>
120:                       <span className="text-xs text-muted-foreground">
121:                         ({formatFileSize(file.size)})
122:                       </span>
123:                     </div>
124:                     <Button
125:                       variant="ghost"
126:                       size="icon"
127:                       className="h-6 w-6"
128:                       onClick={() => removeFile(file.name)}
129:                     >
130:                       <X className="h-4 w-4" />
131:                       <span className="sr-only">Remove file</span>
132:                     </Button>
133:                   </div>
134:                 ))}
135:               </div>
136:             </ScrollArea>
137:           )}
138:         </div>
139:         <DialogFooter>
140:           <Button
141:             onClick={handleUpload}
142:             disabled={files.length === 0}
143:             className="w-full sm:w-auto"
144:           >
145:             <Upload className="mr-2 h-4 w-4" />
146:             Upload {files.length} {files.length === 1 ? 'file' : 'files'}
147:           </Button>
148:         </DialogFooter>
149:       </DialogContent>
150:     </Dialog>
151:   )
152: }
```

## File: apps/web/src/components/chat/chat-input.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useState } from 'react'
 4: import { useChatStore } from '@/lib/stores/chat-store'
 5: import { Button, Textarea, buttonVariants } from '@danky/ui'
 6: import { SendHorizontal, Loader2 } from 'lucide-react'
 7: import { AttachmentButton } from './attachment-button'
 8: import { ToolsDropdown } from './tools-dropdown'
 9: import { type Server } from './types'
10: import { cn } from '@danky/ui'
11: 
12: interface ChatInputProps {
13:   isProcessing: boolean
14:   servers?: Server[]
15:   onToolSelect?: (serverId: string, toolId: string) => void
16: }
17: 
18: export function ChatInput({ 
19:   isProcessing,
20:   servers = [],
21:   onToolSelect = () => {},
22: }: ChatInputProps) {
23:   const [input, setInput] = useState('')
24:   const sendMessage = useChatStore((state) => state.sendMessage)
25: 
26:   const handleSubmit = (event: React.FormEvent) => {
27:     event.preventDefault();
28:     if (!input.trim() || isProcessing) return;
29: 
30:     const message = input.trim();
31:     setInput('');
32:     void sendMessage(message);
33:   };
34: 
35:   const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {
36:     if (e.key === 'Enter' && !e.shiftKey) {
37:       e.preventDefault()
38:       handleSubmit(e)
39:     }
40:   }
41: 
42:   return (
43:     <form onSubmit={handleSubmit} className="relative flex items-center gap-2">
44:       <AttachmentButton />
45:       <div className="relative flex-1">
46:         <Textarea
47:           value={input}
48:           onChange={(e) => setInput(e.target.value)}
49:           onKeyDown={handleKeyDown}
50:           placeholder="Type a message..."
51:           disabled={isProcessing}
52:           className="min-h-[48px] w-full resize-none rounded-lg pr-24"
53:         />
54:         <div className="absolute right-2 bottom-2 flex items-center gap-2">
55:           <ToolsDropdown
56:             servers={servers}
57:             onToolSelect={onToolSelect}
58:             isLoading={isProcessing}
59:           />
60:           <button
61:             type="submit"
62:             disabled={isProcessing || !input.trim()}
63:             className={cn(
64:               buttonVariants({ variant: 'default', size: 'icon' }),
65:               'h-8 w-8'
66:             )}
67:           >
68:             {isProcessing ? (
69:               <Loader2 className="h-4 w-4 animate-spin" />
70:             ) : (
71:               <SendHorizontal className="h-4 w-4" />
72:             )}
73:             <span className="sr-only">Send message</span>
74:           </button>
75:         </div>
76:       </div>
77:     </form>
78:   )
79: }
```

## File: apps/web/src/components/chat/chat-layout.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ReactNode } from 'react'
 4: 
 5: interface ChatLayoutProps {
 6:   children: ReactNode
 7:   sidebar: ReactNode
 8: }
 9: 
10: export function ChatLayout({ children, sidebar }: ChatLayoutProps) {
11:   return (
12:     <div className="flex h-screen">
13:       <div className="w-64 border-r bg-background">
14:         {sidebar}
15:       </div>
16:       <div className="flex-1">
17:         {children}
18:       </div>
19:     </div>
20:   )
21: }
```

## File: apps/web/src/components/chat/chat-messages.tsx
```typescript
 1: 'use client'
 2: 
 3: import { Message } from './message'
 4: import { type Message as MessageType } from './types'
 5: import { cn } from '@danky/ui'
 6: 
 7: interface ChatMessagesProps {
 8:   messages: MessageType[]
 9: }
10: 
11: export function ChatMessages({ messages }: ChatMessagesProps) {
12:   return (
13:     <div className="flex flex-col space-y-4">
14:       {messages.map((message, index) => (
15:         <Message
16:           key={`${message.role}-${index}-${message.timestamp.getTime()}`}
17:           role={message.role}
18:           content={message.content}
19:           timestamp={message.timestamp}
20:         />
21:       ))}
22:       {messages.length === 0 && (
23:         <div className="flex h-[50vh] items-center justify-center text-muted-foreground">
24:           Start a conversation...
25:         </div>
26:       )}
27:     </div>
28:   )
29: }
```

## File: apps/web/src/components/chat/message-content.tsx
```typescript
 1: "use client"
 2: 
 3: import { getHighlighter, type Highlighter, bundledLanguages } from 'shiki'
 4: import { useTheme } from 'next-themes'
 5: import ReactMarkdown from 'react-markdown'
 6: import remarkGfm from 'remark-gfm'
 7: import remarkMath from 'remark-math'
 8: import rehypeKatex from 'rehype-katex'
 9: import rehypeRaw from 'rehype-raw'
10: import { useEffect, useState } from 'react'
11: 
12: interface MessageContentProps {
13:   content: string
14: }
15: 
16: export function MessageContent({ content }: MessageContentProps) {
17:   const { theme } = useTheme()
18:   const [highlighter, setHighlighter] = useState<Highlighter | null>(null)
19: 
20:   useEffect(() => {
21:     getHighlighter({
22:       themes: [theme === 'dark' ? 'github-dark' : 'github-light'],
23:       langs: Object.keys(bundledLanguages),
24:     }).then(setHighlighter)
25:   }, [theme])
26: 
27:   return (
28:     <ReactMarkdown
29:       remarkPlugins={[remarkGfm, remarkMath]}
30:       rehypePlugins={[rehypeKatex, rehypeRaw]}
31:       components={{
32:         code({ className, children }) {
33:           const match = /language-(\w+)/.exec(className || '')
34:           const language = match ? match[1] : 'text'
35: 
36:           if (!className || !highlighter) {
37:             return <code className={className}>{children}</code>
38:           }
39: 
40:           const html = highlighter.codeToHtml(String(children), {
41:             lang: language,
42:             theme: theme === 'dark' ? 'github-dark' : 'github-light',
43:           })
44: 
45:           return (
46:             <div
47:               dangerouslySetInnerHTML={{ __html: html }}
48:               className="not-prose"
49:             />
50:           )
51:         },
52:       }}
53:     >
54:       {content}
55:     </ReactMarkdown>
56:   )
57: }
```

## File: apps/web/src/components/chat/message.tsx
```typescript
 1: 'use client'
 2: 
 3: import { Avatar, AvatarImage, AvatarFallback } from '@danky/ui'
 4: import { formatDistanceToNow } from 'date-fns'
 5: import ReactMarkdown from 'react-markdown'
 6: import remarkGfm from 'remark-gfm'
 7: import remarkMath from 'remark-math'
 8: import rehypeKatex from 'rehype-katex'
 9: import rehypeRaw from 'rehype-raw'
10: import { MessageContent } from './message-content'
11: import { cn } from '@danky/ui'
12: 
13: export interface MessageProps {
14:   role: 'user' | 'assistant'
15:   content: string
16:   timestamp?: Date
17: }
18: 
19: export function Message({ role, content, timestamp = new Date() }: MessageProps) {
20:   const isUser = role === 'user'
21:   
22:   return (
23:     <div
24:       className={cn(
25:         'flex w-full gap-4 p-4',
26:         isUser ? 'flex-row-reverse' : 'flex-row'
27:       )}
28:     >
29:       <Avatar className="h-8 w-8">
30:         <AvatarImage 
31:           src={isUser ? '/avatar.png' : '/bot-avatar.png'} 
32:           alt={isUser ? 'User' : 'Assistant'} 
33:         />
34:         <AvatarFallback>
35:           {isUser ? 'U' : 'A'}
36:         </AvatarFallback>
37:       </Avatar>
38:       
39:       <div className={cn('flex flex-col max-w-[80%]', 
40:         isUser ? 'items-end' : 'items-start'
41:       )}>
42:         <div
43:           className={cn(
44:             'rounded-lg px-4 py-2',
45:             isUser ? 'bg-primary text-primary-foreground' : 'bg-muted'
46:           )}
47:         >
48:           {content.match(/^```[\s\S]*```$/) ? (
49:             <MessageContent content={content} />
50:           ) : (
51:             <ReactMarkdown
52:               className="prose dark:prose-invert max-w-none text-sm"
53:               remarkPlugins={[remarkGfm, remarkMath]}
54:               rehypePlugins={[rehypeKatex, rehypeRaw]}
55:             >
56:               {content}
57:             </ReactMarkdown>
58:           )}
59:         </div>
60:         
61:         <span className="text-xs text-muted-foreground mt-1">
62:           {formatDistanceToNow(timestamp, { addSuffix: true })}
63:         </span>
64:       </div>
65:     </div>
66:   )
67: }
```

## File: apps/web/src/components/chat/notifications-popover.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { Bell } from "lucide-react"
 5: import {
 6:   Popover,
 7:   PopoverContent,
 8:   PopoverTrigger,
 9:   Button,
10:   ScrollArea,
11: } from "@danky/ui"
12: 
13: export function NotificationsPopover() {
14:   const [isOpen, setIsOpen] = React.useState(false)
15: 
16:   return (
17:     <Popover open={isOpen} onOpenChange={setIsOpen}>
18:       <PopoverTrigger asChild>
19:         <Button
20:           variant="ghost"
21:           size="icon"
22:           className="h-8 w-8 relative"
23:           aria-label="Open notifications"
24:         >
25:           <Bell className="h-4 w-4" />
26:           {/* Add notification badge here when needed */}
27:         </Button>
28:       </PopoverTrigger>
29:       <PopoverContent className="w-[380px] p-0" align="end">
30:         <div className="flex items-center justify-between border-b px-4 py-2">
31:           <h4 className="font-semibold">Notifications</h4>
32:           <Button
33:             variant="ghost"
34:             className="text-xs"
35:             onClick={() => setIsOpen(false)}
36:           >
37:             Mark all as read
38:           </Button>
39:         </div>
40:         <ScrollArea className="h-[400px]">
41:           <div className="flex flex-col gap-1 p-2">
42:             {/* Add notification items here */}
43:             <div className="text-center text-sm text-muted-foreground p-4">
44:               No new notifications
45:             </div>
46:           </div>
47:         </ScrollArea>
48:       </PopoverContent>
49:     </Popover>
50:   )
51: }
```

## File: apps/web/src/components/chat/README.md
```markdown
  1: # Chat Components
  2: 
  3: React components for the chat interface in the Danky AI Chatbot platform.
  4: 
  5: ## Overview
  6: 
  7: The chat components handle the real-time chat interface, message rendering, input handling, and chat-specific UI elements.
  8: 
  9: ## Components
 10: 
 11: ### Core Components
 12: - `ChatLayout`: Main chat interface layout
 13: - `ChatMessages`: Message list container
 14: - `Message`: Individual message component
 15: - `MessageContent`: Message content renderer
 16: - `ChatInput`: Message input component
 17: 
 18: ### Supporting Components
 19: - `AttachmentButton`: File attachment handling
 20: - `ToolsDropdown`: AI tool selection
 21: - `NotificationsPopover`: Chat notifications
 22: - `SessionList`: Chat session management
 23: - `ThemeToggle`: Theme switching
 24: 
 25: ## State Management
 26: 
 27: ### Chat Store
 28: ```typescript
 29: interface ChatState {
 30:   messages: Message[]
 31:   sessions: Session[]
 32:   currentSession: Session | null
 33:   isLoading: boolean
 34:   error: Error | null
 35: }
 36: ```
 37: 
 38: ### Actions
 39: - `sendMessage`: Send new message
 40: - `loadSession`: Load chat session
 41: - `clearSession`: Clear current session
 42: - `attachFile`: Handle file attachments
 43: - `selectTool`: Select AI tool
 44: 
 45: ## AI Development Notes
 46: 
 47: ### Key Concepts
 48: 
 49: 1. **Message Handling**
 50:    - Message formatting
 51:    - Markdown support
 52:    - Code highlighting
 53:    - File attachments
 54: 
 55: 2. **Session Management**
 56:    - Session persistence
 57:    - Session switching
 58:    - Session metadata
 59:    - Session cleanup
 60: 
 61: 3. **Tool Integration**
 62:    - Tool selection
 63:    - Tool execution
 64:    - Tool results
 65:    - Error handling
 66: 
 67: ### Common Patterns
 68: 
 69: #### Message Rendering
 70: ```tsx
 71: function Message({ message }: { message: Message }) {
 72:   return (
 73:     <div className="message">
 74:       <Avatar user={message.user} />
 75:       <MessageContent content={message.content} />
 76:       <MessageActions message={message} />
 77:     </div>
 78:   )
 79: }
 80: ```
 81: 
 82: #### Input Handling
 83: ```tsx
 84: function ChatInput({ onSubmit }: { onSubmit: (text: string) => void }) {
 85:   const [text, setText] = useState('')
 86: 
 87:   const handleSubmit = (e: FormEvent) => {
 88:     e.preventDefault()
 89:     onSubmit(text)
 90:     setText('')
 91:   }
 92: 
 93:   return (
 94:     <form onSubmit={handleSubmit}>
 95:       <textarea value={text} onChange={(e) => setText(e.target.value)} />
 96:       <button type="submit">Send</button>
 97:     </form>
 98:   )
 99: }
100: ```
101: 
102: #### Session Loading
103: ```tsx
104: function SessionList() {
105:   const sessions = useStore(state => state.sessions)
106:   const loadSession = useStore(state => state.loadSession)
107: 
108:   return (
109:     <div className="sessions">
110:       {sessions.map(session => (
111:         <button key={session.id} onClick={() => loadSession(session.id)}>
112:           {session.title}
113:         </button>
114:       ))}
115:     </div>
116:   )
117: }
118: ```
119: 
120: ## Component Library
121: 
122: ### Message Components
123: - `Message`: Base message component
124: - `UserMessage`: User message variant
125: - `AIMessage`: AI message variant
126: - `SystemMessage`: System message variant
127: - `ErrorMessage`: Error message variant
128: 
129: ### Input Components
130: - `ChatInput`: Main input component
131: - `AttachmentButton`: File upload button
132: - `ToolsDropdown`: Tool selection dropdown
133: - `SendButton`: Message send button
134: - `CancelButton`: Cancel operation button
135: 
136: ### Session Components
137: - `SessionList`: Session list component
138: - `SessionItem`: Individual session item
139: - `SessionHeader`: Session header with metadata
140: - `SessionActions`: Session action buttons
141: - `NewSessionButton`: Create new session
142: 
143: ## Development
144: 
145: ### Adding New Components
146: 
147: 1. Create component file:
148: ```tsx
149: // src/components/chat/my-component.tsx
150: export function MyComponent() {
151:   return <div>New Component</div>
152: }
153: ```
154: 
155: 2. Add to index:
156: ```typescript
157: // src/components/chat/index.ts
158: export * from './my-component'
159: ```
160: 
161: ### Testing
162: ```bash
163: pnpm test
164: pnpm test:watch
165: ```
166: 
167: ### Storybook
168: ```bash
169: pnpm storybook
170: ```
171: 
172: ## Styling
173: 
174: ### CSS Modules
175: ```css
176: /* styles.module.css */
177: .message {
178:   @apply flex items-start gap-4 p-4;
179: }
180: 
181: .userMessage {
182:   @apply bg-primary/10;
183: }
184: 
185: .aiMessage {
186:   @apply bg-secondary/10;
187: }
188: ```
189: 
190: ### Theme Variables
191: ```css
192: :root {
193:   --chat-bg: hsl(var(--background));
194:   --message-bg: hsl(var(--secondary));
195:   --input-bg: hsl(var(--background));
196: }
197: ```
198: 
199: ## Additional Resources
200: 
201: - [Chat System Design](../../../docs/CHAT_SYSTEM.md)
202: - [Message Format Spec](../../../docs/MESSAGE_FORMAT.md)
203: - [Tool Integration Guide](../../../docs/TOOLS.md)
204: - [Session Management](../../../docs/SESSIONS.md)
```

## File: apps/web/src/components/chat/search.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import {
 5:   CommandDialog,
 6:   CommandEmpty,
 7:   CommandGroup,
 8:   CommandInput,
 9:   CommandItem,
10:   CommandList,
11:   CommandSeparator,
12:   Button,
13:   DialogTitle,
14: } from "@danky/ui"
15: import { Search as SearchIcon } from "lucide-react"
16: 
17: export function Search() {
18:   const [open, setOpen] = React.useState(false)
19: 
20:   React.useEffect(() => {
21:     const down = (e: KeyboardEvent) => {
22:       if (e.key === "k" && (e.metaKey || e.ctrlKey)) {
23:         e.preventDefault()
24:         setOpen((open) => !open)
25:       }
26:     }
27:     document.addEventListener("keydown", down)
28:     return () => document.removeEventListener("keydown", down)
29:   }, [])
30: 
31:   return (
32:     <>
33:       <Button
34:         variant="outline"
35:         className="relative h-8 w-full justify-start text-sm text-muted-foreground 
36:           hover:border-muted-foreground/50 transition-colors
37:           focus-visible:ring-offset-2 focus-visible:ring-2 focus-visible:ring-ring
38:           group"
39:         onClick={() => setOpen(true)}
40:       >
41:         <SearchIcon className="mr-2 h-4 w-4 shrink-0 group-hover:text-foreground/80 transition-colors" />
42:         <span className="inline-flex items-center">
43:           Search messages...
44:           <span className="ml-2 text-xs text-muted-foreground/50">
45:             (Press K)
46:           </span>
47:         </span>
48:         <kbd className="pointer-events-none absolute right-1.5 top-1.5 hidden h-5 select-none items-center gap-1 rounded border bg-muted/50 px-1.5 font-mono text-[10px] font-medium opacity-100 transition-colors group-hover:bg-muted sm:flex">
49:           <span className="text-xs"></span>K
50:         </kbd>
51:       </Button>
52:       <CommandDialog open={open} onOpenChange={setOpen}>
53:         <DialogTitle className="sr-only">Search</DialogTitle>
54:         <CommandInput placeholder="Type a command or search..." className="border-none focus-visible:ring-0" />
55:         <CommandList>
56:           <CommandEmpty>No results found.</CommandEmpty>
57:           <CommandGroup heading="Recent Conversations">
58:             {/* We'll populate this with actual data later */}
59:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
60:               Chat about React components
61:             </CommandItem>
62:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
63:               TypeScript discussion
64:             </CommandItem>
65:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
66:               API integration planning
67:             </CommandItem>
68:           </CommandGroup>
69:           <CommandSeparator className="bg-border/50" />
70:           <CommandGroup heading="Tools">
71:             {/* We'll integrate this with the actual tools */}
72:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
73:               Code Analysis
74:             </CommandItem>
75:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
76:               Database Query
77:             </CommandItem>
78:             <CommandItem className="hover:bg-muted/80 cursor-pointer">
79:               File Operations
80:             </CommandItem>
81:           </CommandGroup>
82:         </CommandList>
83:       </CommandDialog>
84:     </>
85:   )
86: }
```

## File: apps/web/src/components/chat/session-list.tsx
```typescript
 1: "use client"
 2: 
 3: import { ScrollArea, cn } from "@danky/ui"
 4: import { type ChatSession } from "./types"
 5: import { MessageSquare } from "lucide-react"
 6: 
 7: interface ChatSessionListProps {
 8:   sessions: ChatSession[]
 9:   onSelectSession?: (session: ChatSession) => void
10:   currentSessionId?: string
11: }
12: 
13: export function ChatSessionList({ 
14:   sessions, 
15:   onSelectSession,
16:   currentSessionId 
17: }: ChatSessionListProps) {
18:   return (
19:     <ScrollArea className="h-full">
20:       <div className="flex flex-col gap-0.5 p-2">
21:         {sessions.map((session) => (
22:           <button
23:             key={session.id}
24:             onClick={() => onSelectSession?.(session)}
25:             className={cn(
26:               "flex items-start gap-3 p-3 w-full text-left rounded-lg transition-colors",
27:               "hover:bg-accent/50",
28:               session.id === currentSessionId && "bg-accent",
29:               "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
30:             )}
31:           >
32:             <MessageSquare className="h-5 w-5 mt-0.5 text-muted-foreground shrink-0" />
33:             <div className="min-w-0 flex-1">
34:               <div className="mb-1 font-medium truncate">
35:                 {session.title}
36:               </div>
37:               <div className="text-sm text-muted-foreground truncate">
38:                 {session.lastMessage}
39:               </div>
40:             </div>
41:           </button>
42:         ))}
43:       </div>
44:     </ScrollArea>
45:   )
46: }
```

## File: apps/web/src/components/chat/sidebar.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import {
  5:   Button,
  6:   DropdownMenu,
  7:   DropdownMenuContent,
  8:   DropdownMenuItem,
  9:   DropdownMenuLabel,
 10:   DropdownMenuSeparator,
 11:   DropdownMenuTrigger,
 12:   ScrollArea,
 13:   Avatar,
 14:   AvatarFallback,
 15:   AvatarImage,
 16:   ThemeToggle,
 17: } from "@danky/ui"
 18: import {
 19:   ChevronDown,
 20:   Star,
 21:   MessageSquare,
 22:   LayoutDashboard,
 23:   Brain,
 24:   Sparkles,
 25:   ListTodo,
 26:   FileText,
 27:   Settings,
 28:   Shield,
 29:   LogOut,
 30: } from "lucide-react"
 31: import { cn } from "@danky/ui"
 32: import Link from "next/link"
 33: import { usePathname } from "next/navigation"
 34: 
 35: interface NavItem {
 36:   title: string
 37:   href: string
 38:   icon: React.ReactNode
 39: }
 40: 
 41: interface Model {
 42:   id: string
 43:   name: string
 44:   isFavorite: boolean
 45: }
 46: 
 47: interface SidebarProps {
 48:   user?: {
 49:     name: string
 50:     email: string
 51:     image?: string
 52:     isAdmin?: boolean
 53:   }
 54:   models?: Model[]
 55:   currentModel?: string
 56:   onModelSelect?: (modelId: string) => void
 57:   onToggleFavorite?: (modelId: string) => void
 58: }
 59: 
 60: const navItems: NavItem[] = [
 61:   {
 62:     title: "Messages",
 63:     href: "/chat",
 64:     icon: <MessageSquare className="h-4 w-4" />,
 65:   },
 66:   {
 67:     title: "Dashboard",
 68:     href: "/dashboard",
 69:     icon: <LayoutDashboard className="h-4 w-4" />,
 70:   },
 71:   {
 72:     title: "Knowledge",
 73:     href: "/knowledge",
 74:     icon: <Brain className="h-4 w-4" />,
 75:   },
 76:   {
 77:     title: "Prompts",
 78:     href: "/prompts",
 79:     icon: <Sparkles className="h-4 w-4" />,
 80:   },
 81:   {
 82:     title: "Tasks",
 83:     href: "/tasks",
 84:     icon: <ListTodo className="h-4 w-4" />,
 85:   },
 86:   {
 87:     title: "Documentation",
 88:     href: "/docs",
 89:     icon: <FileText className="h-4 w-4" />,
 90:   },
 91: ]
 92: 
 93: export function Sidebar({
 94:   user = {
 95:     name: "John Doe",
 96:     email: "john@example.com",
 97:     isAdmin: true,
 98:   },
 99:   models = [],
100:   currentModel = "",
101:   onModelSelect = () => {},
102:   onToggleFavorite = () => {},
103: }: SidebarProps) {
104:   const pathname = usePathname()
105: 
106:   const favoriteModels = models.filter(m => m.isFavorite)
107:   const otherModels = models.filter(m => !m.isFavorite)
108:   const currentModelData = models.find(m => m.id === currentModel)
109: 
110:   return (
111:     <div className="flex h-full flex-col gap-2">
112:       <div className="flex flex-col gap-2 p-4">
113:         <DropdownMenu>
114:           <DropdownMenuTrigger asChild>
115:             <Button
116:               variant="ghost"
117:               className="h-10 w-full justify-between px-4 hover:bg-accent"
118:             >
119:               <div className="flex items-center gap-2">
120:                 <Avatar className="h-6 w-6">
121:                   <AvatarImage src="/bot-avatar.png" alt="AI Model" />
122:                   <AvatarFallback>AI</AvatarFallback>
123:                 </Avatar>
124:                 <span className="text-sm font-medium">
125:                   {currentModelData?.name || "Select Model"}
126:                 </span>
127:               </div>
128:               <ChevronDown className="h-4 w-4 opacity-50" />
129:             </Button>
130:           </DropdownMenuTrigger>
131:           <DropdownMenuContent className="w-[240px]" align="start">
132:             <DropdownMenuLabel>AI Models</DropdownMenuLabel>
133:             <DropdownMenuSeparator />
134:             {favoriteModels.length > 0 && (
135:               <>
136:                 <DropdownMenuLabel className="text-xs font-normal text-muted-foreground">
137:                   Favorites
138:                 </DropdownMenuLabel>
139:                 {favoriteModels.map((model) => (
140:                   <DropdownMenuItem
141:                     key={model.id}
142:                     onClick={() => onModelSelect(model.id)}
143:                     className="justify-between"
144:                   >
145:                     <span>{model.name}</span>
146:                     <Star
147:                       className="h-4 w-4 text-yellow-400 cursor-pointer"
148:                       onClick={(e) => {
149:                         e.stopPropagation()
150:                         onToggleFavorite(model.id)
151:                       }}
152:                       fill="currentColor"
153:                     />
154:                   </DropdownMenuItem>
155:                 ))}
156:                 <DropdownMenuSeparator />
157:               </>
158:             )}
159:             {otherModels.map((model) => (
160:               <DropdownMenuItem
161:                 key={model.id}
162:                 onClick={() => onModelSelect(model.id)}
163:                 className="justify-between"
164:               >
165:                 <span>{model.name}</span>
166:                 <Star
167:                   className="h-4 w-4 text-muted-foreground cursor-pointer hover:text-yellow-400"
168:                   onClick={(e) => {
169:                     e.stopPropagation()
170:                     onToggleFavorite(model.id)
171:                   }}
172:                 />
173:               </DropdownMenuItem>
174:             ))}
175:           </DropdownMenuContent>
176:         </DropdownMenu>
177:       </div>
178: 
179:       <ScrollArea className="flex-1 px-2">
180:         <div className="space-y-1 p-2">
181:           {navItems.map((item) => (
182:             <Link key={item.href} href={item.href}>
183:               <Button
184:                 variant="ghost"
185:                 className={cn(
186:                   "w-full justify-start",
187:                   pathname === item.href && "bg-accent"
188:                 )}
189:               >
190:                 {item.icon}
191:                 <span className="ml-2">{item.title}</span>
192:               </Button>
193:             </Link>
194:           ))}
195:         </div>
196:       </ScrollArea>
197: 
198:       <div className="mt-auto p-4">
199:         <DropdownMenu>
200:           <DropdownMenuTrigger asChild>
201:             <Button
202:               variant="ghost"
203:               className="h-12 w-full justify-start px-4 hover:bg-accent"
204:             >
205:               <Avatar className="h-8 w-8">
206:                 <AvatarImage src={user.image} alt={user.name} />
207:                 <AvatarFallback>
208:                   {user.name
209:                     .split(" ")
210:                     .map((n) => n[0])
211:                     .join("")}
212:                 </AvatarFallback>
213:               </Avatar>
214:               <div className="ml-2 flex flex-col items-start text-left">
215:                 <span className="text-sm font-medium">{user.name}</span>
216:                 <span className="text-xs text-muted-foreground">
217:                   {user.email}
218:                 </span>
219:               </div>
220:             </Button>
221:           </DropdownMenuTrigger>
222:           <DropdownMenuContent className="w-[240px]" align="end">
223:             <DropdownMenuItem>
224:               <Settings className="mr-2 h-4 w-4" />
225:               <span>Settings</span>
226:             </DropdownMenuItem>
227:             {user.isAdmin && (
228:               <DropdownMenuItem>
229:                 <Shield className="mr-2 h-4 w-4" />
230:                 <span>Admin Panel</span>
231:               </DropdownMenuItem>
232:             )}
233:             <DropdownMenuSeparator />
234:             <DropdownMenuItem className="text-red-600">
235:               <LogOut className="mr-2 h-4 w-4" />
236:               <span>Log out</span>
237:             </DropdownMenuItem>
238:           </DropdownMenuContent>
239:         </DropdownMenu>
240:       </div>
241:     </div>
242:   )
243: }
```

## File: apps/web/src/components/chat/tools-dropdown.tsx
```typescript
  1: "use client"
  2: 
  3: import {
  4:   DropdownMenu,
  5:   DropdownMenuContent,
  6:   DropdownMenuItem,
  7:   DropdownMenuTrigger,
  8:   DropdownMenuSeparator,
  9:   Button,
 10:   Badge,
 11:   cn
 12: } from "@danky/ui"
 13: import { type Server } from "./types"
 14: import { Wrench, CircleDot, Loader2, AlertCircle } from "lucide-react"
 15: 
 16: interface ToolsDropdownProps {
 17:   servers: Server[]
 18:   onToolSelect: (serverId: string, toolId: string) => void
 19:   isLoading?: boolean
 20: }
 21: 
 22: export function ToolsDropdown({ servers, onToolSelect, isLoading = false }: ToolsDropdownProps) {
 23:   const hasServers = servers.length > 0
 24:   const connectedServers = servers.filter(s => s.status === "connected")
 25: 
 26:   return (
 27:     <DropdownMenu>
 28:       <DropdownMenuTrigger asChild>
 29:         <Button 
 30:           variant="outline" 
 31:           size="icon"
 32:           className={cn(
 33:             "relative transition-colors",
 34:             hasServers && "text-primary border-primary hover:bg-primary/10"
 35:           )}
 36:           disabled={isLoading}
 37:         >
 38:           {isLoading ? (
 39:             <Loader2 className="h-4 w-4 animate-spin" />
 40:           ) : (
 41:             <>
 42:               <Wrench className="h-4 w-4" />
 43:               {hasServers && (
 44:                 <Badge 
 45:                   variant="default" 
 46:                   className={cn(
 47:                     "absolute -top-1 -right-1 h-4 w-4 p-0 flex items-center justify-center",
 48:                     "animate-in zoom-in-50 duration-300"
 49:                   )}
 50:                 >
 51:                   {connectedServers.length}
 52:                 </Badge>
 53:               )}
 54:             </>
 55:           )}
 56:           <span className="sr-only">Available tools</span>
 57:         </Button>
 58:       </DropdownMenuTrigger>
 59: 
 60:       <DropdownMenuContent 
 61:         align="end" 
 62:         className="w-72"
 63:         sideOffset={8}
 64:       >
 65:         {isLoading ? (
 66:           <div className="p-4 text-sm text-center flex items-center justify-center gap-2">
 67:             <Loader2 className="h-4 w-4 animate-spin" />
 68:             <span>Connecting to servers...</span>
 69:           </div>
 70:         ) : !hasServers ? (
 71:           <div className="p-4 text-sm text-center flex flex-col items-center gap-2 text-muted-foreground">
 72:             <AlertCircle className="h-5 w-5" />
 73:             <span>No servers available</span>
 74:           </div>
 75:         ) : connectedServers.length === 0 ? (
 76:           <div className="p-4 text-sm text-center flex flex-col items-center gap-2 text-muted-foreground">
 77:             <Loader2 className="h-5 w-5 animate-spin" />
 78:             <span>Waiting for servers to connect...</span>
 79:           </div>
 80:         ) : (
 81:           <>
 82:             {connectedServers.map((server) => (
 83:               <div key={server.id} className="animate-in fade-in-50 duration-200">
 84:                 <div className="px-2 py-1.5 text-sm font-medium flex items-center gap-2">
 85:                   <CircleDot className="h-3 w-3 text-primary animate-pulse" />
 86:                   {server.name}
 87:                 </div>
 88: 
 89:                 {server.tools.map((tool) => (
 90:                   <DropdownMenuItem
 91:                     key={tool.id}
 92:                     onClick={() => onToolSelect(server.id, tool.id)}
 93:                     className="flex flex-col items-start gap-0.5 pl-7 cursor-pointer"
 94:                   >
 95:                     <span className="font-medium">{tool.name}</span>
 96:                     <span className="text-xs text-muted-foreground line-clamp-2">
 97:                       {tool.description}
 98:                     </span>
 99:                   </DropdownMenuItem>
100:                 ))}
101:                 <DropdownMenuSeparator />
102:               </div>
103:             ))}
104:           </>
105:         )}
106:       </DropdownMenuContent>
107:     </DropdownMenu>
108:   )
109: }
```

## File: apps/web/src/components/chat/types.ts
```typescript
 1: export interface Message {
 2:   role: "user" | "assistant"
 3:   content: string
 4:   timestamp: Date
 5: }
 6: 
 7: export interface ChatSession {
 8:   id: string
 9:   title: string
10:   lastMessage: string
11:   timestamp: Date
12: }
13: 
14: export interface Tool {
15:   id: string
16:   name: string
17:   description: string
18:   category?: string
19:   icon?: string
20: }
21: 
22: export interface Server {
23:   id: string
24:   name: string
25:   status: "connected" | "disconnected" | "error"
26:   tools: Tool[]
27:   error?: string
28: }
29: 
30: export type ChatStatus = "idle" | "loading" | "error"
31: 
32: export interface ChatState {
33:   messages: Message[]
34:   sessions: ChatSession[]
35:   currentSession: string | null
36:   status: ChatStatus
37:   error: string | null
38: }
39: 
40: export interface ChatAction {
41:   type: 
42:     | "SET_MESSAGES" 
43:     | "ADD_MESSAGE" 
44:     | "SET_SESSIONS" 
45:     | "ADD_SESSION" 
46:     | "SET_CURRENT_SESSION" 
47:     | "SET_STATUS" 
48:     | "SET_ERROR"
49:   payload: any
50: }
```

## File: apps/web/src/components/chat/user-nav.tsx
```typescript
 1: "use client"
 2: 
 3: import {
 4:   Avatar,
 5:   AvatarFallback,
 6:   AvatarImage,
 7:   Button,
 8:   DropdownMenu,
 9:   DropdownMenuContent,
10:   DropdownMenuGroup,
11:   DropdownMenuItem,
12:   DropdownMenuLabel,
13:   DropdownMenuSeparator,
14:   DropdownMenuShortcut,
15:   DropdownMenuTrigger,
16: } from "@danky/ui"
17: import { 
18:   User, 
19:   Settings, 
20:   FileText, 
21:   Shield, 
22:   LogOut,
23:   CreditCard,
24:   HelpCircle,
25: } from "lucide-react"
26: 
27: export function UserNav() {
28:   return (
29:     <DropdownMenu>
30:       <DropdownMenuTrigger asChild>
31:         <Button variant="ghost" className="relative h-8 w-8 rounded-full">
32:           <Avatar className="h-8 w-8">
33:             <AvatarImage src="/avatar.png" alt="User avatar" />
34:             <AvatarFallback>JD</AvatarFallback>
35:           </Avatar>
36:         </Button>
37:       </DropdownMenuTrigger>
38:       <DropdownMenuContent className="w-56" align="end" forceMount>
39:         <DropdownMenuLabel className="font-normal">
40:           <div className="flex flex-col space-y-1">
41:             <p className="text-sm font-medium leading-none">John Doe</p>
42:             <p className="text-xs leading-none text-muted-foreground">
43:               john@example.com
44:             </p>
45:           </div>
46:         </DropdownMenuLabel>
47:         <DropdownMenuSeparator />
48:         <DropdownMenuGroup>
49:           <DropdownMenuItem>
50:             <User className="mr-2 h-4 w-4" />
51:             <span>Profile</span>
52:             <DropdownMenuShortcut>P</DropdownMenuShortcut>
53:           </DropdownMenuItem>
54:           <DropdownMenuItem>
55:             <Settings className="mr-2 h-4 w-4" />
56:             <span>Settings</span>
57:             <DropdownMenuShortcut>S</DropdownMenuShortcut>
58:           </DropdownMenuItem>
59:           <DropdownMenuItem>
60:             <FileText className="mr-2 h-4 w-4" />
61:             <span>Documentation</span>
62:             <DropdownMenuShortcut>D</DropdownMenuShortcut>
63:           </DropdownMenuItem>
64:           <DropdownMenuItem>
65:             <HelpCircle className="mr-2 h-4 w-4" />
66:             <span>Support</span>
67:           </DropdownMenuItem>
68:         </DropdownMenuGroup>
69:         <DropdownMenuSeparator />
70:         <DropdownMenuItem>
71:           <Shield className="mr-2 h-4 w-4" />
72:           <span>Admin Panel</span>
73:         </DropdownMenuItem>
74:         <DropdownMenuSeparator />
75:         <DropdownMenuItem className="text-red-600">
76:           <LogOut className="mr-2 h-4 w-4" />
77:           <span>Log out</span>
78:           <DropdownMenuShortcut>Q</DropdownMenuShortcut>
79:         </DropdownMenuItem>
80:       </DropdownMenuContent>
81:     </DropdownMenu>
82:   )
83: }
```

## File: apps/web/src/components/chat/utils.ts
```typescript
 1: export const formatTime = (date: Date) => {
 2:   const now = new Date()
 3:   const messageDate = new Date(date)
 4:   
 5:   // If the message is from today, just show the time
 6:   if (messageDate.toDateString() === now.toDateString()) {
 7:     return new Intl.DateTimeFormat("en", {
 8:       hour: "numeric",
 9:       minute: "numeric",
10:       hour12: true
11:     }).format(messageDate)
12:   }
13:   
14:   // If the message is from this year, show the month and day
15:   if (messageDate.getFullYear() === now.getFullYear()) {
16:     return new Intl.DateTimeFormat("en", {
17:       month: "short",
18:       day: "numeric",
19:       hour: "numeric",
20:       minute: "numeric",
21:       hour12: true
22:     }).format(messageDate)
23:   }
24:   
25:   // Otherwise show the full date
26:   return new Intl.DateTimeFormat("en", {
27:     year: "numeric",
28:     month: "short",
29:     day: "numeric",
30:     hour: "numeric",
31:     minute: "numeric",
32:     hour12: true
33:   }).format(messageDate)
34: }
35: 
36: export const detectCodeLanguage = (str: string): string => {
37:   if (str.includes('interface ') || str.includes('type ') || str.includes(': string') || str.includes(': number')) {
38:     return 'typescript'
39:   }
40:   if (str.includes('func ') || str.includes('package ')) {
41:     return 'go'
42:   }
43:   if (str.includes('def ') || str.includes('class ') || str.includes('import ')) {
44:     return 'python'
45:   }
46:   if (str.includes('<?php') || str.includes('namespace ')) {
47:     return 'php'
48:   }
49:   if (str.includes('public class') || str.includes('private void')) {
50:     return 'java'
51:   }
52:   return 'javascript' // default to javascript
53: }
54: 
55: export const isCodeLike = (str: string): boolean => {
56:   const codeIndicators = [
57:     /^import\s+.*from/m,           // imports
58:     /^const\s+.*=/m,               // const declarations
59:     /^let\s+.*=/m,                 // let declarations
60:     /^function\s+\w+\s*\(/m,       // function declarations
61:     /^class\s+\w+/m,               // class declarations
62:     /^if\s*\(/m,                   // if statements
63:     /^for\s*\(/m,                  // for loops
64:     /^while\s*\(/m,                // while loops
65:     /^async\s+function/m,          // async functions
66:     /=>/m,                         // arrow functions
67:     /\{\s*[\r\n]/m,               // opening brackets with newline
68:     /^\s*return\s+/m,             // return statements
69:     /^export\s+/m,                 // exports
70:     /^interface\s+\w+/m,           // TypeScript interfaces
71:     /^type\s+\w+/m,                // TypeScript types
72:   ]
73:   return codeIndicators.some(pattern => pattern.test(str))
74: }
```

## File: apps/web/src/components/mcp/servers/server-card.tsx
```typescript
 1: 'use client'
 2: 
 3: import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../card'
 4: import { Badge } from '../../badge'
 5: 
 6: export interface ServerCardProps {
 7:   serverId: string
 8:   status: 'connected' | 'disconnected' | 'error'
 9:   description?: string
10:   onSelect?: () => void
11: }
12: 
13: export function ServerCard({ serverId, status, description, onSelect }: ServerCardProps) {
14:   const statusColors = {
15:     connected: 'bg-green-500',
16:     disconnected: 'bg-gray-500',
17:     error: 'bg-red-500',
18:   }
19: 
20:   return (
21:     <Card 
22:       className="cursor-pointer hover:border-primary transition-colors"
23:       onClick={onSelect}
24:     >
25:       <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
26:         <CardTitle className="text-sm font-medium">
27:           {serverId}
28:         </CardTitle>
29:         <Badge variant="outline" className={statusColors[status]}>
30:           {status}
31:         </Badge>
32:       </CardHeader>
33:       {description && (
34:         <CardContent>
35:           <CardDescription>{description}</CardDescription>
36:         </CardContent>
37:       )}
38:     </Card>
39:   )
40: }
```

## File: apps/web/src/components/mcp/servers/server-list.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ServerCard } from './server-card'
 4: 
 5: export interface ServerListProps {
 6:   servers: Array<{
 7:     id: string
 8:     status: 'connected' | 'disconnected' | 'error'
 9:     description?: string
10:   }>
11:   onServerSelect?: (serverId: string) => void
12: }
13: 
14: export function ServerList({ servers, onServerSelect }: ServerListProps) {
15:   if (!servers.length) {
16:     return (
17:       <div className="text-center text-muted-foreground p-4">
18:         No MCP servers available
19:       </div>
20:     )
21:   }
22: 
23:   return (
24:     <div className="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
25:       {servers.map((server) => (
26:         <ServerCard
27:           key={server.id}
28:           serverId={server.id}
29:           status={server.status}
30:           description={server.description}
31:           onSelect={() => onServerSelect?.(server.id)}
32:         />
33:       ))}
34:     </div>
35:   )
36: }
```

## File: apps/web/src/components/mcp/tools/tool-card.tsx
```typescript
 1: import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
 2: import { cn } from "@/lib/utils";
 3: 
 4: interface ToolCardProps {
 5:   title: string;
 6:   description: string;
 7:   className?: string;
 8:   onClick?: () => void;
 9: }
10: 
11: export function ToolCard({
12:   title,
13:   description,
14:   className,
15:   onClick,
16: }: ToolCardProps) {
17:   return (
18:     <Card
19:       className={cn(
20:         "hover:bg-accent/50 cursor-pointer transition-colors",
21:         className
22:       )}
23:       onClick={onClick}
24:     >
25:       <CardHeader>
26:         <CardTitle className="text-lg">{title}</CardTitle>
27:       </CardHeader>
28:       <CardContent>
29:         <p className="text-sm text-muted-foreground">{description}</p>
30:       </CardContent>
31:     </Card>
32:   );
33: }
```

## File: apps/web/src/components/mcp/tools/tool-list.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ToolCard } from './tool-card'
 4: 
 5: export interface ToolListProps {
 6:   tools: Array<{
 7:     serverId: string
 8:     toolId: string
 9:     name: string
10:     description: string
11:   }>
12:   onToolSelect?: (serverId: string, toolId: string) => void
13: }
14: 
15: export function ToolList({ tools, onToolSelect }: ToolListProps) {
16:   if (!tools.length) {
17:     return (
18:       <div className="text-center text-muted-foreground p-4">
19:         No MCP tools available
20:       </div>
21:     )
22:   }
23: 
24:   return (
25:     <div className="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
26:       {tools.map((tool) => (
27:         <ToolCard
28:           key={`${tool.serverId}-${tool.toolId}`}
29:           serverId={tool.serverId}
30:           toolId={tool.toolId}
31:           name={tool.name}
32:           description={tool.description}
33:           onSelect={() => onToolSelect?.(tool.serverId, tool.toolId)}
34:         />
35:       ))}
36:     </div>
37:   )
38: }
```

## File: apps/web/src/components/mcp/index.ts
```typescript
1: export * from './servers/server-card'
2: export * from './servers/server-list'
3: export * from './tools/tool-card'
4: export * from './tools/tool-list'
```

## File: apps/web/src/components/mcp/mcp-panel.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect, useState } from 'react'
 4: import { ServerList } from './servers/server-list'
 5: import { ToolList } from './tools/tool-list'
 6: import { Card, CardContent, CardHeader, CardTitle } from '../card'
 7: import { Tabs, TabsContent, TabsList, TabsTrigger } from '../tabs'
 8: import { useToast } from '../../hooks/use-toast'
 9: 
10: interface MCPPanelProps {
11:   onToolSelect?: (serverId: string, toolId: string) => void
12: }
13: 
14: export function MCPPanel({ onToolSelect }: MCPPanelProps) {
15:   const [servers, setServers] = useState<Array<{
16:     id: string
17:     status: 'connected' | 'disconnected' | 'error'
18:     description?: string
19:   }>>([])
20:   
21:   const [tools, setTools] = useState<Array<{
22:     serverId: string
23:     toolId: string
24:     name: string
25:     description: string
26:   }>>([])
27: 
28:   const { toast } = useToast()
29: 
30:   useEffect(() => {
31:     const fetchData = async () => {
32:       try {
33:         // Fetch server status
34:         const serverRes = await fetch('/api/actions/mcp/status')
35:         const serverData = await serverRes.json()
36:         if (serverData.success) {
37:           setServers(Object.entries(serverData.status).map(([id, status]) => ({
38:             id,
39:             status: status as 'connected' | 'disconnected' | 'error'
40:           })))
41:         }
42: 
43:         // Fetch available tools
44:         const toolsRes = await fetch('/api/actions/mcp/tools')
45:         const toolsData = await toolsRes.json()
46:         if (toolsData.success) {
47:           setTools(toolsData.tools)
48:         }
49:       } catch (error) {
50:         toast.error('Failed to fetch MCP data')
51:       }
52:     }
53: 
54:     // Initial fetch
55:     fetchData()
56: 
57:     // Set up polling for updates every 30 seconds
58:     const interval = setInterval(fetchData, 30000)
59: 
60:     return () => clearInterval(interval)
61:   }, [toast])
62: 
63:   return (
64:     <Card>
65:       <CardHeader>
66:         <CardTitle>MCP Integration</CardTitle>
67:       </CardHeader>
68:       <CardContent>
69:         <Tabs defaultValue="servers">
70:           <TabsList className="grid w-full grid-cols-2">
71:             <TabsTrigger value="servers">Servers</TabsTrigger>
72:             <TabsTrigger value="tools">Tools</TabsTrigger>
73:           </TabsList>
74:           <TabsContent value="servers" className="mt-4">
75:             <ServerList 
76:               servers={servers}
77:               onServerSelect={(serverId) => {
78:                 toast.success(`Connected to ${serverId}`)
79:               }}
80:             />
81:           </TabsContent>
82:           <TabsContent value="tools" className="mt-4">
83:             <ToolList 
84:               tools={tools}
85:               onToolSelect={onToolSelect}
86:             />
87:           </TabsContent>
88:         </Tabs>
89:       </CardContent>
90:     </Card>
91:   )
92: }
```

## File: apps/web/src/components/mcp/README.md
```markdown
  1: # MCP Components
  2: 
  3: React components for Model Context Protocol (MCP) integration in the Danky AI Chatbot platform.
  4: 
  5: ## Overview
  6: 
  7: The MCP components handle the integration between the chat interface and the Model Context Protocol, managing tool execution, model responses, and AI interactions.
  8: 
  9: ## Components
 10: 
 11: ### Core Components
 12: - `MCPProvider`: MCP context provider
 13: - `MCPPanel`: Tool execution panel
 14: - `ToolList`: Available tools list
 15: - `ToolCard`: Individual tool component
 16: - `ModelSelector`: AI model selection
 17: 
 18: ### Supporting Components
 19: - `ToolResults`: Tool execution results
 20: - `ModelConfig`: Model configuration
 21: - `ExecutionStatus`: Tool status display
 22: - `ErrorDisplay`: Error handling UI
 23: - `LoadingState`: Loading indicators
 24: 
 25: ## State Management
 26: 
 27: ### MCP Store
 28: ```typescript
 29: interface MCPState {
 30:   tools: Tool[]
 31:   selectedModel: Model
 32:   currentExecution: Execution | null
 33:   history: ExecutionHistory[]
 34:   error: Error | null
 35: }
 36: ```
 37: 
 38: ### Actions
 39: - `executeTool`: Run selected tool
 40: - `selectModel`: Change AI model
 41: - `cancelExecution`: Stop current execution
 42: - `clearHistory`: Clear execution history
 43: - `updateConfig`: Update model config
 44: 
 45: ## AI Development Notes
 46: 
 47: ### Key Concepts
 48: 
 49: 1. **Tool Execution**
 50:    - Tool registration
 51:    - Parameter validation
 52:    - Result handling
 53:    - Error recovery
 54: 
 55: 2. **Model Management**
 56:    - Model selection
 57:    - Configuration
 58:    - Token counting
 59:    - Rate limiting
 60: 
 61: 3. **State Handling**
 62:    - Execution state
 63:    - History tracking
 64:    - Error handling
 65:    - Recovery flows
 66: 
 67: ### Common Patterns
 68: 
 69: #### Tool Registration
 70: ```tsx
 71: function ToolRegistration() {
 72:   const registerTool = useStore(state => state.registerTool)
 73: 
 74:   const handleRegister = async (tool: Tool) => {
 75:     try {
 76:       await registerTool(tool)
 77:     } catch (error) {
 78:       console.error('Tool registration failed:', error)
 79:     }
 80:   }
 81: 
 82:   return (
 83:     <form onSubmit={handleSubmit}>
 84:       <ToolForm onSubmit={handleRegister} />
 85:     </form>
 86:   )
 87: }
 88: ```
 89: 
 90: #### Execution Handling
 91: ```tsx
 92: function ToolExecution({ tool }: { tool: Tool }) {
 93:   const execute = useStore(state => state.executeTool)
 94:   const status = useStore(state => state.status)
 95: 
 96:   const handleExecute = async (params: unknown) => {
 97:     try {
 98:       await execute(tool.name, params)
 99:     } catch (error) {
100:       console.error('Tool execution failed:', error)
101:     }
102:   }
103: 
104:   return (
105:     <div className="tool-execution">
106:       <ToolParams tool={tool} onSubmit={handleExecute} />
107:       <ExecutionStatus status={status} />
108:     </div>
109:   )
110: }
111: ```
112: 
113: #### Model Configuration
114: ```tsx
115: function ModelConfig() {
116:   const config = useStore(state => state.modelConfig)
117:   const updateConfig = useStore(state => state.updateConfig)
118: 
119:   return (
120:     <div className="model-config">
121:       <select
122:         value={config.model}
123:         onChange={(e) => updateConfig({ model: e.target.value })}
124:       >
125:         <option value="gpt-4">GPT-4</option>
126:         <option value="claude-3">Claude 3</option>
127:       </select>
128:       <ConfigOptions config={config} onChange={updateConfig} />
129:     </div>
130:   )
131: }
132: ```
133: 
134: ## Component Library
135: 
136: ### Tool Components
137: - `ToolCard`: Tool display card
138: - `ToolParams`: Parameter input form
139: - `ToolResults`: Result display
140: - `ToolHistory`: Execution history
141: - `ToolDocs`: Tool documentation
142: 
143: ### Model Components
144: - `ModelSelector`: Model selection
145: - `ModelConfig`: Configuration panel
146: - `TokenCounter`: Token usage display
147: - `RateLimit`: Rate limit indicator
148: - `CostEstimate`: Usage cost display
149: 
150: ### Execution Components
151: - `ExecutionPanel`: Main execution UI
152: - `StatusIndicator`: Execution status
153: - `ProgressBar`: Operation progress
154: - `ErrorBoundary`: Error handling
155: - `RetryButton`: Retry failed operations
156: 
157: ## Development
158: 
159: ### Adding New Tools
160: 
161: 1. Create tool definition:
162: ```typescript
163: // src/components/mcp/tools/my-tool.ts
164: import { type Tool } from '@danky/mcp'
165: 
166: export const myTool: Tool = {
167:   name: 'myTool',
168:   description: 'Does something useful',
169:   parameters: {
170:     // Zod schema
171:   },
172:   handler: async (params) => {
173:     // Implementation
174:   }
175: }
176: ```
177: 
178: 2. Register tool:
179: ```typescript
180: // src/components/mcp/tools/index.ts
181: export const tools = [myTool]
182: ```
183: 
184: ### Testing
185: ```bash
186: pnpm test
187: pnpm test:watch
188: ```
189: 
190: ### Storybook
191: ```bash
192: pnpm storybook
193: ```
194: 
195: ## Styling
196: 
197: ### CSS Modules
198: ```css
199: /* styles.module.css */
200: .toolCard {
201:   @apply rounded-lg border p-4;
202: }
203: 
204: .executing {
205:   @apply bg-primary/10;
206: }
207: 
208: .error {
209:   @apply bg-destructive/10;
210: }
211: ```
212: 
213: ### Theme Variables
214: ```css
215: :root {
216:   --tool-bg: hsl(var(--card));
217:   --executing-bg: hsl(var(--primary));
218:   --error-bg: hsl(var(--destructive));
219: }
220: ```
221: 
222: ## Additional Resources
223: 
224: - [MCP Integration Guide](../../../docs/MCP.md)
225: - [Tool Development Guide](../../../docs/TOOLS.md)
226: - [Model Configuration](../../../docs/MODELS.md)
227: - [Error Handling](../../../docs/ERRORS.md)
```

## File: apps/web/src/components/mcp/tools-button.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import { Wrench } from "lucide-react"
  5: import { Button } from "../button"
  6: import {
  7:   Dialog,
  8:   DialogContent,
  9:   DialogHeader,
 10:   DialogTitle,
 11:   DialogTrigger,
 12: } from "../dialog"
 13: import { ScrollArea } from "../scroll-area"
 14: import { Badge } from "../badge"
 15: import { cn } from "../../lib/utils"
 16: 
 17: interface Server {
 18:   id: string
 19:   name: string
 20:   status: "connected" | "disconnected" | "error"
 21:   tools: Tool[]
 22: }
 23: 
 24: interface Tool {
 25:   id: string
 26:   name: string
 27:   description: string
 28:   icon?: React.ReactNode
 29: }
 30: 
 31: interface ToolsButtonProps {
 32:   servers: Server[]
 33:   onToolSelect: (serverId: string, toolId: string) => void
 34:   className?: string
 35: }
 36: 
 37: export function ToolsButton({
 38:   servers,
 39:   onToolSelect,
 40:   className,
 41: }: ToolsButtonProps) {
 42:   const [isOpen, setIsOpen] = React.useState(false)
 43:   const [selectedServer, setSelectedServer] = React.useState<Server | null>(null)
 44: 
 45:   return (
 46:     <Dialog open={isOpen} onOpenChange={setIsOpen}>
 47:       <DialogTrigger asChild>
 48:         <Button
 49:           size="icon"
 50:           variant="ghost"
 51:           className={cn("absolute bottom-4 right-8", className)}
 52:         >
 53:           <Wrench className="h-4 w-4" />
 54:         </Button>
 55:       </DialogTrigger>
 56:       <DialogContent className="sm:max-w-[425px]">
 57:         <DialogHeader>
 58:           <DialogTitle>
 59:             {selectedServer ? selectedServer.name : "Available Servers"}
 60:           </DialogTitle>
 61:         </DialogHeader>
 62:         <ScrollArea className="h-[60vh] mt-4">
 63:           <div className="space-y-4">
 64:             {selectedServer ? (
 65:               <div className="animate-in slide-in-from-right duration-200">
 66:                 <Button
 67:                   variant="ghost"
 68:                   className="mb-4"
 69:                   onClick={() => setSelectedServer(null)}
 70:                 >
 71:                    Back to Servers
 72:                 </Button>
 73:                 {selectedServer.tools.map((tool) => (
 74:                   <div
 75:                     key={tool.id}
 76:                     className="flex items-center space-x-4 p-4 rounded-lg border hover:bg-accent cursor-pointer transition-colors"
 77:                     onClick={() => {
 78:                       onToolSelect(selectedServer.id, tool.id)
 79:                       setIsOpen(false)
 80:                       setSelectedServer(null)
 81:                     }}
 82:                   >
 83:                     {tool.icon}
 84:                     <div className="flex-1">
 85:                       <h4 className="font-medium">{tool.name}</h4>
 86:                       <p className="text-sm text-muted-foreground">
 87:                         {tool.description}
 88:                       </p>
 89:                     </div>
 90:                   </div>
 91:                 ))}
 92:               </div>
 93:             ) : (
 94:               <div className="animate-in slide-in-from-left duration-200">
 95:                 {servers.map((server) => (
 96:                   <div
 97:                     key={server.id}
 98:                     className="flex items-center space-x-4 p-4 rounded-lg border hover:bg-accent cursor-pointer transition-colors"
 99:                     onClick={() => setSelectedServer(server)}
100:                   >
101:                     <div className="flex-1">
102:                       <div className="flex items-center gap-2">
103:                         <h4 className="font-medium">{server.name}</h4>
104:                         <Badge
105:                           variant={
106:                             server.status === "connected"
107:                               ? "default"
108:                               : server.status === "error"
109:                               ? "destructive"
110:                               : "secondary"
111:                           }
112:                         >
113:                           {server.status}
114:                         </Badge>
115:                       </div>
116:                       <p className="text-sm text-muted-foreground">
117:                         {server.tools.length} tools available
118:                       </p>
119:                     </div>
120:                   </div>
121:                 ))}
122:               </div>
123:             )}
124:           </div>
125:         </ScrollArea>
126:       </DialogContent>
127:     </Dialog>
128:   )
129: }
```

## File: apps/web/src/components/sidebar/index.tsx
```typescript
 1: export { Sidebar } from "./sidebar";
 2: export { SidebarProvider, useSidebar } from "./sidebar-context";
 3: export { SidebarTrigger } from "./sidebar-trigger";
 4: export { SidebarSearch } from "./sidebar-search";
 5: export { SidebarContent } from "./sidebar-content";
 6: export {
 7:   SidebarGroup,
 8:   SidebarGroupLabel,
 9:   SidebarGroupAction,
10:   SidebarGroupContent,
11: } from "./sidebar-group";
12: export {
13:   SidebarMenu,
14:   SidebarMenuItem,
15:   SidebarMenuButton,
16:   SidebarMenuAction,
17: } from "./sidebar-menu";
18: export {
19:   SidebarMenuSub,
20:   SidebarMenuSubItem,
21:   SidebarMenuSubButton,
22: } from "./sidebar-menu-sub";
23: export {
24:   SidebarMenuBadge,
25:   SidebarMenuSkeleton,
26: } from "./sidebar-menu-extras";
27: export {
28:   SidebarSection,
29:   SidebarSectionTitle,
30:   SidebarSectionContent,
31:   SidebarSectionSeparator,
32: } from "./sidebar-section";
33: export { SidebarItem, SidebarItemSkeleton } from "./sidebar-item";
34: export { SidebarRail, SidebarInset } from "./sidebar-layout";
35: export {
36:   SidebarInput,
37:   SidebarHeader,
38:   SidebarFooter,
39:   SidebarSeparator,
40: } from "./sidebar-sections";
41: export type { SidebarContext, SidebarState } from "./sidebar-types";
```

## File: apps/web/src/components/sidebar/sidebar-content.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { useSidebar } from "./sidebar-context";
 6: 
 7: export const SidebarContent = React.forwardRef<
 8:   HTMLDivElement,
 9:   React.ComponentProps<"div">
10: >(({ className, ...props }, ref) => {
11:   const { isOpen } = useSidebar();
12: 
13:   return (
14:     <div
15:       ref={ref}
16:       data-sidebar="content"
17:       data-state={isOpen ? "open" : "closed"}
18:       className={cn(
19:         "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
20:         "h-full w-[300px] border-r bg-background transition-all duration-300 ease-in-out data-[state=closed]:w-[0px] data-[state=closed]:opacity-0",
21:         className
22:       )}
23:       {...props}
24:     />
25:   );
26: });
```

## File: apps/web/src/components/sidebar/sidebar-context.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import { useMobile } from "@/hooks/use-mobile";
  5: import { cn } from "@/lib/utils";
  6: import { TooltipProvider } from "../tooltip";
  7: import type { SidebarContext } from "./sidebar-types";
  8: import {
  9:   SIDEBAR_COOKIE_NAME,
 10:   SIDEBAR_COOKIE_MAX_AGE,
 11:   SIDEBAR_WIDTH,
 12:   SIDEBAR_WIDTH_ICON,
 13:   SIDEBAR_KEYBOARD_SHORTCUT,
 14: } from "./sidebar-types";
 15: 
 16: const SidebarContext = React.createContext<SidebarContext | null>(null);
 17: 
 18: export function useSidebar() {
 19:   const context = React.useContext(SidebarContext);
 20:   if (!context) {
 21:     throw new Error("useSidebar must be used within a SidebarProvider");
 22:   }
 23:   return context;
 24: }
 25: 
 26: interface SidebarProviderProps extends React.ComponentProps<"div"> {
 27:   defaultOpen?: boolean;
 28:   open?: boolean;
 29:   onOpenChange?: (open: boolean) => void;
 30: }
 31: 
 32: export const SidebarProvider = React.forwardRef<HTMLDivElement, SidebarProviderProps>(
 33:   (
 34:     {
 35:       defaultOpen = true,
 36:       open: openProp,
 37:       onOpenChange: setOpenProp,
 38:       className,
 39:       style,
 40:       children,
 41:       ...props
 42:     },
 43:     ref
 44:   ) => {
 45:     const isMobile = useMobile();
 46:     const [openMobile, setOpenMobile] = React.useState(false);
 47: 
 48:     const [_open, _setOpen] = React.useState(defaultOpen);
 49:     const open = openProp ?? _open;
 50:     const setOpen = React.useCallback(
 51:       (value: boolean | ((value: boolean) => boolean)) => {
 52:         const openState = typeof value === "function" ? value(open) : value;
 53:         if (setOpenProp) {
 54:           setOpenProp(openState);
 55:         } else {
 56:           _setOpen(openState);
 57:         }
 58: 
 59:         document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
 60:       },
 61:       [setOpenProp, open]
 62:     );
 63: 
 64:     const toggleSidebar = React.useCallback(() => {
 65:       return isMobile
 66:         ? setOpenMobile((open) => !open)
 67:         : setOpen((open) => !open);
 68:     }, [isMobile, setOpen, setOpenMobile]);
 69: 
 70:     React.useEffect(() => {
 71:       const handleKeyDown = (event: KeyboardEvent) => {
 72:         if (
 73:           event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
 74:           (event.metaKey || event.ctrlKey)
 75:         ) {
 76:           event.preventDefault();
 77:           toggleSidebar();
 78:         }
 79:       };
 80: 
 81:       window.addEventListener("keydown", handleKeyDown);
 82:       return () => window.removeEventListener("keydown", handleKeyDown);
 83:     }, [toggleSidebar]);
 84: 
 85:     const state = open ? "expanded" : "collapsed";
 86: 
 87:     const contextValue = React.useMemo<SidebarContext>(
 88:       () => ({
 89:         state,
 90:         isOpen: open,
 91:         setOpen,
 92:         isMobile,
 93:         openMobile,
 94:         setOpenMobile,
 95:         toggleSidebar,
 96:       }),
 97:       [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
 98:     );
 99: 
100:     return (
101:       <SidebarContext.Provider value={contextValue}>
102:         <TooltipProvider delayDuration={0}>
103:           <div
104:             style={
105:               {
106:                 "--sidebar-width": SIDEBAR_WIDTH,
107:                 "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
108:                 ...style,
109:               } as React.CSSProperties
110:             }
111:             className={cn(
112:               "group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",
113:               className
114:             )}
115:             ref={ref}
116:             {...props}
117:           >
118:             {children}
119:           </div>
120:         </TooltipProvider>
121:       </SidebarContext.Provider>
122:     );
123:   }
124: );
```

## File: apps/web/src/components/sidebar/sidebar-group.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cn } from "@/lib/utils";
 6: 
 7: export const SidebarGroup = React.forwardRef<
 8:   HTMLDivElement,
 9:   React.ComponentProps<"div">
10: >(({ className, ...props }, ref) => {
11:   return (
12:     <div
13:       ref={ref}
14:       data-sidebar="group"
15:       className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
16:       {...props}
17:     />
18:   );
19: });
20: 
21: export const SidebarGroupLabel = React.forwardRef<
22:   HTMLDivElement,
23:   React.ComponentProps<"div"> & { asChild?: boolean }
24: >(({ className, asChild = false, ...props }, ref) => {
25:   const Comp = asChild ? Slot : "div";
26: 
27:   return (
28:     <Comp
29:       ref={ref}
30:       data-sidebar="group-label"
31:       className={cn(
32:         "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
33:         "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
34:         className
35:       )}
36:       {...props}
37:     />
38:   );
39: });
40: 
41: export const SidebarGroupAction = React.forwardRef<
42:   HTMLButtonElement,
43:   React.ComponentProps<"button"> & { asChild?: boolean }
44: >(({ className, asChild = false, ...props }, ref) => {
45:   const Comp = asChild ? Slot : "button";
46: 
47:   return (
48:     <Comp
49:       ref={ref}
50:       data-sidebar="group-action"
51:       className={cn(
52:         "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
53:         "after:absolute after:-inset-2 after:md:hidden",
54:         "group-data-[collapsible=icon]:hidden",
55:         className
56:       )}
57:       {...props}
58:     />
59:   );
60: });
61: 
62: export const SidebarGroupContent = React.forwardRef<
63:   HTMLDivElement,
64:   React.ComponentProps<"div">
65: >(({ className, ...props }, ref) => (
66:   <div
67:     ref={ref}
68:     data-sidebar="group-content"
69:     className={cn("w-full text-sm", className)}
70:     {...props}
71:   />
72: ));
```

## File: apps/web/src/components/sidebar/sidebar-item.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cva, type VariantProps } from "class-variance-authority";
 6: import { cn } from "@/lib/utils";
 7: import { Skeleton } from "../skeleton";
 8: import {
 9:   Tooltip,
10:   TooltipContent,
11:   TooltipTrigger,
12: } from "../tooltip";
13: import { useSidebar } from "./sidebar-context";
14: 
15: const sidebarItemVariants = cva(
16:   "group/sidebar-item relative flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",
17:   {
18:     variants: {
19:       size: {
20:         sm: "gap-1.5 px-1.5 py-1 text-xs",
21:         md: "gap-2 px-2 py-1.5 text-sm",
22:         lg: "gap-2.5 px-2.5 py-2 text-base",
23:       },
24:     },
25:     defaultVariants: {
26:       size: "md",
27:     },
28:   }
29: );
30: 
31: export interface SidebarItemProps
32:   extends React.HTMLAttributes<HTMLAnchorElement>,
33:     VariantProps<typeof sidebarItemVariants> {
34:   asChild?: boolean;
35:   isActive?: boolean;
36: }
37: 
38: export const SidebarItem = React.forwardRef<HTMLAnchorElement, SidebarItemProps>(
39:   ({ className, asChild = false, size, isActive, ...props }, ref) => {
40:     const Comp = asChild ? Slot : "a";
41:     const { state } = useSidebar();
42: 
43:     const content = (
44:       <Comp
45:         ref={ref}
46:         className={cn(
47:           sidebarItemVariants({ size }),
48:           isActive && "bg-accent text-accent-foreground",
49:           className
50:         )}
51:         {...props}
52:       />
53:     );
54: 
55:     if (state === "collapsed") {
56:       return (
57:         <Tooltip>
58:           <TooltipTrigger asChild>{content}</TooltipTrigger>
59:           <TooltipContent side="right" sideOffset={20}>
60:             {props.children}
61:           </TooltipContent>
62:         </Tooltip>
63:       );
64:     }
65: 
66:     return content;
67:   }
68: );
69: 
70: export const SidebarItemSkeleton = React.forwardRef<
71:   HTMLDivElement,
72:   React.ComponentPropsWithoutRef<typeof Skeleton> & { size?: "sm" | "md" | "lg" }
73: >(({ size = "md", className, ...props }, ref) => {
74:   return (
75:     <Skeleton
76:       ref={ref}
77:       className={cn(
78:         "w-full",
79:         size === "sm" && "h-6",
80:         size === "md" && "h-8",
81:         size === "lg" && "h-10",
82:         className
83:       )}
84:       {...props}
85:     />
86:   );
87: });
```

## File: apps/web/src/components/sidebar/sidebar-layout.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { useSidebar } from "./sidebar-context";
 6: 
 7: export const SidebarRail = React.forwardRef<
 8:   HTMLButtonElement,
 9:   React.ComponentProps<"button">
10: >(({ className, ...props }, ref) => {
11:   const { toggleSidebar } = useSidebar();
12: 
13:   return (
14:     <button
15:       ref={ref}
16:       data-sidebar="rail"
17:       aria-label="Toggle Sidebar"
18:       tabIndex={-1}
19:       onClick={toggleSidebar}
20:       title="Toggle Sidebar"
21:       className={cn(
22:         "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
23:         "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
24:         "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
25:         "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
26:         "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
27:         "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
28:         className
29:       )}
30:       {...props}
31:     />
32:   );
33: });
34: 
35: export const SidebarInset = React.forwardRef<
36:   HTMLDivElement,
37:   React.ComponentProps<"main">
38: >(({ className, ...props }, ref) => {
39:   return (
40:     <main
41:       ref={ref}
42:       className={cn(
43:         "relative flex min-h-svh flex-1 flex-col bg-background",
44:         "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
45:         className
46:       )}
47:       {...props}
48:     />
49:   );
50: });
```

## File: apps/web/src/components/sidebar/sidebar-menu-extras.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { Skeleton } from "../skeleton";
 6: 
 7: export const SidebarMenuBadge = React.forwardRef<
 8:   HTMLDivElement,
 9:   React.ComponentProps<"div">
10: >(({ className, ...props }, ref) => (
11:   <div
12:     ref={ref}
13:     data-sidebar="menu-badge"
14:     className={cn(
15:       "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
16:       "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
17:       "peer-data-[size=sm]/menu-button:top-1",
18:       "peer-data-[size=default]/menu-button:top-1.5",
19:       "peer-data-[size=lg]/menu-button:top-2.5",
20:       "group-data-[collapsible=icon]:hidden",
21:       className
22:     )}
23:     {...props}
24:   />
25: ));
26: 
27: export const SidebarMenuSkeleton = React.forwardRef<
28:   HTMLDivElement,
29:   React.ComponentProps<"div"> & {
30:     showIcon?: boolean;
31:   }
32: >(({ className, showIcon = false, ...props }, ref) => {
33:   // Random width between 50 to 90%.
34:   const width = React.useMemo(() => {
35:     return `${Math.floor(Math.random() * 40) + 50}%`;
36:   }, []);
37: 
38:   return (
39:     <div
40:       ref={ref}
41:       data-sidebar="menu-skeleton"
42:       className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)}
43:       {...props}
44:     >
45:       {showIcon && (
46:         <Skeleton
47:           className="size-4 rounded-md"
48:           data-sidebar="menu-skeleton-icon"
49:         />
50:       )}
51:       <Skeleton
52:         className="h-4 flex-1 max-w-[--skeleton-width]"
53:         data-sidebar="menu-skeleton-text"
54:         style={
55:           {
56:             "--skeleton-width": width,
57:           } as React.CSSProperties
58:         }
59:       />
60:     </div>
61:   );
62: });
```

## File: apps/web/src/components/sidebar/sidebar-menu-sub.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cn } from "@/lib/utils";
 6: 
 7: export const SidebarMenuSub = React.forwardRef<
 8:   HTMLUListElement,
 9:   React.ComponentProps<"ul">
10: >(({ className, ...props }, ref) => (
11:   <ul
12:     ref={ref}
13:     data-sidebar="menu-sub"
14:     className={cn(
15:       "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
16:       "group-data-[collapsible=icon]:hidden",
17:       className
18:     )}
19:     {...props}
20:   />
21: ));
22: 
23: export const SidebarMenuSubItem = React.forwardRef<
24:   HTMLLIElement,
25:   React.ComponentProps<"li">
26: >(({ ...props }, ref) => <li ref={ref} {...props} />);
27: 
28: export const SidebarMenuSubButton = React.forwardRef<
29:   HTMLAnchorElement,
30:   React.ComponentProps<"a"> & {
31:     asChild?: boolean;
32:     size?: "sm" | "md";
33:     isActive?: boolean;
34:   }
35: >(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
36:   const Comp = asChild ? Slot : "a";
37: 
38:   return (
39:     <Comp
40:       ref={ref}
41:       data-sidebar="menu-sub-button"
42:       data-size={size}
43:       data-active={isActive}
44:       className={cn(
45:         "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
46:         "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
47:         size === "sm" && "text-xs",
48:         size === "md" && "text-sm",
49:         "group-data-[collapsible=icon]:hidden",
50:         className
51:       )}
52:       {...props}
53:     />
54:   );
55: });
```

## File: apps/web/src/components/sidebar/sidebar-menu.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import { Slot } from "@radix-ui/react-slot";
  5: import { cva, type VariantProps } from "class-variance-authority";
  6: import { cn } from "@/lib/utils";
  7: import { Tooltip, TooltipContent, TooltipTrigger } from "../tooltip";
  8: import { useSidebar } from "./sidebar-context";
  9: 
 10: export const SidebarMenu = React.forwardRef<
 11:   HTMLUListElement,
 12:   React.ComponentProps<"ul">
 13: >(({ className, ...props }, ref) => (
 14:   <ul
 15:     ref={ref}
 16:     data-sidebar="menu"
 17:     className={cn("flex w-full min-w-0 flex-col gap-1", className)}
 18:     {...props}
 19:   />
 20: ));
 21: 
 22: export const SidebarMenuItem = React.forwardRef<
 23:   HTMLLIElement,
 24:   React.ComponentProps<"li">
 25: >(({ className, ...props }, ref) => (
 26:   <li
 27:     ref={ref}
 28:     data-sidebar="menu-item"
 29:     className={cn("group/menu-item relative", className)}
 30:     {...props}
 31:   />
 32: ));
 33: 
 34: const sidebarMenuButtonVariants = cva(
 35:   "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
 36:   {
 37:     variants: {
 38:       variant: {
 39:         default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
 40:         outline:
 41:           "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
 42:       },
 43:       size: {
 44:         default: "h-8 text-sm",
 45:         sm: "h-7 text-xs",
 46:         lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
 47:       },
 48:     },
 49:     defaultVariants: {
 50:       variant: "default",
 51:       size: "default",
 52:     },
 53:   }
 54: );
 55: 
 56: export interface SidebarMenuButtonProps
 57:   extends React.ComponentProps<"button">,
 58:     VariantProps<typeof sidebarMenuButtonVariants> {
 59:   asChild?: boolean;
 60:   isActive?: boolean;
 61:   tooltip?: string | React.ComponentProps<typeof TooltipContent>;
 62: }
 63: 
 64: export const SidebarMenuButton = React.forwardRef<
 65:   HTMLButtonElement,
 66:   SidebarMenuButtonProps
 67: >(
 68:   (
 69:     {
 70:       asChild = false,
 71:       isActive = false,
 72:       variant = "default",
 73:       size = "default",
 74:       tooltip,
 75:       className,
 76:       ...props
 77:     },
 78:     ref
 79:   ) => {
 80:     const Comp = asChild ? Slot : "button";
 81:     const { isMobile, state } = useSidebar();
 82: 
 83:     const button = (
 84:       <Comp
 85:         ref={ref}
 86:         data-sidebar="menu-button"
 87:         data-size={size}
 88:         data-active={isActive}
 89:         className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
 90:         {...props}
 91:       />
 92:     );
 93: 
 94:     if (!tooltip) {
 95:       return button;
 96:     }
 97: 
 98:     if (typeof tooltip === "string") {
 99:       tooltip = {
100:         children: tooltip,
101:       };
102:     }
103: 
104:     return (
105:       <Tooltip>
106:         <TooltipTrigger asChild>{button}</TooltipTrigger>
107:         <TooltipContent
108:           side="right"
109:           align="center"
110:           hidden={state !== "collapsed" || isMobile}
111:           {...tooltip}
112:         />
113:       </Tooltip>
114:     );
115:   }
116: );
117: 
118: export const SidebarMenuAction = React.forwardRef<
119:   HTMLButtonElement,
120:   React.ComponentProps<"button"> & {
121:     asChild?: boolean;
122:     showOnHover?: boolean;
123:   }
124: >(({ className, asChild = false, showOnHover = true, ...props }, ref) => {
125:   const Comp = asChild ? Slot : "button";
126: 
127:   return (
128:     <Comp
129:       ref={ref}
130:       data-sidebar="menu-action"
131:       className={cn(
132:         "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
133:         "after:absolute after:-inset-2 after:md:hidden",
134:         "peer-data-[size=sm]/menu-button:top-1",
135:         "peer-data-[size=default]/menu-button:top-1.5",
136:         "peer-data-[size=lg]/menu-button:top-2.5",
137:         "group-data-[collapsible=icon]:hidden",
138:         showOnHover &&
139:           "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
140:         className
141:       )}
142:       {...props}
143:     />
144:   );
145: });
```

## File: apps/web/src/components/sidebar/sidebar-search.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Input } from "../input";
 5: import { cn } from "@/lib/utils";
 6: 
 7: export const SidebarSearch = React.forwardRef<
 8:   HTMLInputElement,
 9:   React.ComponentPropsWithoutRef<typeof Input>
10: >(({ className, ...props }, ref) => {
11:   return (
12:     <div className="px-4 py-2">
13:       <Input
14:         ref={ref}
15:         type="search"
16:         placeholder="Search..."
17:         className={cn("h-8 w-full bg-background px-3", className)}
18:         {...props}
19:       />
20:     </div>
21:   );
22: });
```

## File: apps/web/src/components/sidebar/sidebar-section.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cn } from "@/lib/utils";
 6: import { Separator } from "../separator";
 7: 
 8: export const SidebarSection = React.forwardRef<
 9:   HTMLDivElement,
10:   React.HTMLAttributes<HTMLDivElement>
11: >(({ className, ...props }, ref) => {
12:   return (
13:     <div
14:       ref={ref}
15:       className={cn("flex flex-col gap-2 px-2 py-2", className)}
16:       {...props}
17:     />
18:   );
19: });
20: 
21: export const SidebarSectionTitle = React.forwardRef<
22:   HTMLDivElement,
23:   React.HTMLAttributes<HTMLDivElement>
24: >(({ className, ...props }, ref) => {
25:   return (
26:     <div
27:       ref={ref}
28:       className={cn("px-2 text-xs font-semibold text-muted-foreground", className)}
29:       {...props}
30:     />
31:   );
32: });
33: 
34: export const SidebarSectionContent = React.forwardRef<
35:   HTMLDivElement,
36:   React.HTMLAttributes<HTMLDivElement> & { asChild?: boolean }
37: >(({ className, asChild = false, ...props }, ref) => {
38:   const Comp = asChild ? Slot : "div";
39: 
40:   return (
41:     <Comp
42:       ref={ref}
43:       className={cn("flex flex-col gap-1", className)}
44:       {...props}
45:     />
46:   );
47: });
48: 
49: export const SidebarSectionSeparator = React.forwardRef<
50:   HTMLDivElement,
51:   React.ComponentPropsWithoutRef<typeof Separator>
52: >(({ className, ...props }, ref) => {
53:   return (
54:     <Separator ref={ref} className={cn("my-2", className)} {...props} />
55:   );
56: });
```

## File: apps/web/src/components/sidebar/sidebar-sections.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { Input } from "../input";
 6: import { Separator } from "../separator";
 7: 
 8: export const SidebarInput = React.forwardRef<
 9:   React.ElementRef<typeof Input>,
10:   React.ComponentPropsWithoutRef<typeof Input>
11: >(({ className, ...props }, ref) => {
12:   return (
13:     <Input
14:       ref={ref}
15:       data-sidebar="input"
16:       className={cn(
17:         "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
18:         className
19:       )}
20:       {...props}
21:     />
22:   );
23: });
24: 
25: SidebarInput.displayName = "SidebarInput";
26: 
27: export const SidebarHeader = React.forwardRef<
28:   HTMLDivElement,
29:   React.HTMLAttributes<HTMLDivElement>
30: >(({ className, ...props }, ref) => {
31:   return (
32:     <div
33:       ref={ref}
34:       data-sidebar="header"
35:       className={cn("flex flex-col gap-2 p-2", className)}
36:       {...props}
37:     />
38:   );
39: });
40: 
41: SidebarHeader.displayName = "SidebarHeader";
42: 
43: export const SidebarFooter = React.forwardRef<
44:   HTMLDivElement,
45:   React.HTMLAttributes<HTMLDivElement>
46: >(({ className, ...props }, ref) => {
47:   return (
48:     <div
49:       ref={ref}
50:       data-sidebar="footer"
51:       className={cn("flex flex-col gap-2 p-2", className)}
52:       {...props}
53:     />
54:   );
55: });
56: 
57: SidebarFooter.displayName = "SidebarFooter";
58: 
59: export const SidebarSeparator = React.forwardRef<
60:   React.ElementRef<typeof Separator>,
61:   React.ComponentPropsWithoutRef<typeof Separator>
62: >(({ className, ...props }, ref) => {
63:   return (
64:     <Separator
65:       ref={ref}
66:       data-sidebar="separator"
67:       className={cn("mx-2 w-auto bg-sidebar-border", className)}
68:       {...props}
69:     />
70:   );
71: });
72: 
73: SidebarSeparator.displayName = "SidebarSeparator";
```

## File: apps/web/src/components/sidebar/sidebar-toggle.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { useSidebar } from "./sidebar-context";
 6: 
 7: export function SidebarToggle({
 8:   className,
 9: }: React.HTMLAttributes<HTMLButtonElement>) {
10:   const { toggleSidebar } = useSidebar();
11: 
12:   return (
13:     <button
14:       onClick={toggleSidebar}
15:       className={cn(
16:         "absolute -right-4 top-4 z-50 flex h-8 w-8 items-center justify-center rounded-full border bg-background shadow-sm",
17:         className
18:       )}
19:     >
20:       <svg
21:         xmlns="http://www.w3.org/2000/svg"
22:         width="24"
23:         height="24"
24:         viewBox="0 0 24 24"
25:         fill="none"
26:         stroke="currentColor"
27:         strokeWidth="2"
28:         strokeLinecap="round"
29:         strokeLinejoin="round"
30:         className="h-4 w-4"
31:       >
32:         <path d="m9 18 6-6-6-6" />
33:       </svg>
34:     </button>
35:   );
36: }
```

## File: apps/web/src/components/sidebar/sidebar-trigger.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { PanelLeft } from "lucide-react";
 5: import { Button } from "../button";
 6: import { useSidebar } from "./sidebar-context";
 7: 
 8: export const SidebarTrigger = React.forwardRef<
 9:   React.ElementRef<typeof Button>,
10:   React.ComponentPropsWithoutRef<typeof Button>
11: >(({ className, onClick, ...props }, ref) => {
12:   const { toggleSidebar } = useSidebar();
13: 
14:   return (
15:     <Button
16:       variant="ghost"
17:       size="icon"
18:       className={className}
19:       onClick={(e) => {
20:         onClick?.(e);
21:         toggleSidebar();
22:       }}
23:       ref={ref}
24:       {...props}
25:     >
26:       <PanelLeft className="h-4 w-4" aria-hidden="true" />
27:       <span className="sr-only">Toggle sidebar</span>
28:     </Button>
29:   );
30: });
31: 
32: SidebarTrigger.displayName = "SidebarTrigger";
```

## File: apps/web/src/components/sidebar/sidebar-types.ts
```typescript
 1: export const SIDEBAR_COOKIE_NAME = "sidebar:state";
 2: export const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7; // 7 days
 3: export const SIDEBAR_WIDTH = "16rem";
 4: export const SIDEBAR_WIDTH_MOBILE = "18rem";
 5: export const SIDEBAR_WIDTH_ICON = "3rem";
 6: export const SIDEBAR_KEYBOARD_SHORTCUT = "b";
 7: 
 8: export type SidebarContext = {
 9:   state: "expanded" | "collapsed";
10:   isOpen: boolean;
11:   setOpen: (open: boolean) => void;
12:   openMobile: boolean;
13:   setOpenMobile: (open: boolean) => void;
14:   isMobile: boolean;
15:   toggleSidebar: () => void;
16: };
17: 
18: export type SidebarState = {
19:   isOpen: boolean;
20:   openMobile: boolean;
21:   isMobile: boolean;
22: };
```

## File: apps/web/src/components/sidebar/sidebar.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import { Slot } from "@radix-ui/react-slot"
  5: import type { VariantProps } from "class-variance-authority"
  6: import { cva } from "class-variance-authority"
  7: import { PanelLeft } from "lucide-react"
  8: 
  9: import { useMobile } from "@/hooks/use-mobile"
 10: import { cn } from "@/lib/utils"
 11: import { Button } from "./button"
 12: import { Input } from "./input"
 13: import { Separator } from "./separator"
 14: import { Sheet, SheetContent } from "./sheet"
 15: import { Skeleton } from "./skeleton"
 16: import {
 17:   Tooltip,
 18:   TooltipContent,
 19:   TooltipProvider,
 20:   TooltipTrigger,
 21: } from "./tooltip"
 22: 
 23: const SIDEBAR_COOKIE_NAME = "sidebar:state"
 24: const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7
 25: const SIDEBAR_WIDTH = "16rem"
 26: const SIDEBAR_WIDTH_MOBILE = "18rem"
 27: const SIDEBAR_WIDTH_ICON = "3rem"
 28: const SIDEBAR_KEYBOARD_SHORTCUT = "b"
 29: 
 30: type SidebarContext = {
 31:   state: "expanded" | "collapsed"
 32:   isOpen: boolean
 33:   setOpen: (open: boolean) => void
 34:   openMobile: boolean
 35:   setOpenMobile: (open: boolean) => void
 36:   isMobile: boolean
 37:   toggleSidebar: () => void
 38: }
 39: 
 40: const SidebarContext = React.createContext<SidebarContext | null>(null)
 41: 
 42: function useSidebar() {
 43:   const context = React.useContext(SidebarContext)
 44:   if (!context) {
 45:     throw new Error("useSidebar must be used within a SidebarProvider.")
 46:   }
 47: 
 48:   return context
 49: }
 50: 
 51: const SidebarProvider = React.forwardRef<
 52:   HTMLDivElement,
 53:   React.ComponentProps<"div"> & {
 54:     defaultOpen?: boolean
 55:     open?: boolean
 56:     onOpenChange?: (open: boolean) => void
 57:   }
 58: >(
 59:   (
 60:     {
 61:       defaultOpen = true,
 62:       open: openProp,
 63:       onOpenChange: setOpenProp,
 64:       className,
 65:       style,
 66:       children,
 67:       ...props
 68:     },
 69:     ref
 70:   ) => {
 71:     const isMobile = useMobile()
 72:     const [openMobile, setOpenMobile] = React.useState(false)
 73: 
 74:     // This is the internal state of the sidebar.
 75:     // We use openProp and setOpenProp for control from outside the component.
 76:     const [_open, _setOpen] = React.useState(defaultOpen)
 77:     const open = openProp ?? _open
 78:     const setOpen = React.useCallback(
 79:       (value: boolean | ((value: boolean) => boolean)) => {
 80:         const openState = typeof value === "function" ? value(open) : value
 81:         if (setOpenProp) {
 82:           setOpenProp(openState)
 83:         } else {
 84:           _setOpen(openState)
 85:         }
 86: 
 87:         // This sets the cookie to keep the sidebar state.
 88:         document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`
 89:       },
 90:       [setOpenProp, open]
 91:     )
 92: 
 93:     // Helper to toggle the sidebar.
 94:     const toggleSidebar = React.useCallback(() => {
 95:       return isMobile
 96:         ? setOpenMobile((open) => !open)
 97:         : setOpen((open) => !open)
 98:     }, [isMobile, setOpen, setOpenMobile])
 99: 
100:     // Adds a keyboard shortcut to toggle the sidebar.
101:     React.useEffect(() => {
102:       const handleKeyDown = (event: KeyboardEvent) => {
103:         if (
104:           event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
105:           (event.metaKey || event.ctrlKey)
106:         ) {
107:           event.preventDefault()
108:           toggleSidebar()
109:         }
110:       }
111: 
112:       window.addEventListener("keydown", handleKeyDown)
113:       return () => window.removeEventListener("keydown", handleKeyDown)
114:     }, [toggleSidebar])
115: 
116:     // We add a state so that we can do data-state="expanded" or "collapsed".
117:     // This makes it easier to style the sidebar with Tailwind classes.
118:     const state = open ? "expanded" : "collapsed"
119: 
120:     const contextValue = React.useMemo<SidebarContext>(
121:       () => ({
122:         state,
123:         isOpen: open,
124:         setOpen,
125:         isMobile,
126:         openMobile,
127:         setOpenMobile,
128:         toggleSidebar,
129:       }),
130:       [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
131:     )
132: 
133:     return (
134:       <SidebarContext.Provider value={contextValue}>
135:         <TooltipProvider delayDuration={0}>
136:           <div
137:             style={
138:               {
139:                 "--sidebar-width": SIDEBAR_WIDTH,
140:                 "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
141:                 ...style,
142:               } as React.CSSProperties
143:             }
144:             className={cn(
145:               "group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",
146:               className
147:             )}
148:             ref={ref}
149:             {...props}
150:           >
151:             {children}
152:           </div>
153:         </TooltipProvider>
154:       </SidebarContext.Provider>
155:     )
156:   }
157: )
158: SidebarProvider.displayName = "SidebarProvider"
159: 
160: const Sidebar = React.forwardRef<
161:   HTMLDivElement,
162:   React.ComponentProps<"div"> & {
163:     side?: "left" | "right"
164:     variant?: "sidebar" | "floating" | "inset"
165:     collapsible?: "offcanvas" | "icon" | "none"
166:   }
167: >(
168:   (
169:     {
170:       side = "left",
171:       variant = "sidebar",
172:       collapsible = "offcanvas",
173:       className,
174:       children,
175:       ...props
176:     },
177:     ref
178:   ) => {
179:     const { isMobile, state, openMobile, setOpenMobile } = useSidebar()
180: 
181:     if (collapsible === "none") {
182:       return (
183:         <div
184:           className={cn(
185:             "flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",
186:             className
187:           )}
188:           ref={ref}
189:           {...props}
190:         >
191:           {children}
192:         </div>
193:       )
194:     }
195: 
196:     if (isMobile) {
197:       return (
198:         <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
199:           <SheetContent
200:             data-sidebar="sidebar"
201:             data-mobile="true"
202:             className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
203:             style={
204:               {
205:                 "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
206:               } as React.CSSProperties
207:             }
208:             side={side}
209:           >
210:             <div className="flex h-full w-full flex-col">{children}</div>
211:           </SheetContent>
212:         </Sheet>
213:       )
214:     }
215: 
216:     return (
217:       <div
218:         ref={ref}
219:         className="group peer hidden md:block text-sidebar-foreground"
220:         data-state={state}
221:         data-collapsible={state === "collapsed" ? collapsible : ""}
222:         data-variant={variant}
223:         data-side={side}
224:       >
225:         {/* This is what handles the sidebar gap on desktop */}
226:         <div
227:           className={cn(
228:             "duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear",
229:             "group-data-[collapsible=offcanvas]:w-0",
230:             "group-data-[side=right]:rotate-180",
231:             variant === "floating" || variant === "inset"
232:               ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
233:               : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]"
234:           )}
235:         />
236:         <div
237:           className={cn(
238:             "duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",
239:             side === "left"
240:               ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
241:               : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
242:             // Adjust the padding for floating and inset variants.
243:             variant === "floating" || variant === "inset"
244:               ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
245:               : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
246:             className
247:           )}
248:           {...props}
249:         >
250:           <div
251:             data-sidebar="sidebar"
252:             className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
253:           >
254:             {children}
255:           </div>
256:         </div>
257:       </div>
258:     )
259:   }
260: )
261: Sidebar.displayName = "Sidebar"
262: 
263: const SidebarTrigger = React.forwardRef<
264:   React.ElementRef<typeof Button>,
265:   React.ComponentProps<typeof Button>
266: >(({ className, onClick, ...props }, ref) => {
267:   const { toggleSidebar } = useSidebar()
268: 
269:   return (
270:     <Button
271:       ref={ref}
272:       data-sidebar="trigger"
273:       variant="ghost"
274:       size="icon"
275:       className={cn("h-7 w-7", className)}
276:       onClick={(event) => {
277:         onClick?.(event)
278:         toggleSidebar()
279:       }}
280:       {...props}
281:     >
282:       <PanelLeft />
283:       <span className="sr-only">Toggle Sidebar</span>
284:     </Button>
285:   )
286: })
287: SidebarTrigger.displayName = "SidebarTrigger"
288: 
289: const SidebarRail = React.forwardRef<
290:   HTMLButtonElement,
291:   React.ComponentProps<"button">
292: >(({ className, ...props }, ref) => {
293:   const { toggleSidebar } = useSidebar()
294: 
295:   return (
296:     <button
297:       ref={ref}
298:       data-sidebar="rail"
299:       aria-label="Toggle Sidebar"
300:       tabIndex={-1}
301:       onClick={toggleSidebar}
302:       title="Toggle Sidebar"
303:       className={cn(
304:         "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
305:         "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
306:         "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
307:         "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
308:         "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
309:         "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
310:         className
311:       )}
312:       {...props}
313:     />
314:   )
315: })
316: SidebarRail.displayName = "SidebarRail"
317: 
318: const SidebarInset = React.forwardRef<
319:   HTMLDivElement,
320:   React.ComponentProps<"main">
321: >(({ className, ...props }, ref) => {
322:   return (
323:     <main
324:       ref={ref}
325:       className={cn(
326:         "relative flex min-h-svh flex-1 flex-col bg-background",
327:         "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
328:         className
329:       )}
330:       {...props}
331:     />
332:   )
333: })
334: SidebarInset.displayName = "SidebarInset"
335: 
336: const SidebarInput = React.forwardRef<
337:   React.ElementRef<typeof Input>,
338:   React.ComponentProps<typeof Input>
339: >(({ className, ...props }, ref) => {
340:   return (
341:     <Input
342:       ref={ref}
343:       data-sidebar="input"
344:       className={cn(
345:         "h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",
346:         className
347:       )}
348:       {...props}
349:     />
350:   )
351: })
352: SidebarInput.displayName = "SidebarInput"
353: 
354: const SidebarHeader = React.forwardRef<
355:   HTMLDivElement,
356:   React.ComponentProps<"div">
357: >(({ className, ...props }, ref) => {
358:   return (
359:     <div
360:       ref={ref}
361:       data-sidebar="header"
362:       className={cn("flex flex-col gap-2 p-2", className)}
363:       {...props}
364:     />
365:   )
366: })
367: SidebarHeader.displayName = "SidebarHeader"
368: 
369: const SidebarFooter = React.forwardRef<
370:   HTMLDivElement,
371:   React.ComponentProps<"div">
372: >(({ className, ...props }, ref) => {
373:   return (
374:     <div
375:       ref={ref}
376:       data-sidebar="footer"
377:       className={cn("flex flex-col gap-2 p-2", className)}
378:       {...props}
379:     />
380:   )
381: })
382: SidebarFooter.displayName = "SidebarFooter"
383: 
384: const SidebarSeparator = React.forwardRef<
385:   React.ElementRef<typeof Separator>,
386:   React.ComponentProps<typeof Separator>
387: >(({ className, ...props }, ref) => {
388:   return (
389:     <Separator
390:       ref={ref}
391:       data-sidebar="separator"
392:       className={cn("mx-2 w-auto bg-sidebar-border", className)}
393:       {...props}
394:     />
395:   )
396: })
397: SidebarSeparator.displayName = "SidebarSeparator"
398: 
399: const SidebarContent = React.forwardRef<
400:   HTMLDivElement,
401:   React.ComponentProps<"div">
402: >(({ className, ...props }, ref) => {
403:   return (
404:     <div
405:       ref={ref}
406:       data-sidebar="content"
407:       className={cn(
408:         "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
409:         className
410:       )}
411:       {...props}
412:     />
413:   )
414: })
415: SidebarContent.displayName = "SidebarContent"
416: 
417: const SidebarGroup = React.forwardRef<
418:   HTMLDivElement,
419:   React.ComponentProps<"div">
420: >(({ className, ...props }, ref) => {
421:   return (
422:     <div
423:       ref={ref}
424:       data-sidebar="group"
425:       className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
426:       {...props}
427:     />
428:   )
429: })
430: SidebarGroup.displayName = "SidebarGroup"
431: 
432: const SidebarGroupLabel = React.forwardRef<
433:   HTMLDivElement,
434:   React.ComponentProps<"div"> & { asChild?: boolean }
435: >(({ className, asChild = false, ...props }, ref) => {
436:   const Comp = asChild ? Slot : "div"
437: 
438:   return (
439:     <Comp
440:       ref={ref}
441:       data-sidebar="group-label"
442:       className={cn(
443:         "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
444:         "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
445:         className
446:       )}
447:       {...props}
448:     />
449:   )
450: })
451: SidebarGroupLabel.displayName = "SidebarGroupLabel"
452: 
453: const SidebarGroupAction = React.forwardRef<
454:   HTMLButtonElement,
455:   React.ComponentProps<"button"> & { asChild?: boolean }
456: >(({ className, asChild = false, ...props }, ref) => {
457:   const Comp = asChild ? Slot : "button"
458: 
459:   return (
460:     <Comp
461:       ref={ref}
462:       data-sidebar="group-action"
463:       className={cn(
464:         "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
465:         // Increases the hit area of the button on mobile.
466:         "after:absolute after:-inset-2 after:md:hidden",
467:         "group-data-[collapsible=icon]:hidden",
468:         className
469:       )}
470:       {...props}
471:     />
472:   )
473: })
474: SidebarGroupAction.displayName = "SidebarGroupAction"
475: 
476: const SidebarGroupContent = React.forwardRef<
477:   HTMLDivElement,
478:   React.ComponentProps<"div">
479: >(({ className, ...props }, ref) => (
480:   <div
481:     ref={ref}
482:     data-sidebar="group-content"
483:     className={cn("w-full text-sm", className)}
484:     {...props}
485:   />
486: ))
487: SidebarGroupContent.displayName = "SidebarGroupContent"
488: 
489: const SidebarMenu = React.forwardRef<
490:   HTMLUListElement,
491:   React.ComponentProps<"ul">
492: >(({ className, ...props }, ref) => (
493:   <ul
494:     ref={ref}
495:     data-sidebar="menu"
496:     className={cn("flex w-full min-w-0 flex-col gap-1", className)}
497:     {...props}
498:   />
499: ))
500: SidebarMenu.displayName = "SidebarMenu"
501: 
502: const SidebarMenuItem = React.forwardRef<
503:   HTMLLIElement,
504:   React.ComponentProps<"li">
505: >(({ className, ...props }, ref) => (
506:   <li
507:     ref={ref}
508:     data-sidebar="menu-item"
509:     className={cn("group/menu-item relative", className)}
510:     {...props}
511:   />
512: ))
513: SidebarMenuItem.displayName = "SidebarMenuItem"
514: 
515: const sidebarMenuButtonVariants = cva(
516:   "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
517:   {
518:     variants: {
519:       variant: {
520:         default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
521:         outline:
522:           "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
523:       },
524:       size: {
525:         default: "h-8 text-sm",
526:         sm: "h-7 text-xs",
527:         lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
528:       },
529:     },
530:     defaultVariants: {
531:       variant: "default",
532:       size: "default",
533:     },
534:   }
535: )
536: 
537: const SidebarMenuButton = React.forwardRef<
538:   HTMLButtonElement,
539:   React.ComponentProps<"button"> & {
540:     asChild?: boolean
541:     isActive?: boolean
542:     tooltip?: string | React.ComponentProps<typeof TooltipContent>
543:   } & VariantProps<typeof sidebarMenuButtonVariants>
544: >(
545:   (
546:     {
547:       asChild = false,
548:       isActive = false,
549:       variant = "default",
550:       size = "default",
551:       tooltip,
552:       className,
553:       ...props
554:     },
555:     ref
556:   ) => {
557:     const Comp = asChild ? Slot : "button"
558:     const { isMobile, state } = useSidebar()
559: 
560:     const button = (
561:       <Comp
562:         ref={ref}
563:         data-sidebar="menu-button"
564:         data-size={size}
565:         data-active={isActive}
566:         className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
567:         {...props}
568:       />
569:     )
570: 
571:     if (!tooltip) {
572:       return button
573:     }
574: 
575:     if (typeof tooltip === "string") {
576:       tooltip = {
577:         children: tooltip,
578:       }
579:     }
580: 
581:     return (
582:       <Tooltip>
583:         <TooltipTrigger asChild>{button}</TooltipTrigger>
584:         <TooltipContent
585:           side="right"
586:           align="center"
587:           hidden={state !== "collapsed" || isMobile}
588:           {...tooltip}
589:         />
590:       </Tooltip>
591:     )
592:   }
593: )
594: SidebarMenuButton.displayName = "SidebarMenuButton"
595: 
596: const SidebarMenuAction = React.forwardRef<
597:   HTMLButtonElement,
598:   React.ComponentProps<"button"> & {
599:     asChild?: boolean
600:     showOnHover?: boolean
601:   }
602: >(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
603:   const Comp = asChild ? Slot : "button"
604: 
605:   return (
606:     <Comp
607:       ref={ref}
608:       data-sidebar="menu-action"
609:       className={cn(
610:         "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
611:         // Increases the hit area of the button on mobile.
612:         "after:absolute after:-inset-2 after:md:hidden",
613:         "peer-data-[size=sm]/menu-button:top-1",
614:         "peer-data-[size=default]/menu-button:top-1.5",
615:         "peer-data-[size=lg]/menu-button:top-2.5",
616:         "group-data-[collapsible=icon]:hidden",
617:         showOnHover &&
618:           "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
619:         className
620:       )}
621:       {...props}
622:     />
623:   )
624: })
625: SidebarMenuAction.displayName = "SidebarMenuAction"
626: 
627: const SidebarMenuBadge = React.forwardRef<
628:   HTMLDivElement,
629:   React.ComponentProps<"div">
630: >(({ className, ...props }, ref) => (
631:   <div
632:     ref={ref}
633:     data-sidebar="menu-badge"
634:     className={cn(
635:       "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
636:       "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
637:       "peer-data-[size=sm]/menu-button:top-1",
638:       "peer-data-[size=default]/menu-button:top-1.5",
639:       "peer-data-[size=lg]/menu-button:top-2.5",
640:       "group-data-[collapsible=icon]:hidden",
641:       className
642:     )}
643:     {...props}
644:   />
645: ))
646: SidebarMenuBadge.displayName = "SidebarMenuBadge"
647: 
648: const SidebarMenuSkeleton = React.forwardRef<
649:   HTMLDivElement,
650:   React.ComponentProps<"div"> & {
651:     showIcon?: boolean
652:   }
653: >(({ className, showIcon = false, ...props }, ref) => {
654:   // Random width between 50 to 90%.
655:   const width = React.useMemo(() => {
656:     return `${Math.floor(Math.random() * 40) + 50}%`
657:   }, [])
658: 
659:   return (
660:     <div
661:       ref={ref}
662:       data-sidebar="menu-skeleton"
663:       className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)}
664:       {...props}
665:     >
666:       {showIcon && (
667:         <Skeleton
668:           className="size-4 rounded-md"
669:           data-sidebar="menu-skeleton-icon"
670:         />
671:       )}
672:       <Skeleton
673:         className="h-4 flex-1 max-w-[--skeleton-width]"
674:         data-sidebar="menu-skeleton-text"
675:         style={
676:           {
677:             "--skeleton-width": width,
678:           } as React.CSSProperties
679:         }
680:       />
681:     </div>
682:   )
683: })
684: SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton"
685: 
686: const SidebarMenuSub = React.forwardRef<
687:   HTMLUListElement,
688:   React.ComponentProps<"ul">
689: >(({ className, ...props }, ref) => (
690:   <ul
691:     ref={ref}
692:     data-sidebar="menu-sub"
693:     className={cn(
694:       "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
695:       "group-data-[collapsible=icon]:hidden",
696:       className
697:     )}
698:     {...props}
699:   />
700: ))
701: SidebarMenuSub.displayName = "SidebarMenuSub"
702: 
703: const SidebarMenuSubItem = React.forwardRef<
704:   HTMLLIElement,
705:   React.ComponentProps<"li">
706: >(({ ...props }, ref) => <li ref={ref} {...props} />)
707: SidebarMenuSubItem.displayName = "SidebarMenuSubItem"
708: 
709: const SidebarMenuSubButton = React.forwardRef<
710:   HTMLAnchorElement,
711:   React.ComponentProps<"a"> & {
712:     asChild?: boolean
713:     size?: "sm" | "md"
714:     isActive?: boolean
715:   }
716: >(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
717:   const Comp = asChild ? Slot : "a"
718: 
719:   return (
720:     <Comp
721:       ref={ref}
722:       data-sidebar="menu-sub-button"
723:       data-size={size}
724:       data-active={isActive}
725:       className={cn(
726:         "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
727:         "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
728:         size === "sm" && "text-xs",
729:         size === "md" && "text-sm",
730:         "group-data-[collapsible=icon]:hidden",
731:         className
732:       )}
733:       {...props}
734:     />
735:   )
736: })
737: SidebarMenuSubButton.displayName = "SidebarMenuSubButton"
738: 
739: export {
740:   Sidebar,
741:   SidebarContent,
742:   SidebarFooter,
743:   SidebarGroup,
744:   SidebarGroupAction,
745:   SidebarGroupContent,
746:   SidebarGroupLabel,
747:   SidebarHeader,
748:   SidebarInput,
749:   SidebarInset,
750:   SidebarMenu,
751:   SidebarMenuAction,
752:   SidebarMenuBadge,
753:   SidebarMenuButton,
754:   SidebarMenuItem,
755:   SidebarMenuSkeleton,
756:   SidebarMenuSub,
757:   SidebarMenuSubButton,
758:   SidebarMenuSubItem,
759:   SidebarProvider,
760:   SidebarRail,
761:   SidebarSeparator,
762:   SidebarTrigger,
763:   useSidebar,
764: }
```

## File: apps/web/src/components/theme/theme-provider.tsx
```typescript
 1: "use client";
 2: 
 3: import { ThemeProvider as NextThemesProvider } from "next-themes";
 4: import { type ThemeProviderProps } from "next-themes/dist/types";
 5: 
 6: export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
 7:   return (
 8:     <NextThemesProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:       {...props}
14:     >
15:       {children}
16:     </NextThemesProvider>
17:   );
18: }
19: 
20: ThemeProvider.displayName = "ThemeProvider";
```

## File: apps/web/src/components/theme/theme-toggle.tsx
```typescript
 1: "use client";
 2: 
 3: import { Moon, Sun } from "lucide-react";
 4: import { useTheme } from "next-themes";
 5: import { Button } from "./button";
 6: 
 7: export function ThemeToggle() {
 8:   const { setTheme, theme } = useTheme();
 9: 
10:   return (
11:     <Button
12:       variant="ghost"
13:       size="icon"
14:       onClick={() => setTheme(theme === "light" ? "dark" : "light")}
15:     >
16:       <div className="relative">
17:         <Sun className="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
18:         <Moon className="absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
19:       </div>
20:       <span className="sr-only">Toggle theme</span>
21:     </Button>
22:   );
23: }
```

## File: apps/web/src/components/ui/loading-spinner.tsx
```typescript
 1: 'use client'
 2: 
 3: export function LoadingSpinner() {
 4:   return (
 5:     <div className="flex items-center justify-center">
 6:       <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-primary">
 7:         <span className="sr-only">Loading...</span>
 8:       </div>
 9:     </div>
10:   )
11: }
```

## File: apps/web/src/components/providers.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ThemeProvider } from "next-themes"
 4: 
 5: export function Providers({ children }: { children: React.ReactNode }) {
 6:   return (
 7:     <ThemeProvider
 8:       attribute="class"
 9:       defaultTheme="system"
10:       enableSystem
11:       disableTransitionOnChange
12:     >
13:       {children}
14:     </ThemeProvider>
15:   )
16: }
```

## File: apps/web/src/hooks/use-mobile.tsx
```typescript
 1: import * as React from "react"
 2: 
 3: const MOBILE_BREAKPOINT = 768
 4: 
 5: export function useIsMobile() {
 6:   const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)
 7: 
 8:   React.useEffect(() => {
 9:     const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
10:     const onChange = () => {
11:       setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
12:     }
13:     mql.addEventListener("change", onChange)
14:     setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
15:     return () => mql.removeEventListener("change", onChange)
16:   }, [])
17: 
18:   return !!isMobile
19: }
```

## File: apps/web/src/hooks/use-toast.ts
```typescript
  1: "use client"
  2: 
  3: // Inspired by react-hot-toast library
  4: import * as React from "react"
  5: 
  6: import type {
  7:   ToastActionElement,
  8:   ToastProps,
  9: } from "@danky/ui"
 10: 
 11: const TOAST_LIMIT = 1
 12: const TOAST_REMOVE_DELAY = 1000000
 13: 
 14: type ToasterToast = ToastProps & {
 15:   id: string
 16:   title?: React.ReactNode
 17:   description?: React.ReactNode
 18:   action?: ToastActionElement
 19: }
 20: 
 21: const actionTypes = {
 22:   ADD_TOAST: "ADD_TOAST",
 23:   UPDATE_TOAST: "UPDATE_TOAST",
 24:   DISMISS_TOAST: "DISMISS_TOAST",
 25:   REMOVE_TOAST: "REMOVE_TOAST",
 26: } as const
 27: 
 28: let count = 0
 29: 
 30: function genId() {
 31:   count = (count + 1) % Number.MAX_SAFE_INTEGER
 32:   return count.toString()
 33: }
 34: 
 35: type ActionType = typeof actionTypes
 36: 
 37: type Action =
 38:   | {
 39:       type: ActionType["ADD_TOAST"]
 40:       toast: ToasterToast
 41:     }
 42:   | {
 43:       type: ActionType["UPDATE_TOAST"]
 44:       toast: Partial<ToasterToast>
 45:     }
 46:   | {
 47:       type: ActionType["DISMISS_TOAST"]
 48:       toastId?: ToasterToast["id"]
 49:     }
 50:   | {
 51:       type: ActionType["REMOVE_TOAST"]
 52:       toastId?: ToasterToast["id"]
 53:     }
 54: 
 55: interface State {
 56:   toasts: ToasterToast[]
 57: }
 58: 
 59: const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()
 60: 
 61: const addToRemoveQueue = (toastId: string) => {
 62:   if (toastTimeouts.has(toastId)) {
 63:     return
 64:   }
 65: 
 66:   const timeout = setTimeout(() => {
 67:     toastTimeouts.delete(toastId)
 68:     dispatch({
 69:       type: "REMOVE_TOAST",
 70:       toastId: toastId,
 71:     })
 72:   }, TOAST_REMOVE_DELAY)
 73: 
 74:   toastTimeouts.set(toastId, timeout)
 75: }
 76: 
 77: export const reducer = (state: State, action: Action): State => {
 78:   switch (action.type) {
 79:     case "ADD_TOAST":
 80:       return {
 81:         ...state,
 82:         toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
 83:       }
 84: 
 85:     case "UPDATE_TOAST":
 86:       return {
 87:         ...state,
 88:         toasts: state.toasts.map((t) =>
 89:           t.id === action.toast.id ? { ...t, ...action.toast } : t
 90:         ),
 91:       }
 92: 
 93:     case "DISMISS_TOAST": {
 94:       const { toastId } = action
 95: 
 96:       // ! Side effects ! - This could be extracted into a dismissToast() action,
 97:       // but I'll keep it here for simplicity
 98:       if (toastId) {
 99:         addToRemoveQueue(toastId)
100:       } else {
101:         state.toasts.forEach((toast) => {
102:           addToRemoveQueue(toast.id)
103:         })
104:       }
105: 
106:       return {
107:         ...state,
108:         toasts: state.toasts.map((t) =>
109:           t.id === toastId || toastId === undefined
110:             ? {
111:                 ...t,
112:                 open: false,
113:               }
114:             : t
115:         ),
116:       }
117:     }
118:     case "REMOVE_TOAST":
119:       if (action.toastId === undefined) {
120:         return {
121:           ...state,
122:           toasts: [],
123:         }
124:       }
125:       return {
126:         ...state,
127:         toasts: state.toasts.filter((t) => t.id !== action.toastId),
128:       }
129:   }
130: }
131: 
132: const listeners: Array<(state: State) => void> = []
133: 
134: let memoryState: State = { toasts: [] }
135: 
136: function dispatch(action: Action) {
137:   memoryState = reducer(memoryState, action)
138:   listeners.forEach((listener) => {
139:     listener(memoryState)
140:   })
141: }
142: 
143: type Toast = Omit<ToasterToast, "id">
144: 
145: function toast({ ...props }: Toast) {
146:   const id = genId()
147: 
148:   const update = (props: ToasterToast) =>
149:     dispatch({
150:       type: "UPDATE_TOAST",
151:       toast: { ...props, id },
152:     })
153:   const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })
154: 
155:   dispatch({
156:     type: "ADD_TOAST",
157:     toast: {
158:       ...props,
159:       id,
160:       open: true,
161:       onOpenChange: (open) => {
162:         if (!open) dismiss()
163:       },
164:     },
165:   })
166: 
167:   return {
168:     id: id,
169:     dismiss,
170:     update,
171:   }
172: }
173: 
174: function useToast() {
175:   const [state, setState] = React.useState<State>(memoryState)
176: 
177:   React.useEffect(() => {
178:     listeners.push(setState)
179:     return () => {
180:       const index = listeners.indexOf(setState)
181:       if (index > -1) {
182:         listeners.splice(index, 1)
183:       }
184:     }
185:   }, [state])
186: 
187:   return {
188:     ...state,
189:     toast,
190:     dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
191:   }
192: }
193: 
194: export { useToast, toast }
```

## File: apps/web/src/lib/actions/mcp-actions.ts
```typescript
 1: 'use server'
 2: 
 3: import { getMCPService, shutdownMCPService } from '../services/mcp-provider'
 4: 
 5: type ServerStatus = 'connected' | 'disconnected' | 'error'
 6: 
 7: interface Tool {
 8:   serverId: string
 9:   toolId: string
10:   name: string
11:   description: string
12: }
13: 
14: interface InitializeResult {
15:   isInitialized: boolean
16:   serverStatus: Record<string, ServerStatus>
17:   availableTools: Tool[]
18:   error: string | null
19: }
20: 
21: export async function initialize(): Promise<InitializeResult> {
22:   try {
23:     const _service = await getMCPService()
24:     return {
25:       isInitialized: true,
26:       serverStatus: {
27:         mcp: 'connected'
28:       },
29:       availableTools: [],
30:       error: null
31:     }
32:   } catch (error) {
33:     console.error('Failed to initialize MCP service:', error)
34:     return {
35:       isInitialized: false,
36:       serverStatus: {},
37:       availableTools: [],
38:       error: error instanceof Error ? error.message : String(error)
39:     }
40:   }
41: }
42: 
43: export async function processMessage(message: string) {
44:   try {
45:     const _service = await getMCPService()
46:     return await _service.processMessage(message)
47:   } catch (error) {
48:     console.error('Failed to process message:', error)
49:     throw error
50:   }
51: }
52: 
53: export async function shutdown() {
54:   try {
55:     await shutdownMCPService()
56:   } catch (error) {
57:     console.error('Failed to shutdown MCP service:', error)
58:     throw error
59:   }
60: }
```

## File: apps/web/src/lib/config/mcp-config.ts
```typescript
 1: import { readFileSync } from 'fs'
 2: import JSON5 from 'json5'
 3: import path from 'path'
 4: import dotenv from 'dotenv'
 5: import { type Config, loadConfig as loadBaseConfig } from '@danky/mcp/load-config'
 6: 
 7: // Load environment variables from root .env file
 8: const rootEnvPath = path.resolve(__dirname, '../../../../.env')
 9: dotenv.config({ path: rootEnvPath })
10: 
11: export function loadMCPConfig(): Config {
12:   console.log('Current working directory:', process.cwd())
13:   console.log('Current environment:', {
14:     NODE_ENV: process.env.NODE_ENV,
15:     ANTHROPIC_API_KEY: process.env.ANTHROPIC_API_KEY ? '(set)' : '(not set)'
16:   })
17: 
18:   // Try different possible locations for the config file
19:   const projectRoot = path.resolve(__dirname, '../../../../')
20:   const possiblePaths = [
21:     // Project root
22:     path.join(projectRoot, 'mcp-config.json5'),
23:     // Current directory
24:     path.join(process.cwd(), 'mcp-config.json5'),
25:     // Up one level (from apps/web)
26:     path.join(process.cwd(), '..', 'mcp-config.json5'),
27:     // Absolute path if we know it
28:     '/home/jmagar/code/danky/mcp-config.json5',
29:   ]
30: 
31:   console.log('Searching for config file in:', possiblePaths)
32: 
33:   let loadedPath: string | null = null
34: 
35:   // Try each path until we find the config
36:   for (const configPath of possiblePaths) {
37:     try {
38:       const config = loadBaseConfig(configPath)
39:       loadedPath = configPath
40:       console.log('Successfully loaded MCP config from:', configPath)
41: 
42:       // Update filesystem server path to be relative to the config location
43:       if (config.mcpServers?.filesystem?.args) {
44:         const args = config.mcpServers.filesystem.args
45:         const dirIndex = args.findIndex((arg: string) => arg === '.')
46:         if (dirIndex !== -1) {
47:           const newPath = path.dirname(loadedPath)
48:           console.log(`Updating filesystem server path from '.' to:`, newPath)
49:           args[dirIndex] = newPath
50:         }
51:       }
52: 
53:       return config
54:     } catch (err: unknown) {
55:       const errorMessage = err instanceof Error ? err.message : String(err)
56:       console.log(`Could not load config from ${configPath}:`, errorMessage)
57:       continue
58:     }
59:   }
60: 
61:   throw new Error(`Could not find mcp-config.json5 in any of these locations: ${possiblePaths.join(', ')}`)
62: }
```

## File: apps/web/src/lib/db/chat/batch-sessions.ts
```typescript
  1: import { z } from 'zod';
  2: import { db } from '@danky/db';
  3: import { conversations } from '@danky/db/schema/chat';
  4: import { and, eq, sql, inArray } from 'drizzle-orm';
  5: import { withBatchTransaction } from '../transaction';
  6: import { handlePartialSuccess } from '../../errors';
  7: import { logger } from '@danky/logger';
  8: import {
  9:   batchDeleteSessionsRequestSchema,
 10:   batchRestoreSessionsRequestSchema,
 11:   batchArchiveSessionsRequestSchema,
 12:   batchUpdateSessionsRequestSchema,
 13: } from '@danky/schema';
 14: 
 15: // Batch delete sessions
 16: export async function batchDeleteSessions(
 17:   input: z.infer<typeof batchDeleteSessionsRequestSchema>,
 18:   userId: string
 19: ) {
 20:   return withBatchTransaction(
 21:     [async (tx) => {
 22:       // Verify user has access to all sessions
 23:       const sessionsToDelete = await tx
 24:         .select()
 25:         .from(conversations)
 26:         .where(and(
 27:           inArray(conversations.id, input.sessionIds),
 28:           eq(conversations.userId, userId),
 29:           sql`${conversations.deletedAt} IS NULL`
 30:         ))
 31:         .execute();
 32: 
 33:       const foundIds = new Set(sessionsToDelete.map(s => s.id));
 34:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
 35: 
 36:       if (notFound.length > 0) {
 37:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
 38:       }
 39: 
 40:       // Delete sessions
 41:       const deleted = await tx
 42:         .update(conversations)
 43:         .set(
 44:           input.permanent
 45:             ? { deletedAt: new Date() }
 46:             : { softDeletedAt: new Date() }
 47:         )
 48:         .where(inArray(conversations.id, input.sessionIds))
 49:         .returning()
 50:         .execute();
 51: 
 52:       return deleted;
 53:     }]
 54:   );
 55: }
 56: 
 57: // Batch restore sessions
 58: export async function batchRestoreSessions(
 59:   input: z.infer<typeof batchRestoreSessionsRequestSchema>,
 60:   userId: string
 61: ) {
 62:   return withBatchTransaction(
 63:     [async (tx) => {
 64:       // Verify user has access to all sessions
 65:       const sessionsToRestore = await tx
 66:         .select()
 67:         .from(conversations)
 68:         .where(and(
 69:           inArray(conversations.id, input.sessionIds),
 70:           eq(conversations.userId, userId),
 71:           sql`${conversations.deletedAt} IS NOT NULL`
 72:         ))
 73:         .execute();
 74: 
 75:       const foundIds = new Set(sessionsToRestore.map(s => s.id));
 76:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
 77: 
 78:       if (notFound.length > 0) {
 79:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
 80:       }
 81: 
 82:       // Restore sessions
 83:       const restored = await tx
 84:         .update(conversations)
 85:         .set({
 86:           deletedAt: null,
 87:           softDeletedAt: null,
 88:         })
 89:         .where(inArray(conversations.id, input.sessionIds))
 90:         .returning()
 91:         .execute();
 92: 
 93:       return restored;
 94:     }]
 95:   );
 96: }
 97: 
 98: // Batch archive sessions
 99: export async function batchArchiveSessions(
100:   input: z.infer<typeof batchArchiveSessionsRequestSchema>,
101:   userId: string
102: ) {
103:   return withBatchTransaction(
104:     [async (tx) => {
105:       // Verify user has access to all sessions
106:       const sessionsToArchive = await tx
107:         .select()
108:         .from(conversations)
109:         .where(and(
110:           inArray(conversations.id, input.sessionIds),
111:           eq(conversations.userId, userId),
112:           sql`${conversations.deletedAt} IS NULL`
113:         ))
114:         .execute();
115: 
116:       const foundIds = new Set(sessionsToArchive.map(s => s.id));
117:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
118: 
119:       if (notFound.length > 0) {
120:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
121:       }
122: 
123:       // Archive/unarchive sessions
124:       const updated = await tx
125:         .update(conversations)
126:         .set({
127:           isArchived: input.archive,
128:           updatedAt: new Date(),
129:         })
130:         .where(inArray(conversations.id, input.sessionIds))
131:         .returning()
132:         .execute();
133: 
134:       return updated;
135:     }]
136:   );
137: }
138: 
139: // Batch update sessions
140: export async function batchUpdateSessions(
141:   input: z.infer<typeof batchUpdateSessionsRequestSchema>,
142:   userId: string
143: ) {
144:   return withBatchTransaction(
145:     input.sessions.map((session) => async (tx) => {
146:       // Verify user has access to the session
147:       const [existing] = await tx
148:         .select()
149:         .from(conversations)
150:         .where(and(
151:           eq(conversations.id, session.id),
152:           eq(conversations.userId, userId),
153:           sql`${conversations.deletedAt} IS NULL`
154:         ))
155:         .execute();
156: 
157:       if (!existing) {
158:         throw new Error(`Session not found or access denied: ${session.id}`);
159:       }
160: 
161:       // Build update object with only provided fields
162:       const updateData: Record<string, unknown> = {
163:         updatedAt: new Date(),
164:       };
165: 
166:       if (session.name) updateData.title = session.name;
167:       if (session.description !== undefined) updateData.description = session.description;
168:       if (session.modelId) updateData.modelId = session.modelId;
169:       if (session.isArchived !== undefined) updateData.isArchived = session.isArchived;
170:       if (session.metadata) updateData.metadata = session.metadata;
171: 
172:       // Update session
173:       const [updated] = await tx
174:         .update(conversations)
175:         .set(updateData)
176:         .where(eq(conversations.id, session.id))
177:         .returning()
178:         .execute();
179: 
180:       return updated;
181:     })
182:   );
183: }
```

## File: apps/web/src/lib/db/chat/batch.ts
```typescript
  1: import { z } from 'zod';
  2: import { db } from '@danky/db';
  3: import { messages, conversations } from '@danky/db/schema/chat';
  4: import { and, eq, sql, inArray } from 'drizzle-orm';
  5: import { withBatchTransaction } from '../transaction';
  6: import { handlePartialSuccess } from '../../errors';
  7: import { logger } from '@danky/logger';
  8: import {
  9:   batchCreateMessagesRequestSchema,
 10:   batchDeleteMessagesRequestSchema,
 11:   batchRestoreMessagesRequestSchema,
 12: } from '@danky/schema';
 13: 
 14: // Batch create messages
 15: export async function batchCreateMessages(
 16:   input: z.infer<typeof batchCreateMessagesRequestSchema>,
 17:   userId: string
 18: ) {
 19:   return withBatchTransaction(
 20:     input.messages.map((message) => async (tx) => {
 21:       // First verify the user has access to the conversation
 22:       const [conversation] = await tx
 23:         .select()
 24:         .from(conversations)
 25:         .where(and(
 26:           eq(conversations.id, input.sessionId),
 27:           eq(conversations.userId, userId),
 28:           sql`${conversations.deletedAt} IS NULL`
 29:         ))
 30:         .execute();
 31: 
 32:       if (!conversation) {
 33:         throw new Error('Conversation not found or access denied');
 34:       }
 35: 
 36:       // Create message with all content blocks
 37:       const results = await Promise.all(
 38:         message.content.map(async (content) => {
 39:           const [result] = await tx
 40:             .insert(messages)
 41:             .values({
 42:               conversationId: input.sessionId,
 43:               role: message.role,
 44:               content: content.content,
 45:               contentType: content.type,
 46:               language: content.language,
 47:               metadata: message.metadata,
 48:             })
 49:             .returning()
 50:             .execute();
 51: 
 52:           return result;
 53:         })
 54:       );
 55: 
 56:       // Update conversation's updatedAt
 57:       await tx
 58:         .update(conversations)
 59:         .set({ updatedAt: new Date() })
 60:         .where(eq(conversations.id, input.sessionId))
 61:         .execute();
 62: 
 63:       return results[0]; // Return first message for consistency
 64:     })
 65:   );
 66: }
 67: 
 68: // Batch delete messages
 69: export async function batchDeleteMessages(
 70:   input: z.infer<typeof batchDeleteMessagesRequestSchema>,
 71:   userId: string
 72: ) {
 73:   return withBatchTransaction(
 74:     [async (tx) => {
 75:       // Verify user has access to all messages
 76:       const messagesToDelete = await tx
 77:         .select({
 78:           id: messages.id,
 79:           conversationId: messages.conversationId,
 80:         })
 81:         .from(messages)
 82:         .innerJoin(
 83:           conversations,
 84:           eq(messages.conversationId, conversations.id)
 85:         )
 86:         .where(and(
 87:           inArray(messages.id, input.messageIds),
 88:           eq(conversations.userId, userId),
 89:           sql`${messages.deletedAt} IS NULL`
 90:         ))
 91:         .execute();
 92: 
 93:       const foundIds = new Set(messagesToDelete.map(m => m.id));
 94:       const notFound = input.messageIds.filter(id => !foundIds.has(id));
 95: 
 96:       if (notFound.length > 0) {
 97:         throw new Error(`Messages not found or access denied: ${notFound.join(', ')}`);
 98:       }
 99: 
100:       // Delete messages
101:       const deleted = await tx
102:         .update(messages)
103:         .set(
104:           input.permanent
105:             ? { deletedAt: new Date() }
106:             : { softDeletedAt: new Date() }
107:         )
108:         .where(inArray(messages.id, input.messageIds))
109:         .returning()
110:         .execute();
111: 
112:       // Update conversations' updatedAt
113:       const conversationIds = [...new Set(messagesToDelete.map(m => m.conversationId))];
114:       await Promise.all(
115:         conversationIds.map(conversationId =>
116:           tx
117:             .update(conversations)
118:             .set({ updatedAt: new Date() })
119:             .where(eq(conversations.id, conversationId))
120:             .execute()
121:         )
122:       );
123: 
124:       return deleted;
125:     }]
126:   );
127: }
128: 
129: // Batch restore messages
130: export async function batchRestoreMessages(
131:   input: z.infer<typeof batchRestoreMessagesRequestSchema>,
132:   userId: string
133: ) {
134:   return withBatchTransaction(
135:     [async (tx) => {
136:       // Verify user has access to all messages
137:       const messagesToRestore = await tx
138:         .select({
139:           id: messages.id,
140:           conversationId: messages.conversationId,
141:         })
142:         .from(messages)
143:         .innerJoin(
144:           conversations,
145:           eq(messages.conversationId, conversations.id)
146:         )
147:         .where(and(
148:           inArray(messages.id, input.messageIds),
149:           eq(conversations.userId, userId),
150:           sql`${messages.deletedAt} IS NOT NULL`
151:         ))
152:         .execute();
153: 
154:       const foundIds = new Set(messagesToRestore.map(m => m.id));
155:       const notFound = input.messageIds.filter(id => !foundIds.has(id));
156: 
157:       if (notFound.length > 0) {
158:         throw new Error(`Messages not found or access denied: ${notFound.join(', ')}`);
159:       }
160: 
161:       // Restore messages
162:       const restored = await tx
163:         .update(messages)
164:         .set({
165:           deletedAt: null,
166:           softDeletedAt: null,
167:         })
168:         .where(inArray(messages.id, input.messageIds))
169:         .returning()
170:         .execute();
171: 
172:       // Update conversations' updatedAt
173:       const conversationIds = [...new Set(messagesToRestore.map(m => m.conversationId))];
174:       await Promise.all(
175:         conversationIds.map(conversationId =>
176:           tx
177:             .update(conversations)
178:             .set({ updatedAt: new Date() })
179:             .where(eq(conversations.id, conversationId))
180:             .execute()
181:         )
182:       );
183: 
184:       return restored;
185:     }]
186:   );
187: }
```

## File: apps/web/src/lib/db/chat.ts
```typescript
  1: import { db } from '@danky/db';
  2: import { messages, conversations } from '@danky/db/schema/chat';
  3: import { and, desc, eq, sql, ilike, or, isNull } from 'drizzle-orm';
  4: import { z } from 'zod';
  5: import { webListMessagesSchema } from '../validations/chat';
  6: import { 
  7:   createSessionRequestSchema, 
  8:   listSessionsRequestSchema, 
  9:   updateSessionRequestSchema,
 10:   deleteSessionRequestSchema,
 11:   createMessageRequestSchema 
 12: } from '@danky/schema';
 13: import { withWriteTransaction, withReadOnlyTransaction } from './transaction';
 14: import { ForbiddenError, NotFoundError } from '../errors';
 15: 
 16: export async function getMessages(input: z.infer<typeof webListMessagesSchema>) {
 17:   return withReadOnlyTransaction(async (tx) => {
 18:     const { sessionId, page, limit, includeDeleted, sortOrder } = input;
 19:     const offset = (page - 1) * limit;
 20: 
 21:     // Build where clause
 22:     const whereClause = and(
 23:       eq(messages.conversationId, sessionId),
 24:       includeDeleted ? undefined : isNull(messages.deletedAt)
 25:     );
 26:     
 27:     // Get total count first
 28:     const [countResult] = await tx
 29:       .select({ count: sql<number>`count(*)` })
 30:       .from(messages)
 31:       .where(whereClause)
 32:       .execute();
 33:       
 34:     const totalItems = Number(countResult?.count ?? 0);
 35:     const totalPages = Math.ceil(totalItems / limit);
 36:     
 37:     // Get paginated messages
 38:     const results = await tx
 39:       .select()
 40:       .from(messages)
 41:       .where(whereClause)
 42:       .orderBy(sortOrder === 'desc' ? desc(messages.createdAt) : messages.createdAt)
 43:       .limit(limit)
 44:       .offset(offset)
 45:       .execute();
 46:       
 47:     return {
 48:       messages: results,
 49:       pagination: {
 50:         page,
 51:         limit,
 52:         totalPages,
 53:         totalItems,
 54:       }
 55:     };
 56:   });
 57: }
 58: 
 59: export async function createSession(input: z.infer<typeof createSessionRequestSchema>, userId: string) {
 60:   return withWriteTransaction(async (tx) => {
 61:     const result = await tx
 62:       .insert(conversations)
 63:       .values({
 64:         title: input.name,
 65:         userId,
 66:         modelId: input.modelId,
 67:         description: input.description,
 68:         isArchived: false,
 69:         metadata: input.metadata,
 70:       })
 71:       .returning()
 72:       .execute();
 73: 
 74:     return result[0];
 75:   });
 76: }
 77: 
 78: export async function getSessions(input: z.infer<typeof listSessionsRequestSchema>, userId: string) {
 79:   return withReadOnlyTransaction(async (tx) => {
 80:     const { page, limit, search } = input;
 81:     const offset = (page - 1) * limit;
 82: 
 83:     // Build where clause
 84:     const whereClause = and(
 85:       eq(conversations.userId, userId),
 86:       isNull(conversations.deletedAt),
 87:       search ? ilike(conversations.title, `%${search}%`) : undefined
 88:     );
 89: 
 90:     // Get total count first
 91:     const [countResult] = await tx
 92:       .select({ count: sql<number>`count(*)` })
 93:       .from(conversations)
 94:       .where(whereClause)
 95:       .execute();
 96: 
 97:     const totalItems = Number(countResult?.count ?? 0);
 98:     const totalPages = Math.ceil(totalItems / limit);
 99: 
100:     // Get paginated sessions
101:     const results = await tx
102:       .select()
103:       .from(conversations)
104:       .where(whereClause)
105:       .orderBy(desc(conversations.updatedAt))
106:       .limit(limit)
107:       .offset(offset)
108:       .execute();
109: 
110:     return {
111:       sessions: results,
112:       pagination: {
113:         page,
114:         limit,
115:         totalPages,
116:         totalItems,
117:       }
118:     };
119:   });
120: }
121: 
122: export async function updateSession(input: z.infer<typeof updateSessionRequestSchema>, userId: string) {
123:   return withWriteTransaction(async (tx) => {
124:     // Verify session exists and user has access
125:     const [session] = await tx
126:       .select()
127:       .from(conversations)
128:       .where(and(
129:         eq(conversations.id, input.id),
130:         eq(conversations.userId, userId),
131:         isNull(conversations.deletedAt)
132:       ))
133:       .execute();
134: 
135:     if (!session) {
136:       throw new NotFoundError('Session not found or access denied');
137:     }
138: 
139:     // Build update object with only provided fields
140:     const updateData: Record<string, unknown> = {};
141:     if (input.name) updateData.title = input.name;
142:     if (input.description !== undefined) updateData.description = input.description;
143:     if (input.modelId) updateData.modelId = input.modelId;
144:     if (input.metadata) updateData.metadata = input.metadata;
145: 
146:     // Update session
147:     const [updated] = await tx
148:       .update(conversations)
149:       .set(updateData)
150:       .where(eq(conversations.id, input.id))
151:       .returning()
152:       .execute();
153: 
154:     return updated;
155:   });
156: }
157: 
158: export async function deleteSession(input: z.infer<typeof deleteSessionRequestSchema>, userId: string) {
159:   return withWriteTransaction(async (tx) => {
160:     // Verify session exists and user has access
161:     const [session] = await tx
162:       .select()
163:       .from(conversations)
164:       .where(and(
165:         eq(conversations.id, input.id),
166:         eq(conversations.userId, userId),
167:         isNull(conversations.deletedAt)
168:       ))
169:       .execute();
170: 
171:     if (!session) {
172:       throw new NotFoundError('Session not found or access denied');
173:     }
174: 
175:     // Soft delete the session
176:     const [deleted] = await tx
177:       .update(conversations)
178:       .set({ 
179:         deletedAt: new Date(),
180:         isArchived: true 
181:       })
182:       .where(eq(conversations.id, input.id))
183:       .returning()
184:       .execute();
185: 
186:     return deleted;
187:   });
188: }
189: 
190: // Batch operations
191: export async function batchDeleteSessions(sessionIds: string[], userId: string) {
192:   return withWriteTransaction(async (tx) => {
193:     // Verify all sessions exist and user has access
194:     const sessions = await tx
195:       .select()
196:       .from(conversations)
197:       .where(and(
198:         eq(conversations.userId, userId),
199:         isNull(conversations.deletedAt)
200:       ))
201:       .execute();
202: 
203:     const sessionSet = new Set(sessions.map(s => s.id));
204:     const invalidSessions = sessionIds.filter(id => !sessionSet.has(id));
205: 
206:     if (invalidSessions.length > 0) {
207:       throw new NotFoundError(`Some sessions not found or access denied: ${invalidSessions.join(', ')}`);
208:     }
209: 
210:     // Soft delete all sessions
211:     const deleted = await tx
212:       .update(conversations)
213:       .set({ 
214:         deletedAt: new Date(),
215:         isArchived: true 
216:       })
217:       .where(and(
218:         sql`${conversations.id} = ANY(${sessionIds})`,
219:         eq(conversations.userId, userId)
220:       ))
221:       .returning()
222:       .execute();
223: 
224:     return deleted;
225:   });
226: }
227: 
228: export async function batchArchiveSessions(sessionIds: string[], userId: string, archive: boolean = true) {
229:   return withWriteTransaction(async (tx) => {
230:     // Verify all sessions exist and user has access
231:     const sessions = await tx
232:       .select()
233:       .from(conversations)
234:       .where(and(
235:         eq(conversations.userId, userId),
236:         isNull(conversations.deletedAt)
237:       ))
238:       .execute();
239: 
240:     const sessionSet = new Set(sessions.map(s => s.id));
241:     const invalidSessions = sessionIds.filter(id => !sessionSet.has(id));
242: 
243:     if (invalidSessions.length > 0) {
244:       throw new NotFoundError(`Some sessions not found or access denied: ${invalidSessions.join(', ')}`);
245:     }
246: 
247:     // Update archive status
248:     const updated = await tx
249:       .update(conversations)
250:       .set({ isArchived: archive })
251:       .where(and(
252:         sql`${conversations.id} = ANY(${sessionIds})`,
253:         eq(conversations.userId, userId)
254:       ))
255:       .returning()
256:       .execute();
257: 
258:     return updated;
259:   });
260: }
261: 
262: export async function createMessage(
263:   input: z.infer<typeof createMessageRequestSchema>,
264:   userId: string
265: ) {
266:   return withWriteTransaction(async (tx) => {
267:     // First verify the user has access to the conversation
268:     const [conversation] = await tx
269:       .select()
270:       .from(conversations)
271:       .where(and(
272:         eq(conversations.id, input.sessionId),
273:         eq(conversations.userId, userId),
274:         isNull(conversations.deletedAt)
275:       ))
276:       .execute();
277: 
278:     if (!conversation) {
279:       throw new NotFoundError('Conversation not found');
280:     }
281: 
282:     if (conversation.deletedAt) {
283:       throw new ForbiddenError('Cannot add messages to a deleted conversation');
284:     }
285: 
286:     // Create all message content blocks
287:     const messages = await Promise.all(
288:       input.content.map(async (content) => {
289:         const [message] = await tx
290:           .insert(messages)
291:           .values({
292:             conversationId: input.sessionId,
293:             role: input.role,
294:             content: content.content,
295:             contentType: content.type,
296:             language: content.language,
297:             metadata: input.metadata,
298:           })
299:           .returning()
300:           .execute();
301: 
302:         return message;
303:       })
304:     );
305: 
306:     // Update conversation's updatedAt
307:     await tx
308:       .update(conversations)
309:       .set({ updatedAt: new Date() })
310:       .where(eq(conversations.id, input.sessionId))
311:       .execute();
312: 
313:     return messages[0]; // Return first message for backward compatibility
314:   });
315: }
```

## File: apps/web/src/lib/db/transaction.ts
```typescript
  1: import { db } from '@danky/db';
  2: import { handleDatabaseError } from '../errors';
  3: import { logger } from '@danky/logger';
  4: 
  5: // Transaction options type
  6: interface TransactionOptions {
  7:   maxRetries?: number;
  8:   retryDelay?: number;
  9:   timeout?: number;
 10: }
 11: 
 12: // Default options
 13: const DEFAULT_OPTIONS: Required<TransactionOptions> = {
 14:   maxRetries: 3,
 15:   retryDelay: 100,
 16:   timeout: 30000,
 17: };
 18: 
 19: // Helper to wait between retries
 20: const wait = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));
 21: 
 22: // Helper to check if error is retryable
 23: function isRetryableError(error: unknown): boolean {
 24:   if (!(error instanceof Error)) return false;
 25:   
 26:   const message = error.message.toLowerCase();
 27:   return (
 28:     message.includes('deadlock') ||
 29:     message.includes('lock timeout') ||
 30:     message.includes('serialization') ||
 31:     message.includes('too many connections') ||
 32:     message.includes('connection terminated')
 33:   );
 34: }
 35: 
 36: // Generic transaction executor with retries
 37: async function executeTransaction<T>(
 38:   operation: (tx: typeof db) => Promise<T>,
 39:   options: TransactionOptions = {}
 40: ): Promise<T> {
 41:   const { maxRetries, retryDelay, timeout } = { ...DEFAULT_OPTIONS, ...options };
 42:   let attempt = 0;
 43:   
 44:   while (true) {
 45:     attempt++;
 46:     
 47:     try {
 48:       // Start transaction with timeout
 49:       const result = await Promise.race([
 50:         db.transaction(async (tx) => {
 51:           return operation(tx);
 52:         }),
 53:         new Promise((_, reject) => 
 54:           setTimeout(() => reject(new Error('Transaction timeout')), timeout)
 55:         ),
 56:       ]);
 57:       
 58:       return result as T;
 59:     } catch (error) {
 60:       logger.error({
 61:         operation: 'transaction',
 62:         attempt,
 63:         error: error instanceof Error ? error.message : 'Unknown error',
 64:       });
 65:       
 66:       if (attempt >= maxRetries || !isRetryableError(error)) {
 67:         return handleDatabaseError(error);
 68:       }
 69:       
 70:       // Wait before retrying
 71:       await wait(retryDelay * attempt);
 72:     }
 73:   }
 74: }
 75: 
 76: // Read-only transaction wrapper
 77: export async function withReadOnlyTransaction<T>(
 78:   operation: (tx: typeof db) => Promise<T>,
 79:   options?: TransactionOptions
 80: ): Promise<T> {
 81:   return executeTransaction(async (tx) => {
 82:     // Set transaction to read only
 83:     await tx.execute({ sql: 'SET TRANSACTION READ ONLY' });
 84:     return operation(tx);
 85:   }, options);
 86: }
 87: 
 88: // Write transaction wrapper
 89: export async function withWriteTransaction<T>(
 90:   operation: (tx: typeof db) => Promise<T>,
 91:   options?: TransactionOptions
 92: ): Promise<T> {
 93:   return executeTransaction(async (tx) => {
 94:     // Set transaction isolation level
 95:     await tx.execute({ sql: 'SET TRANSACTION ISOLATION LEVEL SERIALIZABLE' });
 96:     return operation(tx);
 97:   }, options);
 98: }
 99: 
100: // Batch operation wrapper
101: export async function withBatchTransaction<T>(
102:   operations: Array<(tx: typeof db) => Promise<T>>,
103:   options?: TransactionOptions
104: ): Promise<T[]> {
105:   return executeTransaction(async (tx) => {
106:     const results: T[] = [];
107:     const errors: Error[] = [];
108:     
109:     for (const operation of operations) {
110:       try {
111:         const result = await operation(tx);
112:         results.push(result);
113:       } catch (error) {
114:         errors.push(error as Error);
115:         // Don't break the transaction for partial failures
116:         logger.error({
117:           operation: 'batchOperation',
118:           error: error instanceof Error ? error.message : 'Unknown error',
119:         });
120:       }
121:     }
122:     
123:     // If all operations failed, throw error
124:     if (errors.length === operations.length) {
125:       throw new Error('All batch operations failed');
126:     }
127:     
128:     return results;
129:   }, options);
130: }
131: 
132: // Connection pool management
133: let poolSize = 10;
134: 
135: export function setPoolSize(size: number): void {
136:   poolSize = size;
137:   // Update pool size in database configuration
138:   db.execute({ sql: `SET max_connections = ${size}` });
139: }
140: 
141: export function getPoolSize(): number {
142:   return poolSize;
143: }
144: 
145: // Export transaction types
146: export type Transaction = typeof db;
147: export type TransactionClient = Awaited<ReturnType<typeof db.transaction>>;
```

## File: apps/web/src/lib/services/init-chat-model.ts
```typescript
 1: import { ChatOpenAI } from '@langchain/openai'
 2: import { ChatAnthropic } from '@langchain/anthropic'
 3: import { ChatGroq } from '@langchain/groq'
 4: import { type BaseChatModel } from '@langchain/core/language_models/chat_models'
 5: 
 6: type LLMConfig = {
 7:   provider: 'openai' | 'anthropic' | 'groq'
 8:   model: string
 9:   apiKey?: string
10:   temperature?: number
11:   maxTokens?: number
12: }
13: 
14: export function initChatModel(config: LLMConfig): BaseChatModel {
15:   const { provider, model, apiKey, temperature = 0.7, maxTokens = 1000 } = config
16: 
17:   switch (provider) {
18:     case 'openai':
19:       return new ChatOpenAI({
20:         modelName: model,
21:         openAIApiKey: apiKey,
22:         temperature,
23:         maxTokens,
24:       })
25:     case 'anthropic':
26:       // Use provided API key or fall back to environment variable
27:       const anthropicApiKey = apiKey || process.env.ANTHROPIC_API_KEY
28:       if (!anthropicApiKey) {
29:         throw new Error('Anthropic API key not found in config or environment')
30:       }
31:       return new ChatAnthropic({
32:         modelName: model,
33:         anthropicApiKey,
34:         temperature,
35:         maxTokens,
36:       })
37:     case 'groq':
38:       return new ChatGroq({
39:         modelName: model,
40:         apiKey: apiKey,
41:         temperature,
42:         maxTokens,
43:       })
44:     default:
45:       throw new Error(`Unsupported LLM provider: ${provider}`)
46:   }
47: }
```

## File: apps/web/src/lib/services/load-config.ts
```typescript
 1: import { z } from 'zod'
 2: import JSON5 from 'json5'
 3: import { readFileSync } from 'fs'
 4: import path from 'path'
 5: 
 6: const LLMConfigSchema = z.object({
 7:   provider: z.enum(['openai', 'anthropic', 'groq']),
 8:   model: z.string(),
 9:   apiKey: z.string().optional(),
10:   temperature: z.number().optional(),
11:   maxTokens: z.number().optional(),
12: })
13: 
14: const MCPServerConfigSchema = z.object({
15:   command: z.string(),
16:   args: z.array(z.string()),
17:   env: z.record(z.string()).optional(),
18: })
19: 
20: const MCPConfigSchema = z.object({
21:   llm: LLMConfigSchema,
22:   mcpServers: z.record(MCPServerConfigSchema),
23: })
24: 
25: export type MCPConfig = z.infer<typeof MCPConfigSchema>
26: 
27: export function loadMCPConfig(): MCPConfig {
28:   try {
29:     // Load the config file
30:     const configPath = path.resolve(process.cwd(), 'mcp-config.json5')
31:     let configStr = readFileSync(configPath, 'utf-8')
32: 
33:     // Replace environment variables in the format ${VAR_NAME} with their values
34:     Object.entries(process.env).forEach(([key, value]) => {
35:       const regex = new RegExp(`\\$\{${key}\}`, 'g')
36:       if (value) {
37:         configStr = configStr.replace(regex, value)
38:       }
39:     })
40: 
41:     // Parse the config
42:     const config = JSON5.parse(configStr)
43: 
44:     // Validate required environment variables are set
45:     if (config.llm?.apiKey?.includes('${')) {
46:       const missing = config.llm.apiKey.match(/\$\{([^}]+)\}/g)?.map((match: string) => match.slice(2, -1))
47:       throw new Error(`Environment variables not found: ${missing?.join(', ')}. Make sure these are set in the root .env file, not .env.local`)
48:     }
49: 
50:     // Update filesystem server path to be relative to the config location
51:     if (config.mcpServers?.filesystem?.args) {
52:       const args = config.mcpServers.filesystem.args
53:       const dirIndex = args.findIndex((arg: string) => arg === '.')
54:       if (dirIndex !== -1) {
55:         const newPath = path.dirname(configPath)
56:         console.log(`Updating filesystem server path from '.' to:`, newPath)
57:         args[dirIndex] = newPath
58:       }
59:     }
60: 
61:     return MCPConfigSchema.parse(config)
62:   } catch (error) {
63:     console.error('Failed to load MCP configuration:', error)
64:     throw error
65:   }
66: }
```

## File: apps/web/src/lib/services/mcp-provider.ts
```typescript
 1: import { createLogger } from '@danky/mcp'
 2: import { MCPService } from './mcp-service'
 3: 
 4: const logger = createLogger({ level: 'info' })
 5: let mcpService: MCPService | null = null
 6: 
 7: export async function getMCPService(): Promise<MCPService> {
 8:   if (!mcpService) {
 9:     logger.info('Creating new MCP service instance')
10:     mcpService = new MCPService()
11:     await mcpService.initialize()
12:   }
13:   return mcpService
14: }
15: 
16: export async function shutdownMCPService(): Promise<void> {
17:   if (mcpService) {
18:     logger.info('Shutting down MCP service')
19:     await mcpService.shutdown()
20:     mcpService = null
21:   }
22: }
```

## File: apps/web/src/lib/services/mcp-service.ts
```typescript
 1: import { MCPService as BaseMCPService, createLogger } from '@danky/mcp'
 2: import path from 'path'
 3: import { fileURLToPath } from 'url'
 4: import dotenv from 'dotenv'
 5: 
 6: const logger = createLogger({ level: 'debug' })
 7: 
 8: // Get the directory name in ESM
 9: const __filename = fileURLToPath(import.meta.url)
10: const __dirname = path.dirname(__filename)
11: 
12: // Go up to the project root (from apps/web/lib/services to root)
13: const PROJECT_ROOT = path.resolve(__dirname, '../../../..')
14: logger.debug('Project root:', PROJECT_ROOT)
15: 
16: // Load environment variables from root .env file
17: const envPath = path.join(PROJECT_ROOT, '.env')
18: logger.debug('Loading environment variables from:', envPath)
19: dotenv.config({ path: envPath })
20: 
21: export class MCPService extends BaseMCPService {
22:   constructor() {
23:     const configPath = path.join(PROJECT_ROOT, 'mcp-config.json5')
24:     logger.debug('Config path:', configPath)
25:     super({
26:       logger,
27:       configPath
28:     })
29:   }
30: 
31:   async initialize(): Promise<void> {
32:     try {
33:       await super.initialize()
34:     } catch (error) {
35:       logger.error('Failed to initialize MCP Service:', { error })
36:       throw error
37:     }
38:   }
39: }
```

## File: apps/web/src/lib/stores/chat-store.ts
```typescript
  1: 'use client'
  2: 
  3: import { create } from 'zustand'
  4: import { type Message, type ChatSession, type ChatStatus } from '@/components/chat/types'
  5: 
  6: interface ChatStore {
  7:   messages: Message[]
  8:   sessions: ChatSession[]
  9:   currentSession: string | null
 10:   status: ChatStatus
 11:   isInitializing: boolean
 12:   isProcessing: boolean
 13:   error: string | null
 14:   addMessage: (message: Omit<Message, 'timestamp'>) => void
 15:   sendMessage: (content: string) => Promise<void>
 16:   initialize: () => Promise<void>
 17:   createSession: () => void
 18:   setCurrentSession: (sessionId: string) => void
 19:   clearError: () => void
 20: }
 21: 
 22: export const useChatStore = create<ChatStore>((set, get) => ({
 23:   messages: [],
 24:   sessions: [],
 25:   currentSession: null,
 26:   status: 'idle',
 27:   isInitializing: true,
 28:   isProcessing: false,
 29:   error: null,
 30: 
 31:   addMessage: (message) => {
 32:     const timestamp = new Date()
 33:     const newMessage = { ...message, timestamp }
 34:     
 35:     set((state) => ({
 36:       messages: [...state.messages, newMessage],
 37:       sessions: state.currentSession 
 38:         ? state.sessions.map(session => 
 39:             session.id === state.currentSession 
 40:               ? { 
 41:                   ...session, 
 42:                   lastMessage: message.content,
 43:                   timestamp 
 44:                 }
 45:               : session
 46:           )
 47:         : state.sessions
 48:     }))
 49:   },
 50: 
 51:   sendMessage: async (content) => {
 52:     set({ isProcessing: true, error: null, status: 'loading' })
 53:     
 54:     try {
 55:       // Add user message
 56:       get().addMessage({ role: 'user', content })
 57:       
 58:       // Send message to API
 59:       const response = await fetch('/api/chat', {
 60:         method: 'POST',
 61:         headers: {
 62:           'Content-Type': 'application/json',
 63:         },
 64:         body: JSON.stringify({ 
 65:           message: content,
 66:           sessionId: get().currentSession 
 67:         }),
 68:       })
 69: 
 70:       if (!response.ok) {
 71:         const data = await response.json()
 72:         throw new Error(data.error || 'Failed to send message')
 73:       }
 74: 
 75:       const data = await response.json()
 76:       
 77:       if (data.error) {
 78:         throw new Error(data.error)
 79:       }
 80:       
 81:       // Add assistant message
 82:       get().addMessage({ role: 'assistant', content: data.response })
 83:       set({ status: 'idle' })
 84:     } catch (error) {
 85:       console.error('Error processing message:', error)
 86:       set({ 
 87:         error: error instanceof Error ? error.message : String(error),
 88:         status: 'error'
 89:       })
 90:       // Add error message to chat
 91:       get().addMessage({ 
 92:         role: 'assistant', 
 93:         content: `Error: ${error instanceof Error ? error.message : String(error)}`
 94:       })
 95:     } finally {
 96:       set({ isProcessing: false })
 97:     }
 98:   },
 99: 
100:   initialize: async () => {
101:     set({ isInitializing: true, error: null, status: 'loading' })
102:     
103:     try {
104:       const response = await fetch('/api/chat')
105:       
106:       if (!response.ok) {
107:         const data = await response.json()
108:         throw new Error(data.error || 'Failed to initialize chat')
109:       }
110: 
111:       const data = await response.json()
112:       
113:       if (data.error) {
114:         throw new Error(data.error)
115:       }
116: 
117:       // Initialize with any existing sessions
118:       if (data.sessions) {
119:         set({ 
120:           sessions: data.sessions,
121:           currentSession: data.sessions[0]?.id || null
122:         })
123:       }
124: 
125:       set({ isInitializing: false, status: 'idle' })
126:     } catch (error) {
127:       console.error('Error initializing chat:', error)
128:       set({ 
129:         isInitializing: false,
130:         error: error instanceof Error ? error.message : String(error),
131:         status: 'error'
132:       })
133:     }
134:   },
135: 
136:   createSession: () => {
137:     const newSession: ChatSession = {
138:       id: crypto.randomUUID(),
139:       title: 'New Chat',
140:       lastMessage: '',
141:       timestamp: new Date()
142:     }
143: 
144:     set((state) => ({
145:       sessions: [newSession, ...state.sessions],
146:       currentSession: newSession.id,
147:       messages: [] // Clear messages for new session
148:     }))
149:   },
150: 
151:   setCurrentSession: (sessionId) => {
152:     set({ currentSession: sessionId, messages: [] }) // Clear messages when switching sessions
153:     // TODO: Load messages for this session from the backend
154:   },
155: 
156:   clearError: () => {
157:     set({ error: null })
158:   }
159: }))
```

## File: apps/web/src/lib/stores/mcp-store.ts
```typescript
 1: 'use client'
 2: 
 3: import { create } from 'zustand'
 4: import * as mcpActions from '../actions/mcp-actions'
 5: 
 6: type ServerStatus = 'connected' | 'disconnected' | 'error'
 7: 
 8: interface Tool {
 9:   serverId: string
10:   toolId: string
11:   name: string
12:   description: string
13: }
14: 
15: interface MCPState {
16:   isInitialized: boolean
17:   isInitializing: boolean
18:   serverStatus: Record<string, ServerStatus>
19:   availableTools: Tool[]
20:   error: string | null
21: }
22: 
23: interface MCPActions {
24:   initialize: () => Promise<void>
25:   processMessage: (message: string) => Promise<string>
26:   reset: () => void
27: }
28: 
29: const initialState: MCPState = {
30:   isInitialized: false,
31:   isInitializing: false,
32:   serverStatus: {},
33:   availableTools: [],
34:   error: null,
35: }
36: 
37: export const useMCPStore = create<MCPState & MCPActions>((set, get) => ({
38:   ...initialState,
39: 
40:   initialize: async () => {
41:     if (get().isInitialized || get().isInitializing) return
42: 
43:     set({ isInitializing: true })
44: 
45:     try {
46:       const result = await mcpActions.initialize()
47:       
48:       set({
49:         isInitialized: result.isInitialized,
50:         serverStatus: result.serverStatus,
51:         availableTools: result.availableTools,
52:         error: result.error
53:       })
54:     } catch (error) {
55:       set({ 
56:         isInitialized: false,
57:         error: error instanceof Error ? error.message : 'Failed to initialize MCP service',
58:         serverStatus: {},
59:         availableTools: []
60:       })
61:     } finally {
62:       set({ isInitializing: false })
63:     }
64:   },
65: 
66:   processMessage: async (message: string) => {
67:     if (!get().isInitialized) {
68:       throw new Error('MCP service not initialized')
69:     }
70: 
71:     try {
72:       return await mcpActions.processMessage(message)
73:     } catch (error) {
74:       const errorMessage = error instanceof Error ? error.message : 'Failed to process message'
75:       set({ error: errorMessage })
76:       throw new Error(errorMessage)
77:     }
78:   },
79: 
80:   reset: () => {
81:     mcpActions.shutdown().catch(console.error)
82:     set(initialState)
83:   }
84: }))
```

## File: apps/web/src/lib/validations/chat.ts
```typescript
 1: import { z } from 'zod';
 2: import { createMessageRequestSchema, listMessagesRequestSchema } from '@danky/schema';
 3: 
 4: // Extend the base create message schema with app-specific fields
 5: export const webCreateMessageSchema = createMessageRequestSchema.extend({
 6:   attachments: z.array(z.object({
 7:     name: z.string(),
 8:     url: z.string().url(),
 9:     type: z.string(),
10:     size: z.number(),
11:   })).optional(),
12: });
13: 
14: // Extend the base list messages schema with app-specific fields
15: export const webListMessagesSchema = listMessagesRequestSchema.extend({
16:   includeDeleted: z.boolean().default(false),
17:   sortOrder: z.enum(['asc', 'desc']).default('desc'),
18: });
19: 
20: // Chat settings schema
21: export const chatSettingsSchema = z.object({
22:   model: z.string(),
23:   temperature: z.number().min(0).max(2).default(0.7),
24:   maxTokens: z.number().positive().max(4096).default(1024),
25:   topP: z.number().min(0).max(1).default(1),
26:   frequencyPenalty: z.number().min(-2).max(2).default(0),
27:   presencePenalty: z.number().min(-2).max(2).default(0),
28: });
```

## File: apps/web/src/lib/errors.ts
```typescript
  1: import { z } from 'zod';
  2: import { logger } from '@danky/logger';
  3: 
  4: // Error types
  5: export class BaseError extends Error {
  6:   constructor(
  7:     message: string,
  8:     public code: string,
  9:     public statusCode: number = 500,
 10:     public details?: unknown
 11:   ) {
 12:     super(message);
 13:     this.name = this.constructor.name;
 14:   }
 15: }
 16: 
 17: export class ValidationError extends BaseError {
 18:   constructor(message: string, details?: z.ZodError) {
 19:     super(message, 'VALIDATION_ERROR', 400, details);
 20:   }
 21: }
 22: 
 23: export class NotFoundError extends BaseError {
 24:   constructor(message: string) {
 25:     super(message, 'NOT_FOUND', 404);
 26:   }
 27: }
 28: 
 29: export class ForbiddenError extends BaseError {
 30:   constructor(message: string) {
 31:     super(message, 'FORBIDDEN', 403);
 32:   }
 33: }
 34: 
 35: export class UnauthorizedError extends BaseError {
 36:   constructor(message: string) {
 37:     super(message, 'UNAUTHORIZED', 401);
 38:   }
 39: }
 40: 
 41: export class RateLimitError extends BaseError {
 42:   constructor(message: string, details?: { retryAfter?: number }) {
 43:     super(message, 'RATE_LIMIT', 429, details);
 44:   }
 45: }
 46: 
 47: export class DatabaseError extends BaseError {
 48:   constructor(message: string, details?: unknown) {
 49:     super(message, 'DATABASE_ERROR', 500, details);
 50:   }
 51: }
 52: 
 53: export class TokenLimitError extends BaseError {
 54:   constructor(message: string, details?: { limit: number; current: number }) {
 55:     super(message, 'TOKEN_LIMIT', 400, details);
 56:   }
 57: }
 58: 
 59: export class BatchOperationError extends BaseError {
 60:   constructor(message: string, details?: { errors: Array<{ id: string; error: string }> }) {
 61:     super(message, 'BATCH_OPERATION_ERROR', 400, details);
 62:   }
 63: }
 64: 
 65: // Error handler wrapper
 66: export function withErrorHandling<T extends z.ZodType>(
 67:   handler: (...args: any[]) => Promise<z.infer<T>>,
 68:   responseSchema: T,
 69:   operationName: string
 70: ) {
 71:   return async (...args: Parameters<typeof handler>): Promise<z.infer<T>> => {
 72:     try {
 73:       const result = await handler(...args);
 74:       return responseSchema.parse(result);
 75:     } catch (error) {
 76:       logger.error({
 77:         operation: operationName,
 78:         error: error instanceof Error ? error.message : 'Unknown error',
 79:         details: error instanceof BaseError ? error.details : undefined,
 80:         args,
 81:       });
 82: 
 83:       if (error instanceof z.ZodError) {
 84:         throw new ValidationError('Invalid request data', error);
 85:       }
 86: 
 87:       if (error instanceof BaseError) {
 88:         throw error;
 89:       }
 90: 
 91:       throw new BaseError(
 92:         'An unexpected error occurred',
 93:         'INTERNAL_SERVER_ERROR',
 94:         500
 95:       );
 96:     }
 97:   };
 98: }
 99: 
100: // Partial success handler for batch operations
101: export function handlePartialSuccess<T>(
102:   results: Array<{ success: boolean; error?: string; data?: T }>,
103:   operation: string
104: ): {
105:   successful: T[];
106:   failed: Array<{ error: string }>;
107: } {
108:   const successful: T[] = [];
109:   const failed: Array<{ error: string }> = [];
110: 
111:   results.forEach((result) => {
112:     if (result.success && result.data) {
113:       successful.push(result.data);
114:     } else {
115:       failed.push({ error: result.error || `${operation} failed` });
116:     }
117:   });
118: 
119:   if (failed.length > 0 && successful.length === 0) {
120:     throw new BatchOperationError(`All ${operation} operations failed`, {
121:       errors: failed.map((f, i) => ({ id: String(i), error: f.error })),
122:     });
123:   }
124: 
125:   return { successful, failed };
126: }
127: 
128: // Rate limiting helper
129: const rateLimits = new Map<string, { count: number; resetAt: number }>();
130: 
131: export function checkRateLimit(
132:   key: string,
133:   limit: number,
134:   windowMs: number = 60000
135: ): void {
136:   const now = Date.now();
137:   const current = rateLimits.get(key);
138: 
139:   if (!current || current.resetAt <= now) {
140:     rateLimits.set(key, { count: 1, resetAt: now + windowMs });
141:     return;
142:   }
143: 
144:   if (current.count >= limit) {
145:     const retryAfter = Math.ceil((current.resetAt - now) / 1000);
146:     throw new RateLimitError('Rate limit exceeded', { retryAfter });
147:   }
148: 
149:   current.count++;
150: }
151: 
152: // Token counting helper
153: export function checkTokenLimit(
154:   content: string,
155:   limit: number,
156:   current: number = 0
157: ): void {
158:   // Simple approximation: 1 token  4 characters
159:   const estimatedTokens = Math.ceil(content.length / 4);
160:   
161:   if (current + estimatedTokens > limit) {
162:     throw new TokenLimitError('Token limit exceeded', {
163:       limit,
164:       current: current + estimatedTokens,
165:     });
166:   }
167: }
168: 
169: // Database error handler
170: export function handleDatabaseError(error: unknown): never {
171:   if (error instanceof Error) {
172:     // Handle specific database errors
173:     if (error.message.includes('duplicate key')) {
174:       throw new ValidationError('Duplicate record');
175:     }
176:     if (error.message.includes('foreign key')) {
177:       throw new ValidationError('Invalid reference');
178:     }
179:     throw new DatabaseError('Database operation failed', error);
180:   }
181:   throw new DatabaseError('Unknown database error');
182: }
```

## File: apps/web/src/lib/session.ts
```typescript
  1: import { cookies } from 'next/headers';
  2: import { UnauthorizedError } from './errors';
  3: import { logger } from '@danky/logger';
  4: 
  5: // Session types
  6: interface User {
  7:   id: string;
  8:   email: string;
  9:   name: string;
 10:   role: 'user' | 'admin';
 11:   metadata?: Record<string, unknown>;
 12: }
 13: 
 14: interface Session {
 15:   user: User;
 16:   expiresAt: Date;
 17:   metadata?: Record<string, unknown>;
 18: }
 19: 
 20: // Session configuration
 21: const SESSION_COOKIE = 'auth_session';
 22: const SESSION_DURATION = 24 * 60 * 60 * 1000; // 24 hours
 23: 
 24: // Session store (replace with Redis in production)
 25: const sessions = new Map<string, Session>();
 26: 
 27: // Helper to generate session ID
 28: function generateSessionId(): string {
 29:   return crypto.randomUUID();
 30: }
 31: 
 32: // Helper to get current timestamp
 33: function getCurrentTimestamp(): Date {
 34:   return new Date();
 35: }
 36: 
 37: // Helper to check if session is expired
 38: function isSessionExpired(session: Session): boolean {
 39:   return getCurrentTimestamp() > session.expiresAt;
 40: }
 41: 
 42: // Helper to create session
 43: export async function createSession(user: User): Promise<string> {
 44:   const sessionId = generateSessionId();
 45:   const expiresAt = new Date(Date.now() + SESSION_DURATION);
 46:   
 47:   sessions.set(sessionId, {
 48:     user,
 49:     expiresAt,
 50:     metadata: {
 51:       createdAt: getCurrentTimestamp(),
 52:       lastActive: getCurrentTimestamp(),
 53:     },
 54:   });
 55:   
 56:   // Set session cookie
 57:   cookies().set(SESSION_COOKIE, sessionId, {
 58:     httpOnly: true,
 59:     secure: process.env.NODE_ENV === 'production',
 60:     sameSite: 'lax',
 61:     expires: expiresAt,
 62:   });
 63:   
 64:   return sessionId;
 65: }
 66: 
 67: // Helper to get session
 68: export async function getSession(): Promise<Session> {
 69:   const sessionId = cookies().get(SESSION_COOKIE)?.value;
 70:   
 71:   if (!sessionId) {
 72:     throw new UnauthorizedError('No session found');
 73:   }
 74:   
 75:   const session = sessions.get(sessionId);
 76:   
 77:   if (!session) {
 78:     throw new UnauthorizedError('Invalid session');
 79:   }
 80:   
 81:   if (isSessionExpired(session)) {
 82:     sessions.delete(sessionId);
 83:     throw new UnauthorizedError('Session expired');
 84:   }
 85:   
 86:   // Update last active timestamp
 87:   session.metadata = {
 88:     ...session.metadata,
 89:     lastActive: getCurrentTimestamp(),
 90:   };
 91:   
 92:   return session;
 93: }
 94: 
 95: // Helper to end session
 96: export async function endSession(): Promise<void> {
 97:   const sessionId = cookies().get(SESSION_COOKIE)?.value;
 98:   
 99:   if (sessionId) {
100:     sessions.delete(sessionId);
101:     cookies().delete(SESSION_COOKIE);
102:   }
103: }
104: 
105: // Helper to get current user
106: export async function getCurrentUser(): Promise<User> {
107:   try {
108:     const session = await getSession();
109:     return session.user;
110:   } catch (error) {
111:     throw new UnauthorizedError('Not authenticated');
112:   }
113: }
114: 
115: // Helper to require authentication
116: export async function withUser<T>(
117:   handler: (user: User) => Promise<T>
118: ): Promise<T> {
119:   try {
120:     const user = await getCurrentUser();
121:     return handler(user);
122:   } catch (error) {
123:     logger.error({
124:       operation: 'withUser',
125:       error: error instanceof Error ? error.message : 'Unknown error',
126:     });
127:     throw error;
128:   }
129: }
130: 
131: // Helper to require admin role
132: export async function withAdmin<T>(
133:   handler: (user: User) => Promise<T>
134: ): Promise<T> {
135:   return withUser(async (user) => {
136:     if (user.role !== 'admin') {
137:       throw new UnauthorizedError('Admin access required');
138:     }
139:     return handler(user);
140:   });
141: }
142: 
143: // Helper to check if user has access to a resource
144: export async function checkResourceAccess(
145:   resourceUserId: string,
146:   allowAdmin: boolean = true
147: ): Promise<void> {
148:   const user = await getCurrentUser();
149:   
150:   if (
151:     user.id !== resourceUserId &&
152:     (!allowAdmin || user.role !== 'admin')
153:   ) {
154:     throw new UnauthorizedError('Access denied');
155:   }
156: }
157: 
158: // Helper to refresh session
159: export async function refreshSession(): Promise<void> {
160:   const session = await getSession();
161:   const expiresAt = new Date(Date.now() + SESSION_DURATION);
162:   
163:   session.expiresAt = expiresAt;
164:   session.metadata = {
165:     ...session.metadata,
166:     lastActive: getCurrentTimestamp(),
167:   };
168:   
169:   // Update session cookie
170:   cookies().set(SESSION_COOKIE, cookies().get(SESSION_COOKIE)!.value, {
171:     httpOnly: true,
172:     secure: process.env.NODE_ENV === 'production',
173:     sameSite: 'lax',
174:     expires: expiresAt,
175:   });
176: }
177: 
178: // Helper to get all active sessions for a user
179: export async function getUserSessions(userId: string): Promise<Session[]> {
180:   return Array.from(sessions.values()).filter(
181:     session => session.user.id === userId && !isSessionExpired(session)
182:   );
183: }
184: 
185: // Helper to end all sessions for a user
186: export async function endUserSessions(userId: string): Promise<void> {
187:   for (const [sessionId, session] of sessions.entries()) {
188:     if (session.user.id === userId) {
189:       sessions.delete(sessionId);
190:     }
191:   }
192: }
193: 
194: // Export types
195: export type { User, Session };
```

## File: apps/web/src/lib/utils.ts
```typescript
1: import { type ClassValue, clsx } from 'clsx'
2: import { twMerge } from 'tailwind-merge'
3: 
4: export function cn(...inputs: ClassValue[]) {
5:   return twMerge(clsx(inputs))
6: }
```

## File: apps/web/.gitignore
```
 1: # See https://help.github.com/articles/ignoring-files/ for more about ignoring files.
 2: 
 3: # dependencies
 4: /node_modules
 5: /.pnp
 6: .pnp.js
 7: .yarn/install-state.gz
 8: 
 9: # testing
10: /coverage
11: 
12: # next.js
13: /.next/
14: /out/
15: 
16: # production
17: /build
18: 
19: # misc
20: .DS_Store
21: *.pem
22: 
23: # debug
24: npm-debug.log*
25: yarn-debug.log*
26: yarn-error.log*
27: 
28: # env files (can opt-in for commiting if needed)
29: .env*
30: 
31: # vercel
32: .vercel
33: 
34: # typescript
35: *.tsbuildinfo
36: next-env.d.ts
```

## File: apps/web/components.json
```json
 1: {
 2:   "$schema": "https://ui.shadcn.com/schema.json",
 3:   "style": "default",
 4:   "rsc": true,
 5:   "tsx": true,
 6:   "tailwind": {
 7:     "config": "tailwind.config.js",
 8:     "css": "app/globals.css",
 9:     "baseColor": "slate",
10:     "cssVariables": true
11:   },
12:   "iconLibrary": "lucide",
13:   "aliases": {
14:     "components": "@/components",
15:     "utils": "@/lib/utils",
16:     "ui": "@danky/ui/components"
17:   }
18: }
```

## File: apps/web/eslint.config.js
```javascript
  1: import js from "@eslint/js";
  2: import { FlatCompat } from "@eslint/eslintrc";
  3: import path from "path";
  4: import { fileURLToPath } from "url";
  5: import tseslint from "@typescript-eslint/eslint-plugin";
  6: import tsParser from "@typescript-eslint/parser";
  7: import reactHooksPlugin from "eslint-plugin-react-hooks";
  8: import reactPlugin from "eslint-plugin-react";
  9: 
 10: const __filename = fileURLToPath(import.meta.url);
 11: const __dirname = path.dirname(__filename);
 12: 
 13: const compat = new FlatCompat({
 14:   baseDirectory: __dirname,
 15:   resolvePluginsRelativeTo: __dirname,
 16: });
 17: 
 18: export default [
 19:   {
 20:     ignores: [
 21:       ".next/**/*",
 22:       "node_modules/**/*",
 23:       "dist/**/*",
 24:       ".turbo/**/*",
 25:       "public/**/*",
 26:       "**/*.config.js",
 27:       "**/*.config.mjs",
 28:     ],
 29:   },
 30:   js.configs.recommended,
 31:   ...compat.extends("next/core-web-vitals"),
 32:   {
 33:     files: ["**/*.ts", "**/*.tsx"],
 34:     plugins: {
 35:       "@typescript-eslint": tseslint,
 36:       "react": reactPlugin,
 37:       "react-hooks": reactHooksPlugin,
 38:     },
 39:     languageOptions: {
 40:       parser: tsParser,
 41:       parserOptions: {
 42:         project: "./tsconfig.json",
 43:         tsconfigRootDir: __dirname,
 44:         ecmaVersion: 2022,
 45:         sourceType: "module",
 46:         ecmaFeatures: {
 47:           jsx: true,
 48:         },
 49:       },
 50:     },
 51:     settings: {
 52:       "import/resolver": {
 53:         typescript: {
 54:           project: "./tsconfig.json",
 55:         },
 56:       },
 57:       react: {
 58:         version: "detect",
 59:       },
 60:       next: {
 61:         rootDir: __dirname,
 62:       },
 63:     },
 64:     rules: {
 65:       "@typescript-eslint/consistent-type-imports": "error",
 66:       "@typescript-eslint/no-floating-promises": "error",
 67:       "@typescript-eslint/no-unused-vars": [
 68:         "warn",
 69:         { argsIgnorePattern: "^_" },
 70:       ],
 71:       "@typescript-eslint/no-explicit-any": "error",
 72:       "@typescript-eslint/no-non-null-assertion": "error",
 73:       "@typescript-eslint/explicit-function-return-type": "off",
 74:       "@typescript-eslint/explicit-module-boundary-types": "off",
 75:       "@typescript-eslint/no-empty-interface": "error",
 76:       "@typescript-eslint/no-inferrable-types": "error",
 77:       "no-unused-vars": "off",
 78: 
 79:       "react/jsx-key": "error",
 80:       "react/jsx-no-undef": "error",
 81:       "react/no-unescaped-entities": "error",
 82:       "react/no-unused-prop-types": "warn",
 83:       "react/prop-types": "off",
 84:       "react/display-name": "off",
 85: 
 86:       "react-hooks/rules-of-hooks": "error",
 87:       "react-hooks/exhaustive-deps": "warn",
 88: 
 89:       "import/no-cycle": "error",
 90:       "import/no-unresolved": "error",
 91:       "import/no-duplicates": "error",
 92:       "import/order": [
 93:         "error",
 94:         {
 95:           groups: [
 96:             "builtin",
 97:             "external",
 98:             "internal",
 99:             "parent",
100:             "sibling",
101:             "index",
102:           ],
103:           pathGroups: [
104:             {
105:               pattern: "react",
106:               group: "builtin",
107:               position: "before",
108:             },
109:             {
110:               pattern: "@/**",
111:               group: "internal",
112:               position: "after",
113:             },
114:           ],
115:           pathGroupsExcludedImportTypes: ["react"],
116:           "newlines-between": "always",
117:           alphabetize: {
118:             order: "asc",
119:             caseInsensitive: true,
120:           },
121:         },
122:       ],
123:     },
124:   },
125: ];
```

## File: apps/web/mcp-server-guide.md
```markdown
 1: # Comprehensive Guide to Creating Model Context Protocol (MCP) Servers
 2: 
 3: The Model Context Protocol (MCP) is an open standard that enables developers to build secure, two-way connections between their data sources/tools and AI-powered applications like large language models.
 4: 
 5: This guide covers the key concepts and steps involved in creating your own MCP server implementation.
 6: 
 7: ## What is an MCP Server?
 8: 
 9: An MCP server exposes data, tools, APIs or custom workflows to language model clients in a standardized way using the MCP specification. It handles:
10: 
11: - Communicating with the language model client over the defined MCP protocol
12: - Interfacing with the actual data source, tool or application being exposed
13: - Translating between the MCP request/response format and the external system
14: 
15: Servers are a core component of the MCP architecture, along with clients (the language model applications) and the protocol/transport layers that enable communication between them.
16: 
17: ## Why Create an MCP Server?
18: 
19: By implementing an MCP server, you can seamlessly integrate your data, APIs or custom tools with large language models and AI applications. This allows the language models to:
20: 
21: - Access and process information from your systems in context
22: - Trigger actions, updates or workflows in your external tools/apps
23: - Combine capabilities from multiple servers for more powerful capabilities
24: 
25: MCP provides standardized interfaces that make integrating with language models much easier compared to ad-hoc integrations.
26: 
27: ## High-Level Steps
28: 
29: At a high level, creating an MCP server involves:
30: 
31: 1. **Study the MCP specification**: Understand the protocol request/response formats, communication patterns, authentication and more from the official docs.
32: 
33: 2. **Choose language/framework**: Pick your preferred programming language and frameworks. Python, Node.js/TypeScript, Rust and others have libraries/examples.
34: 
35: 3. **Implement protocol layer**: Code the logic to handle MCP protocol communication - framing messages, request/response linking, etc. Can often reuse libraries.
36: 
37: 4. **Implement transport layer**: Set up the transport mechanism for communication between your server and clients (e.g. HTTP, WebSockets, gRPC etc.)
38: 
39: 5. **Build data/tool interface**: Implement the core logic to interface with your actual data source, API, tool or custom application you are exposing.
40: 
41: 6. **Handle authentication/authz**: Build in any required authentication, authorization or usage controls for your MCP server instance.
42: 
43: 7. **Test and debug**: Thoroughly test by setting up a test language model client and ensuring all integration points work as expected.
44: 
45: 8. **Deploy and monitor**: Deploy your MCP server instance to your hosting environment and set up monitoring/logging.
46: 
47: ## Example MCP Servers 
48: 
49: To get started, consider analyzing these example open source MCP server implementations:
50: 
51: - **Airtable Server**: MCP server for Airtable data - https://github.com/modelcontextprotocol/servers/tree/main/airtable
52: 
53: - **Mongo Server**: MCP server enabling LLMs to interact with MongoDB - https://github.com/wong2/awesome-mcp-servers#mongo 
54: 
55: - **Playwright Server**: MCP server using Playwright for browser automation/scraping - https://github.com/wong2/awesome-mcp-servers#playwright-mcp-server
56: 
57: - **Brave Search Server**: Official MCP server implementation for the Brave Search API - https://github.com/modelcontextprotocol/servers/tree/main/brave-search
58: 
59: Studying the code and approach used in these examples can provide a great starting point for your own implementation.
60: 
61: ## Resources
62: 
63: - Official MCP docs and specification: https://github.com/modelcontextprotocol 
64: - Curated list of MCP server examples: https://github.com/wong2/awesome-mcp-servers
65: - Blog posts and guides on implementing MCP servers:
66:     - https://simonwillison.net/2024/Nov/25/model-context-protocol/
67:     - https://glama.ai/blog/2024-11-25-model-context-protocol-quickstart
68:     - https://medium.com/@LakshmiNarayana_U/building-a-model-context-protocol-mcp-server-for-claude-desktop-in-typescript-9022024c8949
69: 
70: With the right planning, existing resources and this guide, you should be well on your way to creating your own powerful MCP server integration!
```

## File: apps/web/next.config.js
```javascript
 1: /** @type {import('next').NextConfig} */
 2: const nextConfig = {
 3:   reactStrictMode: true,
 4:   transpilePackages: ['@danky/ui', '@danky/mcp'],
 5:   experimental: {
 6:     esmExternals: true,
 7:     serverComponentsExternalPackages: ['shiki'],
 8:   },
 9:   webpack: (config, { isServer }) => {
10:     if (!isServer) {
11:       config.resolve.fallback = {
12:         ...config.resolve.fallback,
13:         fs: false,
14:         path: false,
15:         async_hooks: false,
16:         child_process: false,
17:         net: false,
18:         tls: false,
19:         process: false,
20:       }
21:       // Handle node: protocol imports
22:       config.resolve.alias = {
23:         ...config.resolve.alias,
24:         'node:async_hooks': false,
25:         'node:child_process': false,
26:         'node:net': false,
27:         'node:tls': false,
28:         'node:process': false,
29:         'node:fs': false,
30:         'node:path': false,
31:       }
32:     }
33: 
34:     // Add module resolution aliases
35:     config.resolve.alias = {
36:       ...config.resolve.alias,
37:       '@n8n/json-schema-to-zod': '@n8n/json-schema-to-zod',
38:     }
39: 
40:     // Add extension resolution
41:     config.resolve.extensionAlias = {
42:       '.js': ['.js', '.ts', '.tsx'],
43:       '.jsx': ['.jsx', '.tsx'],
44:     }
45: 
46:     return config
47:   },
48:   eslint: {
49:     ignoreDuringBuilds: false,
50:     dirs: ['src/app', 'src/components', 'src/lib', 'src/hooks']
51:   }
52: }
53: 
54: module.exports = nextConfig
```

## File: apps/web/package.json
```json
 1: {
 2:   "name": "@danky/web",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "scripts": {
 7:     "dev": "kill-port 3000 && next dev",
 8:     "build": "next build",
 9:     "start": "next start",
10:     "lint": "eslint . --report-unused-disable-directives",
11:     "lint:fix": "eslint . --fix",
12:     "type-check": "tsc --noEmit",
13:     "clean": "rimraf .next .turbo node_modules",
14:     "ui:add": "pnpm dlx shadcn-ui@latest add",
15:     "ui:diff": "pnpm dlx shadcn-ui@latest diff"
16:   },
17:   "dependencies": {
18:     "@danky/mcp": "workspace:*",
19:     "@danky/ui": "workspace:*",
20:     "@h1deya/mcp-langchain-tools": "^0.1.1",
21:     "@langchain/anthropic": "^0.3.11",
22:     "@langchain/community": "^0.3.22",
23:     "@langchain/core": "^0.3.27",
24:     "@langchain/groq": "^0.1.2",
25:     "@langchain/langgraph": "^0.2.36",
26:     "@langchain/openai": "^0.3.16",
27:     "@modelcontextprotocol/sdk": "^1.1.0",
28:     "@radix-ui/react-slot": "^1.0.2",
29:     "class-variance-authority": "^0.7.0",
30:     "clsx": "^2.1.0",
31:     "lucide-react": "^0.323.0",
32:     "next": "^15.1.4",
33:     "next-themes": "^0.2.1",
34:     "react": "^19.0.0",
35:     "react-dom": "^19.0.0",
36:     "react-markdown": "^9.0.1",
37:     "rehype-katex": "^7.0.0",
38:     "rehype-raw": "^7.0.0",
39:     "remark-gfm": "^4.0.0",
40:     "remark-math": "^6.0.0",
41:     "shiki": "^1.1.7",
42:     "react-syntax-highlighter": "^15.5.0",
43:     "tailwind-merge": "^2.2.1",
44:     "tailwindcss-animate": "^1.0.7"
45:   },
46:   "devDependencies": {
47:     "@danky/eslint-config": "workspace:*",
48:     "@danky/typescript-config": "workspace:*",
49:     "@eslint/eslintrc": "3.2.0",
50:     "@eslint/js": "^9.0.0",
51:     "@next/eslint-plugin-next": "^15.1.4",
52:     "@types/node": "^20",
53:     "@types/react": "^19.0.0",
54:     "@types/react-dom": "^19.0.0",
55:     "@types/react-syntax-highlighter": "^15.5.11",
56:     "@typescript-eslint/eslint-plugin": "^8.19.1",
57:     "@typescript-eslint/parser": "^8.19.1",
58:     "autoprefixer": "^10.0.1",
59:     "eslint": "^9.17.0",
60:     "eslint-config-next": "^15.1.4",
61:     "eslint-import-resolver-typescript": "^3.6.1",
62:     "eslint-plugin-import": "^2.29.1",
63:     "eslint-plugin-react": "^7.33.2",
64:     "eslint-plugin-react-hooks": "^4.6.0",
65:     "postcss": "^8",
66:     "rimraf": "^5.0.5",
67:     "tailwindcss": "^3.3.0",
68:     "typescript": "^5.3.3"
69:   }
70: }
```

## File: apps/web/postcss.config.js
```javascript
1: module.exports = {
2:   plugins: {
3:     tailwindcss: {},
4:     autoprefixer: {},
5:   },
6: }
```

## File: apps/web/README.md
```markdown
  1: # Danky Web Application
  2: 
  3: The main web interface for the Danky AI Chatbot platform, built with Next.js 14, React Server Components, and shadcn/ui.
  4: 
  5: ## Directory Structure
  6: 
  7: ```
  8: src/
  9:  app/                # Next.js App Router pages
 10:     api/           # API routes
 11:     chat/          # Chat interface pages
 12:     layout.tsx     # Root layout
 13:  components/        # React components
 14:     chat/         # Chat-specific components
 15:     mcp/          # MCP integration components
 16:     sidebar/      # Navigation components
 17:     theme/        # Theme components
 18:     ui/           # App-specific UI components
 19:  hooks/            # React hooks
 20:  lib/              # Utilities and services
 21:     actions/      # Server actions
 22:     config/       # App configuration
 23:     db/           # Database utilities
 24:     services/     # Service layer
 25:     stores/       # Client-side state
 26:     validations/  # Schema validations
 27:  types/            # TypeScript types
 28: ```
 29: 
 30: ## Key Features
 31: 
 32: - **Chat Interface**: Real-time AI chat with multiple model support
 33: - **MCP Integration**: Model Context Protocol for AI interactions
 34: - **Theme Support**: Dark/light mode with customizable themes
 35: - **Server Components**: Optimized for performance with RSC
 36: - **Type Safety**: Full TypeScript coverage with strict mode
 37: 
 38: ## Development
 39: 
 40: ### Prerequisites
 41: 
 42: - Node.js 20.11.0+
 43: - pnpm 8.x+
 44: - PostgreSQL 15+
 45: 
 46: ### Setup
 47: 
 48: 1. Install dependencies:
 49: ```bash
 50: pnpm install
 51: ```
 52: 
 53: 2. Set up environment variables:
 54: ```bash
 55: cp .env.example .env
 56: ```
 57: 
 58: 3. Start development server:
 59: ```bash
 60: pnpm dev
 61: ```
 62: 
 63: ### AI Development Notes
 64: 
 65: #### Key Files for Context
 66: - `src/app/layout.tsx` - Root layout and providers
 67: - `src/components/chat/types.ts` - Chat-related types
 68: - `src/lib/stores/chat-store.ts` - Chat state management
 69: 
 70: #### Common Operations
 71: - Add UI component: `pnpm ui:add [component-name]`
 72: - Run type check: `pnpm type-check`
 73: - Run linter: `pnpm lint`
 74: - Run tests: `pnpm test`
 75: 
 76: #### Component Guidelines
 77: - Use Server Components by default
 78: - Add 'use client' only when needed
 79: - Keep components under 200 lines
 80: - Follow the feature-based structure
 81: 
 82: #### State Management
 83: - Server state: Server Components
 84: - Form state: react-hook-form + zod
 85: - Client state: Zustand stores
 86: - Global state: React Context
 87: 
 88: ## Configuration
 89: 
 90: ### ESLint
 91: - Uses flat config format (eslint.config.js)
 92: - Extends from @danky/eslint-config
 93: - Strict TypeScript rules enabled
 94: 
 95: ### TypeScript
 96: - Strict mode enabled
 97: - Path aliases configured
 98: - Server/client separation
 99: 
100: ### Tailwind CSS
101: - Extended theme in tailwind.config.js
102: - shadcn/ui components support
103: - Custom color schemes
104: 
105: ## Testing
106: 
107: ### Unit Tests
108: ```bash
109: pnpm test:unit
110: ```
111: 
112: ### Integration Tests
113: ```bash
114: pnpm test:integration
115: ```
116: 
117: ### E2E Tests
118: ```bash
119: pnpm test:e2e
120: ```
121: 
122: ## Deployment
123: 
124: ### Production Build
125: ```bash
126: pnpm build
127: ```
128: 
129: ### Environment Variables
130: Required:
131: - `DATABASE_URL`: PostgreSQL connection string
132: - `NEXTAUTH_SECRET`: Auth secret key
133: - `NEXTAUTH_URL`: Auth callback URL
134: 
135: Optional:
136: - `SENTRY_DSN`: Error tracking
137: - `VERCEL_URL`: Vercel deployment URL
138: 
139: ## Troubleshooting
140: 
141: ### Common Issues
142: 1. **Type Errors**: Check path aliases in tsconfig.json
143: 2. **Build Errors**: Verify package versions
144: 3. **Style Issues**: Check Tailwind classes
145: 4. **State Issues**: Verify store implementations
146: 
147: ### Debug Tools
148: - React DevTools
149: - Next.js DevTools
150: - Chrome DevTools
151: - VSCode Debugger
152: 
153: ## Additional Resources
154: 
155: - [Architecture Guide](../../docs/ARCHITECTURE.md)
156: - [Component Patterns](../../docs/PATTERNS.md)
157: - [API Documentation](../../docs/API.md)
158: - [Testing Guide](../../docs/TESTING.md)
```

## File: apps/web/tailwind.config.js
```javascript
 1: /** @type {import('tailwindcss').Config} */
 2: module.exports = {
 3:   darkMode: ['class'],
 4:   content: [
 5:     './src/app/**/*.{js,ts,jsx,tsx,mdx}',
 6:     './src/components/**/*.{js,ts,jsx,tsx,mdx}',
 7:     './src/lib/**/*.{js,ts,jsx,tsx,mdx}',
 8:     '../../packages/ui/src/**/*.{js,ts,jsx,tsx,mdx}',
 9:   ],
10:   theme: {
11:     container: {
12:       center: true,
13:       padding: '2rem',
14:       screens: {
15:         '2xl': '1400px',
16:       },
17:     },
18:     extend: {
19:       colors: {
20:         border: 'hsl(var(--border))',
21:         input: 'hsl(var(--input))',
22:         ring: 'hsl(var(--ring))',
23:         background: 'hsl(var(--background))',
24:         foreground: 'hsl(var(--foreground))',
25:         primary: {
26:           DEFAULT: 'hsl(var(--primary))',
27:           foreground: 'hsl(var(--primary-foreground))',
28:         },
29:         secondary: {
30:           DEFAULT: 'hsl(var(--secondary))',
31:           foreground: 'hsl(var(--secondary-foreground))',
32:         },
33:         destructive: {
34:           DEFAULT: 'hsl(var(--destructive))',
35:           foreground: 'hsl(var(--destructive-foreground))',
36:         },
37:         muted: {
38:           DEFAULT: 'hsl(var(--muted))',
39:           foreground: 'hsl(var(--muted-foreground))',
40:         },
41:         accent: {
42:           DEFAULT: 'hsl(var(--accent))',
43:           foreground: 'hsl(var(--accent-foreground))',
44:         },
45:         popover: {
46:           DEFAULT: 'hsl(var(--popover))',
47:           foreground: 'hsl(var(--popover-foreground))',
48:         },
49:         card: {
50:           DEFAULT: 'hsl(var(--card))',
51:           foreground: 'hsl(var(--card-foreground))',
52:         },
53:       },
54:       borderRadius: {
55:         lg: 'var(--radius)',
56:         md: 'calc(var(--radius) - 2px)',
57:         sm: 'calc(var(--radius) - 4px)',
58:       },
59:       keyframes: {
60:         'accordion-down': {
61:           from: { height: '0' },
62:           to: { height: 'var(--radix-accordion-content-height)' },
63:         },
64:         'accordion-up': {
65:           from: { height: 'var(--radix-accordion-content-height)' },
66:           to: { height: '0' },
67:         },
68:       },
69:       animation: {
70:         'accordion-down': 'accordion-down 0.2s ease-out',
71:         'accordion-up': 'accordion-up 0.2s ease-out',
72:       },
73:     },
74:   },
75:   plugins: [require('tailwindcss-animate')],
76: }
```

## File: apps/web/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/nextjs.json",
 3:   "compilerOptions": {
 4:     "plugins": [
 5:       {
 6:         "name": "next"
 7:       }
 8:     ],
 9:     "baseUrl": "src",
10:     "paths": {
11:       "@/*": ["./*"],
12:       "@/lib/*": ["lib/*"],
13:       "@/components/*": ["components/*"],
14:       "@/app/*": ["app/*"],
15:       "@/hooks/*": ["hooks/*"],
16:       "@/styles/*": ["styles/*"],
17:       "@danky/ui": ["../../packages/ui/src"],
18:       "@danky/ui/*": ["../../packages/ui/src/*"],
19:       "@danky/mcp": ["../../packages/mcp/src"],
20:       "@danky/mcp/*": ["../../packages/mcp/src/*"]
21:     }
22:   },
23:   "include": [
24:     "src/**/*.ts",
25:     "src/**/*.tsx",
26:     "next-env.d.ts",
27:     "next.config.js",
28:     ".next/types/**/*.ts",
29:     "types.d.ts"
30:   ],
31:   "exclude": ["node_modules"]
32: }
```

## File: apps/web/types.d.ts
```typescript
 1: declare module 'remark-math' {
 2:   const remarkMath: any
 3:   export default remarkMath
 4: }
 5: 
 6: declare module 'rehype-katex' {
 7:   const rehypeKatex: any
 8:   export default rehypeKatex
 9: }
10: 
11: declare module 'rehype-raw' {
12:   const rehypeRaw: any
13:   export default rehypeRaw
14: }
15: 
16: declare module 'remark-gfm' {
17:   const remarkGfm: any
18:   export default remarkGfm
19: }
```

## File: packages/db/drizzle/meta/_journal.json
```json
 1: {
 2:   "version": "5",
 3:   "dialect": "pg",
 4:   "entries": [
 5:     {
 6:       "idx": 0,
 7:       "version": "5",
 8:       "when": 1736317617260,
 9:       "tag": "0000_noisy_phil_sheldon",
10:       "breakpoints": true
11:     }
12:   ]
13: }
```

## File: packages/db/drizzle/meta/0000_snapshot.json
```json
  1: {
  2:   "id": "d79a9af4-7cf2-4e6c-b046-d2bd3850d294",
  3:   "prevId": "00000000-0000-0000-0000-000000000000",
  4:   "version": "5",
  5:   "dialect": "pg",
  6:   "tables": {
  7:     "sessions": {
  8:       "name": "sessions",
  9:       "schema": "",
 10:       "columns": {
 11:         "id": {
 12:           "name": "id",
 13:           "type": "uuid",
 14:           "primaryKey": true,
 15:           "notNull": true
 16:         },
 17:         "user_id": {
 18:           "name": "user_id",
 19:           "type": "uuid",
 20:           "primaryKey": false,
 21:           "notNull": true
 22:         },
 23:         "refresh_token": {
 24:           "name": "refresh_token",
 25:           "type": "text",
 26:           "primaryKey": false,
 27:           "notNull": true
 28:         },
 29:         "expires_at": {
 30:           "name": "expires_at",
 31:           "type": "timestamp",
 32:           "primaryKey": false,
 33:           "notNull": true
 34:         },
 35:         "created_at": {
 36:           "name": "created_at",
 37:           "type": "timestamp",
 38:           "primaryKey": false,
 39:           "notNull": true,
 40:           "default": "now()"
 41:         },
 42:         "updated_at": {
 43:           "name": "updated_at",
 44:           "type": "timestamp",
 45:           "primaryKey": false,
 46:           "notNull": true,
 47:           "default": "now()"
 48:         }
 49:       },
 50:       "indexes": {},
 51:       "foreignKeys": {
 52:         "sessions_user_id_users_id_fk": {
 53:           "name": "sessions_user_id_users_id_fk",
 54:           "tableFrom": "sessions",
 55:           "tableTo": "users",
 56:           "columnsFrom": [
 57:             "user_id"
 58:           ],
 59:           "columnsTo": [
 60:             "id"
 61:           ],
 62:           "onDelete": "cascade",
 63:           "onUpdate": "no action"
 64:         }
 65:       },
 66:       "compositePrimaryKeys": {},
 67:       "uniqueConstraints": {}
 68:     },
 69:     "users": {
 70:       "name": "users",
 71:       "schema": "",
 72:       "columns": {
 73:         "id": {
 74:           "name": "id",
 75:           "type": "uuid",
 76:           "primaryKey": true,
 77:           "notNull": true
 78:         },
 79:         "email": {
 80:           "name": "email",
 81:           "type": "text",
 82:           "primaryKey": false,
 83:           "notNull": true
 84:         },
 85:         "hashed_password": {
 86:           "name": "hashed_password",
 87:           "type": "text",
 88:           "primaryKey": false,
 89:           "notNull": true
 90:         },
 91:         "full_name": {
 92:           "name": "full_name",
 93:           "type": "text",
 94:           "primaryKey": false,
 95:           "notNull": true
 96:         },
 97:         "is_active": {
 98:           "name": "is_active",
 99:           "type": "boolean",
100:           "primaryKey": false,
101:           "notNull": true,
102:           "default": true
103:         },
104:         "is_verified": {
105:           "name": "is_verified",
106:           "type": "boolean",
107:           "primaryKey": false,
108:           "notNull": true,
109:           "default": false
110:         },
111:         "created_at": {
112:           "name": "created_at",
113:           "type": "timestamp",
114:           "primaryKey": false,
115:           "notNull": true,
116:           "default": "now()"
117:         },
118:         "updated_at": {
119:           "name": "updated_at",
120:           "type": "timestamp",
121:           "primaryKey": false,
122:           "notNull": true,
123:           "default": "now()"
124:         }
125:       },
126:       "indexes": {},
127:       "foreignKeys": {},
128:       "compositePrimaryKeys": {},
129:       "uniqueConstraints": {
130:         "users_email_unique": {
131:           "name": "users_email_unique",
132:           "nullsNotDistinct": false,
133:           "columns": [
134:             "email"
135:           ]
136:         }
137:       }
138:     },
139:     "key_value": {
140:       "name": "key_value",
141:       "schema": "",
142:       "columns": {
143:         "id": {
144:           "name": "id",
145:           "type": "uuid",
146:           "primaryKey": true,
147:           "notNull": true
148:         },
149:         "key": {
150:           "name": "key",
151:           "type": "text",
152:           "primaryKey": false,
153:           "notNull": true
154:         },
155:         "value": {
156:           "name": "value",
157:           "type": "jsonb",
158:           "primaryKey": false,
159:           "notNull": true
160:         },
161:         "expires_at": {
162:           "name": "expires_at",
163:           "type": "timestamp",
164:           "primaryKey": false,
165:           "notNull": false
166:         },
167:         "created_at": {
168:           "name": "created_at",
169:           "type": "timestamp",
170:           "primaryKey": false,
171:           "notNull": true,
172:           "default": "now()"
173:         },
174:         "updated_at": {
175:           "name": "updated_at",
176:           "type": "timestamp",
177:           "primaryKey": false,
178:           "notNull": true,
179:           "default": "now()"
180:         }
181:       },
182:       "indexes": {},
183:       "foreignKeys": {},
184:       "compositePrimaryKeys": {},
185:       "uniqueConstraints": {
186:         "key_value_key_unique": {
187:           "name": "key_value_key_unique",
188:           "nullsNotDistinct": false,
189:           "columns": [
190:             "key"
191:           ]
192:         }
193:       }
194:     },
195:     "attachments": {
196:       "name": "attachments",
197:       "schema": "",
198:       "columns": {
199:         "id": {
200:           "name": "id",
201:           "type": "uuid",
202:           "primaryKey": true,
203:           "notNull": true
204:         },
205:         "message_id": {
206:           "name": "message_id",
207:           "type": "uuid",
208:           "primaryKey": false,
209:           "notNull": true
210:         },
211:         "file_name": {
212:           "name": "file_name",
213:           "type": "text",
214:           "primaryKey": false,
215:           "notNull": true
216:         },
217:         "file_type": {
218:           "name": "file_type",
219:           "type": "text",
220:           "primaryKey": false,
221:           "notNull": true
222:         },
223:         "file_size": {
224:           "name": "file_size",
225:           "type": "integer",
226:           "primaryKey": false,
227:           "notNull": true
228:         },
229:         "file_path": {
230:           "name": "file_path",
231:           "type": "text",
232:           "primaryKey": false,
233:           "notNull": true
234:         },
235:         "created_at": {
236:           "name": "created_at",
237:           "type": "timestamp",
238:           "primaryKey": false,
239:           "notNull": true,
240:           "default": "now()"
241:         },
242:         "updated_at": {
243:           "name": "updated_at",
244:           "type": "timestamp",
245:           "primaryKey": false,
246:           "notNull": true,
247:           "default": "now()"
248:         }
249:       },
250:       "indexes": {},
251:       "foreignKeys": {
252:         "attachments_message_id_messages_id_fk": {
253:           "name": "attachments_message_id_messages_id_fk",
254:           "tableFrom": "attachments",
255:           "tableTo": "messages",
256:           "columnsFrom": [
257:             "message_id"
258:           ],
259:           "columnsTo": [
260:             "id"
261:           ],
262:           "onDelete": "cascade",
263:           "onUpdate": "no action"
264:         }
265:       },
266:       "compositePrimaryKeys": {},
267:       "uniqueConstraints": {}
268:     },
269:     "conversations": {
270:       "name": "conversations",
271:       "schema": "",
272:       "columns": {
273:         "id": {
274:           "name": "id",
275:           "type": "uuid",
276:           "primaryKey": true,
277:           "notNull": true
278:         },
279:         "user_id": {
280:           "name": "user_id",
281:           "type": "uuid",
282:           "primaryKey": false,
283:           "notNull": true
284:         },
285:         "title": {
286:           "name": "title",
287:           "type": "text",
288:           "primaryKey": false,
289:           "notNull": true
290:         },
291:         "is_archived": {
292:           "name": "is_archived",
293:           "type": "boolean",
294:           "primaryKey": false,
295:           "notNull": true,
296:           "default": false
297:         },
298:         "created_at": {
299:           "name": "created_at",
300:           "type": "timestamp",
301:           "primaryKey": false,
302:           "notNull": true,
303:           "default": "now()"
304:         },
305:         "updated_at": {
306:           "name": "updated_at",
307:           "type": "timestamp",
308:           "primaryKey": false,
309:           "notNull": true,
310:           "default": "now()"
311:         }
312:       },
313:       "indexes": {},
314:       "foreignKeys": {
315:         "conversations_user_id_users_id_fk": {
316:           "name": "conversations_user_id_users_id_fk",
317:           "tableFrom": "conversations",
318:           "tableTo": "users",
319:           "columnsFrom": [
320:             "user_id"
321:           ],
322:           "columnsTo": [
323:             "id"
324:           ],
325:           "onDelete": "cascade",
326:           "onUpdate": "no action"
327:         }
328:       },
329:       "compositePrimaryKeys": {},
330:       "uniqueConstraints": {}
331:     },
332:     "messages": {
333:       "name": "messages",
334:       "schema": "",
335:       "columns": {
336:         "id": {
337:           "name": "id",
338:           "type": "uuid",
339:           "primaryKey": true,
340:           "notNull": true
341:         },
342:         "conversation_id": {
343:           "name": "conversation_id",
344:           "type": "uuid",
345:           "primaryKey": false,
346:           "notNull": true
347:         },
348:         "role": {
349:           "name": "role",
350:           "type": "text",
351:           "primaryKey": false,
352:           "notNull": true
353:         },
354:         "content": {
355:           "name": "content",
356:           "type": "text",
357:           "primaryKey": false,
358:           "notNull": true
359:         },
360:         "metadata": {
361:           "name": "metadata",
362:           "type": "jsonb",
363:           "primaryKey": false,
364:           "notNull": false
365:         },
366:         "created_at": {
367:           "name": "created_at",
368:           "type": "timestamp",
369:           "primaryKey": false,
370:           "notNull": true,
371:           "default": "now()"
372:         },
373:         "updated_at": {
374:           "name": "updated_at",
375:           "type": "timestamp",
376:           "primaryKey": false,
377:           "notNull": true,
378:           "default": "now()"
379:         }
380:       },
381:       "indexes": {},
382:       "foreignKeys": {
383:         "messages_conversation_id_conversations_id_fk": {
384:           "name": "messages_conversation_id_conversations_id_fk",
385:           "tableFrom": "messages",
386:           "tableTo": "conversations",
387:           "columnsFrom": [
388:             "conversation_id"
389:           ],
390:           "columnsTo": [
391:             "id"
392:           ],
393:           "onDelete": "cascade",
394:           "onUpdate": "no action"
395:         }
396:       },
397:       "compositePrimaryKeys": {},
398:       "uniqueConstraints": {}
399:     },
400:     "embeddings": {
401:       "name": "embeddings",
402:       "schema": "",
403:       "columns": {
404:         "id": {
405:           "name": "id",
406:           "type": "uuid",
407:           "primaryKey": true,
408:           "notNull": true
409:         },
410:         "content_id": {
411:           "name": "content_id",
412:           "type": "text",
413:           "primaryKey": false,
414:           "notNull": true
415:         },
416:         "content_type": {
417:           "name": "content_type",
418:           "type": "text",
419:           "primaryKey": false,
420:           "notNull": true
421:         },
422:         "embedding": {
423:           "name": "embedding",
424:           "type": "text",
425:           "primaryKey": false,
426:           "notNull": true
427:         },
428:         "metadata": {
429:           "name": "metadata",
430:           "type": "jsonb",
431:           "primaryKey": false,
432:           "notNull": false
433:         },
434:         "created_at": {
435:           "name": "created_at",
436:           "type": "timestamp",
437:           "primaryKey": false,
438:           "notNull": true,
439:           "default": "now()"
440:         },
441:         "updated_at": {
442:           "name": "updated_at",
443:           "type": "timestamp",
444:           "primaryKey": false,
445:           "notNull": true,
446:           "default": "now()"
447:         }
448:       },
449:       "indexes": {},
450:       "foreignKeys": {},
451:       "compositePrimaryKeys": {},
452:       "uniqueConstraints": {}
453:     }
454:   },
455:   "enums": {},
456:   "schemas": {},
457:   "_meta": {
458:     "columns": {},
459:     "schemas": {},
460:     "tables": {}
461:   }
462: }
```

## File: packages/db/drizzle/0000_noisy_phil_sheldon.sql
```sql
 1: CREATE TABLE IF NOT EXISTS "sessions" (
 2: 	"id" uuid PRIMARY KEY NOT NULL,
 3: 	"user_id" uuid NOT NULL,
 4: 	"refresh_token" text NOT NULL,
 5: 	"expires_at" timestamp NOT NULL,
 6: 	"created_at" timestamp DEFAULT now() NOT NULL,
 7: 	"updated_at" timestamp DEFAULT now() NOT NULL
 8: );
 9: --> statement-breakpoint
10: CREATE TABLE IF NOT EXISTS "users" (
11: 	"id" uuid PRIMARY KEY NOT NULL,
12: 	"email" text NOT NULL,
13: 	"hashed_password" text NOT NULL,
14: 	"full_name" text NOT NULL,
15: 	"is_active" boolean DEFAULT true NOT NULL,
16: 	"is_verified" boolean DEFAULT false NOT NULL,
17: 	"created_at" timestamp DEFAULT now() NOT NULL,
18: 	"updated_at" timestamp DEFAULT now() NOT NULL,
19: 	CONSTRAINT "users_email_unique" UNIQUE("email")
20: );
21: --> statement-breakpoint
22: CREATE TABLE IF NOT EXISTS "key_value" (
23: 	"id" uuid PRIMARY KEY NOT NULL,
24: 	"key" text NOT NULL,
25: 	"value" jsonb NOT NULL,
26: 	"expires_at" timestamp,
27: 	"created_at" timestamp DEFAULT now() NOT NULL,
28: 	"updated_at" timestamp DEFAULT now() NOT NULL,
29: 	CONSTRAINT "key_value_key_unique" UNIQUE("key")
30: );
31: --> statement-breakpoint
32: CREATE TABLE IF NOT EXISTS "attachments" (
33: 	"id" uuid PRIMARY KEY NOT NULL,
34: 	"message_id" uuid NOT NULL,
35: 	"file_name" text NOT NULL,
36: 	"file_type" text NOT NULL,
37: 	"file_size" integer NOT NULL,
38: 	"file_path" text NOT NULL,
39: 	"created_at" timestamp DEFAULT now() NOT NULL,
40: 	"updated_at" timestamp DEFAULT now() NOT NULL
41: );
42: --> statement-breakpoint
43: CREATE TABLE IF NOT EXISTS "conversations" (
44: 	"id" uuid PRIMARY KEY NOT NULL,
45: 	"user_id" uuid NOT NULL,
46: 	"title" text NOT NULL,
47: 	"is_archived" boolean DEFAULT false NOT NULL,
48: 	"created_at" timestamp DEFAULT now() NOT NULL,
49: 	"updated_at" timestamp DEFAULT now() NOT NULL
50: );
51: --> statement-breakpoint
52: CREATE TABLE IF NOT EXISTS "messages" (
53: 	"id" uuid PRIMARY KEY NOT NULL,
54: 	"conversation_id" uuid NOT NULL,
55: 	"role" text NOT NULL,
56: 	"content" text NOT NULL,
57: 	"metadata" jsonb,
58: 	"created_at" timestamp DEFAULT now() NOT NULL,
59: 	"updated_at" timestamp DEFAULT now() NOT NULL
60: );
61: --> statement-breakpoint
62: CREATE TABLE IF NOT EXISTS "embeddings" (
63: 	"id" uuid PRIMARY KEY NOT NULL,
64: 	"content_id" text NOT NULL,
65: 	"content_type" text NOT NULL,
66: 	"embedding" text NOT NULL,
67: 	"metadata" jsonb,
68: 	"created_at" timestamp DEFAULT now() NOT NULL,
69: 	"updated_at" timestamp DEFAULT now() NOT NULL
70: );
71: --> statement-breakpoint
72: DO $$ BEGIN
73:  ALTER TABLE "sessions" ADD CONSTRAINT "sessions_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
74: EXCEPTION
75:  WHEN duplicate_object THEN null;
76: END $$;
77: --> statement-breakpoint
78: DO $$ BEGIN
79:  ALTER TABLE "attachments" ADD CONSTRAINT "attachments_message_id_messages_id_fk" FOREIGN KEY ("message_id") REFERENCES "messages"("id") ON DELETE cascade ON UPDATE no action;
80: EXCEPTION
81:  WHEN duplicate_object THEN null;
82: END $$;
83: --> statement-breakpoint
84: DO $$ BEGIN
85:  ALTER TABLE "conversations" ADD CONSTRAINT "conversations_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
86: EXCEPTION
87:  WHEN duplicate_object THEN null;
88: END $$;
89: --> statement-breakpoint
90: DO $$ BEGIN
91:  ALTER TABLE "messages" ADD CONSTRAINT "messages_conversation_id_conversations_id_fk" FOREIGN KEY ("conversation_id") REFERENCES "conversations"("id") ON DELETE cascade ON UPDATE no action;
92: EXCEPTION
93:  WHEN duplicate_object THEN null;
94: END $$;
```

## File: packages/db/drizzle/0001_chat_schema_improvements.sql
```sql
 1: -- Add new columns to conversations
 2: ALTER TABLE conversations
 3: ADD COLUMN model_id TEXT NOT NULL DEFAULT 'gpt-4',
 4: ADD COLUMN description TEXT,
 5: ADD COLUMN deleted_at TIMESTAMP;
 6: 
 7: -- Add new columns to messages
 8: ALTER TABLE messages
 9: ADD COLUMN content_type TEXT NOT NULL DEFAULT 'text',
10: ADD COLUMN language TEXT,
11: ADD COLUMN tokens INTEGER,
12: ADD COLUMN parent_id UUID REFERENCES messages(id),
13: ADD COLUMN deleted_at TIMESTAMP;
14: 
15: -- Add new columns to attachments
16: ALTER TABLE attachments
17: ADD COLUMN mime_type TEXT NOT NULL DEFAULT 'application/octet-stream',
18: ADD COLUMN checksum TEXT,
19: ADD COLUMN metadata JSONB,
20: ADD COLUMN deleted_at TIMESTAMP;
21: 
22: -- Add indexes to conversations
23: CREATE INDEX conversations_user_id_idx ON conversations(user_id);
24: CREATE INDEX conversations_title_idx ON conversations(title);
25: CREATE INDEX conversations_status_idx ON conversations(is_archived, deleted_at);
26: CREATE INDEX conversations_model_id_idx ON conversations(model_id);
27: CREATE INDEX conversations_user_active_idx ON conversations(user_id, is_archived, deleted_at);
28: 
29: -- Add indexes to messages
30: CREATE INDEX messages_conversation_id_idx ON messages(conversation_id);
31: CREATE INDEX messages_deleted_at_idx ON messages(deleted_at);
32: CREATE INDEX messages_role_idx ON messages(role);
33: CREATE INDEX messages_content_type_idx ON messages(content_type);
34: CREATE INDEX messages_timeline_idx ON messages(conversation_id, created_at);
35: CREATE INDEX messages_thread_idx ON messages(parent_id);
36: 
37: -- Add indexes to attachments
38: CREATE INDEX attachments_message_id_idx ON attachments(message_id);
39: CREATE INDEX attachments_file_type_idx ON attachments(file_type);
40: CREATE INDEX attachments_deleted_at_idx ON attachments(deleted_at);
41: CREATE UNIQUE INDEX attachments_file_path_key ON attachments(file_path);
42: 
43: -- Create updated_at trigger function
44: CREATE OR REPLACE FUNCTION update_updated_at()
45: RETURNS TRIGGER AS $$
46: BEGIN
47:   NEW.updated_at = CURRENT_TIMESTAMP;
48:   RETURN NEW;
49: END;
50: $$ language 'plpgsql';
51: 
52: -- Add triggers to all tables
53: CREATE TRIGGER update_conversations_updated_at
54:   BEFORE UPDATE ON conversations
55:   FOR EACH ROW
56:   EXECUTE FUNCTION update_updated_at();
57: 
58: CREATE TRIGGER update_messages_updated_at
59:   BEFORE UPDATE ON messages
60:   FOR EACH ROW
61:   EXECUTE FUNCTION update_updated_at();
62: 
63: CREATE TRIGGER update_attachments_updated_at
64:   BEFORE UPDATE ON attachments
65:   FOR EACH ROW
66:   EXECUTE FUNCTION update_updated_at();
```

## File: packages/db/src/schema/auth.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, boolean } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const users = pgTable("users", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   email: text("email").notNull().unique(),
 7:   hashedPassword: text("hashed_password").notNull(),
 8:   fullName: text("full_name").notNull(),
 9:   isActive: boolean("is_active").notNull().default(true),
10:   isVerified: boolean("is_verified").notNull().default(false),
11:   createdAt: timestamp("created_at").notNull().defaultNow(),
12:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
13: });
14: 
15: export const sessions = pgTable("sessions", {
16:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
17:   userId: uuid("user_id")
18:     .notNull()
19:     .references(() => users.id, { onDelete: "cascade" }),
20:   refreshToken: text("refresh_token").notNull(),
21:   expiresAt: timestamp("expires_at").notNull(),
22:   createdAt: timestamp("created_at").notNull().defaultNow(),
23:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
24: });
```

## File: packages/db/src/schema/cache.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, jsonb } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const keyValue = pgTable("key_value", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   key: text("key").notNull().unique(),
 7:   value: jsonb("value").notNull(),
 8:   expiresAt: timestamp("expires_at"),
 9:   createdAt: timestamp("created_at").notNull().defaultNow(),
10:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
11: });
```

## File: packages/db/src/schema/chat.ts
```typescript
  1: import { pgTable, uuid, text, timestamp, boolean, integer, jsonb, index, uniqueIndex } from "drizzle-orm/pg-core";
  2: import { createId } from "@paralleldrive/cuid2";
  3: import { users } from "./auth";
  4: import { sql } from "drizzle-orm";
  5: 
  6: // Valid message roles
  7: export const MESSAGE_ROLES = ['user', 'assistant', 'system', 'tool', 'function'] as const;
  8: 
  9: // Valid message content types
 10: export const CONTENT_TYPES = ['text', 'code', 'image', 'file'] as const;
 11: 
 12: export const conversations = pgTable("conversations", {
 13:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 14:   userId: uuid("user_id")
 15:     .notNull()
 16:     .references(() => users.id, { onDelete: "cascade" }),
 17:   title: text("title").notNull(),
 18:   modelId: text("model_id").notNull(), // Moved from metadata to proper column
 19:   description: text("description"),
 20:   isArchived: boolean("is_archived").notNull().default(false),
 21:   deletedAt: timestamp("deleted_at"),
 22:   metadata: jsonb("metadata"),
 23:   createdAt: timestamp("created_at").notNull().defaultNow(),
 24:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
 25: }, (table) => ({
 26:   // Index for user's conversations lookup
 27:   userIdIdx: index("conversations_user_id_idx").on(table.userId),
 28:   // Index for searching by title
 29:   titleIdx: index("conversations_title_idx").on(table.title),
 30:   // Index for soft deletes and archiving
 31:   statusIdx: index("conversations_status_idx").on(table.isArchived, table.deletedAt),
 32:   // Index for model-based queries
 33:   modelIdx: index("conversations_model_id_idx").on(table.modelId),
 34:   // Compound index for user's active conversations
 35:   userActiveIdx: index("conversations_user_active_idx").on(table.userId, table.isArchived, table.deletedAt),
 36: }));
 37: 
 38: export const messages = pgTable("messages", {
 39:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 40:   conversationId: uuid("conversation_id")
 41:     .notNull()
 42:     .references(() => conversations.id, { onDelete: "cascade" }),
 43:   role: text("role").notNull().$type<typeof MESSAGE_ROLES[number]>(),
 44:   content: text("content").notNull(),
 45:   contentType: text("content_type").notNull().$type<typeof CONTENT_TYPES[number]>().default('text'),
 46:   language: text("language"), // For code blocks
 47:   tokens: integer("tokens"), // Track token usage
 48:   metadata: jsonb("metadata"),
 49:   parentId: uuid("parent_id").references(() => messages.id), // For threaded conversations
 50:   deletedAt: timestamp("deleted_at"),
 51:   createdAt: timestamp("created_at").notNull().defaultNow(),
 52:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
 53: }, (table) => ({
 54:   // Index for conversation lookup
 55:   conversationIdx: index("messages_conversation_id_idx").on(table.conversationId),
 56:   // Index for soft deletes
 57:   deletedAtIdx: index("messages_deleted_at_idx").on(table.deletedAt),
 58:   // Index for role-based queries
 59:   roleIdx: index("messages_role_idx").on(table.role),
 60:   // Index for content type queries
 61:   contentTypeIdx: index("messages_content_type_idx").on(table.contentType),
 62:   // Compound index for conversation timeline
 63:   timelineIdx: index("messages_timeline_idx").on(table.conversationId, table.createdAt),
 64:   // Index for threaded messages
 65:   threadIdx: index("messages_thread_idx").on(table.parentId),
 66: }));
 67: 
 68: export const attachments = pgTable("attachments", {
 69:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 70:   messageId: uuid("message_id")
 71:     .notNull()
 72:     .references(() => messages.id, { onDelete: "cascade" }),
 73:   fileName: text("file_name").notNull(),
 74:   fileType: text("file_type").notNull(),
 75:   fileSize: integer("file_size").notNull(),
 76:   filePath: text("file_path").notNull(),
 77:   mimeType: text("mime_type").notNull(),
 78:   checksum: text("checksum").notNull(), // For file integrity
 79:   metadata: jsonb("metadata"),
 80:   deletedAt: timestamp("deleted_at"),
 81:   createdAt: timestamp("created_at").notNull().defaultNow(),
 82:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
 83: }, (table) => ({
 84:   // Index for message lookup
 85:   messageIdx: index("attachments_message_id_idx").on(table.messageId),
 86:   // Index for file type queries
 87:   fileTypeIdx: index("attachments_file_type_idx").on(table.fileType),
 88:   // Index for soft deletes
 89:   deletedAtIdx: index("attachments_deleted_at_idx").on(table.deletedAt),
 90:   // Unique constraint for file path
 91:   filePathKey: uniqueIndex("attachments_file_path_key").on(table.filePath),
 92: }));
 93: 
 94: // Trigger to automatically update updatedAt
 95: export const updateUpdatedAtTrigger = sql`
 96:   CREATE OR REPLACE FUNCTION update_updated_at()
 97:   RETURNS TRIGGER AS $$
 98:   BEGIN
 99:     NEW.updated_at = CURRENT_TIMESTAMP;
100:     RETURN NEW;
101:   END;
102:   $$ language 'plpgsql';
103: `;
```

## File: packages/db/src/schema/index.ts
```typescript
1: export * from "./auth";
2: export * from "./chat";
3: export * from "./vector";
4: export * from "./cache";
```

## File: packages/db/src/schema/vector.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, jsonb } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const embeddings = pgTable("embeddings", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   contentId: text("content_id").notNull(),
 7:   contentType: text("content_type").notNull(),
 8:   embedding: text("embedding").notNull(),
 9:   metadata: jsonb("metadata"),
10:   createdAt: timestamp("created_at").notNull().defaultNow(),
11:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
12: });
```

## File: packages/db/src/client.ts
```typescript
 1: import { drizzle } from "drizzle-orm/node-postgres";
 2: import { Pool } from "pg";
 3: import { createLogger } from "@danky/logger";
 4: import * as schema from "./schema";
 5: 
 6: const logger = createLogger("db");
 7: 
 8: // Load environment variables
 9: if (!process.env.DATABASE_URL) {
10:   throw new Error("DATABASE_URL environment variable is required");
11: }
12: 
13: // Configure connection pool
14: const pool = new Pool({
15:   connectionString: process.env.DATABASE_URL,
16:   // PgBouncer settings
17:   statement_timeout: 60000, // 1 minute
18:   max: 10, // Maximum number of clients in the pool
19:   idleTimeoutMillis: 30000, // How long a client is allowed to remain idle before being closed
20:   connectionTimeoutMillis: 2000, // How long to wait for a connection
21: });
22: 
23: // Add error handler
24: pool.on("error", (err) => {
25:   logger.error({ err }, "Unexpected error on idle client");
26:   process.exit(-1);
27: });
28: 
29: // Create Drizzle instance
30: export const db = drizzle(pool, { schema });
31: 
32: // Export pool for direct usage if needed
33: export { pool };
```

## File: packages/db/src/index.ts
```typescript
1: export * from "./client";
2: export * from "./schema";
```

## File: packages/db/src/migrate.ts
```typescript
 1: import { drizzle } from "drizzle-orm/postgres-js";
 2: import { migrate } from "drizzle-orm/postgres-js/migrator";
 3: import postgres from "postgres";
 4: import * as dotenv from "dotenv";
 5: import { resolve, dirname } from "path";
 6: import { fileURLToPath } from "url";
 7: 
 8: // Get the current file's directory
 9: const __filename = fileURLToPath(import.meta.url);
10: const __dirname = dirname(__filename);
11: 
12: // Load environment variables from the root .env file
13: const envPath = resolve(__dirname, "../../../.env");
14: console.log("Loading environment variables from:", envPath);
15: dotenv.config({ path: envPath });
16: 
17: // Construct the DATABASE_URL manually
18: const {
19:   POSTGRES_USER = "danky",
20:   POSTGRES_PASSWORD = "danky",
21:   POSTGRES_DB = "danky",
22:   POSTGRES_PORT = "5432",
23: } = process.env;
24: 
25: const DATABASE_URL = `postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:${POSTGRES_PORT}/${POSTGRES_DB}`;
26: 
27: console.log("Environment variables:", {
28:   DATABASE_URL,
29:   POSTGRES_USER,
30:   POSTGRES_PASSWORD,
31:   POSTGRES_DB,
32:   POSTGRES_PORT,
33: });
34: 
35: const runMigrations = async () => {
36:   if (!DATABASE_URL) {
37:     throw new Error("DATABASE_URL could not be constructed");
38:   }
39: 
40:   const sql = postgres(DATABASE_URL, { max: 1 });
41:   const db = drizzle(sql);
42: 
43:   try {
44:     await migrate(db, { migrationsFolder: "drizzle" });
45:     console.log("Migrations completed successfully");
46:   } catch (error) {
47:     console.error("Error running migrations:", error);
48:     throw error;
49:   } finally {
50:     await sql.end();
51:   }
52: };
53: 
54: runMigrations().catch((error) => {
55:   console.error("Migration script failed:", error);
56:   process.exit(1);
57: });
```

## File: packages/db/src/seed.ts
```typescript
 1: import { drizzle } from "drizzle-orm/node-postgres";
 2: import pkg from "pg";
 3: const { Pool } = pkg;
 4: import { createLogger } from "@danky/logger";
 5: import { users, sessions, conversations, messages } from "./schema";
 6: import * as dotenv from "dotenv";
 7: import { resolve, dirname } from "path";
 8: import { fileURLToPath } from "url";
 9: import { randomUUID } from "crypto";
10: 
11: // Get the current file's directory
12: const __filename = fileURLToPath(import.meta.url);
13: const __dirname = dirname(__filename);
14: 
15: // Load environment variables from the root .env file
16: dotenv.config({ path: resolve(__dirname, "../../../.env") });
17: 
18: const logger = createLogger("db:seed");
19: 
20: // Construct the DATABASE_URL manually
21: const {
22:   POSTGRES_USER = "danky",
23:   POSTGRES_PASSWORD = "danky",
24:   POSTGRES_DB = "danky",
25:   POSTGRES_PORT = "5432",
26: } = process.env;
27: 
28: const DATABASE_URL = `postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:${POSTGRES_PORT}/${POSTGRES_DB}`;
29: 
30: logger.info("Environment variables:", {
31:   DATABASE_URL,
32:   POSTGRES_USER,
33:   POSTGRES_PASSWORD,
34:   POSTGRES_DB,
35:   POSTGRES_PORT,
36: });
37: 
38: // Create a new pool for seeding
39: const pool = new Pool({
40:   connectionString: DATABASE_URL,
41: });
42: 
43: const db = drizzle(pool);
44: 
45: // Seed data
46: async function main() {
47:   logger.info("Seeding database...");
48:   
49:   try {
50:     // Create test user
51:     const [user] = await db.insert(users).values({
52:       id: randomUUID(),
53:       email: "test@example.com",
54:       hashedPassword: "hashed_password_here", // In production, use proper password hashing
55:       fullName: "Test User",
56:       isActive: true,
57:       isVerified: true,
58:     }).returning();
59: 
60:     logger.info({ userId: user.id }, "Created test user");
61: 
62:     // Create test conversation
63:     const [conversation] = await db.insert(conversations).values({
64:       id: randomUUID(),
65:       userId: user.id,
66:       title: "Test Conversation",
67:     }).returning();
68: 
69:     logger.info({ conversationId: conversation.id }, "Created test conversation");
70: 
71:     // Create test messages
72:     await db.insert(messages).values([
73:       {
74:         id: randomUUID(),
75:         conversationId: conversation.id,
76:         role: "user",
77:         content: "Hello, AI!",
78:       },
79:       {
80:         id: randomUUID(),
81:         conversationId: conversation.id,
82:         role: "assistant",
83:         content: "Hello! How can I help you today?",
84:       },
85:     ]);
86: 
87:     logger.info("Created test messages");
88:     logger.info("Seeding completed successfully");
89:   } catch (error) {
90:     logger.error({ error }, "Seeding failed");
91:     process.exit(1);
92:   }
93: 
94:   await pool.end();
95: }
96: 
97: main();
```

## File: packages/db/drizzle.config.ts
```typescript
 1: import type { Config } from "drizzle-kit";
 2: import * as dotenv from "dotenv";
 3: import { resolve } from "path";
 4: 
 5: // Load environment variables from the root .env file
 6: dotenv.config({ path: resolve(__dirname, "../../.env") });
 7: 
 8: if (!process.env.DATABASE_URL) {
 9:   throw new Error("DATABASE_URL environment variable is required");
10: }
11: 
12: export default {
13:   schema: "./src/schema/*",
14:   out: "./drizzle",
15:   driver: "pg",
16:   dbCredentials: {
17:     connectionString: process.env.DATABASE_URL,
18:   },
19: } satisfies Config;
```

## File: packages/db/package.json
```json
 1: {
 2:   "name": "@danky/db",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "clean": "rimraf .turbo node_modules dist",
15:     "generate": "drizzle-kit generate:pg",
16:     "migrate": "tsx src/migrate.ts",
17:     "studio": "drizzle-kit studio"
18:   },
19:   "dependencies": {
20:     "@danky/logger": "workspace:*",
21:     "@paralleldrive/cuid2": "^2.2.2",
22:     "dotenv": "^16.4.5",
23:     "pg": "^8.11.3",
24:     "postgres": "^3.4.3"
25:   },
26:   "devDependencies": {
27:     "@danky/typescript-config": "workspace:*",
28:     "@types/node": "^20.17.12",
29:     "@types/pg": "^8.11.10",
30:     "drizzle-kit": "^0.20.14",
31:     "drizzle-orm": "^0.29.5",
32:     "rimraf": "^5.0.5",
33:     "tsup": "^8.0.2",
34:     "tsx": "^4.7.1",
35:     "typescript": "^5.3.3"
36:   }
37: }
```

## File: packages/db/README.md
```markdown
  1: # @danky/db
  2: 
  3: Database schema, migrations, and utilities for the Danky AI Chatbot platform, built with Drizzle ORM.
  4: 
  5: ## Overview
  6: 
  7: The db package provides the database schema, migrations, and utilities for interacting with the PostgreSQL database. It uses Drizzle ORM for type-safe database operations and schema management.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13:  schema/          # Database schema definitions
 14:  migrations/      # Database migrations
 15:  queries/         # Reusable queries
 16:  utils/           # Database utilities
 17:  types/           # TypeScript types
 18: ```
 19: 
 20: ## Key Features
 21: 
 22: - **Type Safety**: Full TypeScript coverage
 23: - **Migrations**: Automated schema migrations
 24: - **Query Builder**: Type-safe query building
 25: - **Connection Pool**: Connection management
 26: - **Error Handling**: Custom error types
 27: - **Testing**: Database test utilities
 28: 
 29: ## Usage
 30: 
 31: ### Basic Query
 32: 
 33: ```typescript
 34: import { db } from '@danky/db'
 35: import { eq } from 'drizzle-orm'
 36: import { users } from './schema'
 37: 
 38: // Find user by ID
 39: const user = await db.query.users.findFirst({
 40:   where: eq(users.id, userId),
 41: })
 42: 
 43: // Insert new user
 44: const newUser = await db.insert(users).values({
 45:   name: 'John Doe',
 46:   email: 'john@example.com',
 47: }).returning()
 48: ```
 49: 
 50: ### Transactions
 51: 
 52: ```typescript
 53: import { db } from '@danky/db'
 54: 
 55: await db.transaction(async (tx) => {
 56:   const user = await tx.insert(users).values({
 57:     name: 'John Doe',
 58:   }).returning()
 59: 
 60:   await tx.insert(profiles).values({
 61:     userId: user.id,
 62:     bio: 'Hello world',
 63:   })
 64: })
 65: ```
 66: 
 67: ## AI Development Notes
 68: 
 69: ### Key Concepts
 70: 
 71: 1. **Schema Design**
 72:    - Table definitions
 73:    - Relationships
 74:    - Indexes
 75:    - Constraints
 76: 
 77: 2. **Query Patterns**
 78:    - CRUD operations
 79:    - Joins
 80:    - Aggregations
 81:    - Transactions
 82: 
 83: 3. **Error Handling**
 84:    - Connection errors
 85:    - Query errors
 86:    - Constraint violations
 87:    - Deadlocks
 88: 
 89: ### Common Patterns
 90: 
 91: #### Table Definition
 92: ```typescript
 93: import { pgTable, text, timestamp, uuid } from 'drizzle-orm/pg-core'
 94: 
 95: export const users = pgTable('users', {
 96:   id: uuid('id').primaryKey().defaultRandom(),
 97:   name: text('name').notNull(),
 98:   email: text('email').notNull().unique(),
 99:   createdAt: timestamp('created_at').defaultNow(),
100:   updatedAt: timestamp('updated_at').defaultNow(),
101: })
102: 
103: export const profiles = pgTable('profiles', {
104:   id: uuid('id').primaryKey().defaultRandom(),
105:   userId: uuid('user_id').references(() => users.id),
106:   bio: text('bio'),
107: })
108: ```
109: 
110: #### Query Builder
111: ```typescript
112: import { and, eq, like } from 'drizzle-orm'
113: 
114: const users = await db.query.users.findMany({
115:   where: and(
116:     eq(users.role, 'admin'),
117:     like(users.email, '%@example.com')
118:   ),
119:   with: {
120:     profile: true,
121:   },
122:   orderBy: users.createdAt,
123:   limit: 10,
124: })
125: ```
126: 
127: #### Error Handling
128: ```typescript
129: import { DatabaseError } from '@danky/db'
130: import { logger } from '@danky/logger'
131: 
132: try {
133:   await db.query.users.findFirst({
134:     where: eq(users.id, userId),
135:   })
136: } catch (error) {
137:   if (error instanceof DatabaseError) {
138:     logger.error({ error }, 'Database query failed')
139:     throw new Error('Failed to fetch user')
140:   }
141:   throw error
142: }
143: ```
144: 
145: ## Database Schema
146: 
147: ### Core Tables
148: - users
149: - sessions
150: - messages
151: - tools
152: - files
153: - events
154: 
155: ### Relationships
156: - User -> Messages (1:N)
157: - User -> Sessions (1:N)
158: - Message -> Files (N:M)
159: - Tool -> Events (1:N)
160: 
161: ## Development
162: 
163: ### Migrations
164: 
165: 1. Create migration:
166: ```bash
167: pnpm db:migration:create
168: ```
169: 
170: 2. Apply migrations:
171: ```bash
172: pnpm db:migrate
173: ```
174: 
175: 3. Rollback migration:
176: ```bash
177: pnpm db:rollback
178: ```
179: 
180: ### Testing
181: ```bash
182: pnpm test
183: pnpm test:watch
184: ```
185: 
186: ### Linting
187: ```bash
188: pnpm lint
189: pnpm type-check
190: ```
191: 
192: ## Configuration
193: 
194: ### Environment Variables
195: ```env
196: DATABASE_URL=postgresql://user:pass@localhost:5432/db
197: DATABASE_POOL_SIZE=10
198: DATABASE_IDLE_TIMEOUT=10000
199: ```
200: 
201: ### Connection Options
202: ```typescript
203: {
204:   connectionString: process.env.DATABASE_URL,
205:   ssl: process.env.NODE_ENV === 'production',
206:   max: parseInt(process.env.DATABASE_POOL_SIZE || '10'),
207:   idleTimeoutMillis: parseInt(process.env.DATABASE_IDLE_TIMEOUT || '10000'),
208: }
209: ```
210: 
211: ## Troubleshooting
212: 
213: ### Common Issues
214: 1. **Connection Errors**: Check credentials
215: 2. **Migration Failures**: Check schema changes
216: 3. **Performance Issues**: Check indexes
217: 4. **Deadlocks**: Check transaction patterns
218: 
219: ### Debug Tools
220: - pg_stat_statements
221: - explain analyze
222: - pgbouncer stats
223: - connection pooler
224: 
225: ## Additional Resources
226: 
227: - [Schema Documentation](../../docs/SCHEMA.md)
228: - [Migration Guide](../../docs/MIGRATIONS.md)
229: - [Query Patterns](../../docs/QUERIES.md)
230: - [Performance Guide](../../docs/PERFORMANCE.md)
```

## File: packages/db/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/base.json",
 3:   "include": ["src/**/*.ts"],
 4:   "exclude": ["node_modules", "dist"],
 5:   "compilerOptions": {
 6:     "outDir": "./dist",
 7:     "rootDir": "./src",
 8:     "module": "ESNext",
 9:     "moduleResolution": "bundler",
10:     "target": "ES2022",
11:     "lib": ["ES2022"],
12:     "declaration": true,
13:     "declarationMap": true,
14:     "sourceMap": true,
15:     "composite": true,
16:     "noEmit": false,
17:     "paths": {
18:       "@danky/logger": ["../logger/src"]
19:     }
20:   },
21:   "references": [
22:     { "path": "../logger" }
23:   ]
24: }
```

## File: packages/db/tsup.config.ts
```typescript
 1: import { defineConfig } from "tsup";
 2: 
 3: export default defineConfig({
 4:   entry: ["src/index.ts"],
 5:   format: ["cjs", "esm"],
 6:   dts: true,
 7:   splitting: false,
 8:   sourcemap: true,
 9:   clean: true,
10:   external: ["@danky/logger"],
11: });
```

## File: packages/eslint-config/base.js
```javascript
 1: import js from "@eslint/js";
 2: import eslintConfigPrettier from "eslint-config-prettier";
 3: import { FlatCompat } from "@eslint/eslintrc";
 4: import tseslint from "@typescript-eslint/eslint-plugin";
 5: import tsParser from "@typescript-eslint/parser";
 6: import onlyWarn from "eslint-plugin-only-warn";
 7: import globals from "globals";
 8: 
 9: const compat = new FlatCompat();
10: 
11: /** @type {import("eslint").Linter.FlatConfig[]} */
12: const config = [
13:   {
14:     ignores: [
15:       "node_modules/**",
16:       "dist/**",
17:       ".next/**",
18:       "coverage/**",
19:       "*.config.*",
20:     ],
21:   },
22:   js.configs.recommended,
23:   {
24:     files: ["**/*.{ts,tsx,js,jsx}"],
25:     plugins: {
26:       "@typescript-eslint": tseslint,
27:       "only-warn": onlyWarn,
28:     },
29:     languageOptions: {
30:       parser: tsParser,
31:       parserOptions: {
32:         project: true,
33:       },
34:       globals: {
35:         ...globals.browser,
36:         ...globals.node,
37:         ...globals.es2021,
38:       },
39:     },
40:     rules: {
41:       ...eslintConfigPrettier.rules,
42:       "@typescript-eslint/adjacent-overload-signatures": "error",
43:       "@typescript-eslint/ban-types": "error",
44:       "@typescript-eslint/no-explicit-any": "error",
45:       "@typescript-eslint/no-unused-vars": [
46:         "error",
47:         {
48:           argsIgnorePattern: "^_",
49:           varsIgnorePattern: "^_",
50:           caughtErrorsIgnorePattern: "^_",
51:         },
52:       ],
53:       "@typescript-eslint/consistent-type-imports": [
54:         "error",
55:         { prefer: "type-imports", fixStyle: "inline-type-imports" },
56:       ],
57:       "@typescript-eslint/consistent-type-assertions": "error",
58:       "@typescript-eslint/no-array-constructor": "error",
59:       "@typescript-eslint/no-empty-interface": "error",
60:       "@typescript-eslint/no-misused-new": "error",
61:       "@typescript-eslint/no-namespace": "error",
62:       "@typescript-eslint/no-this-alias": "error",
63:       "@typescript-eslint/prefer-as-const": "error",
64:       "@typescript-eslint/triple-slash-reference": "error",
65:       "@typescript-eslint/no-non-null-assertion": "error",
66:       "@typescript-eslint/no-inferrable-types": "error",
67:       "@typescript-eslint/no-unnecessary-type-assertion": "error",
68:       "@typescript-eslint/no-unnecessary-condition": "error",
69:       "@typescript-eslint/strict-boolean-expressions": "error",
70:       "@typescript-eslint/switch-exhaustiveness-check": "error",
71:       "@typescript-eslint/prefer-optional-chain": "error",
72:       "@typescript-eslint/prefer-nullish-coalescing": "error",
73:       "@typescript-eslint/no-floating-promises": "error",
74:       "@typescript-eslint/await-thenable": "error",
75:       "@typescript-eslint/no-misused-promises": "error",
76:       "@typescript-eslint/require-await": "error",
77:       "no-console": ["error", { allow: ["warn", "error"] }],
78:       "no-debugger": "error",
79:       "no-alert": "error",
80:     },
81:   },
82: ];
83: 
84: export default config;
```

## File: packages/eslint-config/index.js
```javascript
1: module.exports = { extends: ["next/core-web-vitals"], env: { node: true, browser: true, es6: true }, rules: { "@typescript-eslint/no-require-imports": "off" } }
```

## File: packages/eslint-config/next.js
```javascript
  1: import js from "@eslint/js";
  2: import eslintConfigPrettier from "eslint-config-prettier";
  3: import tseslint from "@typescript-eslint/eslint-plugin";
  4: import tsParser from "@typescript-eslint/parser";
  5: import pluginReactHooks from "eslint-plugin-react-hooks";
  6: import pluginReact from "eslint-plugin-react";
  7: import globals from "globals";
  8: import pluginNext from "@next/eslint-plugin-next";
  9: 
 10: /** @type {import("eslint").Linter.FlatConfig[]} */
 11: export default [
 12:   {
 13:     ignores: [
 14:       "node_modules/**",
 15:       "dist/**",
 16:       ".next/**",
 17:       "coverage/**",
 18:       "*.config.*",
 19:     ],
 20:   },
 21:   js.configs.recommended,
 22:   {
 23:     files: ["**/*.{ts,tsx,js,jsx}"],
 24:     plugins: {
 25:       "@typescript-eslint": tseslint,
 26:       react: pluginReact,
 27:       "react-hooks": pluginReactHooks,
 28:       "@next/next": pluginNext,
 29:     },
 30:     languageOptions: {
 31:       parser: tsParser,
 32:       parserOptions: {
 33:         project: true,
 34:         ecmaFeatures: {
 35:           jsx: true,
 36:         },
 37:       },
 38:       globals: {
 39:         ...globals.browser,
 40:         ...globals.node,
 41:         ...globals.es2021,
 42:         React: "readonly",
 43:       },
 44:     },
 45:     settings: {
 46:       react: {
 47:         version: "detect",
 48:       },
 49:     },
 50:     rules: {
 51:       ...eslintConfigPrettier.rules,
 52:       ...pluginNext.configs.recommended.rules,
 53:       ...pluginNext.configs["core-web-vitals"].rules,
 54:       // TypeScript Rules
 55:       "@typescript-eslint/adjacent-overload-signatures": "error",
 56:       "@typescript-eslint/ban-types": "error",
 57:       "@typescript-eslint/no-explicit-any": "error",
 58:       "@typescript-eslint/no-unused-vars": [
 59:         "error",
 60:         {
 61:           argsIgnorePattern: "^_",
 62:           varsIgnorePattern: "^_",
 63:           caughtErrorsIgnorePattern: "^_",
 64:         },
 65:       ],
 66:       "@typescript-eslint/consistent-type-imports": [
 67:         "error",
 68:         { prefer: "type-imports", fixStyle: "inline-type-imports" },
 69:       ],
 70:       "@typescript-eslint/consistent-type-assertions": "error",
 71:       "@typescript-eslint/no-array-constructor": "error",
 72:       "@typescript-eslint/no-empty-interface": "error",
 73:       "@typescript-eslint/no-misused-new": "error",
 74:       "@typescript-eslint/no-namespace": "error",
 75:       "@typescript-eslint/no-this-alias": "error",
 76:       "@typescript-eslint/prefer-as-const": "error",
 77:       "@typescript-eslint/triple-slash-reference": "error",
 78:       "@typescript-eslint/no-non-null-assertion": "error",
 79:       "@typescript-eslint/no-inferrable-types": "error",
 80:       "@typescript-eslint/no-unnecessary-type-assertion": "error",
 81:       "@typescript-eslint/no-unnecessary-condition": "error",
 82:       "@typescript-eslint/strict-boolean-expressions": "error",
 83:       "@typescript-eslint/switch-exhaustiveness-check": "error",
 84:       "@typescript-eslint/prefer-optional-chain": "error",
 85:       "@typescript-eslint/prefer-nullish-coalescing": "error",
 86:       "@typescript-eslint/no-floating-promises": "error",
 87:       "@typescript-eslint/await-thenable": "error",
 88:       "@typescript-eslint/no-misused-promises": "error",
 89:       "@typescript-eslint/require-await": "error",
 90:       // React Rules
 91:       "react/jsx-uses-react": "off",
 92:       "react/react-in-jsx-scope": "off",
 93:       "react/prop-types": "off",
 94:       "react/jsx-key": "error",
 95:       "react/jsx-no-duplicate-props": "error",
 96:       "react/jsx-no-undef": "error",
 97:       "react/no-children-prop": "error",
 98:       "react/no-danger-with-children": "error",
 99:       "react/no-deprecated": "error",
100:       "react/no-direct-mutation-state": "error",
101:       "react/no-find-dom-node": "error",
102:       "react/no-is-mounted": "error",
103:       "react/no-render-return-value": "error",
104:       "react/no-string-refs": "error",
105:       "react/no-unescaped-entities": "error",
106:       "react/no-unknown-property": [
107:         "error",
108:         { ignore: ["cmdk-input-wrapper"] },
109:       ],
110:       "react/no-unsafe": "off",
111:       // React Hooks Rules
112:       "react-hooks/rules-of-hooks": "error",
113:       "react-hooks/exhaustive-deps": "error",
114:       // General Rules
115:       "no-console": ["error", { allow: ["warn", "error"] }],
116:       "no-debugger": "error",
117:       "no-alert": "error",
118:       "no-unused-vars": "off", // Use @typescript-eslint/no-unused-vars instead
119:     },
120:   },
121: ];
```

## File: packages/eslint-config/package.json
```json
 1: {
 2:   "name": "@danky/eslint-config",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "exports": {
 7:     "./base": "./base.js",
 8:     "./react-internal": "./react-internal.js",
 9:     "./next": "./next.js"
10:   },
11:   "main": "./base.js",
12:   "files": [
13:     "base.js",
14:     "react-internal.js",
15:     "next.js"
16:   ],
17:   "dependencies": {
18:     "@eslint/eslintrc": "^3.0.0",
19:     "@eslint/js": "^9.0.0",
20:     "@typescript-eslint/eslint-plugin": "^7.0.0",
21:     "@typescript-eslint/parser": "^7.0.0",
22:     "eslint-config-prettier": "^9.1.0",
23:     "eslint-config-turbo": "^1.11.2",
24:     "eslint-plugin-only-warn": "^1.1.0",
25:     "eslint-plugin-react": "^7.33.2",
26:     "eslint-plugin-react-hooks": "^4.6.0",
27:     "eslint-plugin-turbo": "^1.13.4",
28:     "globals": "^13.24.0"
29:   },
30:   "peerDependencies": {
31:     "eslint": "^9.0.0",
32:     "typescript": ">=4.7.4"
33:   }
34: }
```

## File: packages/eslint-config/react-internal.js
```javascript
 1: import js from "@eslint/js";
 2: import eslintConfigPrettier from "eslint-config-prettier";
 3: import tseslint from "@typescript-eslint/eslint-plugin";
 4: import tsParser from "@typescript-eslint/parser";
 5: import pluginReactHooks from "eslint-plugin-react-hooks";
 6: import pluginReact from "eslint-plugin-react";
 7: import globals from "globals";
 8: import baseConfig from "./base.js";
 9: 
10: /** @type {import("eslint").Linter.FlatConfig[]} */
11: const config = [
12:   {
13:     ignores: ["node_modules/**", "dist/**", ".next/**", "coverage/**", "*.config.*"],
14:   },
15:   ...baseConfig,
16:   js.configs.recommended,
17:   {
18:     files: ["**/*.{ts,tsx,js,jsx}"],
19:     plugins: {
20:       "@typescript-eslint": tseslint,
21:       "react": pluginReact,
22:       "react-hooks": pluginReactHooks,
23:     },
24:     languageOptions: {
25:       parser: tsParser,
26:       parserOptions: {
27:         project: true,
28:         ecmaFeatures: {
29:           jsx: true,
30:         },
31:       },
32:       globals: {
33:         ...globals.browser,
34:         ...globals.node,
35:         ...globals.es2021,
36:         React: "readonly",
37:       },
38:     },
39:     settings: {
40:       react: {
41:         version: "detect",
42:       },
43:     },
44:     rules: {
45:       ...eslintConfigPrettier.rules,
46:       // React Rules
47:       "react/jsx-uses-react": "off",
48:       "react/react-in-jsx-scope": "off",
49:       "react/prop-types": "off",
50:       "react/jsx-key": "error",
51:       "react/jsx-no-duplicate-props": "error",
52:       "react/jsx-no-undef": "error",
53:       "react/no-children-prop": "error",
54:       "react/no-danger-with-children": "error",
55:       "react/no-deprecated": "error",
56:       "react/no-direct-mutation-state": "error",
57:       "react/no-find-dom-node": "error",
58:       "react/no-is-mounted": "error",
59:       "react/no-render-return-value": "error",
60:       "react/no-string-refs": "error",
61:       "react/no-unescaped-entities": "error",
62:       "react/no-unknown-property": ["error", { ignore: ["cmdk-input-wrapper"] }],
63:       "react/no-unsafe": "off",
64:       // React Hooks Rules
65:       "react-hooks/rules-of-hooks": "error",
66:       "react-hooks/exhaustive-deps": "warn",
67:       // TypeScript Rules
68:       "@typescript-eslint/no-explicit-any": "warn",
69:       "@typescript-eslint/no-unused-vars": ["warn", { argsIgnorePattern: "^_" }],
70:       "@typescript-eslint/consistent-type-imports": [
71:         "warn",
72:         { prefer: "type-imports", fixStyle: "inline-type-imports" },
73:       ],
74:       "no-unused-vars": "off", // Use @typescript-eslint/no-unused-vars instead
75:     },
76:   },
77: ];
78: 
79: export default config;
```

## File: packages/eslint-config/README.md
```markdown
1: # `@turbo/eslint-config`
2: 
3: Collection of internal eslint configurations.
```

## File: packages/logger/src/index.ts
```typescript
 1: import pino from "pino";
 2: import type { Logger } from "pino";
 3: 
 4: const logger = pino({
 5:   name: "danky",
 6:   transport: {
 7:     target: "pino-pretty",
 8:     options: {
 9:       colorize: true,
10:     },
11:   },
12:   level: process.env["LOG_LEVEL"] && process.env["LOG_LEVEL"].length > 0
13:     ? process.env["LOG_LEVEL"]
14:     : "info",
15: });
16: 
17: export type { Logger };
18: export default logger;
```

## File: packages/logger/eslint.config.js
```javascript
1: import baseConfig from "@danky/eslint-config/base";
2: 
3: export default [...baseConfig];
```

## File: packages/logger/package.json
```json
 1: {
 2:   "name": "@danky/logger",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "clean": "rimraf .turbo node_modules dist",
15:     "dev": "tsup --watch",
16:     "lint": "eslint .",
17:     "type-check": "tsc --noEmit"
18:   },
19:   "dependencies": {
20:     "pino": "^8.17.2",
21:     "pino-pretty": "^10.3.1"
22:   },
23:   "devDependencies": {
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^20.10.6",
27:     "@types/pino": "7.0.5",
28:     "eslint": "^8.56.0",
29:     "rimraf": "^5.0.5",
30:     "tsup": "^8.0.1",
31:     "typescript": "^5.3.3"
32:   }
33: }
```

## File: packages/logger/README.md
```markdown
  1: # @danky/logger
  2: 
  3: Structured logging utilities for the Danky AI Chatbot platform, built with Pino.
  4: 
  5: ## Overview
  6: 
  7: The logger package provides a standardized logging interface across the platform, with support for structured logging, log levels, and various transports. It's built on top of Pino for high performance.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13:  config/          # Logger configuration
 14:  transports/      # Log transports
 15:  formatters/      # Log formatters
 16:  types/           # TypeScript types
 17: ```
 18: 
 19: ## Key Features
 20: 
 21: - **Structured Logging**: JSON-based log format
 22: - **Performance**: High-speed logging with Pino
 23: - **Type Safety**: Full TypeScript coverage
 24: - **Log Levels**: Configurable log levels
 25: - **Transports**: Multiple output targets
 26: - **Context**: Request-scoped logging
 27: 
 28: ## Usage
 29: 
 30: ### Basic Logging
 31: 
 32: ```typescript
 33: import { logger } from '@danky/logger'
 34: 
 35: // Simple logging
 36: logger.info('Hello world')
 37: 
 38: // With context
 39: logger.info({ userId: '123' }, 'User logged in')
 40: 
 41: // Error logging
 42: try {
 43:   throw new Error('Something went wrong')
 44: } catch (error) {
 45:   logger.error({ error }, 'Operation failed')
 46: }
 47: ```
 48: 
 49: ### Request Context
 50: 
 51: ```typescript
 52: import { withRequestContext } from '@danky/logger'
 53: 
 54: export async function handler(req: Request) {
 55:   const log = withRequestContext(req)
 56:   log.info('Processing request')
 57: 
 58:   try {
 59:     // Operation
 60:   } catch (error) {
 61:     log.error({ error }, 'Request failed')
 62:   }
 63: }
 64: ```
 65: 
 66: ## AI Development Notes
 67: 
 68: ### Key Concepts
 69: 
 70: 1. **Log Levels**
 71:    - trace: Verbose debugging
 72:    - debug: Debugging information
 73:    - info: General information
 74:    - warn: Warning messages
 75:    - error: Error messages
 76:    - fatal: Critical errors
 77: 
 78: 2. **Context Management**
 79:    - Request-scoped logging
 80:    - Error serialization
 81:    - Performance metrics
 82:    - User context
 83: 
 84: 3. **Best Practices**
 85:    - Use structured data
 86:    - Include error stacks
 87:    - Add request IDs
 88:    - Keep messages concise
 89: 
 90: ### Common Patterns
 91: 
 92: #### Error Logging
 93: ```typescript
 94: import { logger } from '@danky/logger'
 95: 
 96: try {
 97:   await operation()
 98: } catch (error) {
 99:   logger.error({
100:     error,
101:     context: {
102:       operation: 'operation_name',
103:       input: data,
104:     },
105:   }, 'Operation failed')
106:   throw error
107: }
108: ```
109: 
110: #### Performance Logging
111: ```typescript
112: import { logger } from '@danky/logger'
113: 
114: const start = performance.now()
115: try {
116:   await operation()
117: } finally {
118:   const duration = performance.now() - start
119:   logger.info({ duration }, 'Operation completed')
120: }
121: ```
122: 
123: #### Request Logging
124: ```typescript
125: import { logger } from '@danky/logger'
126: 
127: export async function middleware(req: Request) {
128:   const requestId = crypto.randomUUID()
129:   const log = logger.child({ requestId })
130: 
131:   log.info({
132:     method: req.method,
133:     url: req.url,
134:   }, 'Request received')
135: 
136:   try {
137:     const response = await handler(req)
138:     log.info({ status: response.status }, 'Request completed')
139:     return response
140:   } catch (error) {
141:     log.error({ error }, 'Request failed')
142:     throw error
143:   }
144: }
145: ```
146: 
147: ## Configuration
148: 
149: ### Environment Variables
150: ```env
151: LOG_LEVEL=info
152: LOG_PRETTY=true
153: LOG_FILE=logs/app.log
154: ```
155: 
156: ### Logger Options
157: ```typescript
158: {
159:   level: 'info',
160:   transport: {
161:     target: 'pino-pretty',
162:     options: {
163:       colorize: true,
164:     },
165:   },
166:   serializers: {
167:     error: errorSerializer,
168:     request: requestSerializer,
169:   },
170: }
171: ```
172: 
173: ## Development
174: 
175: ### Setup
176: ```bash
177: pnpm install
178: pnpm build
179: ```
180: 
181: ### Testing
182: ```bash
183: pnpm test
184: pnpm test:watch
185: ```
186: 
187: ### Linting
188: ```bash
189: pnpm lint
190: pnpm type-check
191: ```
192: 
193: ## Troubleshooting
194: 
195: ### Common Issues
196: 1. **Performance**: Check log levels
197: 2. **Memory Usage**: Monitor log size
198: 3. **Missing Context**: Verify child loggers
199: 4. **Transport Errors**: Check file permissions
200: 
201: ### Debug Tools
202: - pino-pretty for development
203: - pino-tee for splitting output
204: - pino-debug for debug logs
205: 
206: ## Additional Resources
207: 
208: - [Logging Best Practices](../../docs/LOGGING.md)
209: - [Error Handling Guide](../../docs/ERRORS.md)
210: - [Performance Guide](../../docs/PERFORMANCE.md)
211: - [Monitoring Guide](../../docs/MONITORING.md)
```

## File: packages/logger/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     },
10:     "composite": true,
11:     "noEmit": false
12:   },
13:   "include": ["src"],
14:   "exclude": ["node_modules", "dist"]
15: }
```

## File: packages/logger/tsconfig.tsbuildinfo
```
1: {"fileNames":["../../node_modules/typescript/lib/lib.es5.d.ts","../../node_modules/typescript/lib/lib.es2015.d.ts","../../node_modules/typescript/lib/lib.es2016.d.ts","../../node_modules/typescript/lib/lib.es2017.d.ts","../../node_modules/typescript/lib/lib.es2018.d.ts","../../node_modules/typescript/lib/lib.es2019.d.ts","../../node_modules/typescript/lib/lib.es2020.d.ts","../../node_modules/typescript/lib/lib.es2021.d.ts","../../node_modules/typescript/lib/lib.es2022.d.ts","../../node_modules/typescript/lib/lib.dom.d.ts","../../node_modules/typescript/lib/lib.dom.iterable.d.ts","../../node_modules/typescript/lib/lib.es2015.core.d.ts","../../node_modules/typescript/lib/lib.es2015.collection.d.ts","../../node_modules/typescript/lib/lib.es2015.generator.d.ts","../../node_modules/typescript/lib/lib.es2015.iterable.d.ts","../../node_modules/typescript/lib/lib.es2015.promise.d.ts","../../node_modules/typescript/lib/lib.es2015.proxy.d.ts","../../node_modules/typescript/lib/lib.es2015.reflect.d.ts","../../node_modules/typescript/lib/lib.es2015.symbol.d.ts","../../node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","../../node_modules/typescript/lib/lib.es2016.array.include.d.ts","../../node_modules/typescript/lib/lib.es2016.intl.d.ts","../../node_modules/typescript/lib/lib.es2017.arraybuffer.d.ts","../../node_modules/typescript/lib/lib.es2017.date.d.ts","../../node_modules/typescript/lib/lib.es2017.object.d.ts","../../node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","../../node_modules/typescript/lib/lib.es2017.string.d.ts","../../node_modules/typescript/lib/lib.es2017.intl.d.ts","../../node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","../../node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","../../node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","../../node_modules/typescript/lib/lib.es2018.intl.d.ts","../../node_modules/typescript/lib/lib.es2018.promise.d.ts","../../node_modules/typescript/lib/lib.es2018.regexp.d.ts","../../node_modules/typescript/lib/lib.es2019.array.d.ts","../../node_modules/typescript/lib/lib.es2019.object.d.ts","../../node_modules/typescript/lib/lib.es2019.string.d.ts","../../node_modules/typescript/lib/lib.es2019.symbol.d.ts","../../node_modules/typescript/lib/lib.es2019.intl.d.ts","../../node_modules/typescript/lib/lib.es2020.bigint.d.ts","../../node_modules/typescript/lib/lib.es2020.date.d.ts","../../node_modules/typescript/lib/lib.es2020.promise.d.ts","../../node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","../../node_modules/typescript/lib/lib.es2020.string.d.ts","../../node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","../../node_modules/typescript/lib/lib.es2020.intl.d.ts","../../node_modules/typescript/lib/lib.es2020.number.d.ts","../../node_modules/typescript/lib/lib.es2021.promise.d.ts","../../node_modules/typescript/lib/lib.es2021.string.d.ts","../../node_modules/typescript/lib/lib.es2021.weakref.d.ts","../../node_modules/typescript/lib/lib.es2021.intl.d.ts","../../node_modules/typescript/lib/lib.es2022.array.d.ts","../../node_modules/typescript/lib/lib.es2022.error.d.ts","../../node_modules/typescript/lib/lib.es2022.intl.d.ts","../../node_modules/typescript/lib/lib.es2022.object.d.ts","../../node_modules/typescript/lib/lib.es2022.string.d.ts","../../node_modules/typescript/lib/lib.es2022.regexp.d.ts","../../node_modules/typescript/lib/lib.decorators.d.ts","../../node_modules/typescript/lib/lib.decorators.legacy.d.ts","../../node_modules/@types/node/compatibility/disposable.d.ts","../../node_modules/@types/node/compatibility/indexable.d.ts","../../node_modules/@types/node/compatibility/iterators.d.ts","../../node_modules/@types/node/compatibility/index.d.ts","../../node_modules/@types/node/globals.typedarray.d.ts","../../node_modules/@types/node/buffer.buffer.d.ts","../../node_modules/buffer/index.d.ts","../../node_modules/@types/node/node_modules/undici-types/header.d.ts","../../node_modules/@types/node/node_modules/undici-types/readable.d.ts","../../node_modules/@types/node/node_modules/undici-types/file.d.ts","../../node_modules/@types/node/node_modules/undici-types/fetch.d.ts","../../node_modules/@types/node/node_modules/undici-types/formdata.d.ts","../../node_modules/@types/node/node_modules/undici-types/connector.d.ts","../../node_modules/@types/node/node_modules/undici-types/client.d.ts","../../node_modules/@types/node/node_modules/undici-types/errors.d.ts","../../node_modules/@types/node/node_modules/undici-types/dispatcher.d.ts","../../node_modules/@types/node/node_modules/undici-types/global-dispatcher.d.ts","../../node_modules/@types/node/node_modules/undici-types/global-origin.d.ts","../../node_modules/@types/node/node_modules/undici-types/pool-stats.d.ts","../../node_modules/@types/node/node_modules/undici-types/pool.d.ts","../../node_modules/@types/node/node_modules/undici-types/handlers.d.ts","../../node_modules/@types/node/node_modules/undici-types/balanced-pool.d.ts","../../node_modules/@types/node/node_modules/undici-types/agent.d.ts","../../node_modules/@types/node/node_modules/undici-types/mock-interceptor.d.ts","../../node_modules/@types/node/node_modules/undici-types/mock-agent.d.ts","../../node_modules/@types/node/node_modules/undici-types/mock-client.d.ts","../../node_modules/@types/node/node_modules/undici-types/mock-pool.d.ts","../../node_modules/@types/node/node_modules/undici-types/mock-errors.d.ts","../../node_modules/@types/node/node_modules/undici-types/proxy-agent.d.ts","../../node_modules/@types/node/node_modules/undici-types/env-http-proxy-agent.d.ts","../../node_modules/@types/node/node_modules/undici-types/retry-handler.d.ts","../../node_modules/@types/node/node_modules/undici-types/retry-agent.d.ts","../../node_modules/@types/node/node_modules/undici-types/api.d.ts","../../node_modules/@types/node/node_modules/undici-types/interceptors.d.ts","../../node_modules/@types/node/node_modules/undici-types/util.d.ts","../../node_modules/@types/node/node_modules/undici-types/cookies.d.ts","../../node_modules/@types/node/node_modules/undici-types/patch.d.ts","../../node_modules/@types/node/node_modules/undici-types/websocket.d.ts","../../node_modules/@types/node/node_modules/undici-types/eventsource.d.ts","../../node_modules/@types/node/node_modules/undici-types/filereader.d.ts","../../node_modules/@types/node/node_modules/undici-types/diagnostics-channel.d.ts","../../node_modules/@types/node/node_modules/undici-types/content-type.d.ts","../../node_modules/@types/node/node_modules/undici-types/cache.d.ts","../../node_modules/@types/node/node_modules/undici-types/index.d.ts","../../node_modules/@types/node/globals.d.ts","../../node_modules/@types/node/assert.d.ts","../../node_modules/@types/node/assert/strict.d.ts","../../node_modules/@types/node/async_hooks.d.ts","../../node_modules/@types/node/buffer.d.ts","../../node_modules/@types/node/child_process.d.ts","../../node_modules/@types/node/cluster.d.ts","../../node_modules/@types/node/console.d.ts","../../node_modules/@types/node/constants.d.ts","../../node_modules/@types/node/crypto.d.ts","../../node_modules/@types/node/dgram.d.ts","../../node_modules/@types/node/diagnostics_channel.d.ts","../../node_modules/@types/node/dns.d.ts","../../node_modules/@types/node/dns/promises.d.ts","../../node_modules/@types/node/domain.d.ts","../../node_modules/@types/node/dom-events.d.ts","../../node_modules/@types/node/events.d.ts","../../node_modules/@types/node/fs.d.ts","../../node_modules/@types/node/fs/promises.d.ts","../../node_modules/@types/node/http.d.ts","../../node_modules/@types/node/http2.d.ts","../../node_modules/@types/node/https.d.ts","../../node_modules/@types/node/inspector.d.ts","../../node_modules/@types/node/module.d.ts","../../node_modules/@types/node/net.d.ts","../../node_modules/@types/node/os.d.ts","../../node_modules/@types/node/path.d.ts","../../node_modules/@types/node/perf_hooks.d.ts","../../node_modules/@types/node/process.d.ts","../../node_modules/@types/node/punycode.d.ts","../../node_modules/@types/node/querystring.d.ts","../../node_modules/@types/node/readline.d.ts","../../node_modules/@types/node/readline/promises.d.ts","../../node_modules/@types/node/repl.d.ts","../../node_modules/@types/node/sea.d.ts","../../node_modules/@types/node/stream.d.ts","../../node_modules/@types/node/stream/promises.d.ts","../../node_modules/@types/node/stream/consumers.d.ts","../../node_modules/@types/node/stream/web.d.ts","../../node_modules/@types/node/string_decoder.d.ts","../../node_modules/@types/node/test.d.ts","../../node_modules/@types/node/timers.d.ts","../../node_modules/@types/node/timers/promises.d.ts","../../node_modules/@types/node/tls.d.ts","../../node_modules/@types/node/trace_events.d.ts","../../node_modules/@types/node/tty.d.ts","../../node_modules/@types/node/url.d.ts","../../node_modules/@types/node/util.d.ts","../../node_modules/@types/node/v8.d.ts","../../node_modules/@types/node/vm.d.ts","../../node_modules/@types/node/wasi.d.ts","../../node_modules/@types/node/worker_threads.d.ts","../../node_modules/@types/node/zlib.d.ts","../../node_modules/@types/node/index.d.ts","../../node_modules/pino-std-serializers/index.d.ts","../../node_modules/sonic-boom/types/index.d.ts","../../node_modules/pino/pino.d.ts","./src/index.ts"],"fileIdsList":[[65,105,108],[65,107,108],[108],[65,108,113,142],[65,108,109,114,120,121,128,139,150],[65,108,109,110,120,128],[65,108],[60,61,62,65,108],[65,108,111,151],[65,108,112,113,121,129],[65,108,113,139,147],[65,108,114,116,120,128],[65,107,108,115],[65,108,116,117],[65,108,120],[65,108,118,120],[65,107,108,120],[65,108,120,121,122,139,150],[65,108,120,121,122,135,139,142],[65,103,108,155],[65,108,116,120,123,128,139,150],[65,108,120,121,123,124,128,139,147,150],[65,108,123,125,139,147,150],[63,64,65,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156],[65,108,120,126],[65,108,127,150,155],[65,108,116,120,128,139],[65,75,79,108,150],[65,75,108,139,150],[65,70,108],[65,72,75,108,147,150],[65,108,128,147],[65,108,157],[65,70,108,157],[65,72,75,108,128,150],[65,67,68,71,74,108,120,139,150],[65,75,82,108],[65,67,73,108],[65,75,96,97,108],[65,71,75,108,142,150,157],[65,96,108,157],[65,69,70,108,157],[65,75,108],[65,69,70,71,72,73,74,75,76,77,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,97,98,99,100,101,102,108],[65,75,90,108],[65,75,82,83,108],[65,73,75,83,84,108],[65,74,108],[65,67,70,75,108],[65,75,79,83,84,108],[65,79,108],[65,73,75,78,108,150],[65,67,72,75,82,108],[65,108,139],[65,70,75,96,108,155,157],[65,108,129],[65,108,130],[65,107,108,131],[65,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156],[65,108,133],[65,108,134],[65,108,120,135,136],[65,108,135,137,151,153],[65,108,120,139,140,141,142],[65,108,139,141],[65,108,139,140],[65,108,142],[65,108,143],[65,105,108,139],[65,108,120,145,146],[65,108,145,146],[65,108,113,128,139,147],[65,108,148],[65,108,128,149],[65,108,123,134,150],[65,108,113,151],[65,108,139,152],[65,108,127,153],[65,108,154],[65,108,113,120,122,131,139,150,153,155],[65,108,139,156],[65,108,123,157],[65,108,120,155,158,159],[65,108,120,157],[65,108,160]],"fileInfos":[{"version":"e41c290ef7dd7dab3493e6cbe5909e0148edf4a8dad0271be08edec368a0f7b9","affectsGlobalScope":true,"impliedFormat":1},{"version":"45b7ab580deca34ae9729e97c13cfd999df04416a79116c3bfb483804f85ded4","impliedFormat":1},{"version":"3facaf05f0c5fc569c5649dd359892c98a85557e3e0c847964caeb67076f4d75","impliedFormat":1},{"version":"e44bb8bbac7f10ecc786703fe0a6a4b952189f908707980ba8f3c8975a760962","impliedFormat":1},{"version":"5e1c4c362065a6b95ff952c0eab010f04dcd2c3494e813b493ecfd4fcb9fc0d8","impliedFormat":1},{"version":"68d73b4a11549f9c0b7d352d10e91e5dca8faa3322bfb77b661839c42b1ddec7","impliedFormat":1},{"version":"5efce4fc3c29ea84e8928f97adec086e3dc876365e0982cc8479a07954a3efd4","impliedFormat":1},{"version":"feecb1be483ed332fad555aff858affd90a48ab19ba7272ee084704eb7167569","impliedFormat":1},{"version":"ee7bad0c15b58988daa84371e0b89d313b762ab83cb5b31b8a2d1162e8eb41c2","impliedFormat":1},{"version":"4fd3f3422b2d2a3dfd5cdd0f387b3a8ec45f006c6ea896a4cb41264c2100bb2c","affectsGlobalScope":true,"impliedFormat":1},{"version":"69e65d976bf166ce4a9e6f6c18f94d2424bf116e90837ace179610dbccad9b42","affectsGlobalScope":true,"impliedFormat":1},{"version":"c57796738e7f83dbc4b8e65132f11a377649c00dd3eee333f672b8f0a6bea671","affectsGlobalScope":true,"impliedFormat":1},{"version":"dc2df20b1bcdc8c2d34af4926e2c3ab15ffe1160a63e58b7e09833f616efff44","affectsGlobalScope":true,"impliedFormat":1},{"version":"515d0b7b9bea2e31ea4ec968e9edd2c39d3eebf4a2d5cbd04e88639819ae3b71","affectsGlobalScope":true,"impliedFormat":1},{"version":"62bb211266ee48b2d0edf0d8d1b191f0c24fc379a82bd4c1692a082c540bc6b1","affectsGlobalScope":true,"impliedFormat":1},{"version":"0dc1e7ceda9b8b9b455c3a2d67b0412feab00bd2f66656cd8850e8831b08b537","affectsGlobalScope":true,"impliedFormat":1},{"version":"ce691fb9e5c64efb9547083e4a34091bcbe5bdb41027e310ebba8f7d96a98671","affectsGlobalScope":true,"impliedFormat":1},{"version":"8d697a2a929a5fcb38b7a65594020fcef05ec1630804a33748829c5ff53640d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ff2a353abf8a80ee399af572debb8faab2d33ad38c4b4474cff7f26e7653b8d","affectsGlobalScope":true,"impliedFormat":1},{"version":"936e80ad36a2ee83fc3caf008e7c4c5afe45b3cf3d5c24408f039c1d47bdc1df","affectsGlobalScope":true,"impliedFormat":1},{"version":"d15bea3d62cbbdb9797079416b8ac375ae99162a7fba5de2c6c505446486ac0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"68d18b664c9d32a7336a70235958b8997ebc1c3b8505f4f1ae2b7e7753b87618","affectsGlobalScope":true,"impliedFormat":1},{"version":"eb3d66c8327153d8fa7dd03f9c58d351107fe824c79e9b56b462935176cdf12a","affectsGlobalScope":true,"impliedFormat":1},{"version":"38f0219c9e23c915ef9790ab1d680440d95419ad264816fa15009a8851e79119","affectsGlobalScope":true,"impliedFormat":1},{"version":"69ab18c3b76cd9b1be3d188eaf8bba06112ebbe2f47f6c322b5105a6fbc45a2e","affectsGlobalScope":true,"impliedFormat":1},{"version":"fef8cfad2e2dc5f5b3d97a6f4f2e92848eb1b88e897bb7318cef0e2820bceaab","affectsGlobalScope":true,"impliedFormat":1},{"version":"2f11ff796926e0832f9ae148008138ad583bd181899ab7dd768a2666700b1893","affectsGlobalScope":true,"impliedFormat":1},{"version":"4de680d5bb41c17f7f68e0419412ca23c98d5749dcaaea1896172f06435891fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"954296b30da6d508a104a3a0b5d96b76495c709785c1d11610908e63481ee667","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac9538681b19688c8eae65811b329d3744af679e0bdfa5d842d0e32524c73e1c","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a969edff4bd52585473d24995c5ef223f6652d6ef46193309b3921d65dd4376","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e9fbd7030c440b33d021da145d3232984c8bb7916f277e8ffd3dc2e3eae2bdb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811ec78f7fefcabbda4bfa93b3eb67d9ae166ef95f9bff989d964061cbf81a0c","affectsGlobalScope":true,"impliedFormat":1},{"version":"717937616a17072082152a2ef351cb51f98802fb4b2fdabd32399843875974ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"d7e7d9b7b50e5f22c915b525acc5a49a7a6584cf8f62d0569e557c5cfc4b2ac2","affectsGlobalScope":true,"impliedFormat":1},{"version":"71c37f4c9543f31dfced6c7840e068c5a5aacb7b89111a4364b1d5276b852557","affectsGlobalScope":true,"impliedFormat":1},{"version":"576711e016cf4f1804676043e6a0a5414252560eb57de9faceee34d79798c850","affectsGlobalScope":true,"impliedFormat":1},{"version":"89c1b1281ba7b8a96efc676b11b264de7a8374c5ea1e6617f11880a13fc56dc6","affectsGlobalScope":true,"impliedFormat":1},{"version":"74f7fa2d027d5b33eb0471c8e82a6c87216223181ec31247c357a3e8e2fddc5b","affectsGlobalScope":true,"impliedFormat":1},{"version":"f1e2a172204962276504466a6393426d2ca9c54894b1ad0a6c9dad867a65f876","affectsGlobalScope":true,"impliedFormat":1},{"version":"063600664504610fe3e99b717a1223f8b1900087fab0b4cad1496a114744f8df","affectsGlobalScope":true,"impliedFormat":1},{"version":"934019d7e3c81950f9a8426d093458b65d5aff2c7c1511233c0fd5b941e608ab","affectsGlobalScope":true,"impliedFormat":1},{"version":"52ada8e0b6e0482b728070b7639ee42e83a9b1c22d205992756fe020fd9f4a47","affectsGlobalScope":true,"impliedFormat":1},{"version":"3bdefe1bfd4d6dee0e26f928f93ccc128f1b64d5d501ff4a8cf3c6371200e5e6","affectsGlobalScope":true,"impliedFormat":1},{"version":"59fb2c069260b4ba00b5643b907ef5d5341b167e7d1dbf58dfd895658bda2867","affectsGlobalScope":true,"impliedFormat":1},{"version":"639e512c0dfc3fad96a84caad71b8834d66329a1f28dc95e3946c9b58176c73a","affectsGlobalScope":true,"impliedFormat":1},{"version":"368af93f74c9c932edd84c58883e736c9e3d53cec1fe24c0b0ff451f529ceab1","affectsGlobalScope":true,"impliedFormat":1},{"version":"af3dd424cf267428f30ccfc376f47a2c0114546b55c44d8c0f1d57d841e28d74","affectsGlobalScope":true,"impliedFormat":1},{"version":"995c005ab91a498455ea8dfb63aa9f83fa2ea793c3d8aa344be4a1678d06d399","affectsGlobalScope":true,"impliedFormat":1},{"version":"959d36cddf5e7d572a65045b876f2956c973a586da58e5d26cde519184fd9b8a","affectsGlobalScope":true,"impliedFormat":1},{"version":"965f36eae237dd74e6cca203a43e9ca801ce38824ead814728a2807b1910117d","affectsGlobalScope":true,"impliedFormat":1},{"version":"3925a6c820dcb1a06506c90b1577db1fdbf7705d65b62b99dce4be75c637e26b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a3d63ef2b853447ec4f749d3f368ce642264246e02911fcb1590d8c161b8005","affectsGlobalScope":true,"impliedFormat":1},{"version":"b5ce7a470bc3628408429040c4e3a53a27755022a32fd05e2cb694e7015386c7","affectsGlobalScope":true,"impliedFormat":1},{"version":"8444af78980e3b20b49324f4a16ba35024fef3ee069a0eb67616ea6ca821c47a","affectsGlobalScope":true,"impliedFormat":1},{"version":"3287d9d085fbd618c3971944b65b4be57859f5415f495b33a6adc994edd2f004","affectsGlobalScope":true,"impliedFormat":1},{"version":"b4b67b1a91182421f5df999988c690f14d813b9850b40acd06ed44691f6727ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e7f8264d0fb4c5339605a15daadb037bf238c10b654bb3eee14208f860a32ea","affectsGlobalScope":true,"impliedFormat":1},{"version":"782dec38049b92d4e85c1585fbea5474a219c6984a35b004963b00beb1aab538","affectsGlobalScope":true,"impliedFormat":1},{"version":"70521b6ab0dcba37539e5303104f29b721bfb2940b2776da4cc818c07e1fefc1","affectsGlobalScope":true,"impliedFormat":1},{"version":"ab41ef1f2cdafb8df48be20cd969d875602483859dc194e9c97c8a576892c052","affectsGlobalScope":true,"impliedFormat":1},{"version":"d153a11543fd884b596587ccd97aebbeed950b26933ee000f94009f1ab142848","affectsGlobalScope":true,"impliedFormat":1},{"version":"21d819c173c0cf7cc3ce57c3276e77fd9a8a01d35a06ad87158781515c9a438a","impliedFormat":1},{"version":"a79e62f1e20467e11a904399b8b18b18c0c6eea6b50c1168bf215356d5bebfaf","affectsGlobalScope":true,"impliedFormat":1},{"version":"0fd06258805d26c72f5997e07a23155d322d5f05387adb3744a791fe6a0b042d","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e9c23ba78aabc2e0a27033f18737a6df754067731e69dc5f52823957d60a4b6","impliedFormat":1},{"version":"5929864ce17fba74232584d90cb721a89b7ad277220627cc97054ba15a98ea8f","impliedFormat":1},{"version":"24bd580b5743dc56402c440dc7f9a4f5d592ad7a419f25414d37a7bfe11e342b","impliedFormat":1},{"version":"25c8056edf4314820382a5fdb4bb7816999acdcb929c8f75e3f39473b87e85bc","impliedFormat":1},{"version":"c464d66b20788266e5353b48dc4aa6bc0dc4a707276df1e7152ab0c9ae21fad8","impliedFormat":1},{"version":"78d0d27c130d35c60b5e5566c9f1e5be77caf39804636bc1a40133919a949f21","impliedFormat":1},{"version":"c6fd2c5a395f2432786c9cb8deb870b9b0e8ff7e22c029954fabdd692bff6195","impliedFormat":1},{"version":"1d6e127068ea8e104a912e42fc0a110e2aa5a66a356a917a163e8cf9a65e4a75","impliedFormat":1},{"version":"5ded6427296cdf3b9542de4471d2aa8d3983671d4cac0f4bf9c637208d1ced43","impliedFormat":1},{"version":"6bdc71028db658243775263e93a7db2fd2abfce3ca569c3cca5aee6ed5eb186d","impliedFormat":1},{"version":"cadc8aced301244057c4e7e73fbcae534b0f5b12a37b150d80e5a45aa4bebcbd","impliedFormat":1},{"version":"385aab901643aa54e1c36f5ef3107913b10d1b5bb8cbcd933d4263b80a0d7f20","impliedFormat":1},{"version":"9670d44354bab9d9982eca21945686b5c24a3f893db73c0dae0fd74217a4c219","impliedFormat":1},{"version":"0b8a9268adaf4da35e7fa830c8981cfa22adbbe5b3f6f5ab91f6658899e657a7","impliedFormat":1},{"version":"11396ed8a44c02ab9798b7dca436009f866e8dae3c9c25e8c1fbc396880bf1bb","impliedFormat":1},{"version":"ba7bc87d01492633cb5a0e5da8a4a42a1c86270e7b3d2dea5d156828a84e4882","impliedFormat":1},{"version":"4893a895ea92c85345017a04ed427cbd6a1710453338df26881a6019432febdd","impliedFormat":1},{"version":"c21dc52e277bcfc75fac0436ccb75c204f9e1b3fa5e12729670910639f27343e","impliedFormat":1},{"version":"13f6f39e12b1518c6650bbb220c8985999020fe0f21d818e28f512b7771d00f9","impliedFormat":1},{"version":"9b5369969f6e7175740bf51223112ff209f94ba43ecd3bb09eefff9fd675624a","impliedFormat":1},{"version":"4fe9e626e7164748e8769bbf74b538e09607f07ed17c2f20af8d680ee49fc1da","impliedFormat":1},{"version":"24515859bc0b836719105bb6cc3d68255042a9f02a6022b3187948b204946bd2","impliedFormat":1},{"version":"ea0148f897b45a76544ae179784c95af1bd6721b8610af9ffa467a518a086a43","impliedFormat":1},{"version":"24c6a117721e606c9984335f71711877293a9651e44f59f3d21c1ea0856f9cc9","impliedFormat":1},{"version":"dd3273ead9fbde62a72949c97dbec2247ea08e0c6952e701a483d74ef92d6a17","impliedFormat":1},{"version":"405822be75ad3e4d162e07439bac80c6bcc6dbae1929e179cf467ec0b9ee4e2e","impliedFormat":1},{"version":"0db18c6e78ea846316c012478888f33c11ffadab9efd1cc8bcc12daded7a60b6","impliedFormat":1},{"version":"4d2b0eb911816f66abe4970898f97a2cfc902bcd743cbfa5017fad79f7ef90d8","impliedFormat":1},{"version":"bd0532fd6556073727d28da0edfd1736417a3f9f394877b6d5ef6ad88fba1d1a","impliedFormat":1},{"version":"89167d696a849fce5ca508032aabfe901c0868f833a8625d5a9c6e861ef935d2","impliedFormat":1},{"version":"e53a3c2a9f624d90f24bf4588aacd223e7bec1b9d0d479b68d2f4a9e6011147f","impliedFormat":1},{"version":"24b8685c62562f5d98615c5a0c1d05f297cf5065f15246edfe99e81ec4c0e011","impliedFormat":1},{"version":"93507c745e8f29090efb99399c3f77bec07db17acd75634249dc92f961573387","impliedFormat":1},{"version":"339dc5265ee5ed92e536a93a04c4ebbc2128f45eeec6ed29f379e0085283542c","impliedFormat":1},{"version":"4732aec92b20fb28c5fe9ad99521fb59974289ed1e45aecb282616202184064f","impliedFormat":1},{"version":"2e85db9e6fd73cfa3d7f28e0ab6b55417ea18931423bd47b409a96e4a169e8e6","impliedFormat":1},{"version":"c46e079fe54c76f95c67fb89081b3e399da2c7d109e7dca8e4b58d83e332e605","impliedFormat":1},{"version":"bf67d53d168abc1298888693338cb82854bdb2e69ef83f8a0092093c2d562107","impliedFormat":1},{"version":"ca6d304b929748ea15c33f28c1f159df18a94470b424ab78c52d68d40a41e1e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"a72ffc815104fb5c075106ebca459b2d55d07862a773768fce89efc621b3964b","impliedFormat":1},{"version":"7394959e5a741b185456e1ef5d64599c36c60a323207450991e7a42e08911419","impliedFormat":1},{"version":"3d77c73be94570813f8cadd1f05ebc3dc5e2e4fdefe4d340ca20cd018724ee36","impliedFormat":1},{"version":"d674383111e06b6741c4ad2db962131b5b0fa4d0294b998566c635e86195a453","affectsGlobalScope":true,"impliedFormat":1},{"version":"f3e58c4c18a031cbb17abec7a4ad0bd5ae9fc70c1f4ba1e7fb921ad87c504aca","impliedFormat":1},{"version":"a3e8bafb2af8e850c644f4be7f5156cf7d23b7bfdc3b786bd4d10ed40329649c","impliedFormat":1},{"version":"35ec8b6760fd7138bbf5809b84551e31028fb2ba7b6dc91d95d098bf212ca8b4","affectsGlobalScope":true,"impliedFormat":1},{"version":"a40826e8476694e90da94aa008283a7de50d1dafd37beada623863f1901cb7fb","impliedFormat":1},{"version":"f77d9188e41291acf14f476e931972460a303e1952538f9546e7b370cb8d0d20","affectsGlobalScope":true,"impliedFormat":1},{"version":"b0c0d1d13be149f790a75b381b413490f98558649428bb916fd2d71a3f47a134","impliedFormat":1},{"version":"3c884d9d9ec454bdf0d5a0b8465bf8297d2caa4d853851d92cc417ac6f30b969","impliedFormat":1},{"version":"5a369483ac4cfbdf0331c248deeb36140e6907db5e1daed241546b4a2055f82c","impliedFormat":1},{"version":"e8f5b5cc36615c17d330eaf8eebbc0d6bdd942c25991f96ef122f246f4ff722f","impliedFormat":1},{"version":"f0bd7e6d931657b59605c44112eaf8b980ba7f957a5051ed21cb93d978cf2f45","impliedFormat":1},{"version":"ee1ee365d88c4c6c0c0a5a5701d66ebc27ccd0bcfcfaa482c6e2e7fe7b98edf7","affectsGlobalScope":true,"impliedFormat":1},{"version":"0ada07543808f3b967624645a8e1ccd446f8b01ade47842acf1328aec899fed0","affectsGlobalScope":true,"impliedFormat":1},{"version":"a4bdde4e601e9554a844e1e0d0ccfa05e183ef9d82ab3ac25f17c1709033d360","impliedFormat":1},{"version":"ad23fd126ff06e72728dd7bfc84326a8ca8cec2b9d2dac0193d42a777df0e7d8","impliedFormat":1},{"version":"c60db41f7bee80fb80c0b12819f5e465c8c8b465578da43e36d04f4a4646f57d","impliedFormat":1},{"version":"93bd413918fa921c8729cef45302b24d8b6c7855d72d5bf82d3972595ae8dcbf","impliedFormat":1},{"version":"4ff41188773cbf465807dd2f7059c7494cbee5115608efc297383832a1150c43","impliedFormat":1},{"version":"dccdf1677e531e33f8ac961a68bc537418c9a414797c1ea7e91307501cdc3f5e","impliedFormat":1},{"version":"1f4fc6905c4c3ae701838f89484f477b8d9b3ef39270e016b5488600d247d9a5","affectsGlobalScope":true,"impliedFormat":1},{"version":"d206b4baf4ddcc15d9d69a9a2f4999a72a2c6adeaa8af20fa7a9960816287555","impliedFormat":1},{"version":"93f437e1398a4f06a984f441f7fa7a9f0535c04399619b5c22e0b87bdee182cb","impliedFormat":1},{"version":"afbe24ab0d74694372baa632ecb28bb375be53f3be53f9b07ecd7fc994907de5","impliedFormat":1},{"version":"70731d10d5311bd4cf710ef7f6539b62660f4b0bfdbb3f9fbe1d25fe6366a7fa","affectsGlobalScope":true,"impliedFormat":1},{"version":"a20f1e119615bf7632729fd89b6c0b5ffdc2df3b512d6304146294528e3ebe19","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e043a1bc8fbf2a255bccf9bf27e0f1caf916c3b0518ea34aa72357c0afd42ec","impliedFormat":1},{"version":"137c2894e8f3e9672d401cc0a305dc7b1db7c69511cf6d3970fb53302f9eae09","impliedFormat":1},{"version":"3bc2f1e2c95c04048212c569ed38e338873f6a8593930cf5a7ef24ffb38fc3b6","impliedFormat":1},{"version":"8145e07aad6da5f23f2fcd8c8e4c5c13fb26ee986a79d03b0829b8fce152d8b2","impliedFormat":1},{"version":"f9d9d753d430ed050dc1bf2667a1bab711ccbb1c1507183d794cc195a5b085cc","impliedFormat":1},{"version":"9eece5e586312581ccd106d4853e861aaaa1a39f8e3ea672b8c3847eedd12f6e","impliedFormat":1},{"version":"235bfb54b4869c26f7e98e3d1f68dbfc85acf4cf5c38a4444a006fbf74a8a43d","impliedFormat":1},{"version":"37ba7b45141a45ce6e80e66f2a96c8a5ab1bcef0fc2d0f56bb58df96ec67e972","impliedFormat":1},{"version":"93452d394fdd1dc551ec62f5042366f011a00d342d36d50793b3529bfc9bd633","impliedFormat":1},{"version":"bb715efb4857eb94539eafb420352105a0cff40746837c5140bf6b035dd220ba","affectsGlobalScope":true,"impliedFormat":1},{"version":"1851a3b4db78664f83901bb9cac9e45e03a37bb5933cc5bf37e10bb7e91ab4eb","impliedFormat":1},{"version":"fdedf82878e4c744bc2a1c1e802ae407d63474da51f14a54babe039018e53d8f","affectsGlobalScope":true,"impliedFormat":1},{"version":"27d8987fd22d92efe6560cf0ce11767bf089903ffe26047727debfd1f3bf438b","affectsGlobalScope":true,"impliedFormat":1},{"version":"578d8bb6dcb2a1c03c4c3f8eb71abc9677e1a5c788b7f24848e3138ce17f3400","impliedFormat":1},{"version":"4f029899f9bae07e225c43aef893590541b2b43267383bf5e32e3a884d219ed5","impliedFormat":1},{"version":"ae56f65caf3be91108707bd8dfbccc2a57a91feb5daabf7165a06a945545ed26","impliedFormat":1},{"version":"a136d5de521da20f31631a0a96bf712370779d1c05b7015d7019a9b2a0446ca9","impliedFormat":1},{"version":"5b566927cad2ed2139655d55d690ffa87df378b956e7fe1c96024c4d9f75c4cf","affectsGlobalScope":true,"impliedFormat":1},{"version":"bce947017cb7a2deebcc4f5ba04cead891ce6ad1602a4438ae45ed9aa1f39104","affectsGlobalScope":true,"impliedFormat":1},{"version":"d3dffd70e6375b872f0b4e152de4ae682d762c61a24881ecc5eb9f04c5caf76f","impliedFormat":1},{"version":"e2c72c065a36bc9ab2a00ac6a6f51e71501619a72c0609defd304d46610487a4","impliedFormat":1},{"version":"d91a7d8b5655c42986f1bdfe2105c4408f472831c8f20cf11a8c3345b6b56c8c","impliedFormat":1},{"version":"616075a6ac578cf5a013ee12964188b4412823796ce0b202c6f1d2e4ca8480d7","affectsGlobalScope":true,"impliedFormat":1},{"version":"e8a979b8af001c9fc2e774e7809d233c8ca955a28756f52ee5dee88ccb0611d2","impliedFormat":1},{"version":"cac793cc47c29e26e4ac3601dcb00b4435ebed26203485790e44f2ad8b6ad847","impliedFormat":1},{"version":"4fe80f12b1d5189384a219095c2eabadbb389c2d3703aae7c5376dbaa56061df","impliedFormat":1},{"version":"ad70fdf3826676b87e49c859035690311e6e1f27fc58c76ebfd5c714f7cee2e6","impliedFormat":1},{"version":"edd2bf117f61517d22264e2204925df0f422315f5df9be844feebb3aab4876f0","impliedFormat":1},{"version":"5a7813ca09d8b67cd5dab49912909a50d2d1b599dfdf71662e3b75546dc34df8","signature":"f6d7ce4efc9927f9958caa449ad3fbb9a541a8d2a268d7297fc9c2eb9bfbd544"}],"root":[161],"options":{"allowJs":true,"allowSyntheticDefaultImports":true,"allowUnreachableCode":false,"allowUnusedLabels":false,"alwaysStrict":true,"composite":true,"declaration":true,"declarationMap":true,"esModuleInterop":true,"exactOptionalPropertyTypes":true,"inlineSources":false,"module":99,"noFallthroughCasesInSwitch":true,"noImplicitAny":true,"noImplicitReturns":true,"noImplicitThis":true,"noPropertyAccessFromIndexSignature":true,"noUncheckedIndexedAccess":true,"noUnusedLocals":true,"noUnusedParameters":true,"outDir":"./dist","rootDir":"./src","skipLibCheck":true,"strict":true,"strictBindCallApply":true,"strictFunctionTypes":true,"strictNullChecks":true,"strictPropertyInitialization":true,"target":9,"useUnknownInCatchVariables":true,"verbatimModuleSyntax":true},"referencedMap":[[105,1],[106,1],[107,2],[65,3],[108,4],[109,5],[110,6],[60,7],[63,8],[61,7],[62,7],[111,9],[112,10],[113,11],[114,12],[115,13],[116,14],[117,14],[119,15],[118,16],[120,17],[121,18],[122,19],[104,20],[64,7],[123,21],[124,22],[125,23],[157,24],[126,25],[127,26],[128,27],[82,28],[92,29],[81,28],[102,30],[73,31],[72,32],[101,33],[95,34],[100,35],[75,36],[89,37],[74,38],[98,39],[70,40],[69,33],[99,41],[71,42],[76,43],[77,7],[80,43],[67,7],[103,44],[93,45],[84,46],[85,47],[87,48],[83,49],[86,50],[96,33],[78,51],[79,52],[88,53],[68,54],[91,45],[90,43],[94,7],[97,55],[129,56],[130,57],[131,58],[132,59],[133,60],[134,61],[135,62],[136,62],[137,63],[138,7],[139,64],[141,65],[140,66],[142,67],[143,68],[144,69],[145,70],[146,71],[147,72],[148,73],[149,74],[150,75],[151,76],[152,77],[153,78],[154,79],[155,80],[156,81],[66,7],[158,82],[160,83],[159,84],[58,7],[59,7],[10,7],[11,7],[13,7],[12,7],[2,7],[14,7],[15,7],[16,7],[17,7],[18,7],[19,7],[20,7],[21,7],[3,7],[22,7],[23,7],[4,7],[24,7],[28,7],[25,7],[26,7],[27,7],[29,7],[30,7],[31,7],[5,7],[32,7],[33,7],[34,7],[35,7],[6,7],[39,7],[36,7],[37,7],[38,7],[40,7],[7,7],[41,7],[46,7],[47,7],[42,7],[43,7],[44,7],[45,7],[8,7],[51,7],[48,7],[49,7],[50,7],[52,7],[9,7],[53,7],[54,7],[55,7],[57,7],[56,7],[1,7],[161,85]],"affectedFilesPendingEmit":[[161,51]],"emitSignatures":[161],"version":"5.7.2"}
```

## File: packages/logger/tsup.config.ts
```typescript
 1: import { defineConfig } from "tsup";
 2: 
 3: export default defineConfig({
 4:   entry: ["src/index.ts"],
 5:   format: ["cjs", "esm"],
 6:   dts: true,
 7:   splitting: false,
 8:   sourcemap: true,
 9:   clean: true,
10: });
```

## File: packages/mcp/src/servers/mcp-server-langchain-tool.ts
```typescript
  1: // Copyright (C) 2024 Hideya Kawahara
  2: // SPDX-License-Identifier: MIT
  3: 
  4: import { Client } from '@modelcontextprotocol/sdk/client/index.js';
  5: import { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';
  6: import { CallToolResultSchema, ListToolsResultSchema } from '@modelcontextprotocol/sdk/types.js';
  7: import { DynamicStructuredTool } from '@langchain/core/tools';
  8: import type { JsonSchema } from '@n8n/json-schema-to-zod';
  9: import type { z } from 'zod';
 10: import { Logger } from '../logger.js';
 11: import { type LogLevelString } from '../logger.js';
 12: 
 13: // Import jsonSchemaToZod using require
 14: const { jsonSchemaToZod } = require('@n8n/json-schema-to-zod/dist/cjs/index.js');
 15: 
 16: interface MCPServerConfig {
 17:   command: string;
 18:   args: string[];
 19:   env?: Record<string, string>;
 20: }
 21: 
 22: export interface MCPServersConfig {
 23:   [key: string]: MCPServerConfig;
 24: }
 25: 
 26: export interface LogOptions {
 27:   logLevel?: LogLevelString
 28:   continueOnError?: boolean
 29: }
 30: 
 31: interface MCPError extends Error {
 32:   serverName: string;
 33:   code: string;
 34:   details?: unknown;
 35: }
 36: 
 37: export interface MCPServerCleanupFunction {
 38:   (): Promise<void>;
 39: }
 40: 
 41: class MCPInitializationError extends Error implements MCPError {
 42:   constructor(
 43:     public serverName: string,
 44:     public code: string,
 45:     message: string,
 46:     public details?: unknown
 47:   ) {
 48:     super(message);
 49:     this.name = 'MCPInitializationError';
 50:   }
 51: }
 52: 
 53: export async function convertMCPServersToLangChainTools(
 54:   configs: MCPServersConfig,
 55:   options?: LogOptions
 56: ): Promise<{
 57:   allTools: DynamicStructuredTool[];
 58:   cleanup: MCPServerCleanupFunction;
 59: }> {
 60:   const allTools: DynamicStructuredTool[] = [];
 61:   const cleanupCallbacks: MCPServerCleanupFunction[] = [];
 62:   const logger = new Logger({ level: options?.logLevel || 'info' });
 63: 
 64:   const serverInitPromises = Object.entries(configs).map(async ([name, config]) => {
 65:     logger.info(`Initializing MCP server "${name}"`);
 66:     logger.debug(`with config: `, config);
 67:     const result = await convertMCPServerToLangChainTools(name, config, logger);
 68:     return { name, result };
 69:   });
 70: 
 71:   // Track server names alongside their promises
 72:   const serverNames = Object.keys(configs);
 73: 
 74:   // Concurrently initialize all the MCP servers
 75:   const results = await Promise.allSettled(
 76:     serverInitPromises
 77:   );
 78: 
 79:   // Process successful initializations and log failures
 80:   results.forEach((result, index) => {
 81:     if (result.status === 'fulfilled') {
 82:       const { result: { tools, cleanup } } = result.value;
 83:       allTools.push(...tools);
 84:       cleanupCallbacks.push(cleanup);
 85:     } else {
 86:       logger.error(`MCP server "${serverNames[index]}": failed to initialize: ${result.reason}`);
 87:     }
 88:   });
 89: 
 90:   async function cleanup(): Promise<void> {
 91:     // Concurrently execute all the callbacks
 92:     const results = await Promise.allSettled(cleanupCallbacks.map(callback => callback()));
 93: 
 94:     // Log any cleanup failures
 95:     const failures = results.filter(result => result.status === 'rejected');
 96:     if (failures.length > 0) {
 97:       failures.forEach((failure, index) => {
 98:         logger.error(`MCP server "${serverNames[index]}": failed to close: ${failure.reason}`);
 99:       });
100:     }
101:   }
102: 
103:   logger.info(`MCP servers initialized and found ${allTools.length} tool(s) in total:`);
104:   allTools.forEach((tool) => logger.info(`- ${tool.name}`));
105: 
106:   return { allTools, cleanup };
107: }
108: 
109: async function convertMCPServerToLangChainTools(
110:   serverName: string,
111:   config: MCPServerConfig,
112:   logger: Logger
113: ): Promise<{
114:   tools: DynamicStructuredTool[];
115:   cleanup: MCPServerCleanupFunction;
116: }> {
117:   let transport: StdioClientTransport | null = null;
118:   let client: Client | null = null;
119: 
120:   try {
121:     transport = new StdioClientTransport({
122:       command: config.command,
123:       args: config.args ?? [],
124:       env: config.env ?? {},
125:     });
126: 
127:     client = new Client(
128:       {
129:         name: "mcp-client",
130:         version: "0.0.1",
131:       },
132:       {
133:         capabilities: {},
134:       }
135:     );
136: 
137:     await client.connect(transport);
138: 
139:     const toolsResponse = await client.request(
140:       { method: "tools/list" },
141:       ListToolsResultSchema
142:     );
143: 
144:     logger.info(`MCP server "${serverName}": connected`);
145: 
146:     const tools = toolsResponse.tools.map((tool) => (
147:       new DynamicStructuredTool({
148:         name: `${serverName}_${tool.name}`,
149:         description: `[${serverName}] ${tool.description || ''}`,
150:         // FIXME
151:         // eslint-disable-next-line @typescript-eslint/no-explicit-any
152:         schema: jsonSchemaToZod(tool.inputSchema as JsonSchema) as z.ZodObject<any>,
153: 
154:         func: async (input) => {
155:           logger.info(`MCP Tool "${serverName}/${tool.name}" received input:`, input);
156: 
157:           if (Object.keys(input).length === 0) {
158:             return 'No input provided';
159:           }
160: 
161:           // Execute tool call
162:           const result = await client?.request(
163:             {
164:               method: "tools/call",
165:               params: {
166:                 name: tool.name,
167:                 arguments: input,
168:               },
169:             },
170:             CallToolResultSchema
171:           );
172: 
173:           const roughLength = JSON.stringify(result).length;
174:           logger.info(`MCP Tool "${serverName}/${tool.name}" received result (length: ${roughLength})`);
175:           logger.debug('result:', result);
176: 
177:           const filteredResult = result?.content
178:             .filter(content => content.type === 'text')
179:             .map(content => content.text)
180:             .join('\n\n');
181: 
182:           return filteredResult;
183:         },
184:       })
185:     ));
186: 
187:     logger.info(`MCP server "${serverName}": found ${tools.length} tool(s)`);
188:     tools.forEach((tool) => logger.debug(`- ${serverName}/${tool.name}`));
189: 
190:     async function cleanup(): Promise<void> {
191:       if (transport) {
192:         await transport.close();
193:         logger.info(`Closed MCP connection to "${serverName}"`);
194:       }
195:     }
196: 
197:     return { tools, cleanup };
198:   } catch (error: unknown) {
199:     // Proper cleanup in case of initialization error
200:     if (transport) await transport.close();
201:     throw new MCPInitializationError(
202:       serverName,
203:       'INIT_FAILED',
204:       `Failed to initialize MCP server: ${error instanceof Error ? error.message : String(error)}`,
205:       error
206:     );
207:   }
208: }
```

## File: packages/mcp/src/index.ts
```typescript
  1: export * from './init-chat-model'
  2: export * from './load-config'
  3: export * from './logger'
  4: 
  5: import { createReactAgent } from '@langchain/langgraph/prebuilt'
  6: import { MemorySaver } from '@langchain/langgraph'
  7: import { HumanMessage } from '@langchain/core/messages'
  8: import { convertMCPServersToLangChainTools, type MCPServerCleanupFunction } from '@h1deya/mcp-langchain-tools'
  9: import { initChatModel } from './init-chat-model'
 10: import { loadConfig, type Config } from './load-config'
 11: import { Logger, createLogger } from './logger'
 12: 
 13: export interface MCPServiceOptions {
 14:   configPath?: string
 15:   logger?: Logger
 16: }
 17: 
 18: export class MCPService {
 19:   private config: Config | null = null
 20:   private agent: ReturnType<typeof createReactAgent> | null = null
 21:   private cleanup: MCPServerCleanupFunction | null = null
 22:   private logger: Logger
 23:   private configPath: string
 24: 
 25:   constructor(options: MCPServiceOptions = {}) {
 26:     this.logger = options.logger || createLogger({ level: 'info' })
 27:     this.configPath = options.configPath || 'mcp-config.json5'
 28:   }
 29: 
 30:   async initialize(): Promise<void> {
 31:     try {
 32:       // Load and validate config
 33:       this.logger.info('Loading MCP configuration')
 34:       const configPath = process.env["CONFIG_FILE"] ?? this.configPath
 35:       this.config = loadConfig(configPath)
 36:       this.logger.info('Configuration loaded successfully')
 37: 
 38:       // Initialize LLM
 39:       this.logger.info('Initializing LLM model')
 40:       const llmModel = initChatModel(this.config.llm)
 41:       this.logger.info('LLM model initialized successfully')
 42: 
 43:       // Initialize MCP servers
 44:       this.logger.info(`Initializing ${Object.keys(this.config.mcpServers).length} MCP server(s)...`)
 45:       const { tools, cleanup } = await convertMCPServersToLangChainTools(
 46:         this.config.mcpServers,
 47:         { logLevel: 'info' }
 48:       )
 49:       this.cleanup = cleanup
 50: 
 51:       // Create React agent
 52:       this.agent = createReactAgent({
 53:         llm: llmModel,
 54:         tools,
 55:         checkpointSaver: new MemorySaver(),
 56:       })
 57:       this.logger.info('React agent created successfully')
 58:     } catch (error) {
 59:       this.logger.error('Failed to initialize MCP Service:', {
 60:         error: error instanceof Error ? {
 61:           name: error.name,
 62:           message: error.message,
 63:           stack: error.stack
 64:         } : String(error)
 65:       })
 66:       throw error
 67:     }
 68:   }
 69: 
 70:   async processMessage(message: string): Promise<string> {
 71:     if (!this.agent) {
 72:       throw new Error('MCP Service not initialized')
 73:     }
 74: 
 75:     try {
 76:       const result = await this.agent.invoke(
 77:         { messages: [new HumanMessage(message)] },
 78:         { configurable: { thread_id: 'test-thread' } }
 79:       )
 80:       return result["messages"][result["messages"].length - 1].content
 81:     } catch (error) {
 82:       this.logger.error('Error processing message:', {
 83:         error: error instanceof Error ? {
 84:           name: error.name,
 85:           message: error.message,
 86:           stack: error.stack
 87:         } : String(error)
 88:       })
 89:       throw error
 90:     }
 91:   }
 92: 
 93:   async shutdown(): Promise<void> {
 94:     if (this.cleanup) {
 95:       await this.cleanup()
 96:       this.cleanup = null
 97:     }
 98:     this.agent = null
 99:   }
100: }
101: 
102: // CLI interface
103: if (require.main === module) {
104:   const service = new MCPService()
105:   service.initialize()
106:     .then(() => {
107:       console.log('MCP Service initialized successfully')
108:       // TODO: Add CLI interface here
109:     })
110:     .catch(error => {
111:       console.error('Failed to initialize MCP Service:', error)
112:       process.exit(1)
113:     })
114: }
```

## File: packages/mcp/src/init-chat-model.ts
```typescript
 1: // Copyright (C) 2024 Hideya Kawahara
 2: // SPDX-License-Identifier: MIT
 3: 
 4: import { ChatOpenAI } from '@langchain/openai';
 5: import { ChatAnthropic } from '@langchain/anthropic';
 6: import { ChatGroq } from '@langchain/groq';
 7: import type { BaseChatModel } from '@langchain/core/language_models/chat_models';
 8: import type { LLMConfig } from "./load-config";
 9: 
10: export function initChatModel(config: LLMConfig): BaseChatModel {
11:   let model: BaseChatModel;
12: 
13:   const llmConfig = {
14:     modelName: config.model,
15:     temperature: config.temperature ?? 0.7,
16:     maxTokens: config.maxTokens ?? undefined,
17:   };
18: 
19:   switch (config.provider?.toLowerCase()) {
20:     case "openai": {
21:       const openaiApiKey = config.apiKey ?? process.env["OPENAI_API_KEY"];
22:       if (!openaiApiKey) {
23:         throw new Error("OpenAI API key not found");
24:       }
25:       model = new ChatOpenAI({
26:         apiKey: openaiApiKey,
27:         modelName: config.model ?? "gpt-4",
28:         temperature: llmConfig.temperature,
29:         maxTokens: config.maxTokens ?? 4096,
30:       });
31:       break;
32:     }
33: 
34:     case "anthropic": {
35:       const anthropicApiKey = config.apiKey ?? process.env["ANTHROPIC_API_KEY"];
36:       if (!anthropicApiKey) {
37:         throw new Error("Anthropic API key not found");
38:       }
39:       model = new ChatAnthropic({
40:         apiKey: anthropicApiKey,
41:         model: config.model ?? "claude-3-opus-20240229",
42:         temperature: llmConfig.temperature,
43:         maxTokens: llmConfig.maxTokens ?? 4096,
44:       });
45:       break;
46:     }
47: 
48:     case "groq": {
49:       const groqApiKey = config.apiKey ?? process.env["GROQ_API_KEY"];
50:       if (!groqApiKey) {
51:         throw new Error("Groq API key not found");
52:       }
53:       model = new ChatGroq({
54:         apiKey: groqApiKey,
55:         model: config.model ?? "mixtral-8x7b-32768",
56:         temperature: llmConfig.temperature,
57:         maxTokens: llmConfig.maxTokens ?? 4096,
58:       });
59:       break;
60:     }
61: 
62:     default:
63:       throw new Error(`Unsupported provider: ${config.provider}`);
64:   }
65: 
66:   return model;
67: }
```

## File: packages/mcp/src/load-config.ts
```typescript
  1: // Copyright (C) 2024 Hideya Kawahara
  2: // SPDX-License-Identifier: MIT
  3: 
  4: import JSON5 from 'json5';
  5: import { readFileSync } from 'fs';
  6: 
  7: // Validate required environment variables
  8: function validateEnvironmentVariables(config: Config): void {
  9:   const missingVars = new Set<string>();
 10: 
 11:   // Check LLM API keys
 12:   if (config.llm?.apiKey?.includes('${')) {
 13:     const matches = config.llm.apiKey.match(/\$\{([^}]+)\}/g);
 14:     if (matches) {
 15:       matches.forEach(match => {
 16:         const varName = match.slice(2, -1);
 17:         if (!process.env[varName]) {
 18:           missingVars.add(varName);
 19:         }
 20:       });
 21:     }
 22:   }
 23: 
 24:   // Check server environment variables
 25:   Object.entries(config.mcpServers || {}).forEach(([_, server]) => {
 26:     if (server.env) {
 27:       Object.values(server.env).forEach(value => {
 28:         if (typeof value === 'string' && value.includes('${')) {
 29:           const matches = value.match(/\$\{([^}]+)\}/g);
 30:           if (matches) {
 31:             matches.forEach(match => {
 32:               const varName = match.slice(2, -1);
 33:               if (!process.env[varName]) {
 34:                 missingVars.add(varName);
 35:               }
 36:             });
 37:           }
 38:         }
 39:       });
 40:     }
 41:   });
 42: 
 43:   if (missingVars.size > 0) {
 44:     throw new Error(`Missing required environment variables: ${Array.from(missingVars).join(', ')}. Make sure these are set in the root .env file.`);
 45:   }
 46: }
 47: 
 48: export interface LLMConfig {
 49:   provider: string;
 50:   model?: string;
 51:   modelName?: string;
 52:   temperature?: number;
 53:   maxTokens?: number;
 54:   apiKey?: string;
 55: }
 56: 
 57: export interface MCPServerConfig {
 58:   command: string;
 59:   args: string[];
 60:   env?: Record<string, string>;
 61: }
 62: 
 63: export interface Config {
 64:   llm: LLMConfig;
 65:   mcpServers: {
 66:     [key: string]: MCPServerConfig;
 67:   }
 68: }
 69: 
 70: export function loadConfig(configPath: string): Config {
 71:   try {
 72:     // Check if file exists
 73:     try {
 74:       readFileSync(configPath);
 75:     } catch (error) {
 76:       throw new Error(`Config file not found at "${configPath}". Error: ${error instanceof Error ? error.message : String(error)}`);
 77:     }
 78: 
 79:     let json5Str = readFileSync(configPath, 'utf-8');
 80: 
 81:     // Replace environment variables in the format ${VAR_NAME} with their values
 82:     Object.entries(process.env).forEach(([key, value]) => {
 83:       const regex = new RegExp(`\\$\{${key}\}`, 'g');
 84:       if (value) {
 85:         json5Str = json5Str.replace(regex, value);
 86:       }
 87:     });
 88: 
 89:     let config;
 90:     try {
 91:       config = JSON5.parse(json5Str);
 92:     } catch (error) {
 93:       throw new Error(`Failed to parse config file: ${error instanceof Error ? error.message : String(error)}`);
 94:     }
 95: 
 96:     // Validate required fields
 97:     validateConfig(config);
 98: 
 99:     // Validate environment variables
100:     validateEnvironmentVariables(config);
101: 
102:     return config;
103:   } catch (error) {
104:     if (error instanceof Error) {
105:       throw new Error(`Failed to load configuration from "${configPath}": ${error.message}`);
106:     }
107:     throw error;
108:   }
109: }
110: 
111: // eslint-disable-next-line @typescript-eslint/no-explicit-any
112: function validateConfig(config: any): asserts config is Config {
113:   if (typeof config !== 'object' || config === null) {
114:     throw new Error('Configuration must be an object');
115:   }
116: 
117:   if (!config.llm) {
118:     throw new Error('LLM configuration is required');
119:   }
120:   validateLLMConfig(config.llm);
121: 
122:   if (typeof config.mcpServers !== 'object' || config.mcpServers === null) {
123:     throw new Error('mcpServers must be an object');
124:   }
125: 
126:   Object.entries(config.mcpServers).forEach(([key, value]) => {
127:     try {
128:       validateMCPServerConfig(value);
129:     } catch (error) {
130:       throw new Error(`Invalid configuration for MCP server "${key}": ${error instanceof Error ? error.message : String(error)}`);
131:     }
132:   });
133: }
134: 
135: // eslint-disable-next-line @typescript-eslint/no-explicit-any
136: function validateLLMConfig(llmConfig: any): asserts llmConfig is LLMConfig {
137:   if (typeof llmConfig !== 'object' || llmConfig === null) {
138:     throw new Error('LLM configuration must be an object');
139:   }
140: 
141:   if (typeof llmConfig.provider !== 'string') {
142:     throw new Error('LLM provider must be a string');
143:   }
144: 
145:   if (llmConfig.model !== undefined && typeof llmConfig.model !== 'string') {
146:     throw new Error('LLM model must be a string if provided');
147:   }
148: 
149:   if (llmConfig.modelName !== undefined && typeof llmConfig.modelName !== 'string') {
150:     throw new Error('LLM modelName must be a string if provided');
151:   }
152: 
153:   if (llmConfig.temperature !== undefined && typeof llmConfig.temperature !== 'number') {
154:     throw new Error('LLM temperature must be a number if provided');
155:   }
156: 
157:   if (llmConfig.maxTokens !== undefined && typeof llmConfig.maxTokens !== 'number') {
158:     throw new Error('LLM maxTokens must be a number if provided');
159:   }
160: 
161:   if (llmConfig.apiKey !== undefined && typeof llmConfig.apiKey !== 'string') {
162:     throw new Error('LLM apiKey must be a string if provided');
163:   }
164: }
165: 
166: // eslint-disable-next-line @typescript-eslint/no-explicit-any
167: function validateMCPServerConfig(serverConfig: any): asserts serverConfig is MCPServerConfig {
168:   if (typeof serverConfig !== 'object' || serverConfig === null) {
169:     throw new Error('MCP server configuration must be an object');
170:   }
171: 
172:   if (typeof serverConfig.command !== 'string') {
173:     throw new Error('MCP server command must be a string');
174:   }
175: 
176:   if (!Array.isArray(serverConfig.args)) {
177:     throw new Error('MCP server args must be an array');
178:   }
179: 
180:   if (serverConfig.args.some((arg: unknown) => typeof arg !== 'string')) {
181:     throw new Error('All MCP server args must be strings');
182:   }
183: 
184:   if (serverConfig.env !== undefined) {
185:     if (typeof serverConfig.env !== 'object' || serverConfig.env === null) {
186:       throw new Error('MCP server env must be an object if provided');
187:     }
188: 
189:     // Validate that all env values are strings
190:     for (const [, value] of Object.entries(serverConfig.env)) {
191:       if (typeof value !== 'string') {
192:         throw new Error('All MCP server env values must be strings');
193:       }
194:     }
195:   }
196: }
```

## File: packages/mcp/src/logger.ts
```typescript
 1: // Copyright (C) 2024 Hideya Kawahara
 2: // SPDX-License-Identifier: MIT
 3: 
 4: type LogLevelString = 'trace' | 'debug' | 'info' | 'warn' | 'error' | 'fatal';
 5: 
 6: enum LogLevel {
 7:   TRACE = 0,
 8:   DEBUG = 1,
 9:   INFO = 2,
10:   WARN = 3,
11:   ERROR = 4,
12:   FATAL = 5
13: }
14: 
15: const LOG_COLORS = {
16:   [LogLevel.TRACE]: '\x1b[90m',  // Gray
17:   [LogLevel.DEBUG]: '\x1b[90m',  // Gray
18:   [LogLevel.INFO]: '\x1b[90m',  // Gray
19:   [LogLevel.WARN]: '\x1b[1;93m',  // Bold bright yellow
20:   [LogLevel.ERROR]: '\x1b[1;91m',  // Bold bright red
21:   [LogLevel.FATAL]: '\x1b[1;101m', // Red background, Bold text
22: } as const;
23: 
24: const LOG_LEVEL_MAP: Record<LogLevelString, LogLevel> = {
25:   trace: LogLevel.TRACE,
26:   debug: LogLevel.DEBUG,
27:   info: LogLevel.INFO,
28:   warn: LogLevel.WARN,
29:   error: LogLevel.ERROR,
30:   fatal: LogLevel.FATAL
31: } as const;
32: 
33: export class Logger {
34:   private readonly level: LogLevel;
35:   private static readonly RESET = '\x1b[0m';
36: 
37:   constructor({ level = LogLevel.INFO }: { level?: LogLevelString | LogLevel } = {}) {
38:     this.level = this.parseLogLevel(level);
39:   }
40: 
41:   private parseLogLevel(level: LogLevel | LogLevelString): LogLevel {
42:     if (typeof level === 'number') return level;
43:     return LOG_LEVEL_MAP[level.toLowerCase() as LogLevelString];
44:   }
45: 
46:   private log(level: LogLevel, ...args: unknown[]): void {
47:     if (level < this.level) return;
48: 
49:     const color = LOG_COLORS[level];
50:     const levelStr = `[${LogLevel[level].toLowerCase()}]`;
51: 
52:     console.log(`${color}${levelStr}${Logger.RESET}`, ...args.map(this.formatValue));
53:   }
54: 
55:   private formatValue(value: unknown): string {
56:     if (value === null) return 'null';
57:     if (value === undefined) return 'undefined';
58:     return typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value);
59:   }
60: 
61:   private createLogMethod(level: LogLevel) {
62:     return (...args: unknown[]) => this.log(level, ...args);
63:   }
64: 
65:   trace = this.createLogMethod(LogLevel.TRACE);
66:   debug = this.createLogMethod(LogLevel.DEBUG);
67:   info = this.createLogMethod(LogLevel.INFO);
68:   warn = this.createLogMethod(LogLevel.WARN);
69:   error = this.createLogMethod(LogLevel.ERROR);
70:   fatal = this.createLogMethod(LogLevel.FATAL);
71: }
72: 
73: export interface LoggerOptions {
74:   level?: LogLevelString | LogLevel;
75: }
76: 
77: export function createLogger(options: LoggerOptions = {}): Logger {
78:   return new Logger(options);
79: }
80: 
81: export { LogLevel };
82: export type { LogLevelString };
```

## File: packages/mcp/eslint.config.js
```javascript
1: import baseConfig from "@danky/eslint-config/base";
2: 
3: export default [...baseConfig];
```

## File: packages/mcp/package.json
```json
 1: {
 2:   "name": "@danky/mcp",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "exports": {
10:     ".": {
11:       "types": "./dist/index.d.ts",
12:       "import": "./dist/index.js",
13:       "default": "./dist/index.js"
14:     },
15:     "./servers/*": {
16:       "types": "./dist/servers/*.d.ts",
17:       "import": "./dist/servers/*.js",
18:       "default": "./dist/servers/*.js"
19:     },
20:     "./logger": {
21:       "types": "./dist/logger.d.ts",
22:       "import": "./dist/logger.js",
23:       "default": "./dist/logger.js"
24:     }
25:   },
26:   "scripts": {
27:     "build": "tsc",
28:     "dev": "tsc --watch",
29:     "lint": "eslint .",
30:     "type-check": "tsc --noEmit",
31:     "clean": "rimraf .turbo node_modules dist"
32:   },
33:   "dependencies": {
34:     "@langchain/anthropic": "^0.3.11",
35:     "@langchain/community": "^0.3.20",
36:     "@langchain/core": "^0.3.26",
37:     "@langchain/groq": "^0.1.2",
38:     "@langchain/langgraph": "^0.2.36",
39:     "@langchain/openai": "^0.3.16",
40:     "@modelcontextprotocol/sdk": "^1.0.4",
41:     "@n8n/json-schema-to-zod": "^1.1.0",
42:     "dotenv": "^16.4.7",
43:     "json5": "^2.2.3",
44:     "yargs": "^17.7.2",
45:     "zod": "^3.24.1"
46:   },
47:   "devDependencies": {
48:     "@danky/eslint-config": "workspace:*",
49:     "@danky/typescript-config": "workspace:*",
50:     "@types/yargs": "^17.0.33",
51:     "eslint": "^9.0.0",
52:     "rimraf": "^5.0.5",
53:     "typescript": "^5.3.3"
54:   }
55: }
```

## File: packages/mcp/README.md
```markdown
  1: # Model Context Protocol (MCP) Implementation
  2: 
  3: ## Overview
  4: 
  5: The Model Context Protocol (MCP) is a standardized interface that enables applications to provide context for LLMs in a standardized way, separating the concerns of providing context from the actual LLM interaction.
  6: 
  7: ## Architecture
  8: 
  9: MCP follows a client-host-server architecture where each host can run multiple client instances:
 10: 
 11: ```
 12: 
 13:           Application Host           
 14:                          
 15:    Host                           
 16:              
 17:    C1    C2    C3           
 18:              
 19:                          
 20: 
 21:                      
 22:                      
 23:       
 24:      S1    S2    S3  
 25:       
 26:     Files   Database  APIs
 27: ```
 28: 
 29: ### Core Components
 30: 
 31: - **Host**: Creates and manages multiple client instances, controls permissions, enforces security policies
 32: - **Clients**: Maintain 1:1 connections with servers, handle protocol negotiation
 33: - **Servers**: Provide specialized context and capabilities through resources, tools, and prompts
 34: 
 35: ## Protocol Features
 36: 
 37: ### Base Protocol
 38: - JSON-RPC 2.0 message format
 39: - Stateful connections
 40: - Server and client capability negotiation
 41: - Bidirectional communication
 42: 
 43: ### Message Types
 44: 1. **Requests**: Bidirectional messages with method and parameters expecting a response
 45: 2. **Responses**: Successful results or errors matching specific request IDs
 46: 3. **Notifications**: One-way messages requiring no response
 47: 
 48: ### Transport Layer
 49: 
 50: MCP defines two standard transport mechanisms:
 51: 
 52: #### stdio Transport
 53: ```typescript
 54: import { Server } from "@modelcontextprotocol/sdk/server/index.js"
 55: import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js"
 56: 
 57: const server = new Server(
 58:   {
 59:     name: "example-server",
 60:     version: "0.1.0",
 61:   },
 62:   {
 63:     capabilities: {
 64:       resources: {},
 65:       tools: {},
 66:       prompts: {},
 67:     },
 68:   }
 69: )
 70: 
 71: const transport = new StdioServerTransport()
 72: await server.connect(transport)
 73: ```
 74: 
 75: #### HTTP with Server-Sent Events (SSE)
 76: ```typescript
 77: import { Server } from "@modelcontextprotocol/sdk/server/index.js"
 78: import { SSEServerTransport } from "@modelcontextprotocol/sdk/server/sse.js"
 79: 
 80: const transport = new SSEServerTransport("/message", res)
 81: const server = new Server(
 82:   {
 83:     name: "example-server",
 84:     version: "0.1.0",
 85:   },
 86:   {
 87:     capabilities: {},
 88:   }
 89: )
 90: 
 91: await server.connect(transport)
 92: ```
 93: 
 94: ## Core Capabilities
 95: 
 96: ### Resources
 97: Resources represent data that can be accessed by AI models:
 98: 
 99: ```typescript
100: server.setRequestHandler(ListResourcesRequestSchema, async () => {
101:   return {
102:     resources: [{
103:       uri: `resource://example/1`,
104:       mimeType: "text/plain",
105:       name: "Example Resource",
106:       description: "A text resource"
107:     }]
108:   }
109: })
110: ```
111: 
112: ### Tools
113: Tools enable LLMs to perform actions through your server:
114: 
115: ```typescript
116: server.setRequestHandler(CallToolRequestSchema, async (request) => {
117:   switch (request.params.name) {
118:     case "example_tool": {
119:       const title = String(request.params.arguments?.title)
120:       const content = String(request.params.arguments?.content)
121: 
122:       return {
123:         content: [{
124:           type: "text",
125:           text: `Operation completed`
126:         }]
127:       }
128:     }
129:     default:
130:       throw new Error("Unknown tool")
131:   }
132: })
133: ```
134: 
135: ### Prompts
136: Prompts define structured interactions with AI models:
137: 
138: ```typescript
139: server.setRequestHandler(ListPromptsRequestSchema, async () => {
140:   return {
141:     prompts: [
142:       {
143:         name: "example_prompt",
144:         description: "Example prompt",
145:       }
146:     ]
147:   }
148: })
149: ```
150: 
151: ## LangChain Integration
152: 
153: MCP tools can be integrated with LangChain using the `@h1deya/mcp-langchain-tools` package:
154: 
155: ```typescript
156: import { convertMCPServersToLangChainTools } from '@h1deya/mcp-langchain-tools'
157: 
158: const mcpServers = {
159:   filesystem: {
160:     command: 'npx',
161:     args: [
162:       '-y',
163:       '@modelcontextprotocol/server-filesystem',
164:       '/path/to/directory'
165:     ]
166:   }
167: }
168: 
169: const { tools, cleanup } = await convertMCPServersToLangChainTools(mcpServers)
170: ```
171: 
172: Currently supports OpenAI, Anthropic, and Groq LLMs.
173: 
174: ### Current Limitations
175: - Only text-based tool results are supported
176: 
177: ## Development
178: 
179: ### Setup
180: ```bash
181: npm install
182: npm run build
183: ```
184: 
185: ## Design Principles
186: 
187: 1. **Servers should be extremely easy to build**
188:    - Host applications handle complex orchestration
189:    - Servers focus on specific, well-defined capabilities
190:    - Simple interfaces minimize implementation overhead
191: 
192: 2. **Servers should be highly composable**
193:    - Each server provides focused functionality
194:    - Multiple servers can be combined seamlessly
195:    - Shared protocol enables interoperability
196: 
197: 3. **Servers maintain isolation**
198:    - Servers receive only necessary contextual information
199:    - Full conversation history stays with the host
200:    - Each server connection maintains isolation
201:    - Cross-server interactions are controlled by the host
202: 
203: 4. **Progressive feature adoption**
204:    - Core protocol provides minimal required functionality
205:    - Additional capabilities can be negotiated as needed
206:    - Servers and clients evolve independently
207:    - Backwards compatibility is maintained
208: 
209: ## Additional Resources
210: 
211: - [Model Context Protocol](https://modelcontextprotocol.io) - Official documentation
212: - [JSON-RPC 2.0 Specification](https://www.jsonrpc.org/specification)
213: - [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
214: - [MCP LangChain Tools](https://github.com/hideya/mcp-langchain-tools-ts)
```

## File: packages/mcp/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "dist",
 5:     "rootDir": "src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/schema/src/chat-batch.ts
```typescript
  1: import { z } from 'zod';
  2: import { baseResponseSchema } from './types';
  3: import { messageMetadataSchema, messageContentSchema, MODEL_IDS } from './metadata';
  4: import { messageRoleSchema } from './chat';
  5: import { chatSessionSchema } from './chat-session';
  6: 
  7: // Constants
  8: const MAX_BATCH_SIZE = 100;
  9: const MIN_BATCH_SIZE = 1;
 10: 
 11: // Batch delete sessions request
 12: export const batchDeleteSessionsRequestSchema = z.object({
 13:   sessionIds: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 14:   permanent: z.boolean().default(false),
 15: });
 16: 
 17: // Batch delete sessions response
 18: export const batchDeleteSessionsResponseSchema = baseResponseSchema.extend({
 19:   data: z.object({
 20:     deletedCount: z.number(),
 21:     deletedIds: z.array(z.string()),
 22:     errors: z.array(z.object({
 23:       id: z.string(),
 24:       error: z.string(),
 25:     })).optional(),
 26:   }).optional(),
 27: });
 28: 
 29: // Batch restore sessions request
 30: export const batchRestoreSessionsRequestSchema = z.object({
 31:   sessionIds: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 32: });
 33: 
 34: // Batch restore sessions response
 35: export const batchRestoreSessionsResponseSchema = baseResponseSchema.extend({
 36:   data: z.object({
 37:     restoredCount: z.number(),
 38:     restoredSessions: z.array(chatSessionSchema),
 39:     errors: z.array(z.object({
 40:       id: z.string(),
 41:       error: z.string(),
 42:     })).optional(),
 43:   }).optional(),
 44: });
 45: 
 46: // Batch archive sessions request
 47: export const batchArchiveSessionsRequestSchema = z.object({
 48:   sessionIds: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 49:   archive: z.boolean().default(true),
 50: });
 51: 
 52: // Batch archive sessions response
 53: export const batchArchiveSessionsResponseSchema = baseResponseSchema.extend({
 54:   data: z.object({
 55:     updatedCount: z.number(),
 56:     updatedIds: z.array(z.string()),
 57:     errors: z.array(z.object({
 58:       id: z.string(),
 59:       error: z.string(),
 60:     })).optional(),
 61:   }).optional(),
 62: });
 63: 
 64: // Batch update sessions request
 65: export const batchUpdateSessionsRequestSchema = z.object({
 66:   sessions: z.array(z.object({
 67:     id: z.string().uuid(),
 68:     name: z.string().min(1).max(255).optional(),
 69:     description: z.string().max(1000).optional(),
 70:     modelId: z.enum(MODEL_IDS).optional(),
 71:     isArchived: z.boolean().optional(),
 72:     metadata: z.record(z.unknown()).optional(),
 73:   })).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 74: });
 75: 
 76: // Batch update sessions response
 77: export const batchUpdateSessionsResponseSchema = baseResponseSchema.extend({
 78:   data: z.object({
 79:     updatedCount: z.number(),
 80:     updatedSessions: z.array(chatSessionSchema),
 81:     errors: z.array(z.object({
 82:       id: z.string(),
 83:       error: z.string(),
 84:     })).optional(),
 85:   }).optional(),
 86: });
 87: 
 88: // Batch delete messages request
 89: export const batchDeleteMessagesRequestSchema = z.object({
 90:   messageIds: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 91:   permanent: z.boolean().default(false),
 92: });
 93: 
 94: // Batch delete messages response
 95: export const batchDeleteMessagesResponseSchema = baseResponseSchema.extend({
 96:   data: z.object({
 97:     deletedCount: z.number(),
 98:     deletedIds: z.array(z.string()),
 99:     errors: z.array(z.object({
100:       id: z.string(),
101:       error: z.string(),
102:     })).optional(),
103:   }).optional(),
104: });
105: 
106: // Batch restore messages request
107: export const batchRestoreMessagesRequestSchema = z.object({
108:   messageIds: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
109: });
110: 
111: // Batch restore messages response
112: export const batchRestoreMessagesResponseSchema = baseResponseSchema.extend({
113:   data: z.object({
114:     restoredCount: z.number(),
115:     restoredIds: z.array(z.string()),
116:     errors: z.array(z.object({
117:       id: z.string(),
118:       error: z.string(),
119:     })).optional(),
120:   }).optional(),
121: });
122: 
123: // Batch create messages request
124: export const batchCreateMessagesRequestSchema = z.object({
125:   sessionId: z.string().uuid(),
126:   messages: z.array(z.object({
127:     role: messageRoleSchema,
128:     content: z.array(messageContentSchema).min(1),
129:     metadata: messageMetadataSchema.optional(),
130:   })).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
131: });
132: 
133: // Batch create messages response
134: export const batchCreateMessagesResponseSchema = baseResponseSchema.extend({
135:   data: z.object({
136:     createdCount: z.number(),
137:     messages: z.array(z.object({
138:       id: z.string(),
139:       role: messageRoleSchema,
140:       content: z.array(messageContentSchema),
141:       sessionId: z.string(),
142:       metadata: messageMetadataSchema.optional(),
143:       createdAt: z.date(),
144:       updatedAt: z.date(),
145:     })),
146:     errors: z.array(z.object({
147:       index: z.number(),
148:       error: z.string(),
149:     })).optional(),
150:   }).optional(),
151: });
```

## File: packages/schema/src/chat-session.ts
```typescript
 1: import { z } from 'zod';
 2: import { baseResponseSchema } from './types';
 3: import { sessionMetadataSchema, MODEL_IDS } from './metadata';
 4: 
 5: // Chat session schema
 6: export const chatSessionSchema = z.object({
 7:   id: z.string().uuid(),
 8:   title: z.string().min(1).max(255),
 9:   description: z.string().max(1000).optional(),
10:   modelId: z.enum(MODEL_IDS),
11:   userId: z.string().uuid(),
12:   isArchived: z.boolean().default(false),
13:   metadata: sessionMetadataSchema.optional(),
14:   createdAt: z.date(),
15:   updatedAt: z.date(),
16:   deletedAt: z.date().nullable(),
17: });
18: 
19: // Create session request
20: export const createSessionRequestSchema = z.object({
21:   name: z.string().min(1).max(255),
22:   description: z.string().max(1000).optional(),
23:   modelId: z.enum(MODEL_IDS),
24:   metadata: sessionMetadataSchema.optional(),
25: });
26: 
27: // Create session response
28: export const createSessionResponseSchema = baseResponseSchema.extend({
29:   data: chatSessionSchema.optional(),
30: });
31: 
32: // List sessions request
33: export const listSessionsRequestSchema = z.object({
34:   page: z.number().int().positive(),
35:   limit: z.number().int().min(1).max(100),
36:   search: z.string().max(255).optional(),
37:   modelId: z.enum(MODEL_IDS).optional(),
38:   isArchived: z.boolean().optional(),
39:   includeDeleted: z.boolean().default(false),
40:   sortBy: z.enum(['createdAt', 'updatedAt', 'title']).default('updatedAt'),
41:   sortOrder: z.enum(['asc', 'desc']).default('desc'),
42: });
43: 
44: // List sessions response
45: export const listSessionsResponseSchema = baseResponseSchema.extend({
46:   data: z.object({
47:     sessions: z.array(chatSessionSchema),
48:     pagination: z.object({
49:       page: z.number(),
50:       limit: z.number(),
51:       totalPages: z.number(),
52:       totalItems: z.number(),
53:     }),
54:   }).optional(),
55: });
56: 
57: // Update session request
58: export const updateSessionRequestSchema = z.object({
59:   id: z.string().uuid(),
60:   name: z.string().min(1).max(255).optional(),
61:   description: z.string().max(1000).optional(),
62:   modelId: z.enum(MODEL_IDS).optional(),
63:   isArchived: z.boolean().optional(),
64:   metadata: sessionMetadataSchema.optional(),
65: });
66: 
67: // Update session response
68: export const updateSessionResponseSchema = baseResponseSchema.extend({
69:   data: chatSessionSchema.optional(),
70: });
71: 
72: // Delete session request
73: export const deleteSessionRequestSchema = z.object({
74:   id: z.string().uuid(),
75:   permanent: z.boolean().default(false),
76: });
77: 
78: // Delete session response
79: export const deleteSessionResponseSchema = baseResponseSchema.extend({
80:   data: z.object({
81:     id: z.string(),
82:     deletedAt: z.date(),
83:   }).optional(),
84: });
85: 
86: // Restore session request
87: export const restoreSessionRequestSchema = z.object({
88:   id: z.string().uuid(),
89: });
90: 
91: // Restore session response
92: export const restoreSessionResponseSchema = baseResponseSchema.extend({
93:   data: chatSessionSchema.optional(),
94: });
```

## File: packages/schema/src/chat.ts
```typescript
 1: import { z } from 'zod';
 2: import { baseResponseSchema } from './types';
 3: import { messageMetadataSchema, messageContentSchema } from './metadata';
 4: 
 5: // Message role schema
 6: export const messageRoleSchema = z.enum(['user', 'assistant', 'system', 'tool', 'function']);
 7: 
 8: // Chat message schema
 9: export const chatMessageSchema = z.object({
10:   id: z.string().uuid(),
11:   role: messageRoleSchema,
12:   content: z.array(messageContentSchema).min(1),
13:   sessionId: z.string().uuid(),
14:   metadata: messageMetadataSchema.optional(),
15:   createdAt: z.date(),
16:   updatedAt: z.date(),
17:   deletedAt: z.date().nullable(),
18: });
19: 
20: // Create message request
21: export const createMessageRequestSchema = z.object({
22:   sessionId: z.string().uuid(),
23:   role: messageRoleSchema,
24:   content: z.array(messageContentSchema).min(1),
25:   metadata: messageMetadataSchema.optional(),
26: });
27: 
28: // Create message response
29: export const createMessageResponseSchema = baseResponseSchema.extend({
30:   data: chatMessageSchema.optional(),
31: });
32: 
33: // List messages request
34: export const listMessagesRequestSchema = z.object({
35:   sessionId: z.string().uuid(),
36:   page: z.number().int().positive(),
37:   limit: z.number().int().min(1).max(100),
38:   includeDeleted: z.boolean().default(false),
39:   sortOrder: z.enum(['asc', 'desc']).default('asc'),
40: });
41: 
42: // List messages response
43: export const listMessagesResponseSchema = baseResponseSchema.extend({
44:   data: z.object({
45:     messages: z.array(chatMessageSchema),
46:     pagination: z.object({
47:       page: z.number(),
48:       limit: z.number(),
49:       totalPages: z.number(),
50:       totalItems: z.number(),
51:     }),
52:   }).optional(),
53: });
54: 
55: // Delete message request
56: export const deleteMessageRequestSchema = z.object({
57:   id: z.string().uuid(),
58:   permanent: z.boolean().default(false),
59: });
60: 
61: // Delete message response
62: export const deleteMessageResponseSchema = baseResponseSchema.extend({
63:   data: z.object({
64:     id: z.string(),
65:     deletedAt: z.date(),
66:   }).optional(),
67: });
68: 
69: // Restore message request
70: export const restoreMessageRequestSchema = z.object({
71:   id: z.string().uuid(),
72: });
73: 
74: // Restore message response
75: export const restoreMessageResponseSchema = baseResponseSchema.extend({
76:   data: chatMessageSchema.optional(),
77: });
```

## File: packages/schema/src/index.ts
```typescript
 1: // Export base types
 2: export * from './types';
 3: 
 4: // Export chat message schemas
 5: export * from './chat';
 6: 
 7: // Export chat session schemas
 8: export * from './chat-session';
 9: 
10: // Export batch operation schemas
11: export * from './chat-batch';
12: 
13: // Export types from zod
14: export { z } from 'zod';
```

## File: packages/schema/src/metadata.ts
```typescript
  1: import { z } from 'zod';
  2: 
  3: // Model configuration metadata
  4: export const modelConfigSchema = z.object({
  5:   temperature: z.number().min(0).max(2).optional(),
  6:   topP: z.number().min(0).max(1).optional(),
  7:   frequencyPenalty: z.number().min(-2).max(2).optional(),
  8:   presencePenalty: z.number().min(-2).max(2).optional(),
  9:   maxTokens: z.number().positive().max(32000).optional(),
 10:   stop: z.array(z.string()).max(4).optional(),
 11: });
 12: 
 13: // Valid model IDs
 14: export const MODEL_IDS = [
 15:   'gpt-4-turbo-preview',
 16:   'gpt-4',
 17:   'gpt-3.5-turbo',
 18:   'claude-3-opus',
 19:   'claude-3-sonnet',
 20:   'claude-2',
 21:   'gemini-pro',
 22:   'mistral-medium',
 23:   'mixtral-8x7b',
 24: ] as const;
 25: 
 26: // Message metadata
 27: export const messageMetadataSchema = z.object({
 28:   tokens: z.object({
 29:     prompt: z.number().nonnegative(),
 30:     completion: z.number().nonnegative(),
 31:     total: z.number().nonnegative(),
 32:   }).optional(),
 33:   model: z.object({
 34:     id: z.enum(MODEL_IDS),
 35:     provider: z.enum(['openai', 'anthropic', 'google', 'mistral']),
 36:     config: modelConfigSchema.optional(),
 37:   }).optional(),
 38:   timing: z.object({
 39:     startedAt: z.date(),
 40:     completedAt: z.date(),
 41:     latencyMs: z.number().nonnegative(),
 42:   }).optional(),
 43:   error: z.object({
 44:     code: z.string(),
 45:     message: z.string(),
 46:     type: z.enum(['rate_limit', 'token_limit', 'context_length', 'invalid_request', 'server_error']),
 47:   }).optional(),
 48:   tools: z.array(z.object({
 49:     name: z.string(),
 50:     args: z.record(z.unknown()),
 51:     result: z.unknown(),
 52:     error: z.string().optional(),
 53:   })).optional(),
 54: });
 55: 
 56: // Session metadata
 57: export const sessionMetadataSchema = z.object({
 58:   model: z.object({
 59:     id: z.enum(MODEL_IDS),
 60:     provider: z.enum(['openai', 'anthropic', 'google', 'mistral']),
 61:     config: modelConfigSchema,
 62:   }),
 63:   purpose: z.enum(['chat', 'completion', 'analysis', 'coding', 'other']),
 64:   tags: z.array(z.string()).max(10).optional(),
 65:   language: z.string().optional(), // For coding sessions
 66:   framework: z.string().optional(), // For coding sessions
 67:   context: z.object({
 68:     systemPrompt: z.string().optional(),
 69:     documents: z.array(z.object({
 70:       id: z.string(),
 71:       type: z.enum(['file', 'url', 'text']),
 72:       name: z.string(),
 73:       summary: z.string().optional(),
 74:     })).optional(),
 75:   }).optional(),
 76:   stats: z.object({
 77:     messageCount: z.number().nonnegative(),
 78:     totalTokens: z.number().nonnegative(),
 79:     averageLatencyMs: z.number().nonnegative(),
 80:     lastActive: z.date(),
 81:   }).optional(),
 82: });
 83: 
 84: // Content validation
 85: export const textContentSchema = z.object({
 86:   type: z.literal('text'),
 87:   content: z.string().max(32000), // OpenAI's max token limit
 88: });
 89: 
 90: export const codeContentSchema = z.object({
 91:   type: z.literal('code'),
 92:   content: z.string().max(32000),
 93:   language: z.string(),
 94:   fileName: z.string().optional(),
 95:   lineNumbers: z.boolean().optional(),
 96: });
 97: 
 98: export const imageContentSchema = z.object({
 99:   type: z.literal('image'),
100:   content: z.string().url(),
101:   mimeType: z.enum(['image/png', 'image/jpeg', 'image/gif', 'image/webp']),
102:   width: z.number().positive().optional(),
103:   height: z.number().positive().optional(),
104:   altText: z.string().optional(),
105: });
106: 
107: export const fileContentSchema = z.object({
108:   type: z.literal('file'),
109:   content: z.string().url(),
110:   mimeType: z.string(),
111:   fileName: z.string(),
112:   fileSize: z.number().positive(),
113:   checksum: z.string().optional(),
114: });
115: 
116: // Combined content schema
117: export const messageContentSchema = z.discriminatedUnion('type', [
118:   textContentSchema,
119:   codeContentSchema,
120:   imageContentSchema,
121:   fileContentSchema,
122: ]);
```

## File: packages/schema/src/test-eslint.ts
```typescript
1: // Test file to verify ESLint rules
2: export function testFunction(): boolean {
3:   return true;
4: }
```

## File: packages/schema/src/types.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: // Base response schema for API endpoints
 4: export const baseResponseSchema = z.object({
 5:   success: z.boolean(),
 6:   message: z.string().optional(),
 7:   error: z.string().optional(),
 8: });
 9: 
10: // Base pagination schema
11: export const paginationSchema = z.object({
12:   page: z.number().int().positive(),
13:   limit: z.number().int().positive().max(100),
14:   totalPages: z.number().int().positive().optional(),
15:   totalItems: z.number().int().nonnegative().optional(),
16: });
17: 
18: // Base timestamp fields
19: export const timestampFields = {
20:   createdAt: z.date(),
21:   updatedAt: z.date(),
22: };
23: 
24: // Base ID field
25: export const idField = {
26:   id: z.string().uuid(),
27: };
28: 
29: // Base soft delete field
30: export const softDeleteField = {
31:   deletedAt: z.date().nullable(),
32: };
```

## File: packages/schema/eslint.config.js
```javascript
1: import baseConfig from "@danky/eslint-config/base";
2: 
3: export default [
4:   {
5:     ignores: ["dist", ".turbo", "node_modules"]
6:   },
7:   ...baseConfig
8: ];
```

## File: packages/schema/package.json
```json
 1: {
 2:   "name": "@danky/schema",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "exports": {
10:     ".": "./dist/index.js"
11:   },
12:   "scripts": {
13:     "build": "tsup",
14:     "dev": "tsup --watch",
15:     "lint": "eslint .",
16:     "type-check": "tsc --noEmit",
17:     "clean": "rimraf .turbo node_modules dist"
18:   },
19:   "dependencies": {
20:     "zod": "^3.22.4"
21:   },
22:   "devDependencies": {
23:     "@danky/eslint-config": "workspace:*",
24:     "@danky/typescript-config": "workspace:*",
25:     "eslint": "^8.56.0",
26:     "rimraf": "^5.0.5",
27:     "tsup": "^8.0.1",
28:     "typescript": "^5.3.3"
29:   }
30: }
```

## File: packages/schema/README.md
```markdown
  1: # @danky/schema
  2: 
  3: Shared type definitions and validation schemas for the Danky AI Chatbot platform, built with Zod.
  4: 
  5: ## Overview
  6: 
  7: The schema package provides centralized type definitions, validation schemas, and utilities for ensuring type safety and data validation across the platform. It uses Zod for runtime type checking and validation.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13:  ai/              # AI-related schemas
 14:  chat/            # Chat-related schemas
 15:  db/              # Database schemas
 16:  api/             # API schemas
 17:  config/          # Configuration schemas
 18:  types/           # Shared TypeScript types
 19: ```
 20: 
 21: ## Key Features
 22: 
 23: - **Type Safety**: Full TypeScript coverage
 24: - **Runtime Validation**: Zod schemas
 25: - **Error Messages**: Customizable validation errors
 26: - **Composability**: Reusable schema components
 27: - **Documentation**: Type and schema docs
 28: - **Testing**: Validation test utilities
 29: 
 30: ## Usage
 31: 
 32: ### Basic Validation
 33: 
 34: ```typescript
 35: import { userSchema } from '@danky/schema'
 36: 
 37: // Validate data
 38: const result = userSchema.safeParse(data)
 39: if (!result.success) {
 40:   console.error(result.error.format())
 41:   return
 42: }
 43: 
 44: // Use validated data
 45: const user = result.data
 46: ```
 47: 
 48: ### Type Usage
 49: 
 50: ```typescript
 51: import type { User, Message } from '@danky/schema'
 52: 
 53: function processUser(user: User) {
 54:   // TypeScript knows the shape of User
 55: }
 56: 
 57: function processMessage(message: Message) {
 58:   // TypeScript knows the shape of Message
 59: }
 60: ```
 61: 
 62: ## AI Development Notes
 63: 
 64: ### Key Concepts
 65: 
 66: 1. **Schema Organization**
 67:    - Domain-specific schemas
 68:    - Shared base schemas
 69:    - Type exports
 70:    - Error messages
 71: 
 72: 2. **Validation Patterns**
 73:    - Input validation
 74:    - API responses
 75:    - Database records
 76:    - Configuration
 77: 
 78: 3. **Type System**
 79:    - Branded types
 80:    - Union types
 81:    - Utility types
 82:    - Type inference
 83: 
 84: ### Common Patterns
 85: 
 86: #### Schema Definition
 87: ```typescript
 88: import { z } from 'zod'
 89: 
 90: export const userSchema = z.object({
 91:   id: z.string().uuid(),
 92:   name: z.string().min(1),
 93:   email: z.string().email(),
 94:   role: z.enum(['user', 'admin']),
 95:   metadata: z.record(z.unknown()).optional(),
 96: })
 97: 
 98: export type User = z.infer<typeof userSchema>
 99: ```
100: 
101: #### Branded Types
102: ```typescript
103: import { z } from 'zod'
104: 
105: export const UserId = z.string().uuid().brand('UserId')
106: export type UserId = z.infer<typeof UserId>
107: 
108: export const MessageId = z.string().uuid().brand('MessageId')
109: export type MessageId = z.infer<typeof MessageId>
110: ```
111: 
112: #### API Schemas
113: ```typescript
114: import { z } from 'zod'
115: 
116: export const createUserRequest = z.object({
117:   name: z.string().min(1),
118:   email: z.string().email(),
119: })
120: 
121: export const createUserResponse = z.object({
122:   user: userSchema,
123:   token: z.string(),
124: })
125: 
126: export type CreateUserRequest = z.infer<typeof createUserRequest>
127: export type CreateUserResponse = z.infer<typeof createUserResponse>
128: ```
129: 
130: ## Schema Library
131: 
132: ### Core Schemas
133: - User
134: - Message
135: - Session
136: - Tool
137: - Config
138: - Error
139: 
140: ### Domain Schemas
141: - Chat
142: - MCP
143: - Database
144: - API
145: - Events
146: 
147: ## Development
148: 
149: ### Adding New Schemas
150: 
151: 1. Create schema file:
152: ```typescript
153: // src/chat/message.ts
154: import { z } from 'zod'
155: 
156: export const messageSchema = z.object({
157:   id: z.string().uuid(),
158:   content: z.string(),
159:   timestamp: z.date(),
160: })
161: 
162: export type Message = z.infer<typeof messageSchema>
163: ```
164: 
165: 2. Export from index:
166: ```typescript
167: // src/index.ts
168: export * from './chat/message'
169: ```
170: 
171: ### Testing
172: ```bash
173: pnpm test
174: pnpm test:watch
175: ```
176: 
177: ### Linting
178: ```bash
179: pnpm lint
180: pnpm type-check
181: ```
182: 
183: ## Validation Utilities
184: 
185: ### Type Guards
186: ```typescript
187: import { isUser, isMessage } from '@danky/schema'
188: 
189: if (isUser(data)) {
190:   // data is typed as User
191: }
192: 
193: if (isMessage(data)) {
194:   // data is typed as Message
195: }
196: ```
197: 
198: ### Error Formatting
199: ```typescript
200: import { formatZodError } from '@danky/schema'
201: 
202: try {
203:   schema.parse(data)
204: } catch (error) {
205:   const formatted = formatZodError(error)
206:   console.error(formatted)
207: }
208: ```
209: 
210: ## Troubleshooting
211: 
212: ### Common Issues
213: 1. **Type Errors**: Check schema definitions
214: 2. **Validation Errors**: Check input data
215: 3. **Circular Dependencies**: Check imports
216: 4. **Performance**: Check schema complexity
217: 
218: ### Debug Tools
219: - Type checkers
220: - Schema validators
221: - Error formatters
222: - Test utilities
223: 
224: ## Additional Resources
225: 
226: - [Type System Guide](../../docs/TYPES.md)
227: - [Validation Guide](../../docs/VALIDATION.md)
228: - [Schema Best Practices](../../docs/SCHEMAS.md)
229: - [Error Handling Guide](../../docs/ERRORS.md)
```

## File: packages/schema/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/schema/tsup.config.ts
```typescript
 1: import { defineConfig } from "tsup";
 2: 
 3: export default defineConfig({
 4:   entry: ["src/index.ts"],
 5:   format: ["cjs", "esm"],
 6:   dts: true,
 7:   splitting: false,
 8:   sourcemap: true,
 9:   clean: true,
10: });
```

## File: packages/typescript-config/base.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "Default",
 4:   "compilerOptions": {
 5:     "composite": false,
 6:     "declaration": true,
 7:     "declarationMap": true,
 8:     "esModuleInterop": true,
 9:     "forceConsistentCasingInFileNames": true,
10:     "inlineSources": false,
11:     "isolatedModules": true,
12:     "moduleResolution": "bundler",
13:     "preserveWatchOutput": true,
14:     "skipLibCheck": true,
15:     "resolveJsonModule": true,
16:     "allowJs": true,
17:     "target": "ES2022",
18:     "module": "ESNext",
19:     "lib": ["ES2022", "DOM", "DOM.Iterable"],
20:     "types": ["node"],
21: 
22:     // Strict Type Checking
23:     "strict": true,
24:     "noImplicitAny": true,
25:     "strictNullChecks": true,
26:     "strictFunctionTypes": true,
27:     "strictBindCallApply": true,
28:     "strictPropertyInitialization": true,
29:     "noImplicitThis": true,
30:     "useUnknownInCatchVariables": true,
31:     "alwaysStrict": true,
32: 
33:     // Additional Checks
34:     "noUnusedLocals": true,
35:     "noUnusedParameters": true,
36:     "noImplicitReturns": true,
37:     "noFallthroughCasesInSwitch": true,
38:     "noUncheckedIndexedAccess": false,
39: 
40:     // Module Resolution
41:     "allowSyntheticDefaultImports": true,
42:     "verbatimModuleSyntax": true,
43:     "exactOptionalPropertyTypes": false,
44:     "noPropertyAccessFromIndexSignature": false,
45:     "allowUnusedLabels": false,
46:     "allowUnreachableCode": false
47:   },
48:   "exclude": ["node_modules", "dist"]
49: }
```

## File: packages/typescript-config/nextjs.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "Next.js",
 4:   "extends": "./base.json",
 5:   "compilerOptions": {
 6:     "allowJs": true,
 7:     "declaration": false,
 8:     "declarationMap": false,
 9:     "incremental": true,
10:     "jsx": "preserve",
11:     "lib": ["dom", "dom.iterable", "esnext"],
12:     "module": "esnext",
13:     "moduleResolution": "bundler",
14:     "noEmit": true,
15:     "plugins": [{ "name": "next" }],
16:     "resolveJsonModule": true,
17:     "target": "ES2022",
18:     "types": ["node", "react", "react-dom"],
19:     "paths": {
20:       "@/*": ["./src/*"]
21:     },
22:     "verbatimModuleSyntax": true,
23:     "allowImportingTsExtensions": true,
24:     "moduleDetection": "force"
25:   },
26:   "include": ["src", "next-env.d.ts"],
27:   "exclude": [
28:     "node_modules",
29:     ".next",
30:     "coverage",
31:     ".turbo",
32:     "**/*.test.ts",
33:     "**/*.spec.ts"
34:   ]
35: }
```

## File: packages/typescript-config/package.json
```json
 1: {
 2:   "name": "@danky/typescript-config",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "main": "base.json",
 6:   "files": [
 7:     "base.json",
 8:     "react-library.json",
 9:     "nextjs.json"
10:   ]
11: }
```

## File: packages/typescript-config/react-library.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "React Library",
 4:   "extends": "./base.json",
 5:   "compilerOptions": {
 6:     "jsx": "react-jsx",
 7:     "jsxImportSource": "react",
 8:     "lib": ["dom", "dom.iterable", "esnext"],
 9:     "module": "ESNext",
10:     "moduleResolution": "bundler",
11:     "target": "ES2022",
12:     "types": ["node", "react", "react-dom"],
13:     "paths": {
14:       "@/*": ["./src/*"]
15:     },
16:     "declaration": true,
17:     "declarationMap": true,
18:     "sourceMap": true,
19:     "noEmit": true,
20:     "isolatedModules": true,
21:     "allowImportingTsExtensions": true,
22:     "moduleDetection": "force",
23:     "verbatimModuleSyntax": false
24:   },
25:   "include": ["src", "*.ts"],
26:   "exclude": ["node_modules", "dist"]
27: }
```

## File: packages/ui/packages/eslint-config/package.json
```json
1: {"name":"@danky/eslint-config","version":"0.0.1","private":true,"main":"index.js"}
```

## File: packages/ui/src/components/accordion.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AccordionPrimitive from "@radix-ui/react-accordion"
 5: import { ChevronDown } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const Accordion = AccordionPrimitive.Root
10: 
11: const AccordionItem = React.forwardRef<
12:   React.ElementRef<typeof AccordionPrimitive.Item>,
13:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
14: >(({ className, ...props }, ref) => (
15:   <AccordionPrimitive.Item
16:     ref={ref}
17:     className={cn("border-b", className)}
18:     {...props}
19:   />
20: ))
21: AccordionItem.displayName = "AccordionItem"
22: 
23: const AccordionTrigger = React.forwardRef<
24:   React.ElementRef<typeof AccordionPrimitive.Trigger>,
25:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
26: >(({ className, children, ...props }, ref) => (
27:   <AccordionPrimitive.Header className="flex">
28:     <AccordionPrimitive.Trigger
29:       ref={ref}
30:       className={cn(
31:         "flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",
32:         className
33:       )}
34:       {...props}
35:     >
36:       {children}
37:       <ChevronDown className="h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200" />
38:     </AccordionPrimitive.Trigger>
39:   </AccordionPrimitive.Header>
40: ))
41: AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName
42: 
43: const AccordionContent = React.forwardRef<
44:   React.ElementRef<typeof AccordionPrimitive.Content>,
45:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
46: >(({ className, children, ...props }, ref) => (
47:   <AccordionPrimitive.Content
48:     ref={ref}
49:     className="overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
50:     {...props}
51:   >
52:     <div className={cn("pb-4 pt-0", className)}>{children}</div>
53:   </AccordionPrimitive.Content>
54: ))
55: AccordionContent.displayName = AccordionPrimitive.Content.displayName
56: 
57: export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
```

## File: packages/ui/src/components/alert-dialog.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"
  5: 
  6: import { cn } from "@/lib/utils"
  7: import { buttonVariants } from "./button"
  8: 
  9: const AlertDialog = AlertDialogPrimitive.Root
 10: 
 11: const AlertDialogTrigger = AlertDialogPrimitive.Trigger
 12: 
 13: const AlertDialogPortal = AlertDialogPrimitive.Portal
 14: 
 15: const AlertDialogOverlay = React.forwardRef<
 16:   React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
 17:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
 18: >(({ className, ...props }, ref) => (
 19:   <AlertDialogPrimitive.Overlay
 20:     className={cn(
 21:       "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
 22:       className
 23:     )}
 24:     {...props}
 25:     ref={ref}
 26:   />
 27: ))
 28: AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName
 29: 
 30: const AlertDialogContent = React.forwardRef<
 31:   React.ElementRef<typeof AlertDialogPrimitive.Content>,
 32:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
 33: >(({ className, ...props }, ref) => (
 34:   <AlertDialogPortal>
 35:     <AlertDialogOverlay />
 36:     <AlertDialogPrimitive.Content
 37:       ref={ref}
 38:       className={cn(
 39:         "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
 40:         className
 41:       )}
 42:       {...props}
 43:     />
 44:   </AlertDialogPortal>
 45: ))
 46: AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName
 47: 
 48: const AlertDialogHeader = ({
 49:   className,
 50:   ...props
 51: }: React.HTMLAttributes<HTMLDivElement>) => (
 52:   <div
 53:     className={cn(
 54:       "flex flex-col space-y-2 text-center sm:text-left",
 55:       className
 56:     )}
 57:     {...props}
 58:   />
 59: )
 60: AlertDialogHeader.displayName = "AlertDialogHeader"
 61: 
 62: const AlertDialogFooter = ({
 63:   className,
 64:   ...props
 65: }: React.HTMLAttributes<HTMLDivElement>) => (
 66:   <div
 67:     className={cn(
 68:       "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
 69:       className
 70:     )}
 71:     {...props}
 72:   />
 73: )
 74: AlertDialogFooter.displayName = "AlertDialogFooter"
 75: 
 76: const AlertDialogTitle = React.forwardRef<
 77:   React.ElementRef<typeof AlertDialogPrimitive.Title>,
 78:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
 79: >(({ className, ...props }, ref) => (
 80:   <AlertDialogPrimitive.Title
 81:     ref={ref}
 82:     className={cn("text-lg font-semibold", className)}
 83:     {...props}
 84:   />
 85: ))
 86: AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName
 87: 
 88: const AlertDialogDescription = React.forwardRef<
 89:   React.ElementRef<typeof AlertDialogPrimitive.Description>,
 90:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
 91: >(({ className, ...props }, ref) => (
 92:   <AlertDialogPrimitive.Description
 93:     ref={ref}
 94:     className={cn("text-sm text-muted-foreground", className)}
 95:     {...props}
 96:   />
 97: ))
 98: AlertDialogDescription.displayName =
 99:   AlertDialogPrimitive.Description.displayName
100: 
101: const AlertDialogAction = React.forwardRef<
102:   React.ElementRef<typeof AlertDialogPrimitive.Action>,
103:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
104: >(({ className, ...props }, ref) => (
105:   <AlertDialogPrimitive.Action
106:     ref={ref}
107:     className={cn(buttonVariants(), className)}
108:     {...props}
109:   />
110: ))
111: AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName
112: 
113: const AlertDialogCancel = React.forwardRef<
114:   React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
115:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
116: >(({ className, ...props }, ref) => (
117:   <AlertDialogPrimitive.Cancel
118:     ref={ref}
119:     className={cn(
120:       buttonVariants({ variant: "outline" }),
121:       "mt-2 sm:mt-0",
122:       className
123:     )}
124:     {...props}
125:   />
126: ))
127: AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName
128: 
129: export {
130:   AlertDialog,
131:   AlertDialogPortal,
132:   AlertDialogOverlay,
133:   AlertDialogTrigger,
134:   AlertDialogContent,
135:   AlertDialogHeader,
136:   AlertDialogFooter,
137:   AlertDialogTitle,
138:   AlertDialogDescription,
139:   AlertDialogAction,
140:   AlertDialogCancel,
141: }
```

## File: packages/ui/src/components/alert.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const alertVariants = cva(
 7:   "relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",
 8:   {
 9:     variants: {
10:       variant: {
11:         default: "bg-background text-foreground",
12:         destructive:
13:           "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
14:       },
15:     },
16:     defaultVariants: {
17:       variant: "default",
18:     },
19:   }
20: )
21: 
22: const Alert = React.forwardRef<
23:   HTMLDivElement,
24:   React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
25: >(({ className, variant, ...props }, ref) => (
26:   <div
27:     ref={ref}
28:     role="alert"
29:     className={cn(alertVariants({ variant }), className)}
30:     {...props}
31:   />
32: ))
33: Alert.displayName = "Alert"
34: 
35: const AlertTitle = React.forwardRef<
36:   HTMLParagraphElement,
37:   React.HTMLAttributes<HTMLHeadingElement>
38: >(({ className, ...props }, ref) => (
39:   <h5
40:     ref={ref}
41:     className={cn("mb-1 font-medium leading-none tracking-tight", className)}
42:     {...props}
43:   />
44: ))
45: AlertTitle.displayName = "AlertTitle"
46: 
47: const AlertDescription = React.forwardRef<
48:   HTMLParagraphElement,
49:   React.HTMLAttributes<HTMLParagraphElement>
50: >(({ className, ...props }, ref) => (
51:   <div
52:     ref={ref}
53:     className={cn("text-sm [&_p]:leading-relaxed", className)}
54:     {...props}
55:   />
56: ))
57: AlertDescription.displayName = "AlertDescription"
58: 
59: export { Alert, AlertTitle, AlertDescription }
```

## File: packages/ui/src/components/aspect-ratio.tsx
```typescript
1: "use client"
2: 
3: import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"
4: 
5: const AspectRatio = AspectRatioPrimitive.Root
6: 
7: export { AspectRatio }
```

## File: packages/ui/src/components/avatar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AvatarPrimitive from "@radix-ui/react-avatar"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Avatar = React.forwardRef<
 9:   React.ElementRef<typeof AvatarPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
11: >(({ className, ...props }, ref) => (
12:   <AvatarPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
16:       className
17:     )}
18:     {...props}
19:   />
20: ))
21: Avatar.displayName = AvatarPrimitive.Root.displayName
22: 
23: const AvatarImage = React.forwardRef<
24:   React.ElementRef<typeof AvatarPrimitive.Image>,
25:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
26: >(({ className, ...props }, ref) => (
27:   <AvatarPrimitive.Image
28:     ref={ref}
29:     className={cn("aspect-square h-full w-full", className)}
30:     {...props}
31:   />
32: ))
33: AvatarImage.displayName = AvatarPrimitive.Image.displayName
34: 
35: const AvatarFallback = React.forwardRef<
36:   React.ElementRef<typeof AvatarPrimitive.Fallback>,
37:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
38: >(({ className, ...props }, ref) => (
39:   <AvatarPrimitive.Fallback
40:     ref={ref}
41:     className={cn(
42:       "flex h-full w-full items-center justify-center rounded-full bg-muted",
43:       className
44:     )}
45:     {...props}
46:   />
47: ))
48: AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName
49: 
50: export { Avatar, AvatarImage, AvatarFallback }
```

## File: packages/ui/src/components/badge.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const badgeVariants = cva(
 7:   "inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
 8:   {
 9:     variants: {
10:       variant: {
11:         default:
12:           "border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",
13:         secondary:
14:           "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
15:         destructive:
16:           "border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",
17:         outline: "text-foreground",
18:       },
19:     },
20:     defaultVariants: {
21:       variant: "default",
22:     },
23:   }
24: )
25: 
26: export interface BadgeProps
27:   extends React.HTMLAttributes<HTMLDivElement>,
28:     VariantProps<typeof badgeVariants> {}
29: 
30: function Badge({ className, variant, ...props }: BadgeProps) {
31:   return (
32:     <div className={cn(badgeVariants({ variant }), className)} {...props} />
33:   )
34: }
35: 
36: export { Badge, badgeVariants }
```

## File: packages/ui/src/components/breadcrumb.tsx
```typescript
  1: import * as React from "react"
  2: import { Slot } from "@radix-ui/react-slot"
  3: import { ChevronRight, MoreHorizontal } from "lucide-react"
  4: 
  5: import { cn } from "@/lib/utils"
  6: 
  7: const Breadcrumb = React.forwardRef<
  8:   HTMLElement,
  9:   React.ComponentPropsWithoutRef<"nav"> & {
 10:     separator?: React.ReactNode
 11:   }
 12: >(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />)
 13: Breadcrumb.displayName = "Breadcrumb"
 14: 
 15: const BreadcrumbList = React.forwardRef<
 16:   HTMLOListElement,
 17:   React.ComponentPropsWithoutRef<"ol">
 18: >(({ className, ...props }, ref) => (
 19:   <ol
 20:     ref={ref}
 21:     className={cn(
 22:       "flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",
 23:       className
 24:     )}
 25:     {...props}
 26:   />
 27: ))
 28: BreadcrumbList.displayName = "BreadcrumbList"
 29: 
 30: const BreadcrumbItem = React.forwardRef<
 31:   HTMLLIElement,
 32:   React.ComponentPropsWithoutRef<"li">
 33: >(({ className, ...props }, ref) => (
 34:   <li
 35:     ref={ref}
 36:     className={cn("inline-flex items-center gap-1.5", className)}
 37:     {...props}
 38:   />
 39: ))
 40: BreadcrumbItem.displayName = "BreadcrumbItem"
 41: 
 42: const BreadcrumbLink = React.forwardRef<
 43:   HTMLAnchorElement,
 44:   React.ComponentPropsWithoutRef<"a"> & {
 45:     asChild?: boolean
 46:   }
 47: >(({ asChild, className, ...props }, ref) => {
 48:   const Comp = asChild ? Slot : "a"
 49: 
 50:   return (
 51:     <Comp
 52:       ref={ref}
 53:       className={cn("transition-colors hover:text-foreground", className)}
 54:       {...props}
 55:     />
 56:   )
 57: })
 58: BreadcrumbLink.displayName = "BreadcrumbLink"
 59: 
 60: const BreadcrumbPage = React.forwardRef<
 61:   HTMLSpanElement,
 62:   React.ComponentPropsWithoutRef<"span">
 63: >(({ className, ...props }, ref) => (
 64:   <span
 65:     ref={ref}
 66:     role="link"
 67:     aria-disabled="true"
 68:     aria-current="page"
 69:     className={cn("font-normal text-foreground", className)}
 70:     {...props}
 71:   />
 72: ))
 73: BreadcrumbPage.displayName = "BreadcrumbPage"
 74: 
 75: const BreadcrumbSeparator = ({
 76:   children,
 77:   className,
 78:   ...props
 79: }: React.ComponentProps<"li">) => (
 80:   <li
 81:     role="presentation"
 82:     aria-hidden="true"
 83:     className={cn("[&>svg]:w-3.5 [&>svg]:h-3.5", className)}
 84:     {...props}
 85:   >
 86:     {children ?? <ChevronRight />}
 87:   </li>
 88: )
 89: BreadcrumbSeparator.displayName = "BreadcrumbSeparator"
 90: 
 91: const BreadcrumbEllipsis = ({
 92:   className,
 93:   ...props
 94: }: React.ComponentProps<"span">) => (
 95:   <span
 96:     role="presentation"
 97:     aria-hidden="true"
 98:     className={cn("flex h-9 w-9 items-center justify-center", className)}
 99:     {...props}
100:   >
101:     <MoreHorizontal className="h-4 w-4" />
102:     <span className="sr-only">More</span>
103:   </span>
104: )
105: BreadcrumbEllipsis.displayName = "BreadcrumbElipssis"
106: 
107: export {
108:   Breadcrumb,
109:   BreadcrumbList,
110:   BreadcrumbItem,
111:   BreadcrumbLink,
112:   BreadcrumbPage,
113:   BreadcrumbSeparator,
114:   BreadcrumbEllipsis,
115: }
```

## File: packages/ui/src/components/button.tsx
```typescript
 1: 'use client'
 2: 
 3: import * as React from "react"
 4: import { Slot } from "@radix-ui/react-slot"
 5: import { cva, type VariantProps } from "class-variance-authority"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const buttonVariants = cva(
10:   "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
11:   {
12:     variants: {
13:       variant: {
14:         default:
15:           "bg-primary text-primary-foreground shadow hover:bg-primary/90",
16:         destructive:
17:           "bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",
18:         outline:
19:           "border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",
20:         secondary:
21:           "bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",
22:         ghost: "hover:bg-accent hover:text-accent-foreground",
23:         link: "text-primary underline-offset-4 hover:underline",
24:       },
25:       size: {
26:         default: "h-9 px-4 py-2",
27:         sm: "h-8 rounded-md px-3 text-xs",
28:         lg: "h-10 rounded-md px-8",
29:         icon: "h-9 w-9",
30:       },
31:     },
32:     defaultVariants: {
33:       variant: "default",
34:       size: "default",
35:     },
36:   }
37: )
38: 
39: export interface ButtonProps
40:   extends React.ButtonHTMLAttributes<HTMLButtonElement>,
41:     VariantProps<typeof buttonVariants> {
42:   asChild?: boolean
43: }
44: 
45: const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
46:   ({ className, variant, size, asChild = false, ...props }, ref) => {
47:     const Comp = asChild ? Slot : "button"
48:     return (
49:       <Comp
50:         className={cn(buttonVariants({ variant, size, className }))}
51:         ref={ref}
52:         {...props}
53:       />
54:     )
55:   }
56: )
57: Button.displayName = "Button"
58: 
59: export { Button, buttonVariants }
```

## File: packages/ui/src/components/calendar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { ChevronLeft, ChevronRight } from "lucide-react"
 5: import { DayPicker } from "react-day-picker"
 6: import { cn } from "../lib/utils"
 7: import { buttonVariants } from "./button"
 8: 
 9: export type CalendarProps = React.ComponentProps<typeof DayPicker>
10: 
11: function Calendar({
12:   className,
13:   classNames,
14:   showOutsideDays = true,
15:   ...props
16: }: CalendarProps) {
17:   return (
18:     <DayPicker
19:       showOutsideDays={showOutsideDays}
20:       className={cn("p-3", className)}
21:       classNames={{
22:         months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
23:         month: "space-y-4",
24:         caption: "flex justify-center pt-1 relative items-center",
25:         caption_label: "text-sm font-medium",
26:         nav: "space-x-1 flex items-center",
27:         nav_button: cn(
28:           buttonVariants({ variant: "outline" }),
29:           "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
30:         ),
31:         nav_button_previous: "absolute left-1",
32:         nav_button_next: "absolute right-1",
33:         table: "w-full border-collapse space-y-1",
34:         head_row: "flex",
35:         head_cell:
36:           "text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",
37:         row: "flex w-full mt-2",
38:         cell: cn(
39:           "relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",
40:           props.mode === "range"
41:             ? "[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md"
42:             : "[&:has([aria-selected])]:rounded-md"
43:         ),
44:         day: cn(
45:           buttonVariants({ variant: "ghost" }),
46:           "h-8 w-8 p-0 font-normal aria-selected:opacity-100"
47:         ),
48:         day_range_start: "day-range-start",
49:         day_range_end: "day-range-end",
50:         day_selected:
51:           "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
52:         day_today: "bg-accent text-accent-foreground",
53:         day_outside:
54:           "day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",
55:         day_disabled: "text-muted-foreground opacity-50",
56:         day_range_middle:
57:           "aria-selected:bg-accent aria-selected:text-accent-foreground",
58:         day_hidden: "invisible",
59:         ...classNames,
60:       }}
61:       components={{
62:         IconLeft: ({ className, ...props }) => (
63:           <ChevronLeft className={cn("h-4 w-4", className)} {...props} />
64:         ),
65:         IconRight: ({ className, ...props }) => (
66:           <ChevronRight className={cn("h-4 w-4", className)} {...props} />
67:         ),
68:       }}
69:       {...props}
70:     />
71:   )
72: }
73: Calendar.displayName = "Calendar"
74: 
75: export { Calendar }
```

## File: packages/ui/src/components/card.tsx
```typescript
 1: import * as React from "react"
 2: 
 3: import { cn } from "@/lib/utils"
 4: 
 5: const Card = React.forwardRef<
 6:   HTMLDivElement,
 7:   React.HTMLAttributes<HTMLDivElement>
 8: >(({ className, ...props }, ref) => (
 9:   <div
10:     ref={ref}
11:     className={cn(
12:       "rounded-xl border bg-card text-card-foreground shadow",
13:       className
14:     )}
15:     {...props}
16:   />
17: ))
18: Card.displayName = "Card"
19: 
20: const CardHeader = React.forwardRef<
21:   HTMLDivElement,
22:   React.HTMLAttributes<HTMLDivElement>
23: >(({ className, ...props }, ref) => (
24:   <div
25:     ref={ref}
26:     className={cn("flex flex-col space-y-1.5 p-6", className)}
27:     {...props}
28:   />
29: ))
30: CardHeader.displayName = "CardHeader"
31: 
32: const CardTitle = React.forwardRef<
33:   HTMLDivElement,
34:   React.HTMLAttributes<HTMLDivElement>
35: >(({ className, ...props }, ref) => (
36:   <div
37:     ref={ref}
38:     className={cn("font-semibold leading-none tracking-tight", className)}
39:     {...props}
40:   />
41: ))
42: CardTitle.displayName = "CardTitle"
43: 
44: const CardDescription = React.forwardRef<
45:   HTMLDivElement,
46:   React.HTMLAttributes<HTMLDivElement>
47: >(({ className, ...props }, ref) => (
48:   <div
49:     ref={ref}
50:     className={cn("text-sm text-muted-foreground", className)}
51:     {...props}
52:   />
53: ))
54: CardDescription.displayName = "CardDescription"
55: 
56: const CardContent = React.forwardRef<
57:   HTMLDivElement,
58:   React.HTMLAttributes<HTMLDivElement>
59: >(({ className, ...props }, ref) => (
60:   <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
61: ))
62: CardContent.displayName = "CardContent"
63: 
64: const CardFooter = React.forwardRef<
65:   HTMLDivElement,
66:   React.HTMLAttributes<HTMLDivElement>
67: >(({ className, ...props }, ref) => (
68:   <div
69:     ref={ref}
70:     className={cn("flex items-center p-6 pt-0", className)}
71:     {...props}
72:   />
73: ))
74: CardFooter.displayName = "CardFooter"
75: 
76: export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
```

## File: packages/ui/src/components/carousel.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import useEmblaCarousel, {
  5:   type UseEmblaCarouselType,
  6: } from "embla-carousel-react"
  7: import { ArrowLeft, ArrowRight } from "lucide-react"
  8: 
  9: import { cn } from "@/lib/utils"
 10: import { Button } from "./button"
 11: 
 12: type CarouselApi = UseEmblaCarouselType[1]
 13: type UseCarouselParameters = Parameters<typeof useEmblaCarousel>
 14: type CarouselOptions = UseCarouselParameters[0]
 15: type CarouselPlugin = UseCarouselParameters[1]
 16: 
 17: type CarouselProps = {
 18:   opts?: CarouselOptions
 19:   plugins?: CarouselPlugin
 20:   orientation?: "horizontal" | "vertical"
 21:   setApi?: (api: CarouselApi) => void
 22: }
 23: 
 24: type CarouselContextProps = {
 25:   carouselRef: ReturnType<typeof useEmblaCarousel>[0]
 26:   api: ReturnType<typeof useEmblaCarousel>[1]
 27:   scrollPrev: () => void
 28:   scrollNext: () => void
 29:   canScrollPrev: boolean
 30:   canScrollNext: boolean
 31: } & CarouselProps
 32: 
 33: const CarouselContext = React.createContext<CarouselContextProps | null>(null)
 34: 
 35: function useCarousel() {
 36:   const context = React.useContext(CarouselContext)
 37: 
 38:   if (!context) {
 39:     throw new Error("useCarousel must be used within a <Carousel />")
 40:   }
 41: 
 42:   return context
 43: }
 44: 
 45: const Carousel = React.forwardRef<
 46:   HTMLDivElement,
 47:   React.HTMLAttributes<HTMLDivElement> & CarouselProps
 48: >(({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }, ref) => {
 49:   const [emblaRef, emblaApi] = useEmblaCarousel(
 50:     {
 51:       ...opts,
 52:       axis: orientation === "horizontal" ? "x" : "y",
 53:     },
 54:     plugins
 55:   )
 56: 
 57:   const [canScrollPrev, setCanScrollPrev] = React.useState(false)
 58:   const [canScrollNext, setCanScrollNext] = React.useState(false)
 59: 
 60:   const scrollPrev = React.useCallback(() => {
 61:     if (emblaApi) emblaApi.scrollPrev()
 62:   }, [emblaApi])
 63: 
 64:   const scrollNext = React.useCallback(() => {
 65:     if (emblaApi) emblaApi.scrollNext()
 66:   }, [emblaApi])
 67: 
 68:   const onSelect = React.useCallback(() => {
 69:     if (!emblaApi) return
 70:     setCanScrollPrev(emblaApi.canScrollPrev())
 71:     setCanScrollNext(emblaApi.canScrollNext())
 72:   }, [emblaApi])
 73: 
 74:   const handleKeyDown = React.useCallback(
 75:     (event: React.KeyboardEvent<HTMLDivElement>) => {
 76:       if (event.key === "ArrowLeft") {
 77:         event.preventDefault()
 78:         scrollPrev()
 79:       } else if (event.key === "ArrowRight") {
 80:         event.preventDefault()
 81:         scrollNext()
 82:       }
 83:     },
 84:     [scrollPrev, scrollNext]
 85:   )
 86: 
 87:   React.useEffect(() => {
 88:     if (!emblaApi || !setApi) {
 89:       return
 90:     }
 91: 
 92:     setApi(emblaApi)
 93:   }, [emblaApi, setApi])
 94: 
 95:   React.useEffect(() => {
 96:     if (!emblaApi) return
 97: 
 98:     onSelect()
 99:     emblaApi.on("select", onSelect)
100:     emblaApi.on("reInit", onSelect)
101: 
102:     return () => {
103:       emblaApi.off("select", onSelect)
104:     }
105:   }, [emblaApi, onSelect])
106: 
107:   return (
108:     <CarouselContext.Provider
109:       value={{
110:         carouselRef: emblaRef,
111:         api: emblaApi,
112:         opts,
113:         orientation: orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
114:         scrollPrev,
115:         scrollNext,
116:         canScrollPrev,
117:         canScrollNext,
118:       }}
119:     >
120:       <div
121:         ref={ref}
122:         onKeyDownCapture={handleKeyDown}
123:         className={cn("relative", className)}
124:         role="region"
125:         aria-roledescription="carousel"
126:         {...props}
127:       >
128:         {children}
129:       </div>
130:     </CarouselContext.Provider>
131:   )
132: })
133: Carousel.displayName = "Carousel"
134: 
135: const CarouselContent = React.forwardRef<
136:   HTMLDivElement,
137:   React.HTMLAttributes<HTMLDivElement>
138: >(({ className, ...props }, ref) => {
139:   const { carouselRef, orientation } = useCarousel()
140: 
141:   return (
142:     <div ref={carouselRef} className="overflow-hidden">
143:       <div
144:         ref={ref}
145:         className={cn(
146:           "flex",
147:           orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
148:           className
149:         )}
150:         {...props}
151:       />
152:     </div>
153:   )
154: })
155: CarouselContent.displayName = "CarouselContent"
156: 
157: const CarouselItem = React.forwardRef<
158:   HTMLDivElement,
159:   React.HTMLAttributes<HTMLDivElement>
160: >(({ className, ...props }, ref) => {
161:   const { orientation } = useCarousel()
162: 
163:   return (
164:     <div
165:       ref={ref}
166:       role="group"
167:       aria-roledescription="slide"
168:       className={cn(
169:         "min-w-0 shrink-0 grow-0 basis-full",
170:         orientation === "horizontal" ? "pl-4" : "pt-4",
171:         className
172:       )}
173:       {...props}
174:     />
175:   )
176: })
177: CarouselItem.displayName = "CarouselItem"
178: 
179: const CarouselPrevious = React.forwardRef<
180:   HTMLButtonElement,
181:   React.ComponentProps<typeof Button>
182: >(({ className, variant = "outline", size = "icon", ...props }, ref) => {
183:   const { orientation, scrollPrev, canScrollPrev } = useCarousel()
184: 
185:   return (
186:     <Button
187:       ref={ref}
188:       variant={variant}
189:       size={size}
190:       className={cn(
191:         "absolute  h-8 w-8 rounded-full",
192:         orientation === "horizontal"
193:           ? "-left-12 top-1/2 -translate-y-1/2"
194:           : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
195:         className
196:       )}
197:       disabled={!canScrollPrev}
198:       onClick={scrollPrev}
199:       {...props}
200:     >
201:       <ArrowLeft className="h-4 w-4" />
202:       <span className="sr-only">Previous slide</span>
203:     </Button>
204:   )
205: })
206: CarouselPrevious.displayName = "CarouselPrevious"
207: 
208: const CarouselNext = React.forwardRef<
209:   HTMLButtonElement,
210:   React.ComponentProps<typeof Button>
211: >(({ className, variant = "outline", size = "icon", ...props }, ref) => {
212:   const { orientation, scrollNext, canScrollNext } = useCarousel()
213: 
214:   return (
215:     <Button
216:       ref={ref}
217:       variant={variant}
218:       size={size}
219:       className={cn(
220:         "absolute h-8 w-8 rounded-full",
221:         orientation === "horizontal"
222:           ? "-right-12 top-1/2 -translate-y-1/2"
223:           : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
224:         className
225:       )}
226:       disabled={!canScrollNext}
227:       onClick={scrollNext}
228:       {...props}
229:     >
230:       <ArrowRight className="h-4 w-4" />
231:       <span className="sr-only">Next slide</span>
232:     </Button>
233:   )
234: })
235: CarouselNext.displayName = "CarouselNext"
236: 
237: export {
238:   type CarouselApi,
239:   Carousel,
240:   CarouselContent,
241:   CarouselItem,
242:   CarouselPrevious,
243:   CarouselNext,
244: }
```

## File: packages/ui/src/components/chart.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { cn } from "@/lib/utils"
 5: import { Line, LineChart, ResponsiveContainer, Tooltip } from "recharts"
 6: import { Card } from "../card"
 7: import { useTheme } from "next-themes"
 8: 
 9: import type { TooltipProps } from "recharts"
10: import type { NameType, ValueType } from "recharts/types/component/DefaultTooltipContent"
11: 
12: interface ChartProps extends React.HTMLAttributes<HTMLDivElement> {
13:   data: any[]
14: }
15: 
16: export function Chart({ data, className, ...props }: ChartProps) {
17:   const { theme: mode } = useTheme()
18: 
19:   return (
20:     <Card className={cn("space-y-4", className)} {...props}>
21:       <ResponsiveContainer width="100%" height={350}>
22:         <LineChart data={data}>
23:           <Line
24:             type="monotone"
25:             dataKey="total"
26:             strokeWidth={2}
27:             activeDot={{
28:               r: 8,
29:             }}
30:             style={
31:               {
32:                 stroke: "hsl(var(--primary))",
33:               } as React.CSSProperties
34:             }
35:           />
36:           <Tooltip
37:             content={({ active, payload }: TooltipProps<ValueType, NameType>) => {
38:               if (active && payload && payload.length) {
39:                 return (
40:                   <div className="rounded-lg border bg-background p-2 shadow-sm">
41:                     <div className="grid grid-cols-2 gap-2">
42:                       <div className="flex flex-col">
43:                         <span className="text-[0.70rem] uppercase text-muted-foreground">
44:                           Total
45:                         </span>
46:                         <span className="font-bold text-muted-foreground">
47:                           {payload[0].value}
48:                         </span>
49:                       </div>
50:                     </div>
51:                   </div>
52:                 )
53:               }
54: 
55:               return null
56:             }}
57:           />
58:         </LineChart>
59:       </ResponsiveContainer>
60:     </Card>
61:   )
62: }
```

## File: packages/ui/src/components/checkbox.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
 5: import { Check } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const Checkbox = React.forwardRef<
10:   React.ElementRef<typeof CheckboxPrimitive.Root>,
11:   React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
12: >(({ className, ...props }, ref) => (
13:   <CheckboxPrimitive.Root
14:     ref={ref}
15:     className={cn(
16:       "peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
17:       className
18:     )}
19:     {...props}
20:   >
21:     <CheckboxPrimitive.Indicator
22:       className={cn("flex items-center justify-center text-current")}
23:     >
24:       <Check className="h-4 w-4" />
25:     </CheckboxPrimitive.Indicator>
26:   </CheckboxPrimitive.Root>
27: ))
28: Checkbox.displayName = CheckboxPrimitive.Root.displayName
29: 
30: export { Checkbox }
```

## File: packages/ui/src/components/collapsible.tsx
```typescript
 1: "use client"
 2: 
 3: import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"
 4: 
 5: const Collapsible = CollapsiblePrimitive.Root
 6: 
 7: const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger
 8: 
 9: const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent
10: 
11: export { Collapsible, CollapsibleTrigger, CollapsibleContent }
```

## File: packages/ui/src/components/command.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import { type DialogProps } from "@radix-ui/react-dialog"
  5: import { Command as CommandPrimitive } from "cmdk"
  6: import { Search } from "lucide-react"
  7: 
  8: import { cn } from "@/lib/utils"
  9: import { Dialog, DialogContent } from "./dialog"
 10: 
 11: const Command = React.forwardRef<
 12:   React.ElementRef<typeof CommandPrimitive>,
 13:   React.ComponentPropsWithoutRef<typeof CommandPrimitive>
 14: >(({ className, ...props }, ref) => (
 15:   <CommandPrimitive
 16:     ref={ref}
 17:     className={cn(
 18:       "flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",
 19:       className
 20:     )}
 21:     {...props}
 22:   />
 23: ))
 24: Command.displayName = CommandPrimitive.displayName
 25: 
 26: const CommandDialog = ({ children, ...props }: DialogProps) => {
 27:   return (
 28:     <Dialog {...props}>
 29:       <DialogContent className="overflow-hidden p-0">
 30:         <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
 31:           {children}
 32:         </Command>
 33:       </DialogContent>
 34:     </Dialog>
 35:   )
 36: }
 37: 
 38: const CommandInput = React.forwardRef<
 39:   React.ElementRef<typeof CommandPrimitive.Input>,
 40:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
 41: >(({ className, ...props }, ref) => (
 42:   <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
 43:     <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
 44:     <CommandPrimitive.Input
 45:       ref={ref}
 46:       className={cn(
 47:         "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
 48:         className
 49:       )}
 50:       data-cmdk-input-wrapper=""
 51:       {...props}
 52:     />
 53:   </div>
 54: ))
 55: 
 56: CommandInput.displayName = CommandPrimitive.Input.displayName
 57: 
 58: const CommandList = React.forwardRef<
 59:   React.ElementRef<typeof CommandPrimitive.List>,
 60:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
 61: >(({ className, ...props }, ref) => (
 62:   <CommandPrimitive.List
 63:     ref={ref}
 64:     className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)}
 65:     {...props}
 66:   />
 67: ))
 68: 
 69: CommandList.displayName = CommandPrimitive.List.displayName
 70: 
 71: const CommandEmpty = React.forwardRef<
 72:   React.ElementRef<typeof CommandPrimitive.Empty>,
 73:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
 74: >((props, ref) => (
 75:   <CommandPrimitive.Empty
 76:     ref={ref}
 77:     className="py-6 text-center text-sm"
 78:     {...props}
 79:   />
 80: ))
 81: 
 82: CommandEmpty.displayName = CommandPrimitive.Empty.displayName
 83: 
 84: const CommandGroup = React.forwardRef<
 85:   React.ElementRef<typeof CommandPrimitive.Group>,
 86:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
 87: >(({ className, ...props }, ref) => (
 88:   <CommandPrimitive.Group
 89:     ref={ref}
 90:     className={cn(
 91:       "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
 92:       className
 93:     )}
 94:     {...props}
 95:   />
 96: ))
 97: 
 98: CommandGroup.displayName = CommandPrimitive.Group.displayName
 99: 
100: const CommandSeparator = React.forwardRef<
101:   React.ElementRef<typeof CommandPrimitive.Separator>,
102:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
103: >(({ className, ...props }, ref) => (
104:   <CommandPrimitive.Separator
105:     ref={ref}
106:     className={cn("-mx-1 h-px bg-border", className)}
107:     {...props}
108:   />
109: ))
110: CommandSeparator.displayName = CommandPrimitive.Separator.displayName
111: 
112: const CommandItem = React.forwardRef<
113:   React.ElementRef<typeof CommandPrimitive.Item>,
114:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
115: >(({ className, ...props }, ref) => (
116:   <CommandPrimitive.Item
117:     ref={ref}
118:     className={cn(
119:       "relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
120:       className
121:     )}
122:     {...props}
123:   />
124: ))
125: 
126: CommandItem.displayName = CommandPrimitive.Item.displayName
127: 
128: const CommandShortcut = ({
129:   className,
130:   ...props
131: }: React.HTMLAttributes<HTMLSpanElement>) => {
132:   return (
133:     <span
134:       className={cn(
135:         "ml-auto text-xs tracking-widest text-muted-foreground",
136:         className
137:       )}
138:       {...props}
139:     />
140:   )
141: }
142: CommandShortcut.displayName = "CommandShortcut"
143: 
144: export {
145:   Command,
146:   CommandDialog,
147:   CommandInput,
148:   CommandList,
149:   CommandEmpty,
150:   CommandGroup,
151:   CommandItem,
152:   CommandShortcut,
153:   CommandSeparator,
154: }
```

## File: packages/ui/src/components/context-menu.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
  5: import { Check, ChevronRight, Circle } from "lucide-react";
  6: 
  7: import { cn } from "@/lib/utils";
  8: 
  9: const ContextMenu = ContextMenuPrimitive.Root;
 10: 
 11: const ContextMenuTrigger = ContextMenuPrimitive.Trigger;
 12: 
 13: const ContextMenuGroup = ContextMenuPrimitive.Group;
 14: 
 15: const ContextMenuPortal = ContextMenuPrimitive.Portal;
 16: 
 17: const ContextMenuSub = ContextMenuPrimitive.Sub;
 18: 
 19: const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;
 20: 
 21: interface ContextMenuSubTriggerProps
 22:   extends React.ComponentPropsWithoutRef<
 23:     typeof ContextMenuPrimitive.SubTrigger
 24:   > {
 25:   inset?: boolean;
 26:   children: React.ReactNode;
 27: }
 28: 
 29: const ContextMenuSubTrigger = React.forwardRef<
 30:   React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
 31:   ContextMenuSubTriggerProps
 32: >(({ className, inset, children, ...props }, ref) => (
 33:   <ContextMenuPrimitive.SubTrigger
 34:     ref={ref}
 35:     className={cn(
 36:       "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
 37:       inset && "pl-8",
 38:       className
 39:     )}
 40:     {...props}
 41:   >
 42:     {children}
 43:     <ChevronRight className="ml-auto h-4 w-4" />
 44:   </ContextMenuPrimitive.SubTrigger>
 45: ));
 46: ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;
 47: 
 48: interface ContextMenuSubContentProps
 49:   extends React.ComponentPropsWithoutRef<
 50:     typeof ContextMenuPrimitive.SubContent
 51:   > {
 52:   children: React.ReactNode;
 53: }
 54: 
 55: const ContextMenuSubContent = React.forwardRef<
 56:   React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
 57:   ContextMenuSubContentProps
 58: >(({ className, ...props }, ref) => (
 59:   <ContextMenuPrimitive.SubContent
 60:     ref={ref}
 61:     className={cn(
 62:       "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 63:       className
 64:     )}
 65:     {...props}
 66:   />
 67: ));
 68: ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;
 69: 
 70: interface ContextMenuContentProps
 71:   extends React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content> {
 72:   children: React.ReactNode;
 73: }
 74: 
 75: const ContextMenuContent = React.forwardRef<
 76:   React.ElementRef<typeof ContextMenuPrimitive.Content>,
 77:   ContextMenuContentProps
 78: >(({ className, ...props }, ref) => (
 79:   <ContextMenuPrimitive.Portal>
 80:     <ContextMenuPrimitive.Content
 81:       ref={ref}
 82:       className={cn(
 83:         "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 84:         className
 85:       )}
 86:       {...props}
 87:     />
 88:   </ContextMenuPrimitive.Portal>
 89: ));
 90: ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;
 91: 
 92: interface ContextMenuItemProps
 93:   extends React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> {
 94:   inset?: boolean;
 95:   children: React.ReactNode;
 96: }
 97: 
 98: const ContextMenuItem = React.forwardRef<
 99:   React.ElementRef<typeof ContextMenuPrimitive.Item>,
100:   ContextMenuItemProps
101: >(({ className, inset, ...props }, ref) => (
102:   <ContextMenuPrimitive.Item
103:     ref={ref}
104:     className={cn(
105:       "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
106:       inset && "pl-8",
107:       className
108:     )}
109:     {...props}
110:   />
111: ));
112: ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;
113: 
114: interface ContextMenuCheckboxItemProps
115:   extends React.ComponentPropsWithoutRef<
116:     typeof ContextMenuPrimitive.CheckboxItem
117:   > {
118:   checked?: boolean;
119:   children: React.ReactNode;
120: }
121: 
122: const ContextMenuCheckboxItem = React.forwardRef<
123:   React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
124:   ContextMenuCheckboxItemProps
125: >(({ className, children, checked, ...props }, ref) => (
126:   <ContextMenuPrimitive.CheckboxItem
127:     ref={ref}
128:     className={cn(
129:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
130:       className
131:     )}
132:     checked={checked}
133:     {...props}
134:   >
135:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
136:       <ContextMenuPrimitive.ItemIndicator>
137:         <Check className="h-4 w-4" />
138:       </ContextMenuPrimitive.ItemIndicator>
139:     </span>
140:     {children}
141:   </ContextMenuPrimitive.CheckboxItem>
142: ));
143: ContextMenuCheckboxItem.displayName =
144:   ContextMenuPrimitive.CheckboxItem.displayName;
145: 
146: interface ContextMenuRadioItemProps
147:   extends React.ComponentPropsWithoutRef<
148:     typeof ContextMenuPrimitive.RadioItem
149:   > {
150:   children: React.ReactNode;
151: }
152: 
153: const ContextMenuRadioItem = React.forwardRef<
154:   React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
155:   ContextMenuRadioItemProps
156: >(({ className, children, ...props }, ref) => (
157:   <ContextMenuPrimitive.RadioItem
158:     ref={ref}
159:     className={cn(
160:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
161:       className
162:     )}
163:     {...props}
164:   >
165:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
166:       <ContextMenuPrimitive.ItemIndicator>
167:         <Circle className="h-4 w-4 fill-current" />
168:       </ContextMenuPrimitive.ItemIndicator>
169:     </span>
170:     {children}
171:   </ContextMenuPrimitive.RadioItem>
172: ));
173: ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;
174: 
175: interface ContextMenuLabelProps
176:   extends React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> {
177:   inset?: boolean;
178:   children: React.ReactNode;
179: }
180: 
181: const ContextMenuLabel = React.forwardRef<
182:   React.ElementRef<typeof ContextMenuPrimitive.Label>,
183:   ContextMenuLabelProps
184: >(({ className, inset, ...props }, ref) => (
185:   <ContextMenuPrimitive.Label
186:     ref={ref}
187:     className={cn(
188:       "px-2 py-1.5 text-sm font-semibold text-foreground",
189:       inset && "pl-8",
190:       className
191:     )}
192:     {...props}
193:   />
194: ));
195: ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;
196: 
197: interface ContextMenuSeparatorProps
198:   extends React.ComponentPropsWithoutRef<
199:     typeof ContextMenuPrimitive.Separator
200:   > {
201:   className?: string;
202: }
203: 
204: const ContextMenuSeparator = React.forwardRef<
205:   React.ElementRef<typeof ContextMenuPrimitive.Separator>,
206:   ContextMenuSeparatorProps
207: >(({ className, ...props }, ref) => (
208:   <ContextMenuPrimitive.Separator
209:     ref={ref}
210:     className={cn("-mx-1 my-1 h-px bg-border", className)}
211:     {...props}
212:   />
213: ));
214: ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;
215: 
216: interface ContextMenuShortcutProps
217:   extends React.HTMLAttributes<HTMLSpanElement> {
218:   className?: string;
219:   children: React.ReactNode;
220: }
221: 
222: const ContextMenuShortcut = ({
223:   className,
224:   children,
225:   ...props
226: }: ContextMenuShortcutProps) => {
227:   return (
228:     <span
229:       className={cn(
230:         "ml-auto text-xs tracking-widest text-muted-foreground",
231:         className
232:       )}
233:       {...props}
234:     >
235:       {children}
236:     </span>
237:   );
238: };
239: ContextMenuShortcut.displayName = "ContextMenuShortcut";
240: 
241: export {
242:   ContextMenu,
243:   ContextMenuTrigger,
244:   ContextMenuContent,
245:   ContextMenuItem,
246:   ContextMenuCheckboxItem,
247:   ContextMenuRadioItem,
248:   ContextMenuLabel,
249:   ContextMenuSeparator,
250:   ContextMenuShortcut,
251:   ContextMenuGroup,
252:   ContextMenuPortal,
253:   ContextMenuSub,
254:   ContextMenuSubContent,
255:   ContextMenuSubTrigger,
256:   ContextMenuRadioGroup,
257: };
```

## File: packages/ui/src/components/dialog.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import * as DialogPrimitive from "@radix-ui/react-dialog";
  5: import { X } from "lucide-react";
  6: 
  7: import { cn } from "@/lib/utils";
  8: 
  9: const Dialog = DialogPrimitive.Root;
 10: 
 11: const DialogTrigger = DialogPrimitive.Trigger;
 12: 
 13: const DialogPortal = DialogPrimitive.Portal;
 14: 
 15: const DialogClose = DialogPrimitive.Close;
 16: 
 17: interface DialogOverlayProps
 18:   extends React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay> {
 19:   className?: string;
 20: }
 21: 
 22: const DialogOverlay = React.forwardRef<
 23:   React.ElementRef<typeof DialogPrimitive.Overlay>,
 24:   DialogOverlayProps
 25: >(({ className, ...props }, ref) => (
 26:   <DialogPrimitive.Overlay
 27:     ref={ref}
 28:     className={cn(
 29:       "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
 30:       className
 31:     )}
 32:     {...props}
 33:   />
 34: ));
 35: DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;
 36: 
 37: interface DialogContentProps
 38:   extends React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> {
 39:   children: React.ReactNode;
 40:   className?: string;
 41: }
 42: 
 43: const DialogContent = React.forwardRef<
 44:   React.ElementRef<typeof DialogPrimitive.Content>,
 45:   DialogContentProps
 46: >(({ className, children, ...props }, ref) => (
 47:   <DialogPortal>
 48:     <DialogOverlay />
 49:     <DialogPrimitive.Content
 50:       ref={ref}
 51:       className={cn(
 52:         "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
 53:         className
 54:       )}
 55:       {...props}
 56:     >
 57:       {children}
 58:       <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
 59:         <X className="h-4 w-4" />
 60:         <span className="sr-only">Close</span>
 61:       </DialogPrimitive.Close>
 62:     </DialogPrimitive.Content>
 63:   </DialogPortal>
 64: ));
 65: DialogContent.displayName = DialogPrimitive.Content.displayName;
 66: 
 67: interface DialogHeaderProps extends React.HTMLAttributes<HTMLDivElement> {
 68:   className?: string;
 69:   children: React.ReactNode;
 70: }
 71: 
 72: const DialogHeader = ({ className, children, ...props }: DialogHeaderProps) => (
 73:   <div
 74:     className={cn(
 75:       "flex flex-col space-y-1.5 text-center sm:text-left",
 76:       className
 77:     )}
 78:     {...props}
 79:   >
 80:     {children}
 81:   </div>
 82: );
 83: DialogHeader.displayName = "DialogHeader";
 84: 
 85: interface DialogFooterProps extends React.HTMLAttributes<HTMLDivElement> {
 86:   className?: string;
 87:   children: React.ReactNode;
 88: }
 89: 
 90: const DialogFooter = ({ className, children, ...props }: DialogFooterProps) => (
 91:   <div
 92:     className={cn(
 93:       "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
 94:       className
 95:     )}
 96:     {...props}
 97:   >
 98:     {children}
 99:   </div>
100: );
101: DialogFooter.displayName = "DialogFooter";
102: 
103: interface DialogTitleProps
104:   extends React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title> {
105:   className?: string;
106:   children: React.ReactNode;
107: }
108: 
109: const DialogTitle = React.forwardRef<
110:   React.ElementRef<typeof DialogPrimitive.Title>,
111:   DialogTitleProps
112: >(({ className, children, ...props }, ref) => (
113:   <DialogPrimitive.Title
114:     ref={ref}
115:     className={cn(
116:       "text-lg font-semibold leading-none tracking-tight",
117:       className
118:     )}
119:     {...props}
120:   >
121:     {children}
122:   </DialogPrimitive.Title>
123: ));
124: DialogTitle.displayName = DialogPrimitive.Title.displayName;
125: 
126: interface DialogDescriptionProps
127:   extends React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description> {
128:   className?: string;
129:   children: React.ReactNode;
130: }
131: 
132: const DialogDescription = React.forwardRef<
133:   React.ElementRef<typeof DialogPrimitive.Description>,
134:   DialogDescriptionProps
135: >(({ className, children, ...props }, ref) => (
136:   <DialogPrimitive.Description
137:     ref={ref}
138:     className={cn("text-sm text-muted-foreground", className)}
139:     {...props}
140:   >
141:     {children}
142:   </DialogPrimitive.Description>
143: ));
144: DialogDescription.displayName = DialogPrimitive.Description.displayName;
145: 
146: export {
147:   Dialog,
148:   DialogPortal,
149:   DialogOverlay,
150:   DialogTrigger,
151:   DialogClose,
152:   DialogContent,
153:   DialogHeader,
154:   DialogFooter,
155:   DialogTitle,
156:   DialogDescription,
157: };
```

## File: packages/ui/src/components/drawer.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import { Drawer as DrawerPrimitive } from "vaul"
  5: 
  6: import { cn } from "@/lib/utils"
  7: 
  8: const Drawer = ({
  9:   shouldScaleBackground = true,
 10:   ...props
 11: }: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
 12:   <DrawerPrimitive.Root
 13:     shouldScaleBackground={shouldScaleBackground}
 14:     {...props}
 15:   />
 16: )
 17: Drawer.displayName = "Drawer"
 18: 
 19: const DrawerTrigger = DrawerPrimitive.Trigger
 20: 
 21: const DrawerPortal = DrawerPrimitive.Portal
 22: 
 23: const DrawerClose = DrawerPrimitive.Close
 24: 
 25: const DrawerOverlay = React.forwardRef<
 26:   React.ElementRef<typeof DrawerPrimitive.Overlay>,
 27:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
 28: >(({ className, ...props }, ref) => (
 29:   <DrawerPrimitive.Overlay
 30:     ref={ref}
 31:     className={cn("fixed inset-0 z-50 bg-black/80", className)}
 32:     {...props}
 33:   />
 34: ))
 35: DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName
 36: 
 37: const DrawerContent = React.forwardRef<
 38:   React.ElementRef<typeof DrawerPrimitive.Content>,
 39:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
 40: >(({ className, children, ...props }, ref) => (
 41:   <DrawerPortal>
 42:     <DrawerOverlay />
 43:     <DrawerPrimitive.Content
 44:       ref={ref}
 45:       className={cn(
 46:         "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
 47:         className
 48:       )}
 49:       {...props}
 50:     >
 51:       <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
 52:       {children}
 53:     </DrawerPrimitive.Content>
 54:   </DrawerPortal>
 55: ))
 56: DrawerContent.displayName = "DrawerContent"
 57: 
 58: const DrawerHeader = ({
 59:   className,
 60:   ...props
 61: }: React.HTMLAttributes<HTMLDivElement>) => (
 62:   <div
 63:     className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
 64:     {...props}
 65:   />
 66: )
 67: DrawerHeader.displayName = "DrawerHeader"
 68: 
 69: const DrawerFooter = ({
 70:   className,
 71:   ...props
 72: }: React.HTMLAttributes<HTMLDivElement>) => (
 73:   <div
 74:     className={cn("mt-auto flex flex-col gap-2 p-4", className)}
 75:     {...props}
 76:   />
 77: )
 78: DrawerFooter.displayName = "DrawerFooter"
 79: 
 80: const DrawerTitle = React.forwardRef<
 81:   React.ElementRef<typeof DrawerPrimitive.Title>,
 82:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
 83: >(({ className, ...props }, ref) => (
 84:   <DrawerPrimitive.Title
 85:     ref={ref}
 86:     className={cn(
 87:       "text-lg font-semibold leading-none tracking-tight",
 88:       className
 89:     )}
 90:     {...props}
 91:   />
 92: ))
 93: DrawerTitle.displayName = DrawerPrimitive.Title.displayName
 94: 
 95: const DrawerDescription = React.forwardRef<
 96:   React.ElementRef<typeof DrawerPrimitive.Description>,
 97:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
 98: >(({ className, ...props }, ref) => (
 99:   <DrawerPrimitive.Description
100:     ref={ref}
101:     className={cn("text-sm text-muted-foreground", className)}
102:     {...props}
103:   />
104: ))
105: DrawerDescription.displayName = DrawerPrimitive.Description.displayName
106: 
107: export {
108:   Drawer,
109:   DrawerPortal,
110:   DrawerOverlay,
111:   DrawerTrigger,
112:   DrawerClose,
113:   DrawerContent,
114:   DrawerHeader,
115:   DrawerFooter,
116:   DrawerTitle,
117:   DrawerDescription,
118: }
```

## File: packages/ui/src/components/dropdown-menu.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
  5: import { Check, ChevronRight, Circle } from "lucide-react";
  6: 
  7: import { cn } from "@/lib/utils";
  8: 
  9: const DropdownMenu = DropdownMenuPrimitive.Root;
 10: 
 11: const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;
 12: 
 13: const DropdownMenuGroup = DropdownMenuPrimitive.Group;
 14: 
 15: const DropdownMenuPortal = DropdownMenuPrimitive.Portal;
 16: 
 17: const DropdownMenuSub = DropdownMenuPrimitive.Sub;
 18: 
 19: const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;
 20: 
 21: interface DropdownMenuSubTriggerProps
 22:   extends React.ComponentPropsWithoutRef<
 23:     typeof DropdownMenuPrimitive.SubTrigger
 24:   > {
 25:   inset?: boolean;
 26:   children: React.ReactNode;
 27:   className?: string;
 28: }
 29: 
 30: const DropdownMenuSubTrigger = React.forwardRef<
 31:   React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
 32:   DropdownMenuSubTriggerProps
 33: >(({ className, inset, children, ...props }, ref) => (
 34:   <DropdownMenuPrimitive.SubTrigger
 35:     ref={ref}
 36:     className={cn(
 37:       "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",
 38:       inset && "pl-8",
 39:       className
 40:     )}
 41:     {...props}
 42:   >
 43:     {children}
 44:     <ChevronRight className="ml-auto h-4 w-4" />
 45:   </DropdownMenuPrimitive.SubTrigger>
 46: ));
 47: DropdownMenuSubTrigger.displayName =
 48:   DropdownMenuPrimitive.SubTrigger.displayName;
 49: 
 50: interface DropdownMenuSubContentProps
 51:   extends React.ComponentPropsWithoutRef<
 52:     typeof DropdownMenuPrimitive.SubContent
 53:   > {
 54:   className?: string;
 55:   children: React.ReactNode;
 56: }
 57: 
 58: const DropdownMenuSubContent = React.forwardRef<
 59:   React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
 60:   DropdownMenuSubContentProps
 61: >(({ className, children, ...props }, ref) => (
 62:   <DropdownMenuPrimitive.SubContent
 63:     ref={ref}
 64:     className={cn(
 65:       "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 66:       className
 67:     )}
 68:     {...props}
 69:   >
 70:     {children}
 71:   </DropdownMenuPrimitive.SubContent>
 72: ));
 73: DropdownMenuSubContent.displayName =
 74:   DropdownMenuPrimitive.SubContent.displayName;
 75: 
 76: interface DropdownMenuContentProps
 77:   extends React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content> {
 78:   className?: string;
 79:   sideOffset?: number;
 80:   children: React.ReactNode;
 81: }
 82: 
 83: const DropdownMenuContent = React.forwardRef<
 84:   React.ElementRef<typeof DropdownMenuPrimitive.Content>,
 85:   DropdownMenuContentProps
 86: >(({ className, sideOffset = 4, children, ...props }, ref) => (
 87:   <DropdownMenuPrimitive.Portal>
 88:     <DropdownMenuPrimitive.Content
 89:       ref={ref}
 90:       sideOffset={sideOffset}
 91:       className={cn(
 92:         "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 93:         className
 94:       )}
 95:       {...props}
 96:     >
 97:       {children}
 98:     </DropdownMenuPrimitive.Content>
 99:   </DropdownMenuPrimitive.Portal>
100: ));
101: DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;
102: 
103: interface DropdownMenuItemProps
104:   extends React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> {
105:   inset?: boolean;
106:   className?: string;
107:   children: React.ReactNode;
108: }
109: 
110: const DropdownMenuItem = React.forwardRef<
111:   React.ElementRef<typeof DropdownMenuPrimitive.Item>,
112:   DropdownMenuItemProps
113: >(({ className, inset, children, ...props }, ref) => (
114:   <DropdownMenuPrimitive.Item
115:     ref={ref}
116:     className={cn(
117:       "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
118:       inset && "pl-8",
119:       className
120:     )}
121:     {...props}
122:   >
123:     {children}
124:   </DropdownMenuPrimitive.Item>
125: ));
126: DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;
127: 
128: interface DropdownMenuCheckboxItemProps
129:   extends React.ComponentPropsWithoutRef<
130:     typeof DropdownMenuPrimitive.CheckboxItem
131:   > {
132:   className?: string;
133:   children: React.ReactNode;
134:   checked?: boolean;
135: }
136: 
137: const DropdownMenuCheckboxItem = React.forwardRef<
138:   React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
139:   DropdownMenuCheckboxItemProps
140: >(({ className, children, checked, ...props }, ref) => (
141:   <DropdownMenuPrimitive.CheckboxItem
142:     ref={ref}
143:     className={cn(
144:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
145:       className
146:     )}
147:     checked={checked}
148:     {...props}
149:   >
150:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
151:       <DropdownMenuPrimitive.ItemIndicator>
152:         <Check className="h-4 w-4" />
153:       </DropdownMenuPrimitive.ItemIndicator>
154:     </span>
155:     {children}
156:   </DropdownMenuPrimitive.CheckboxItem>
157: ));
158: DropdownMenuCheckboxItem.displayName =
159:   DropdownMenuPrimitive.CheckboxItem.displayName;
160: 
161: interface DropdownMenuRadioItemProps
162:   extends React.ComponentPropsWithoutRef<
163:     typeof DropdownMenuPrimitive.RadioItem
164:   > {
165:   className?: string;
166:   children: React.ReactNode;
167: }
168: 
169: const DropdownMenuRadioItem = React.forwardRef<
170:   React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
171:   DropdownMenuRadioItemProps
172: >(({ className, children, ...props }, ref) => (
173:   <DropdownMenuPrimitive.RadioItem
174:     ref={ref}
175:     className={cn(
176:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
177:       className
178:     )}
179:     {...props}
180:   >
181:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
182:       <DropdownMenuPrimitive.ItemIndicator>
183:         <Circle className="h-2 w-2 fill-current" />
184:       </DropdownMenuPrimitive.ItemIndicator>
185:     </span>
186:     {children}
187:   </DropdownMenuPrimitive.RadioItem>
188: ));
189: DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;
190: 
191: interface DropdownMenuLabelProps
192:   extends React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> {
193:   inset?: boolean;
194:   className?: string;
195:   children: React.ReactNode;
196: }
197: 
198: const DropdownMenuLabel = React.forwardRef<
199:   React.ElementRef<typeof DropdownMenuPrimitive.Label>,
200:   DropdownMenuLabelProps
201: >(({ className, inset, children, ...props }, ref) => (
202:   <DropdownMenuPrimitive.Label
203:     ref={ref}
204:     className={cn(
205:       "px-2 py-1.5 text-sm font-semibold",
206:       inset && "pl-8",
207:       className
208:     )}
209:     {...props}
210:   >
211:     {children}
212:   </DropdownMenuPrimitive.Label>
213: ));
214: DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;
215: 
216: interface DropdownMenuSeparatorProps
217:   extends React.ComponentPropsWithoutRef<
218:     typeof DropdownMenuPrimitive.Separator
219:   > {
220:   className?: string;
221: }
222: 
223: const DropdownMenuSeparator = React.forwardRef<
224:   React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
225:   DropdownMenuSeparatorProps
226: >(({ className, ...props }, ref) => (
227:   <DropdownMenuPrimitive.Separator
228:     ref={ref}
229:     className={cn("-mx-1 my-1 h-px bg-muted", className)}
230:     {...props}
231:   />
232: ));
233: DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;
234: 
235: interface DropdownMenuShortcutProps
236:   extends React.HTMLAttributes<HTMLSpanElement> {
237:   className?: string;
238:   children: React.ReactNode;
239: }
240: 
241: const DropdownMenuShortcut = ({
242:   className,
243:   children,
244:   ...props
245: }: DropdownMenuShortcutProps) => {
246:   return (
247:     <span
248:       className={cn("ml-auto text-xs tracking-widest opacity-60", className)}
249:       {...props}
250:     >
251:       {children}
252:     </span>
253:   );
254: };
255: DropdownMenuShortcut.displayName = "DropdownMenuShortcut";
256: 
257: export {
258:   DropdownMenu,
259:   DropdownMenuTrigger,
260:   DropdownMenuContent,
261:   DropdownMenuItem,
262:   DropdownMenuCheckboxItem,
263:   DropdownMenuRadioItem,
264:   DropdownMenuLabel,
265:   DropdownMenuSeparator,
266:   DropdownMenuShortcut,
267:   DropdownMenuGroup,
268:   DropdownMenuPortal,
269:   DropdownMenuSub,
270:   DropdownMenuSubContent,
271:   DropdownMenuSubTrigger,
272:   DropdownMenuRadioGroup,
273: };
```

## File: packages/ui/src/components/form.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react";
  4: import { Slot } from "@radix-ui/react-slot";
  5: import { Controller, FormProvider, useFormContext } from "react-hook-form";
  6: import type { ControllerProps, FieldPath, FieldValues } from "react-hook-form";
  7: 
  8: import { cn } from "@/lib/utils";
  9: import { Label } from "./label";
 10: 
 11: const Form = FormProvider;
 12: 
 13: type FormFieldContextValue<
 14:   TFieldValues extends FieldValues = FieldValues,
 15:   TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
 16: > = {
 17:   name: TName;
 18: };
 19: 
 20: const FormFieldContext = React.createContext<FormFieldContextValue>(
 21:   {} as FormFieldContextValue
 22: );
 23: 
 24: const FormField = <
 25:   TFieldValues extends FieldValues = FieldValues,
 26:   TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
 27: >({
 28:   ...props
 29: }: ControllerProps<TFieldValues, TName>) => {
 30:   return (
 31:     <FormFieldContext.Provider value={{ name: props.name }}>
 32:       <Controller {...props} />
 33:     </FormFieldContext.Provider>
 34:   );
 35: };
 36: 
 37: const useFormField = () => {
 38:   const fieldContext = React.useContext(FormFieldContext);
 39:   const itemContext = React.useContext(FormItemContext);
 40:   const { getFieldState, formState } = useFormContext();
 41: 
 42:   const fieldState = getFieldState(fieldContext.name, formState);
 43: 
 44:   if (!fieldContext) {
 45:     throw new Error("useFormField should be used within <FormField>");
 46:   }
 47: 
 48:   const { id } = itemContext;
 49: 
 50:   return {
 51:     id,
 52:     name: fieldContext.name,
 53:     formItemId: `${id}-form-item`,
 54:     formDescriptionId: `${id}-form-item-description`,
 55:     formMessageId: `${id}-form-item-message`,
 56:     ...fieldState,
 57:   };
 58: };
 59: 
 60: type FormItemContextValue = {
 61:   id: string;
 62: };
 63: 
 64: const FormItemContext = React.createContext<FormItemContextValue>(
 65:   {} as FormItemContextValue
 66: );
 67: 
 68: const FormItem = React.forwardRef<
 69:   HTMLDivElement,
 70:   React.HTMLAttributes<HTMLDivElement>
 71: >(({ className, ...props }, ref) => {
 72:   const id = React.useId();
 73: 
 74:   return (
 75:     <FormItemContext.Provider value={{ id }}>
 76:       <div ref={ref} className={cn("space-y-2", className)} {...props} />
 77:     </FormItemContext.Provider>
 78:   );
 79: });
 80: FormItem.displayName = "FormItem";
 81: 
 82: const FormLabel = React.forwardRef<
 83:   React.ElementRef<typeof Label>,
 84:   React.ComponentPropsWithoutRef<typeof Label>
 85: >(({ className, ...props }, ref) => {
 86:   const { error, formItemId } = useFormField();
 87: 
 88:   return (
 89:     <Label
 90:       ref={ref}
 91:       className={cn(error && "text-destructive", className)}
 92:       htmlFor={formItemId}
 93:       {...props}
 94:     />
 95:   );
 96: });
 97: FormLabel.displayName = "FormLabel";
 98: 
 99: const FormControl = React.forwardRef<
100:   React.ElementRef<typeof Slot>,
101:   React.ComponentPropsWithoutRef<typeof Slot>
102: >(({ ...props }, ref) => {
103:   const { error, formItemId, formDescriptionId, formMessageId } = useFormField();
104: 
105:   return (
106:     <Slot
107:       ref={ref}
108:       id={formItemId}
109:       aria-describedby={
110:         !error
111:           ? `${formDescriptionId}`
112:           : `${formDescriptionId} ${formMessageId}`
113:       }
114:       aria-invalid={!!error}
115:       {...props}
116:     />
117:   );
118: });
119: FormControl.displayName = "FormControl";
120: 
121: const FormDescription = React.forwardRef<
122:   HTMLParagraphElement,
123:   React.HTMLAttributes<HTMLParagraphElement>
124: >(({ className, ...props }, ref) => {
125:   const { formDescriptionId } = useFormField();
126: 
127:   return (
128:     <p
129:       ref={ref}
130:       id={formDescriptionId}
131:       className={cn("text-sm text-muted-foreground", className)}
132:       {...props}
133:     />
134:   );
135: });
136: FormDescription.displayName = "FormDescription";
137: 
138: const FormMessage = React.forwardRef<
139:   HTMLParagraphElement,
140:   React.HTMLAttributes<HTMLParagraphElement>
141: >(({ className, children, ...props }, ref) => {
142:   const { error, formMessageId } = useFormField();
143:   const body = error ? String(error?.message) : children;
144: 
145:   if (!body) {
146:     return null;
147:   }
148: 
149:   return (
150:     <p
151:       ref={ref}
152:       id={formMessageId}
153:       className={cn("text-sm font-medium text-destructive", className)}
154:       {...props}
155:     >
156:       {body}
157:     </p>
158:   );
159: });
160: FormMessage.displayName = "FormMessage";
161: 
162: export {
163:   useFormField,
164:   Form,
165:   FormItem,
166:   FormLabel,
167:   FormControl,
168:   FormDescription,
169:   FormMessage,
170:   FormField,
171: };
```

## File: packages/ui/src/components/hover-card.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as HoverCardPrimitive from "@radix-ui/react-hover-card"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const HoverCard = HoverCardPrimitive.Root
 9: 
10: const HoverCardTrigger = HoverCardPrimitive.Trigger
11: 
12: const HoverCardContent = React.forwardRef<
13:   React.ElementRef<typeof HoverCardPrimitive.Content>,
14:   React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
15: >(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
16:   <HoverCardPrimitive.Content
17:     ref={ref}
18:     align={align}
19:     sideOffset={sideOffset}
20:     className={cn(
21:       "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
22:       className
23:     )}
24:     {...props}
25:   />
26: ))
27: HoverCardContent.displayName = HoverCardPrimitive.Content.displayName
28: 
29: export { HoverCard, HoverCardTrigger, HoverCardContent }
```

## File: packages/ui/src/components/icons.tsx
```typescript
 1: import type { HTMLAttributes } from "react"
 2: import {
 3:   Rocket,
 4:   type LucideIcon,
 5:   LucideProps
 6: } from "lucide-react"
 7: 
 8: export type Icon = LucideIcon
 9: export type IconProps = HTMLAttributes<SVGElement>
10: 
11: export const Icons = {
12:   rocket: Rocket,
13:   spinner: (props: LucideProps) => (
14:     <svg
15:       xmlns="http://www.w3.org/2000/svg"
16:       width="24"
17:       height="24"
18:       viewBox="0 0 24 24"
19:       fill="none"
20:       stroke="currentColor"
21:       strokeWidth="2"
22:       strokeLinecap="round"
23:       strokeLinejoin="round"
24:       {...props}
25:     >
26:       <path d="M21 12a9 9 0 1 1-6.219-8.56" />
27:     </svg>
28:   ),
29: } satisfies Record<string, Icon | ((props: LucideProps) => JSX.Element)>
```

## File: packages/ui/src/components/input-otp.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { OTPInput, OTPInputContext } from "input-otp"
 5: import { Minus } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const InputOTP = React.forwardRef<
10:   React.ElementRef<typeof OTPInput>,
11:   React.ComponentPropsWithoutRef<typeof OTPInput>
12: >(({ className, containerClassName, ...props }, ref) => (
13:   <OTPInput
14:     ref={ref}
15:     containerClassName={cn(
16:       "flex items-center gap-2 has-[:disabled]:opacity-50",
17:       containerClassName
18:     )}
19:     className={cn("disabled:cursor-not-allowed", className)}
20:     {...props}
21:   />
22: ))
23: InputOTP.displayName = "InputOTP"
24: 
25: const InputOTPGroup = React.forwardRef<
26:   React.ElementRef<"div">,
27:   React.ComponentPropsWithoutRef<"div">
28: >(({ className, ...props }, ref) => (
29:   <div ref={ref} className={cn("flex items-center", className)} {...props} />
30: ))
31: InputOTPGroup.displayName = "InputOTPGroup"
32: 
33: const InputOTPSlot = React.forwardRef<
34:   React.ElementRef<"div">,
35:   React.ComponentPropsWithoutRef<"div"> & { index: number }
36: >(({ index, className, ...props }, ref) => {
37:   const inputOTPContext = React.useContext(OTPInputContext)
38:   const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]
39: 
40:   return (
41:     <div
42:       ref={ref}
43:       className={cn(
44:         "relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
45:         isActive && "z-10 ring-1 ring-ring",
46:         className
47:       )}
48:       {...props}
49:     >
50:       {char}
51:       {hasFakeCaret && (
52:         <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
53:           <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
54:         </div>
55:       )}
56:     </div>
57:   )
58: })
59: InputOTPSlot.displayName = "InputOTPSlot"
60: 
61: const InputOTPSeparator = React.forwardRef<
62:   React.ElementRef<"div">,
63:   React.ComponentPropsWithoutRef<"div">
64: >(({ ...props }, ref) => (
65:   <div ref={ref} role="separator" {...props}>
66:     <Minus />
67:   </div>
68: ))
69: InputOTPSeparator.displayName = "InputOTPSeparator"
70: 
71: export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }
```

## File: packages/ui/src/components/input.tsx
```typescript
 1: 'use client'
 2: 
 3: import * as React from 'react'
 4: import { Button } from './button'
 5: import { Textarea } from './textarea'
 6: import { cn } from '../lib/utils'
 7: import { SendHorizontal, Loader2 } from 'lucide-react'
 8: 
 9: interface MessageInputProps {
10:   action: (formData: FormData) => Promise<void>
11:   isLoading?: boolean
12:   isDisabled?: boolean
13:   placeholder?: string
14: }
15: 
16: export function MessageInput({
17:   action,
18:   isLoading = false,
19:   isDisabled = false,
20:   placeholder = 'Type your message...'
21: }: MessageInputProps) {
22:   const [input, setInput] = React.useState('')
23:   const textareaRef = React.useRef<HTMLTextAreaElement>(null)
24:   const formRef = React.useRef<HTMLFormElement>(null)
25: 
26:   React.useEffect(() => {
27:     if (textareaRef.current) {
28:       textareaRef.current.style.height = '0px'
29:       const scrollHeight = textareaRef.current.scrollHeight
30:       textareaRef.current.style.height = scrollHeight + 'px'
31:     }
32:   }, [input])
33: 
34:   const handleSubmit = async (formData: FormData) => {
35:     if (!input.trim() || isDisabled || isLoading) return
36:     await action(formData)
37:     setInput('')
38:     if (textareaRef.current) {
39:       textareaRef.current.style.height = '48px'
40:     }
41:   }
42: 
43:   const handleKeyDown = (e: React.KeyboardEvent) => {
44:     if (e.key === 'Enter' && !e.shiftKey) {
45:       e.preventDefault()
46:       formRef.current?.requestSubmit()
47:     }
48:   }
49: 
50:   return (
51:     <form ref={formRef} action={handleSubmit} className="relative">
52:       <Textarea
53:         ref={textareaRef}
54:         name="message"
55:         value={input}
56:         onChange={(e) => setInput(e.target.value)}
57:         onKeyDown={handleKeyDown}
58:         placeholder={placeholder}
59:         disabled={isDisabled}
60:         className={cn(
61:           'min-h-[48px] w-full resize-none rounded-lg pr-12',
62:           'focus-visible:ring-1 focus-visible:ring-offset-0',
63:           isDisabled && 'opacity-50 cursor-not-allowed'
64:         )}
65:         rows={1}
66:       />
67:       <Button
68:         type="submit"
69:         size="icon"
70:         disabled={isDisabled || isLoading || !input.trim()}
71:         className={cn(
72:           'absolute right-1 top-1 h-[34px] w-[34px]',
73:           'bg-primary hover:bg-primary/90',
74:           'text-primary-foreground',
75:           'transition-opacity',
76:           (!input.trim() || isDisabled) && 'opacity-50'
77:         )}
78:       >
79:         {isLoading ? (
80:           <Loader2 className="h-4 w-4 animate-spin" />
81:         ) : (
82:           <SendHorizontal className="h-4 w-4" />
83:         )}
84:         <span className="sr-only">Send message</span>
85:       </Button>
86:     </form>
87:   )
88: }
```

## File: packages/ui/src/components/label.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as LabelPrimitive from "@radix-ui/react-label"
 5: import { cva, type VariantProps } from "class-variance-authority"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const labelVariants = cva(
10:   "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
11: )
12: 
13: const Label = React.forwardRef<
14:   React.ElementRef<typeof LabelPrimitive.Root>,
15:   React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
16:     VariantProps<typeof labelVariants>
17: >(({ className, ...props }, ref) => (
18:   <LabelPrimitive.Root
19:     ref={ref}
20:     className={cn(labelVariants(), className)}
21:     {...props}
22:   />
23: ))
24: Label.displayName = LabelPrimitive.Root.displayName
25: 
26: export { Label }
```

## File: packages/ui/src/components/loading-spinner.tsx
```typescript
 1: 'use client'
 2: 
 3: export function LoadingSpinner() {
 4:   return (
 5:     <div className="flex items-center justify-center">
 6:       <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-primary">
 7:         <span className="sr-only">Loading...</span>
 8:       </div>
 9:     </div>
10:   )
11: }
```

## File: packages/ui/src/components/menubar.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as MenubarPrimitive from "@radix-ui/react-menubar"
  5: import { Check, ChevronRight, Circle } from "lucide-react"
  6: 
  7: import { cn } from "@/lib/utils"
  8: 
  9: const MenubarMenu = MenubarPrimitive.Menu
 10: 
 11: const MenubarGroup = MenubarPrimitive.Group
 12: 
 13: const MenubarPortal = MenubarPrimitive.Portal
 14: 
 15: const MenubarSub = MenubarPrimitive.Sub
 16: 
 17: const MenubarRadioGroup = MenubarPrimitive.RadioGroup
 18: 
 19: const Menubar = React.forwardRef<
 20:   React.ElementRef<typeof MenubarPrimitive.Root>,
 21:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
 22: >(({ className, ...props }, ref) => (
 23:   <MenubarPrimitive.Root
 24:     ref={ref}
 25:     className={cn(
 26:       "flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm",
 27:       className
 28:     )}
 29:     {...props}
 30:   />
 31: ))
 32: Menubar.displayName = MenubarPrimitive.Root.displayName
 33: 
 34: const MenubarTrigger = React.forwardRef<
 35:   React.ElementRef<typeof MenubarPrimitive.Trigger>,
 36:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
 37: >(({ className, ...props }, ref) => (
 38:   <MenubarPrimitive.Trigger
 39:     ref={ref}
 40:     className={cn(
 41:       "flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
 42:       className
 43:     )}
 44:     {...props}
 45:   />
 46: ))
 47: MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName
 48: 
 49: const MenubarSubTrigger = React.forwardRef<
 50:   React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
 51:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
 52:     inset?: boolean
 53:   }
 54: >(({ className, inset, children, ...props }, ref) => (
 55:   <MenubarPrimitive.SubTrigger
 56:     ref={ref}
 57:     className={cn(
 58:       "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
 59:       inset && "pl-8",
 60:       className
 61:     )}
 62:     {...props}
 63:   >
 64:     {children}
 65:     <ChevronRight className="ml-auto h-4 w-4" />
 66:   </MenubarPrimitive.SubTrigger>
 67: ))
 68: MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName
 69: 
 70: const MenubarSubContent = React.forwardRef<
 71:   React.ElementRef<typeof MenubarPrimitive.SubContent>,
 72:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
 73: >(({ className, ...props }, ref) => (
 74:   <MenubarPrimitive.SubContent
 75:     ref={ref}
 76:     className={cn(
 77:       "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 78:       className
 79:     )}
 80:     {...props}
 81:   />
 82: ))
 83: MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName
 84: 
 85: const MenubarContent = React.forwardRef<
 86:   React.ElementRef<typeof MenubarPrimitive.Content>,
 87:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
 88: >(
 89:   (
 90:     { className, align = "start", alignOffset = -4, sideOffset = 8, ...props },
 91:     ref
 92:   ) => (
 93:     <MenubarPrimitive.Portal>
 94:       <MenubarPrimitive.Content
 95:         ref={ref}
 96:         align={align}
 97:         alignOffset={alignOffset}
 98:         sideOffset={sideOffset}
 99:         className={cn(
100:           "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
101:           className
102:         )}
103:         {...props}
104:       />
105:     </MenubarPrimitive.Portal>
106:   )
107: )
108: MenubarContent.displayName = MenubarPrimitive.Content.displayName
109: 
110: const MenubarItem = React.forwardRef<
111:   React.ElementRef<typeof MenubarPrimitive.Item>,
112:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
113:     inset?: boolean
114:   }
115: >(({ className, inset, ...props }, ref) => (
116:   <MenubarPrimitive.Item
117:     ref={ref}
118:     className={cn(
119:       "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
120:       inset && "pl-8",
121:       className
122:     )}
123:     {...props}
124:   />
125: ))
126: MenubarItem.displayName = MenubarPrimitive.Item.displayName
127: 
128: const MenubarCheckboxItem = React.forwardRef<
129:   React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
130:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
131: >(({ className, children, checked, ...props }, ref) => (
132:   <MenubarPrimitive.CheckboxItem
133:     ref={ref}
134:     className={cn(
135:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
136:       className
137:     )}
138:     checked={checked}
139:     {...props}
140:   >
141:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
142:       <MenubarPrimitive.ItemIndicator>
143:         <Check className="h-4 w-4" />
144:       </MenubarPrimitive.ItemIndicator>
145:     </span>
146:     {children}
147:   </MenubarPrimitive.CheckboxItem>
148: ))
149: MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName
150: 
151: const MenubarRadioItem = React.forwardRef<
152:   React.ElementRef<typeof MenubarPrimitive.RadioItem>,
153:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
154: >(({ className, children, ...props }, ref) => (
155:   <MenubarPrimitive.RadioItem
156:     ref={ref}
157:     className={cn(
158:       "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
159:       className
160:     )}
161:     {...props}
162:   >
163:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
164:       <MenubarPrimitive.ItemIndicator>
165:         <Circle className="h-4 w-4 fill-current" />
166:       </MenubarPrimitive.ItemIndicator>
167:     </span>
168:     {children}
169:   </MenubarPrimitive.RadioItem>
170: ))
171: MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName
172: 
173: const MenubarLabel = React.forwardRef<
174:   React.ElementRef<typeof MenubarPrimitive.Label>,
175:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
176:     inset?: boolean
177:   }
178: >(({ className, inset, ...props }, ref) => (
179:   <MenubarPrimitive.Label
180:     ref={ref}
181:     className={cn(
182:       "px-2 py-1.5 text-sm font-semibold",
183:       inset && "pl-8",
184:       className
185:     )}
186:     {...props}
187:   />
188: ))
189: MenubarLabel.displayName = MenubarPrimitive.Label.displayName
190: 
191: const MenubarSeparator = React.forwardRef<
192:   React.ElementRef<typeof MenubarPrimitive.Separator>,
193:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
194: >(({ className, ...props }, ref) => (
195:   <MenubarPrimitive.Separator
196:     ref={ref}
197:     className={cn("-mx-1 my-1 h-px bg-muted", className)}
198:     {...props}
199:   />
200: ))
201: MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName
202: 
203: const MenubarShortcut = ({
204:   className,
205:   ...props
206: }: React.HTMLAttributes<HTMLSpanElement>) => {
207:   return (
208:     <span
209:       className={cn(
210:         "ml-auto text-xs tracking-widest text-muted-foreground",
211:         className
212:       )}
213:       {...props}
214:     />
215:   )
216: }
217: MenubarShortcut.displayname = "MenubarShortcut"
218: 
219: export {
220:   Menubar,
221:   MenubarMenu,
222:   MenubarTrigger,
223:   MenubarContent,
224:   MenubarItem,
225:   MenubarSeparator,
226:   MenubarLabel,
227:   MenubarCheckboxItem,
228:   MenubarRadioGroup,
229:   MenubarRadioItem,
230:   MenubarPortal,
231:   MenubarSubContent,
232:   MenubarSubTrigger,
233:   MenubarGroup,
234:   MenubarSub,
235:   MenubarShortcut,
236: }
```

## File: packages/ui/src/components/navigation-menu.tsx
```typescript
  1: import * as React from "react"
  2: import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu"
  3: import { cva } from "class-variance-authority"
  4: import { ChevronDown } from "lucide-react"
  5: 
  6: import { cn } from "@/lib/utils"
  7: 
  8: const NavigationMenu = React.forwardRef<
  9:   React.ElementRef<typeof NavigationMenuPrimitive.Root>,
 10:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
 11: >(({ className, children, ...props }, ref) => (
 12:   <NavigationMenuPrimitive.Root
 13:     ref={ref}
 14:     className={cn(
 15:       "relative z-10 flex max-w-max flex-1 items-center justify-center",
 16:       className
 17:     )}
 18:     {...props}
 19:   >
 20:     {children}
 21:     <NavigationMenuViewport />
 22:   </NavigationMenuPrimitive.Root>
 23: ))
 24: NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName
 25: 
 26: const NavigationMenuList = React.forwardRef<
 27:   React.ElementRef<typeof NavigationMenuPrimitive.List>,
 28:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
 29: >(({ className, ...props }, ref) => (
 30:   <NavigationMenuPrimitive.List
 31:     ref={ref}
 32:     className={cn(
 33:       "group flex flex-1 list-none items-center justify-center space-x-1",
 34:       className
 35:     )}
 36:     {...props}
 37:   />
 38: ))
 39: NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName
 40: 
 41: const NavigationMenuItem = NavigationMenuPrimitive.Item
 42: 
 43: const navigationMenuTriggerStyle = cva(
 44:   "group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
 45: )
 46: 
 47: const NavigationMenuTrigger = React.forwardRef<
 48:   React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
 49:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
 50: >(({ className, children, ...props }, ref) => (
 51:   <NavigationMenuPrimitive.Trigger
 52:     ref={ref}
 53:     className={cn(navigationMenuTriggerStyle(), "group", className)}
 54:     {...props}
 55:   >
 56:     {children}{" "}
 57:     <ChevronDown
 58:       className="relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180"
 59:       aria-hidden="true"
 60:     />
 61:   </NavigationMenuPrimitive.Trigger>
 62: ))
 63: NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName
 64: 
 65: const NavigationMenuContent = React.forwardRef<
 66:   React.ElementRef<typeof NavigationMenuPrimitive.Content>,
 67:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
 68: >(({ className, ...props }, ref) => (
 69:   <NavigationMenuPrimitive.Content
 70:     ref={ref}
 71:     className={cn(
 72:       "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",
 73:       className
 74:     )}
 75:     {...props}
 76:   />
 77: ))
 78: NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName
 79: 
 80: const NavigationMenuLink = NavigationMenuPrimitive.Link
 81: 
 82: const NavigationMenuViewport = React.forwardRef<
 83:   React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
 84:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
 85: >(({ className, ...props }, ref) => (
 86:   <div className={cn("absolute left-0 top-full flex justify-center")}>
 87:     <NavigationMenuPrimitive.Viewport
 88:       className={cn(
 89:         "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
 90:         className
 91:       )}
 92:       ref={ref}
 93:       {...props}
 94:     />
 95:   </div>
 96: ))
 97: NavigationMenuViewport.displayName =
 98:   NavigationMenuPrimitive.Viewport.displayName
 99: 
100: const NavigationMenuIndicator = React.forwardRef<
101:   React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
102:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
103: >(({ className, ...props }, ref) => (
104:   <NavigationMenuPrimitive.Indicator
105:     ref={ref}
106:     className={cn(
107:       "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
108:       className
109:     )}
110:     {...props}
111:   >
112:     <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
113:   </NavigationMenuPrimitive.Indicator>
114: ))
115: NavigationMenuIndicator.displayName =
116:   NavigationMenuPrimitive.Indicator.displayName
117: 
118: export {
119:   navigationMenuTriggerStyle,
120:   NavigationMenu,
121:   NavigationMenuList,
122:   NavigationMenuItem,
123:   NavigationMenuContent,
124:   NavigationMenuTrigger,
125:   NavigationMenuLink,
126:   NavigationMenuIndicator,
127:   NavigationMenuViewport,
128: }
```

## File: packages/ui/src/components/pagination.tsx
```typescript
  1: import * as React from "react"
  2: import { ChevronLeft, ChevronRight, MoreHorizontal } from "lucide-react"
  3: 
  4: import { cn } from "@/lib/utils"
  5: import type { ButtonProps } from "./button"
  6: import { buttonVariants } from "./button"
  7: 
  8: const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  9:   <nav
 10:     role="navigation"
 11:     aria-label="pagination"
 12:     className={cn("mx-auto flex w-full justify-center", className)}
 13:     {...props}
 14:   />
 15: )
 16: Pagination.displayName = "Pagination"
 17: 
 18: const PaginationContent = React.forwardRef<
 19:   HTMLUListElement,
 20:   React.ComponentProps<"ul">
 21: >(({ className, ...props }, ref) => (
 22:   <ul
 23:     ref={ref}
 24:     className={cn("flex flex-row items-center gap-1", className)}
 25:     {...props}
 26:   />
 27: ))
 28: PaginationContent.displayName = "PaginationContent"
 29: 
 30: const PaginationItem = React.forwardRef<
 31:   HTMLLIElement,
 32:   React.ComponentProps<"li">
 33: >(({ className, ...props }, ref) => (
 34:   <li ref={ref} className={cn("", className)} {...props} />
 35: ))
 36: PaginationItem.displayName = "PaginationItem"
 37: 
 38: type PaginationLinkProps = {
 39:   isActive?: boolean
 40: } & Pick<ButtonProps, "size"> &
 41:   React.ComponentProps<"a">
 42: 
 43: const PaginationLink = ({
 44:   className,
 45:   isActive,
 46:   size = "icon",
 47:   ...props
 48: }: PaginationLinkProps) => (
 49:   <a
 50:     aria-current={isActive ? "page" : undefined}
 51:     className={cn(
 52:       buttonVariants({
 53:         variant: isActive ? "outline" : "ghost",
 54:         size,
 55:       }),
 56:       className
 57:     )}
 58:     {...props}
 59:   />
 60: )
 61: PaginationLink.displayName = "PaginationLink"
 62: 
 63: const PaginationPrevious = ({
 64:   className,
 65:   ...props
 66: }: React.ComponentProps<typeof PaginationLink>) => (
 67:   <PaginationLink
 68:     aria-label="Go to previous page"
 69:     size="default"
 70:     className={cn("gap-1 pl-2.5", className)}
 71:     {...props}
 72:   >
 73:     <ChevronLeft className="h-4 w-4" />
 74:     <span>Previous</span>
 75:   </PaginationLink>
 76: )
 77: PaginationPrevious.displayName = "PaginationPrevious"
 78: 
 79: const PaginationNext = ({
 80:   className,
 81:   ...props
 82: }: React.ComponentProps<typeof PaginationLink>) => (
 83:   <PaginationLink
 84:     aria-label="Go to next page"
 85:     size="default"
 86:     className={cn("gap-1 pr-2.5", className)}
 87:     {...props}
 88:   >
 89:     <span>Next</span>
 90:     <ChevronRight className="h-4 w-4" />
 91:   </PaginationLink>
 92: )
 93: PaginationNext.displayName = "PaginationNext"
 94: 
 95: const PaginationEllipsis = ({
 96:   className,
 97:   ...props
 98: }: React.ComponentProps<"span">) => (
 99:   <span
100:     aria-hidden
101:     className={cn("flex h-9 w-9 items-center justify-center", className)}
102:     {...props}
103:   >
104:     <MoreHorizontal className="h-4 w-4" />
105:     <span className="sr-only">More pages</span>
106:   </span>
107: )
108: PaginationEllipsis.displayName = "PaginationEllipsis"
109: 
110: export {
111:   Pagination,
112:   PaginationContent,
113:   PaginationLink,
114:   PaginationItem,
115:   PaginationPrevious,
116:   PaginationNext,
117:   PaginationEllipsis,
118: }
```

## File: packages/ui/src/components/popover.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as PopoverPrimitive from "@radix-ui/react-popover"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Popover = PopoverPrimitive.Root
 9: 
10: const PopoverTrigger = PopoverPrimitive.Trigger
11: 
12: const PopoverAnchor = PopoverPrimitive.Anchor
13: 
14: const PopoverContent = React.forwardRef<
15:   React.ElementRef<typeof PopoverPrimitive.Content>,
16:   React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
17: >(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
18:   <PopoverPrimitive.Portal>
19:     <PopoverPrimitive.Content
20:       ref={ref}
21:       align={align}
22:       sideOffset={sideOffset}
23:       className={cn(
24:         "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
25:         className
26:       )}
27:       {...props}
28:     />
29:   </PopoverPrimitive.Portal>
30: ))
31: PopoverContent.displayName = PopoverPrimitive.Content.displayName
32: 
33: export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }
```

## File: packages/ui/src/components/progress.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as ProgressPrimitive from "@radix-ui/react-progress"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Progress = React.forwardRef<
 9:   React.ElementRef<typeof ProgressPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
11: >(({ className, value, ...props }, ref) => (
12:   <ProgressPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative h-2 w-full overflow-hidden rounded-full bg-primary/20",
16:       className
17:     )}
18:     {...props}
19:   >
20:     <ProgressPrimitive.Indicator
21:       className="h-full w-full flex-1 bg-primary transition-all"
22:       style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
23:     />
24:   </ProgressPrimitive.Root>
25: ))
26: Progress.displayName = ProgressPrimitive.Root.displayName
27: 
28: export { Progress }
```

## File: packages/ui/src/components/radio-group.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as RadioGroupPrimitive from "@radix-ui/react-radio-group"
 5: import { Circle } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const RadioGroup = React.forwardRef<
10:   React.ElementRef<typeof RadioGroupPrimitive.Root>,
11:   React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
12: >(({ className, ...props }, ref) => {
13:   return (
14:     <RadioGroupPrimitive.Root
15:       className={cn("grid gap-2", className)}
16:       {...props}
17:       ref={ref}
18:     />
19:   )
20: })
21: RadioGroup.displayName = RadioGroupPrimitive.Root.displayName
22: 
23: const RadioGroupItem = React.forwardRef<
24:   React.ElementRef<typeof RadioGroupPrimitive.Item>,
25:   React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
26: >(({ className, ...props }, ref) => {
27:   return (
28:     <RadioGroupPrimitive.Item
29:       ref={ref}
30:       className={cn(
31:         "aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",
32:         className
33:       )}
34:       {...props}
35:     >
36:       <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
37:         <Circle className="h-3.5 w-3.5 fill-primary" />
38:       </RadioGroupPrimitive.Indicator>
39:     </RadioGroupPrimitive.Item>
40:   )
41: })
42: RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName
43: 
44: export { RadioGroup, RadioGroupItem }
```

## File: packages/ui/src/components/resizable.tsx
```typescript
 1: "use client"
 2: 
 3: import { GripVertical } from "lucide-react";
 4: import * as ResizablePrimitive from "react-resizable-panels";
 5: 
 6: import { cn } from "@/lib/utils";
 7: 
 8: const ResizablePanelGroup = ({
 9:   className,
10:   ...props
11: }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
12:   <ResizablePrimitive.PanelGroup
13:     className={cn(
14:       "flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
15:       className
16:     )}
17:     {...props}
18:   />
19: );
20: 
21: const ResizablePanel = ResizablePrimitive.Panel;
22: 
23: const ResizableHandle = ({
24:   withHandle,
25:   className,
26:   ...props
27: }: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
28:   withHandle?: boolean;
29: }) => (
30:   <ResizablePrimitive.PanelResizeHandle
31:     className={cn(
32:       "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
33:       className
34:     )}
35:     {...props}
36:   >
37:     {withHandle && (
38:       <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
39:         <GripVertical className="h-2.5 w-2.5" />
40:       </div>
41:     )}
42:   </ResizablePrimitive.PanelResizeHandle>
43: );
44: 
45: export {
46:   ResizablePanelGroup,
47:   ResizablePanel,
48:   ResizableHandle,
49: }
```

## File: packages/ui/src/components/scroll-area.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"
 5: 
 6: import { cn } from "@/lib/utils"  // Already using correct import path
 7: 
 8: const ScrollArea = React.forwardRef<
 9:   React.ElementRef<typeof ScrollAreaPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
11: >(({ className, children, ...props }, ref) => (
12:   <ScrollAreaPrimitive.Root
13:     ref={ref}
14:     className={cn("relative overflow-hidden", className)}
15:     {...props}
16:   >
17:     <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
18:       {children}
19:     </ScrollAreaPrimitive.Viewport>
20:     <ScrollBar />
21:     <ScrollAreaPrimitive.Corner />
22:   </ScrollAreaPrimitive.Root>
23: ))
24: ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName
25: 
26: const ScrollBar = React.forwardRef<
27:   React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
28:   React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
29: >(({ className, orientation = "vertical", ...props }, ref) => (
30:   <ScrollAreaPrimitive.ScrollAreaScrollbar
31:     ref={ref}
32:     orientation={orientation}
33:     className={cn(
34:       "flex touch-none select-none transition-colors",
35:       orientation === "vertical" &&
36:         "h-full w-2.5 border-l border-l-transparent p-[1px]",
37:       orientation === "horizontal" &&
38:         "h-2.5 flex-col border-t border-t-transparent p-[1px]",
39:       className
40:     )}
41:     {...props}
42:   >
43:     <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
44:   </ScrollAreaPrimitive.ScrollAreaScrollbar>
45: ))
46: ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName
47: 
48: export { ScrollArea, ScrollBar }
```

## File: packages/ui/src/components/select.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as SelectPrimitive from "@radix-ui/react-select"
  5: import { Check, ChevronDown, ChevronUp } from "lucide-react"
  6: 
  7: import { cn } from "@/lib/utils"
  8: 
  9: const Select = SelectPrimitive.Root
 10: 
 11: const SelectGroup = SelectPrimitive.Group
 12: 
 13: const SelectValue = SelectPrimitive.Value
 14: 
 15: const SelectTrigger = React.forwardRef<
 16:   React.ElementRef<typeof SelectPrimitive.Trigger>,
 17:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
 18: >(({ className, children, ...props }, ref) => (
 19:   <SelectPrimitive.Trigger
 20:     ref={ref}
 21:     className={cn(
 22:       "flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
 23:       className
 24:     )}
 25:     {...props}
 26:   >
 27:     {children}
 28:     <SelectPrimitive.Icon asChild>
 29:       <ChevronDown className="h-4 w-4 opacity-50" />
 30:     </SelectPrimitive.Icon>
 31:   </SelectPrimitive.Trigger>
 32: ))
 33: SelectTrigger.displayName = SelectPrimitive.Trigger.displayName
 34: 
 35: const SelectScrollUpButton = React.forwardRef<
 36:   React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
 37:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
 38: >(({ className, ...props }, ref) => (
 39:   <SelectPrimitive.ScrollUpButton
 40:     ref={ref}
 41:     className={cn(
 42:       "flex cursor-default items-center justify-center py-1",
 43:       className
 44:     )}
 45:     {...props}
 46:   >
 47:     <ChevronUp className="h-4 w-4" />
 48:   </SelectPrimitive.ScrollUpButton>
 49: ))
 50: SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName
 51: 
 52: const SelectScrollDownButton = React.forwardRef<
 53:   React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
 54:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
 55: >(({ className, ...props }, ref) => (
 56:   <SelectPrimitive.ScrollDownButton
 57:     ref={ref}
 58:     className={cn(
 59:       "flex cursor-default items-center justify-center py-1",
 60:       className
 61:     )}
 62:     {...props}
 63:   >
 64:     <ChevronDown className="h-4 w-4" />
 65:   </SelectPrimitive.ScrollDownButton>
 66: ))
 67: SelectScrollDownButton.displayName =
 68:   SelectPrimitive.ScrollDownButton.displayName
 69: 
 70: const SelectContent = React.forwardRef<
 71:   React.ElementRef<typeof SelectPrimitive.Content>,
 72:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
 73: >(({ className, children, position = "popper", ...props }, ref) => (
 74:   <SelectPrimitive.Portal>
 75:     <SelectPrimitive.Content
 76:       ref={ref}
 77:       className={cn(
 78:         "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
 79:         position === "popper" &&
 80:           "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
 81:         className
 82:       )}
 83:       position={position}
 84:       {...props}
 85:     >
 86:       <SelectScrollUpButton />
 87:       <SelectPrimitive.Viewport
 88:         className={cn(
 89:           "p-1",
 90:           position === "popper" &&
 91:             "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
 92:         )}
 93:       >
 94:         {children}
 95:       </SelectPrimitive.Viewport>
 96:       <SelectScrollDownButton />
 97:     </SelectPrimitive.Content>
 98:   </SelectPrimitive.Portal>
 99: ))
100: SelectContent.displayName = SelectPrimitive.Content.displayName
101: 
102: const SelectLabel = React.forwardRef<
103:   React.ElementRef<typeof SelectPrimitive.Label>,
104:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
105: >(({ className, ...props }, ref) => (
106:   <SelectPrimitive.Label
107:     ref={ref}
108:     className={cn("px-2 py-1.5 text-sm font-semibold", className)}
109:     {...props}
110:   />
111: ))
112: SelectLabel.displayName = SelectPrimitive.Label.displayName
113: 
114: const SelectItem = React.forwardRef<
115:   React.ElementRef<typeof SelectPrimitive.Item>,
116:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
117: >(({ className, children, ...props }, ref) => (
118:   <SelectPrimitive.Item
119:     ref={ref}
120:     className={cn(
121:       "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
122:       className
123:     )}
124:     {...props}
125:   >
126:     <span className="absolute right-2 flex h-3.5 w-3.5 items-center justify-center">
127:       <SelectPrimitive.ItemIndicator>
128:         <Check className="h-4 w-4" />
129:       </SelectPrimitive.ItemIndicator>
130:     </span>
131:     <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
132:   </SelectPrimitive.Item>
133: ))
134: SelectItem.displayName = SelectPrimitive.Item.displayName
135: 
136: const SelectSeparator = React.forwardRef<
137:   React.ElementRef<typeof SelectPrimitive.Separator>,
138:   React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
139: >(({ className, ...props }, ref) => (
140:   <SelectPrimitive.Separator
141:     ref={ref}
142:     className={cn("-mx-1 my-1 h-px bg-muted", className)}
143:     {...props}
144:   />
145: ))
146: SelectSeparator.displayName = SelectPrimitive.Separator.displayName
147: 
148: export {
149:   Select,
150:   SelectGroup,
151:   SelectValue,
152:   SelectTrigger,
153:   SelectContent,
154:   SelectLabel,
155:   SelectItem,
156:   SelectSeparator,
157:   SelectScrollUpButton,
158:   SelectScrollDownButton,
159: }
```

## File: packages/ui/src/components/separator.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as SeparatorPrimitive from "@radix-ui/react-separator"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Separator = React.forwardRef<
 9:   React.ElementRef<typeof SeparatorPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
11: >(
12:   (
13:     { className, orientation = "horizontal", decorative = true, ...props },
14:     ref
15:   ) => (
16:     <SeparatorPrimitive.Root
17:       ref={ref}
18:       decorative={decorative}
19:       orientation={orientation}
20:       className={cn(
21:         "shrink-0 bg-border",
22:         orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
23:         className
24:       )}
25:       {...props}
26:     />
27:   )
28: )
29: Separator.displayName = SeparatorPrimitive.Root.displayName
30: 
31: export { Separator }
```

## File: packages/ui/src/components/sheet.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as SheetPrimitive from "@radix-ui/react-dialog"
  5: import { cva, type VariantProps } from "class-variance-authority"
  6: import { X } from "lucide-react"
  7: 
  8: import { cn } from "@/lib/utils"
  9: 
 10: const Sheet = SheetPrimitive.Root
 11: 
 12: const SheetTrigger = SheetPrimitive.Trigger
 13: 
 14: const SheetClose = SheetPrimitive.Close
 15: 
 16: const SheetPortal = SheetPrimitive.Portal
 17: 
 18: const SheetOverlay = React.forwardRef<
 19:   React.ElementRef<typeof SheetPrimitive.Overlay>,
 20:   React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
 21: >(({ className, ...props }, ref) => (
 22:   <SheetPrimitive.Overlay
 23:     className={cn(
 24:       "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
 25:       className
 26:     )}
 27:     {...props}
 28:     ref={ref}
 29:   />
 30: ))
 31: SheetOverlay.displayName = SheetPrimitive.Overlay.displayName
 32: 
 33: const sheetVariants = cva(
 34:   "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",
 35:   {
 36:     variants: {
 37:       side: {
 38:         top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
 39:         bottom:
 40:           "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
 41:         left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
 42:         right:
 43:           "inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
 44:       },
 45:     },
 46:     defaultVariants: {
 47:       side: "right",
 48:     },
 49:   }
 50: )
 51: 
 52: interface SheetContentProps
 53:   extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
 54:     VariantProps<typeof sheetVariants> {}
 55: 
 56: const SheetContent = React.forwardRef<
 57:   React.ElementRef<typeof SheetPrimitive.Content>,
 58:   SheetContentProps
 59: >(({ side = "right", className, children, ...props }, ref) => (
 60:   <SheetPortal>
 61:     <SheetOverlay />
 62:     <SheetPrimitive.Content
 63:       ref={ref}
 64:       className={cn(sheetVariants({ side }), className)}
 65:       {...props}
 66:     >
 67:       <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
 68:         <X className="h-4 w-4" />
 69:         <span className="sr-only">Close</span>
 70:       </SheetPrimitive.Close>
 71:       {children}
 72:     </SheetPrimitive.Content>
 73:   </SheetPortal>
 74: ))
 75: SheetContent.displayName = SheetPrimitive.Content.displayName
 76: 
 77: const SheetHeader = ({
 78:   className,
 79:   ...props
 80: }: React.HTMLAttributes<HTMLDivElement>) => (
 81:   <div
 82:     className={cn(
 83:       "flex flex-col space-y-2 text-center sm:text-left",
 84:       className
 85:     )}
 86:     {...props}
 87:   />
 88: )
 89: SheetHeader.displayName = "SheetHeader"
 90: 
 91: const SheetFooter = ({
 92:   className,
 93:   ...props
 94: }: React.HTMLAttributes<HTMLDivElement>) => (
 95:   <div
 96:     className={cn(
 97:       "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
 98:       className
 99:     )}
100:     {...props}
101:   />
102: )
103: SheetFooter.displayName = "SheetFooter"
104: 
105: const SheetTitle = React.forwardRef<
106:   React.ElementRef<typeof SheetPrimitive.Title>,
107:   React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
108: >(({ className, ...props }, ref) => (
109:   <SheetPrimitive.Title
110:     ref={ref}
111:     className={cn("text-lg font-semibold text-foreground", className)}
112:     {...props}
113:   />
114: ))
115: SheetTitle.displayName = SheetPrimitive.Title.displayName
116: 
117: const SheetDescription = React.forwardRef<
118:   React.ElementRef<typeof SheetPrimitive.Description>,
119:   React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
120: >(({ className, ...props }, ref) => (
121:   <SheetPrimitive.Description
122:     ref={ref}
123:     className={cn("text-sm text-muted-foreground", className)}
124:     {...props}
125:   />
126: ))
127: SheetDescription.displayName = SheetPrimitive.Description.displayName
128: 
129: export {
130:   Sheet,
131:   SheetPortal,
132:   SheetOverlay,
133:   SheetTrigger,
134:   SheetClose,
135:   SheetContent,
136:   SheetHeader,
137:   SheetFooter,
138:   SheetTitle,
139:   SheetDescription,
140: }
```

## File: packages/ui/src/components/skeleton.tsx
```typescript
 1: import { cn } from "@/lib/utils"
 2: 
 3: function Skeleton({
 4:   className,
 5:   ...props
 6: }: React.HTMLAttributes<HTMLDivElement>) {
 7:   return (
 8:     <div
 9:       className={cn("animate-pulse rounded-md bg-primary/10", className)}
10:       {...props}
11:     />
12:   )
13: }
14: 
15: export { Skeleton }
```

## File: packages/ui/src/components/slider.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react";
 5: import * as SliderPrimitive from "@radix-ui/react-slider";
 6: 
 7: import { cn } from "@/lib/utils";
 8: 
 9: interface SliderProps extends ComponentPropsWithoutRef<typeof SliderPrimitive.Root> {
10:   "aria-label"?: string;
11: }
12: 
13: const Slider = React.forwardRef<ElementRef<typeof SliderPrimitive.Root>, SliderProps>(
14:   ({ className, "aria-label": ariaLabel = "Volume", ...props }, ref) => (
15:     <SliderPrimitive.Root
16:       ref={ref}
17:       className={cn(
18:         "relative flex w-full touch-none select-none items-center",
19:         className
20:       )}
21:       {...props}
22:     >
23:       <SliderPrimitive.Track className="relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20">
24:         <SliderPrimitive.Range className="absolute h-full bg-primary" />
25:       </SliderPrimitive.Track>
26:       <SliderPrimitive.Thumb
27:         className="block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"
28:         aria-label={ariaLabel}
29:       />
30:     </SliderPrimitive.Root>
31:   )
32: );
33: 
34: Slider.displayName = "Slider";
35: 
36: export { Slider };
```

## File: packages/ui/src/components/sonner.tsx
```typescript
 1: "use client";
 2: 
 3: import { useTheme } from "next-themes";
 4: import { Toaster as Sonner, type ToasterProps as SonnerProps } from "sonner";
 5: 
 6: interface ToasterProps extends Omit<SonnerProps, "theme"> {
 7:   theme?: SonnerProps["theme"] | undefined;
 8: }
 9: 
10: const Toaster = ({ theme: propTheme, ...props }: ToasterProps) => {
11:   const { theme = "system" } = useTheme();
12: 
13:   return (
14:     <Sonner
15:       theme={(propTheme ?? theme) as SonnerProps["theme"]}
16:       className="toaster group"
17:       toastOptions={{
18:         classNames: {
19:           toast:
20:             "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
21:           description: "group-[.toast]:text-muted-foreground",
22:           actionButton:
23:             "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
24:           cancelButton:
25:             "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
26:         },
27:       }}
28:       {...props}
29:     />
30:   );
31: };
32: 
33: Toaster.displayName = "Toaster";
34: 
35: export { Toaster };
36: export type { ToasterProps };
```

## File: packages/ui/src/components/switch.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react";
 5: import * as SwitchPrimitives from "@radix-ui/react-switch";
 6: 
 7: import { cn } from "@/lib/utils";
 8: 
 9: interface SwitchProps extends ComponentPropsWithoutRef<typeof SwitchPrimitives.Root> {
10:   className?: string;
11: }
12: 
13: const Switch = React.forwardRef<ElementRef<typeof SwitchPrimitives.Root>, SwitchProps>(
14:   ({ className, ...props }, ref) => (
15:     <SwitchPrimitives.Root
16:       className={cn(
17:         "peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
18:         className
19:       )}
20:       {...props}
21:       ref={ref}
22:     >
23:       <SwitchPrimitives.Thumb
24:         className={cn(
25:           "pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0"
26:         )}
27:         aria-hidden="true"
28:       />
29:     </SwitchPrimitives.Root>
30:   )
31: );
32: 
33: Switch.displayName = "Switch";
34: 
35: export { Switch };
```

## File: packages/ui/src/components/table.tsx
```typescript
  1: import * as React from "react"
  2: 
  3: import { cn } from "@/lib/utils"
  4: 
  5: const Table = React.forwardRef<
  6:   HTMLTableElement,
  7:   React.HTMLAttributes<HTMLTableElement>
  8: >(({ className, ...props }, ref) => (
  9:   <div className="relative w-full overflow-auto">
 10:     <table
 11:       ref={ref}
 12:       className={cn("w-full caption-bottom text-sm", className)}
 13:       {...props}
 14:     />
 15:   </div>
 16: ))
 17: Table.displayName = "Table"
 18: 
 19: const TableHeader = React.forwardRef<
 20:   HTMLTableSectionElement,
 21:   React.HTMLAttributes<HTMLTableSectionElement>
 22: >(({ className, ...props }, ref) => (
 23:   <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
 24: ))
 25: TableHeader.displayName = "TableHeader"
 26: 
 27: const TableBody = React.forwardRef<
 28:   HTMLTableSectionElement,
 29:   React.HTMLAttributes<HTMLTableSectionElement>
 30: >(({ className, ...props }, ref) => (
 31:   <tbody
 32:     ref={ref}
 33:     className={cn("[&_tr:last-child]:border-0", className)}
 34:     {...props}
 35:   />
 36: ))
 37: TableBody.displayName = "TableBody"
 38: 
 39: const TableFooter = React.forwardRef<
 40:   HTMLTableSectionElement,
 41:   React.HTMLAttributes<HTMLTableSectionElement>
 42: >(({ className, ...props }, ref) => (
 43:   <tfoot
 44:     ref={ref}
 45:     className={cn(
 46:       "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
 47:       className
 48:     )}
 49:     {...props}
 50:   />
 51: ))
 52: TableFooter.displayName = "TableFooter"
 53: 
 54: const TableRow = React.forwardRef<
 55:   HTMLTableRowElement,
 56:   React.HTMLAttributes<HTMLTableRowElement>
 57: >(({ className, ...props }, ref) => (
 58:   <tr
 59:     ref={ref}
 60:     className={cn(
 61:       "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
 62:       className
 63:     )}
 64:     {...props}
 65:   />
 66: ))
 67: TableRow.displayName = "TableRow"
 68: 
 69: const TableHead = React.forwardRef<
 70:   HTMLTableCellElement,
 71:   React.ThHTMLAttributes<HTMLTableCellElement>
 72: >(({ className, ...props }, ref) => (
 73:   <th
 74:     ref={ref}
 75:     className={cn(
 76:       "h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
 77:       className
 78:     )}
 79:     {...props}
 80:   />
 81: ))
 82: TableHead.displayName = "TableHead"
 83: 
 84: const TableCell = React.forwardRef<
 85:   HTMLTableCellElement,
 86:   React.TdHTMLAttributes<HTMLTableCellElement>
 87: >(({ className, ...props }, ref) => (
 88:   <td
 89:     ref={ref}
 90:     className={cn(
 91:       "p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
 92:       className
 93:     )}
 94:     {...props}
 95:   />
 96: ))
 97: TableCell.displayName = "TableCell"
 98: 
 99: const TableCaption = React.forwardRef<
100:   HTMLTableCaptionElement,
101:   React.HTMLAttributes<HTMLTableCaptionElement>
102: >(({ className, ...props }, ref) => (
103:   <caption
104:     ref={ref}
105:     className={cn("mt-4 text-sm text-muted-foreground", className)}
106:     {...props}
107:   />
108: ))
109: TableCaption.displayName = "TableCaption"
110: 
111: export {
112:   Table,
113:   TableHeader,
114:   TableBody,
115:   TableFooter,
116:   TableHead,
117:   TableRow,
118:   TableCell,
119:   TableCaption,
120: }
```

## File: packages/ui/src/components/tabs.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react";
 5: import * as TabsPrimitive from "@radix-ui/react-tabs";
 6: 
 7: import { cn } from "@/lib/utils";
 8: 
 9: const Tabs = TabsPrimitive.Root;
10: 
11: interface TabsListProps extends ComponentPropsWithoutRef<typeof TabsPrimitive.List> {
12:   className?: string;
13: }
14: 
15: const TabsList = React.forwardRef<ElementRef<typeof TabsPrimitive.List>, TabsListProps>(
16:   ({ className, ...props }, ref) => (
17:     <TabsPrimitive.List
18:       ref={ref}
19:       className={cn(
20:         "inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",
21:         className
22:       )}
23:       {...props}
24:     />
25:   )
26: );
27: 
28: TabsList.displayName = TabsPrimitive.List.displayName;
29: 
30: interface TabsTriggerProps extends ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger> {
31:   className?: string;
32:   value: string;
33: }
34: 
35: const TabsTrigger = React.forwardRef<ElementRef<typeof TabsPrimitive.Trigger>, TabsTriggerProps>(
36:   ({ className, ...props }, ref) => (
37:     <TabsPrimitive.Trigger
38:       ref={ref}
39:       className={cn(
40:         "inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",
41:         className
42:       )}
43:       {...props}
44:     />
45:   )
46: );
47: 
48: TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;
49: 
50: interface TabsContentProps extends ComponentPropsWithoutRef<typeof TabsPrimitive.Content> {
51:   className?: string;
52:   value: string;
53: }
54: 
55: const TabsContent = React.forwardRef<ElementRef<typeof TabsPrimitive.Content>, TabsContentProps>(
56:   ({ className, ...props }, ref) => (
57:     <TabsPrimitive.Content
58:       ref={ref}
59:       className={cn(
60:         "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
61:         className
62:       )}
63:       {...props}
64:     />
65:   )
66: );
67: 
68: TabsContent.displayName = TabsPrimitive.Content.displayName;
69: 
70: export { Tabs, TabsList, TabsTrigger, TabsContent };
```

## File: packages/ui/src/components/textarea.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: 
 5: import { cn } from "@/lib/utils"
 6: 
 7: export interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {
 8:   className?: string;
 9: }
10: 
11: const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
12:   ({ className, ...props }, ref) => {
13:     return (
14:       <textarea
15:         className={cn(
16:           "flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
17:           className
18:         )}
19:         ref={ref}
20:         {...props}
21:       />
22:     )
23:   }
24: )
25: Textarea.displayName = "Textarea"
26: 
27: export { Textarea }
```

## File: packages/ui/src/components/toast.tsx
```typescript
  1: "use client";
  2: 
  3: import * as React from "react";
  4: import type { ComponentPropsWithoutRef, ElementRef, ReactElement } from "react";
  5: import * as ToastPrimitives from "@radix-ui/react-toast";
  6: import { cva, type VariantProps } from "class-variance-authority";
  7: import { X } from "lucide-react";
  8: 
  9: import { cn } from "@/lib/utils";
 10: 
 11: const ToastProvider = ToastPrimitives.Provider;
 12: 
 13: interface ToastViewportProps extends ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport> {
 14:   className?: string;
 15: }
 16: 
 17: const ToastViewport = React.forwardRef<
 18:   ElementRef<typeof ToastPrimitives.Viewport>,
 19:   ToastViewportProps
 20: >(({ className, ...props }, ref) => (
 21:   <ToastPrimitives.Viewport
 22:     ref={ref}
 23:     className={cn(
 24:       "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
 25:       className
 26:     )}
 27:     {...props}
 28:   />
 29: ));
 30: ToastViewport.displayName = ToastPrimitives.Viewport.displayName;
 31: 
 32: const toastVariants = cva(
 33:   "group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
 34:   {
 35:     variants: {
 36:       variant: {
 37:         default: "border bg-background text-foreground",
 38:         destructive:
 39:           "destructive group border-destructive bg-destructive text-destructive-foreground",
 40:       },
 41:     },
 42:     defaultVariants: {
 43:       variant: "default",
 44:     },
 45:   }
 46: );
 47: 
 48: interface ToastRootProps
 49:   extends ComponentPropsWithoutRef<typeof ToastPrimitives.Root> {
 50:   variant?: VariantProps<typeof toastVariants>["variant"];
 51:   className?: string;
 52: }
 53: 
 54: const Toast = React.forwardRef<
 55:   ElementRef<typeof ToastPrimitives.Root>,
 56:   ToastRootProps
 57: >(({ className, variant, ...props }, ref) => {
 58:   return (
 59:     <ToastPrimitives.Root
 60:       ref={ref}
 61:       className={cn(toastVariants({ variant }), className)}
 62:       {...props}
 63:     />
 64:   );
 65: });
 66: Toast.displayName = ToastPrimitives.Root.displayName;
 67: 
 68: interface ToastActionProps
 69:   extends ComponentPropsWithoutRef<typeof ToastPrimitives.Action> {
 70:   altText: string;
 71:   className?: string;
 72: }
 73: 
 74: const ToastAction = React.forwardRef<
 75:   ElementRef<typeof ToastPrimitives.Action>,
 76:   ToastActionProps
 77: >(({ className, altText, ...props }, ref) => (
 78:   <ToastPrimitives.Action
 79:     ref={ref}
 80:     className={cn(
 81:       "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
 82:       className
 83:     )}
 84:     aria-label={altText}
 85:     {...props}
 86:   />
 87: ));
 88: ToastAction.displayName = ToastPrimitives.Action.displayName;
 89: 
 90: interface ToastCloseProps extends ComponentPropsWithoutRef<typeof ToastPrimitives.Close> {
 91:   className?: string;
 92: }
 93: 
 94: const ToastClose = React.forwardRef<
 95:   ElementRef<typeof ToastPrimitives.Close>,
 96:   ToastCloseProps
 97: >(({ className, ...props }, ref) => (
 98:   <ToastPrimitives.Close
 99:     ref={ref}
100:     className={cn(
101:       "absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
102:       className
103:     )}
104:     toast-close=""
105:     {...props}
106:   >
107:     <X className="h-4 w-4" />
108:   </ToastPrimitives.Close>
109: ));
110: ToastClose.displayName = ToastPrimitives.Close.displayName;
111: 
112: interface ToastTitleProps extends ComponentPropsWithoutRef<typeof ToastPrimitives.Title> {
113:   className?: string;
114: }
115: 
116: const ToastTitle = React.forwardRef<
117:   ElementRef<typeof ToastPrimitives.Title>,
118:   ToastTitleProps
119: >(({ className, ...props }, ref) => (
120:   <ToastPrimitives.Title
121:     ref={ref}
122:     className={cn("text-sm font-semibold [&+div]:text-xs", className)}
123:     {...props}
124:   />
125: ));
126: ToastTitle.displayName = ToastPrimitives.Title.displayName;
127: 
128: interface ToastDescriptionProps extends ComponentPropsWithoutRef<typeof ToastPrimitives.Description> {
129:   className?: string;
130: }
131: 
132: const ToastDescription = React.forwardRef<
133:   ElementRef<typeof ToastPrimitives.Description>,
134:   ToastDescriptionProps
135: >(({ className, ...props }, ref) => (
136:   <ToastPrimitives.Description
137:     ref={ref}
138:     className={cn("text-sm opacity-90", className)}
139:     {...props}
140:   />
141: ));
142: ToastDescription.displayName = ToastPrimitives.Description.displayName;
143: 
144: type ToastProps = ComponentPropsWithoutRef<typeof Toast>;
145: 
146: type ToastActionElement = ReactElement<typeof ToastAction>;
147: 
148: export {
149:   type ToastProps,
150:   type ToastActionElement,
151:   ToastProvider,
152:   ToastViewport,
153:   Toast,
154:   ToastTitle,
155:   ToastDescription,
156:   ToastClose,
157:   ToastAction,
158: };
```

## File: packages/ui/src/components/toaster.tsx
```typescript
 1: "use client"
 2: 
 3: import { Toaster as SonnerToaster } from "sonner"
 4: 
 5: export function Toaster() {
 6:   return (
 7:     <SonnerToaster
 8:       className="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse gap-2 p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"
 9:       toastOptions={{
10:         duration: 3000,
11:         className: "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all",
12:       }}
13:       closeButton
14:     />
15:   )
16: }
```

## File: packages/ui/src/components/toggle-group.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react";
 5: import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group";
 6: import type { ToggleGroupMultipleProps, ToggleGroupSingleProps } from "@radix-ui/react-toggle-group";
 7: import type { VariantProps } from "class-variance-authority";
 8: 
 9: import { cn } from "@/lib/utils";
10: import { toggleVariants } from "@/components/toggle";
11: 
12: type BaseToggleGroupProps = {
13:   className?: string;
14:   variant?: VariantProps<typeof toggleVariants>["variant"];
15:   size?: VariantProps<typeof toggleVariants>["size"];
16: };
17: 
18: type ToggleGroupProps = BaseToggleGroupProps &
19:   (ToggleGroupSingleProps | ToggleGroupMultipleProps);
20: 
21: const ToggleGroup = React.forwardRef<
22:   ElementRef<typeof ToggleGroupPrimitive.Root>,
23:   ToggleGroupProps
24: >(({ className, variant, size, ...props }, ref) => (
25:   <ToggleGroupPrimitive.Root
26:     ref={ref}
27:     className={cn("flex items-center justify-center gap-1", className)}
28:     {...props}
29:   />
30: ));
31: 
32: ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;
33: 
34: interface ToggleGroupItemProps
35:   extends ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> {
36:   className?: string;
37:   variant?: VariantProps<typeof toggleVariants>["variant"];
38:   size?: VariantProps<typeof toggleVariants>["size"];
39: }
40: 
41: const ToggleGroupItem = React.forwardRef<
42:   ElementRef<typeof ToggleGroupPrimitive.Item>,
43:   ToggleGroupItemProps
44: >(({ className, variant, size, ...props }, ref) => (
45:   <ToggleGroupPrimitive.Item
46:     ref={ref}
47:     className={cn(toggleVariants({ variant, size }), className)}
48:     {...props}
49:   />
50: ));
51: 
52: ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;
53: 
54: export {
55:   type ToggleGroupProps,
56:   type ToggleGroupItemProps,
57:   ToggleGroup,
58:   ToggleGroupItem
59: };
```

## File: packages/ui/src/components/toggle.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react"
 5: import * as TogglePrimitive from "@radix-ui/react-toggle"
 6: import { cva, type VariantProps } from "class-variance-authority"
 7: 
 8: import { cn } from "@/lib/utils"
 9: 
10: const toggleVariants = cva(
11:   "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
12:   {
13:     variants: {
14:       variant: {
15:         default: "bg-transparent",
16:         outline:
17:           "border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground",
18:       },
19:       size: {
20:         default: "h-9 px-2 min-w-9",
21:         sm: "h-8 px-1.5 min-w-8",
22:         lg: "h-10 px-2.5 min-w-10",
23:       },
24:     },
25:     defaultVariants: {
26:       variant: "default",
27:       size: "default",
28:     },
29:   }
30: )
31: 
32: interface ToggleProps extends ComponentPropsWithoutRef<typeof TogglePrimitive.Root> {
33:   variant?: VariantProps<typeof toggleVariants>["variant"];
34:   size?: VariantProps<typeof toggleVariants>["size"];
35:   className?: string;
36: }
37: 
38: const Toggle = React.forwardRef<ElementRef<typeof TogglePrimitive.Root>, ToggleProps>(
39:   ({ className, variant, size, ...props }, ref) => (
40:     <TogglePrimitive.Root
41:       ref={ref}
42:       className={cn(toggleVariants({ variant, size }), className)}
43:       {...props}
44:     />
45:   )
46: )
47: 
48: Toggle.displayName = TogglePrimitive.Root.displayName
49: 
50: export {
51:   type ToggleProps,
52:   Toggle,
53:   toggleVariants
54: }
```

## File: packages/ui/src/components/tooltip.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import type { ComponentPropsWithoutRef, ElementRef } from "react"
 5: import * as TooltipPrimitive from "@radix-ui/react-tooltip"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const TooltipProvider = TooltipPrimitive.Provider
10: 
11: const Tooltip = TooltipPrimitive.Root
12: 
13: const TooltipTrigger = TooltipPrimitive.Trigger
14: 
15: interface TooltipContentProps extends ComponentPropsWithoutRef<typeof TooltipPrimitive.Content> {
16:   sideOffset?: number;
17:   className?: string;
18: }
19: 
20: const TooltipContent = React.forwardRef<
21:   ElementRef<typeof TooltipPrimitive.Content>,
22:   TooltipContentProps
23: >(({ className, sideOffset = 4, ...props }, ref) => (
24:   <TooltipPrimitive.Portal>
25:     <TooltipPrimitive.Content
26:       ref={ref}
27:       sideOffset={sideOffset}
28:       className={cn(
29:         "z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
30:         className
31:       )}
32:       {...props}
33:     />
34:   </TooltipPrimitive.Portal>
35: ))
36: TooltipContent.displayName = TooltipPrimitive.Content.displayName
37: 
38: export {
39:   type TooltipContentProps,
40:   Tooltip,
41:   TooltipTrigger,
42:   TooltipContent,
43:   TooltipProvider
44: }
```

## File: packages/ui/src/hooks/use-mobile.ts
```typescript
 1: "use client"
 2: 
 3: import { useEffect, useState } from "react"
 4: 
 5: export function useMobile() {
 6:   const [isMobile, setIsMobile] = useState(false)
 7: 
 8:   useEffect(() => {
 9:     const checkMobile = () => {
10:       setIsMobile(window.innerWidth < 768)
11:     }
12: 
13:     checkMobile()
14:     window.addEventListener("resize", checkMobile)
15: 
16:     return () => window.removeEventListener("resize", checkMobile)
17:   }, [])
18: 
19:   return isMobile
20: }
```

## File: packages/ui/src/hooks/use-toast.ts
```typescript
1: import { toast } from "sonner"
2: 
3: export { toast }
4: 
5: export function useToast() {
6:   return {
7:     toast,
8:   }
9: }
```

## File: packages/ui/src/lib/utils.ts
```typescript
1: import { clsx, type ClassValue } from "clsx"
2: import { twMerge } from "tailwind-merge"
3: 
4: export function cn(...inputs: ClassValue[]) {
5:   return twMerge(clsx(inputs))
6: }
```

## File: packages/ui/src/styles/fonts.ts
```typescript
 1: import { Inter, JetBrains_Mono } from 'next/font/google'
 2: 
 3: export const inter = Inter({
 4:   subsets: ['latin'],
 5:   variable: '--font-sans',
 6: })
 7: 
 8: export const jetbrainsMono = JetBrains_Mono({
 9:   subsets: ['latin'],
10:   variable: '--font-mono',
11: })
```

## File: packages/ui/src/styles/globals.css
```css
 1: @tailwind base;
 2: @tailwind components;
 3: @tailwind utilities;
 4: 
 5: @layer base {
 6:   :root {
 7:     --font-sans: "Inter", system-ui, -apple-system;
 8:     --font-mono: "JetBrains Mono", monospace;
 9: 
10:     --background: 0 0% 100%;
11:     --foreground: 222.2 84% 4.9%;
12: 
13:     --card: 0 0% 100%;
14:     --card-foreground: 222.2 84% 4.9%;
15: 
16:     --popover: 0 0% 100%;
17:     --popover-foreground: 222.2 84% 4.9%;
18: 
19:     --primary: 222.2 47.4% 11.2%;
20:     --primary-foreground: 210 40% 98%;
21: 
22:     --secondary: 210 40% 96.1%;
23:     --secondary-foreground: 222.2 47.4% 11.2%;
24: 
25:     --muted: 210 40% 96.1%;
26:     --muted-foreground: 215.4 16.3% 46.9%;
27: 
28:     --accent: 210 40% 96.1%;
29:     --accent-foreground: 222.2 47.4% 11.2%;
30: 
31:     --destructive: 0 84.2% 60.2%;
32:     --destructive-foreground: 210 40% 98%;
33: 
34:     --border: 214.3 31.8% 91.4%;
35:     --input: 214.3 31.8% 91.4%;
36:     --ring: 222.2 84% 4.9%;
37: 
38:     --radius: 0.5rem;
39:   }
40: 
41:   .dark {
42:     --background: 222.2 84% 4.9%;
43:     --foreground: 210 40% 98%;
44: 
45:     --card: 222.2 84% 4.9%;
46:     --card-foreground: 210 40% 98%;
47: 
48:     --popover: 222.2 84% 4.9%;
49:     --popover-foreground: 210 40% 98%;
50: 
51:     --primary: 210 40% 98%;
52:     --primary-foreground: 222.2 47.4% 11.2%;
53: 
54:     --secondary: 217.2 32.6% 17.5%;
55:     --secondary-foreground: 210 40% 98%;
56: 
57:     --muted: 217.2 32.6% 17.5%;
58:     --muted-foreground: 215 20.2% 65.1%;
59: 
60:     --accent: 217.2 32.6% 17.5%;
61:     --accent-foreground: 210 40% 98%;
62: 
63:     --destructive: 0 62.8% 30.6%;
64:     --destructive-foreground: 210 40% 98%;
65: 
66:     --border: 217.2 32.6% 17.5%;
67:     --input: 217.2 32.6% 17.5%;
68:     --ring: 212.7 26.8% 83.9%;
69:   }
70: 
71:   * {
72:     @apply border-border;
73:   }
74: 
75:   body {
76:     @apply bg-background text-foreground font-sans antialiased;
77:   }
78: 
79:   pre, code {
80:     @apply font-mono;
81:   }
82: }
```

## File: packages/ui/src/button.tsx
```typescript
 1: "use client";
 2: 
 3: import { type ReactNode } from "react";
 4: 
 5: interface ButtonProps {
 6:   children: ReactNode;
 7:   className?: string;
 8:   appName: string;
 9: }
10: 
11: export const Button = ({ children, className, appName }: ButtonProps) => {
12:   return (
13:     <button
14:       className={className}
15:       onClick={() => alert(`Hello from your ${appName} app!`)}
16:     >
17:       {children}
18:     </button>
19:   );
20: };
```

## File: packages/ui/src/card.tsx
```typescript
 1: import { type JSX } from "react";
 2: 
 3: export function Card({
 4:   className,
 5:   title,
 6:   children,
 7:   href,
 8: }: {
 9:   className?: string;
10:   title: string;
11:   children: React.ReactNode;
12:   href: string;
13: }): JSX.Element {
14:   return (
15:     <a
16:       className={className}
17:       href={`${href}?utm_source=create-turbo&utm_medium=basic&utm_campaign=create-turbo"`}
18:       rel="noopener noreferrer"
19:       target="_blank"
20:     >
21:       <h2>
22:         {title} <span>-&gt;</span>
23:       </h2>
24:       <p>{children}</p>
25:     </a>
26:   );
27: }
```

## File: packages/ui/src/code.tsx
```typescript
 1: import { type JSX } from "react";
 2: 
 3: export function Code({
 4:   children,
 5:   className,
 6: }: {
 7:   children: React.ReactNode;
 8:   className?: string;
 9: }): JSX.Element {
10:   return <code className={className}>{children}</code>;
11: }
```

## File: packages/ui/src/index.ts
```typescript
 1: // Components
 2: export * from './components/accordion'
 3: export * from './components/alert'
 4: export * from './components/alert-dialog'
 5: export * from './components/aspect-ratio'
 6: export * from './components/avatar'
 7: export * from './components/badge'
 8: export * from './components/button'
 9: export * from './components/calendar'
10: export * from './components/card'
11: export * from './components/carousel'
12: export * from './components/checkbox'
13: export * from './components/collapsible'
14: export * from './components/command'
15: export * from './components/context-menu'
16: export * from './components/dialog'
17: export * from './components/dropdown-menu'
18: export * from './components/form'
19: export * from './components/hover-card'
20: export * from './components/icons'
21: export * from './components/input'
22: export * from './components/label'
23: export * from './components/menubar'
24: export * from './components/navigation-menu'
25: export * from './components/popover'
26: export * from './components/progress'
27: export * from './components/radio-group'
28: export * from './components/scroll-area'
29: export * from './components/select'
30: export * from './components/separator'
31: export * from './components/sheet'
32: export * from './components/skeleton'
33: export * from './components/slider'
34: export * from './components/switch'
35: export * from './components/table'
36: export * from './components/tabs'
37: export * from './components/textarea'
38: export * from './components/theme-provider'
39: export * from './components/toast'
40: export * from './components/toggle'
41: export * from './components/tooltip'
42: export * from './components/resizable'
43: export * from './components/theme-toggle'
44: export * from './components/loading-spinner'
45: export * from './components/message-input'
46: 
47: // Hooks
48: export * from './hooks/use-toast'
49: export * from './hooks/use-mobile'
50: 
51: // Provider Components
52: export * from './components/toaster'
53: 
54: // Styles
55: export * from './styles/fonts'
56: 
57: // Utils
58: export * from './lib/utils'
59: 
60: // Types
61: export type { ToastProps, ToastActionElement } from './components/toast'
```

## File: packages/ui/turbo/generators/templates/component.hbs
```
1: export const {{ pascalCase name }} = ({ children }: { children: React.ReactNode }) => {
2:   return (
3:     <div>
4:       <h1>{{ pascalCase name }} Component</h1>
5:       {children}
6:     </div>
7:   );
8: };
```

## File: packages/ui/turbo/generators/config.ts
```typescript
 1: import type { PlopTypes } from "@turbo/gen";
 2: 
 3: // Learn more about Turborepo Generators at https://turbo.build/repo/docs/core-concepts/monorepos/code-generation
 4: 
 5: export default function generator(plop: PlopTypes.NodePlopAPI): void {
 6:   // A simple generator to add a new React component to the internal UI library
 7:   plop.setGenerator("react-component", {
 8:     description: "Adds a new react component",
 9:     prompts: [
10:       {
11:         type: "input",
12:         name: "name",
13:         message: "What is the name of the component?",
14:       },
15:     ],
16:     actions: [
17:       {
18:         type: "add",
19:         path: "src/{{kebabCase name}}.tsx",
20:         templateFile: "templates/component.hbs",
21:       },
22:       {
23:         type: "append",
24:         path: "package.json",
25:         pattern: /"exports": {(?<insertion>)/g,
26:         template: '    "./{{kebabCase name}}": "./src/{{kebabCase name}}.tsx",',
27:       },
28:     ],
29:   });
30: }
```

## File: packages/ui/components.json
```json
 1: {
 2:   "$schema": "https://ui.shadcn.com/schema.json",
 3:   "style": "default",
 4:   "rsc": true,
 5:   "tsx": true,
 6:   "tailwind": {
 7:     "config": "tailwind.config.js",
 8:     "css": "src/styles/globals.css",
 9:     "baseColor": "slate",
10:     "cssVariables": true
11:   },
12:   "iconLibrary": "lucide",
13:   "aliases": {
14:     "components": "@danky/ui/components",
15:     "utils": "@danky/ui/lib/utils",
16:     "hooks": "@danky/ui/hooks",
17:     "lib": "@danky/ui/lib",
18:     "ui": "@danky/ui/components"
19:   }
20: }
```

## File: packages/ui/eslint.config.js
```javascript
1: import reactInternalConfig from "@danky/eslint-config/react-internal";
2: 
3: export default [
4:   {
5:     ignores: ["dist", ".turbo", "node_modules"]
6:   },
7:   ...reactInternalConfig
8: ]
```

## File: packages/ui/package.json
```json
 1: {
 2:   "name": "@danky/ui",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "exports": {
10:     ".": "./dist/index.js",
11:     "./styles.css": "./dist/index.css"
12:   },
13:   "scripts": {
14:     "build": "tsup",
15:     "dev": "tsup --watch",
16:     "lint": "eslint .",
17:     "type-check": "tsc --noEmit",
18:     "clean": "rimraf .turbo node_modules dist"
19:   },
20:   "peerDependencies": {
21:     "react": "^19.0.0",
22:     "react-dom": "^19.0.0"
23:   },
24:   "dependencies": {
25:     "@radix-ui/react-accordion": "^1.1.2",
26:     "@radix-ui/react-alert-dialog": "^1.0.5",
27:     "@radix-ui/react-avatar": "^1.0.4",
28:     "@radix-ui/react-checkbox": "^1.0.4",
29:     "@radix-ui/react-context-menu": "^2.1.5",
30:     "@radix-ui/react-dialog": "^1.0.5",
31:     "@radix-ui/react-dropdown-menu": "^2.0.6",
32:     "@radix-ui/react-hover-card": "^1.0.7",
33:     "@radix-ui/react-label": "^2.0.2",
34:     "@radix-ui/react-menubar": "^1.0.4",
35:     "@radix-ui/react-navigation-menu": "^1.1.4",
36:     "@radix-ui/react-popover": "^1.0.7",
37:     "@radix-ui/react-progress": "^1.0.3",
38:     "@radix-ui/react-radio-group": "^1.1.3",
39:     "@radix-ui/react-scroll-area": "^1.0.5",
40:     "@radix-ui/react-select": "^2.0.0",
41:     "@radix-ui/react-separator": "^1.0.3",
42:     "@radix-ui/react-slider": "^1.1.2",
43:     "@radix-ui/react-slot": "^1.0.2",
44:     "@radix-ui/react-switch": "^1.0.3",
45:     "@radix-ui/react-tabs": "^1.0.4",
46:     "@radix-ui/react-toast": "^1.1.5",
47:     "@radix-ui/react-toggle": "^1.0.3",
48:     "@radix-ui/react-toggle-group": "^1.0.4",
49:     "@radix-ui/react-tooltip": "^1.0.7",
50:     "class-variance-authority": "^0.7.0",
51:     "clsx": "^2.1.0",
52:     "cmdk": "^0.2.1",
53:     "lucide-react": "^0.323.0",
54:     "next-themes": "^0.2.1",
55:     "react-day-picker": "^8.10.1",
56:     "react-resizable-panels": "^2.0.9",
57:     "recharts": "^2.12.1",
58:     "sonner": "^1.4.0",
59:     "tailwind-merge": "^2.2.1",
60:     "tailwindcss-animate": "^1.0.7"
61:   },
62:   "devDependencies": {
63:     "@danky/eslint-config": "workspace:*",
64:     "@danky/typescript-config": "workspace:*",
65:     "@types/node": "^20.11.24",
66:     "@types/react": "^19.0.0",
67:     "@types/react-dom": "^19.0.0",
68:     "autoprefixer": "^10.4.17",
69:     "eslint": "^9.17.0",
70:     "postcss": "^8.4.35",
71:     "react": "^19.0.0",
72:     "react-dom": "^19.0.0",
73:     "rimraf": "^5.0.5",
74:     "tailwindcss": "^3.4.1",
75:     "tsup": "^8.0.1",
76:     "typescript": "^5.3.3"
77:   }
78: }
```

## File: packages/ui/README.md
```markdown
  1: # @danky/ui
  2: 
  3: Shared UI components for the Danky AI Chatbot platform, built with shadcn/ui and Tailwind CSS.
  4: 
  5: ## Overview
  6: 
  7: The UI package provides a collection of reusable, accessible, and customizable components that follow our design system. It's built on top of shadcn/ui and uses Tailwind CSS for styling.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13:  components/       # UI components
 14:     ui/          # Base components (shadcn)
 15:     custom/      # Custom components
 16:  hooks/           # Shared hooks
 17:  styles/          # Global styles
 18:     globals.css  # Global CSS
 19:  lib/             # Utilities
 20:     utils.ts     # Helper functions
 21:  types/           # TypeScript types
 22: ```
 23: 
 24: ## Key Features
 25: 
 26: - **Accessibility**: ARIA compliant components
 27: - **Theme Support**: Dark/light mode
 28: - **Type Safety**: Full TypeScript coverage
 29: - **Customization**: Tailwind CSS + CSS variables
 30: - **Documentation**: Component stories
 31: - **Testing**: Unit and integration tests
 32: 
 33: ## Usage
 34: 
 35: ### Installation
 36: 
 37: ```bash
 38: pnpm add @danky/ui
 39: ```
 40: 
 41: ### Basic Usage
 42: 
 43: ```typescript
 44: import { Button } from '@danky/ui'
 45: 
 46: export function MyComponent() {
 47:   return (
 48:     <Button variant="primary">
 49:       Click me
 50:     </Button>
 51:   )
 52: }
 53: ```
 54: 
 55: ### Theme Setup
 56: 
 57: ```typescript
 58: import '@danky/ui/styles/globals.css'
 59: 
 60: export function RootLayout({ children }) {
 61:   return (
 62:     <html lang="en" suppressHydrationWarning>
 63:       <body className="min-h-screen bg-background">
 64:         {children}
 65:       </body>
 66:     </html>
 67:   )
 68: }
 69: ```
 70: 
 71: ## AI Development Notes
 72: 
 73: ### Key Concepts
 74: 
 75: 1. **Component Architecture**
 76:    - Base components from shadcn/ui
 77:    - Custom components extend base
 78:    - Composition over inheritance
 79:    - Props for customization
 80: 
 81: 2. **Styling System**
 82:    - Tailwind CSS classes
 83:    - CSS variables for theming
 84:    - Component variants
 85:    - Responsive design
 86: 
 87: 3. **Type System**
 88:    - Props interfaces
 89:    - Variant types
 90:    - Event handlers
 91:    - Ref forwarding
 92: 
 93: ### Common Patterns
 94: 
 95: #### Component Structure
 96: ```typescript
 97: import * as React from 'react'
 98: import { cn } from '../lib/utils'
 99: 
100: interface Props extends React.ComponentPropsWithoutRef<'div'> {
101:   variant?: 'default' | 'primary'
102: }
103: 
104: export const Component = React.forwardRef<HTMLDivElement, Props>(
105:   ({ className, variant = 'default', ...props }, ref) => {
106:     return (
107:       <div
108:         ref={ref}
109:         className={cn(
110:           'base-styles',
111:           variant === 'primary' && 'primary-styles',
112:           className
113:         )}
114:         {...props}
115:       />
116:     )
117:   }
118: )
119: Component.displayName = 'Component'
120: ```
121: 
122: #### Hook Pattern
123: ```typescript
124: import { useState, useCallback } from 'react'
125: 
126: export function useComponent() {
127:   const [state, setState] = useState(false)
128: 
129:   const toggle = useCallback(() => {
130:     setState(prev => !prev)
131:   }, [])
132: 
133:   return { state, toggle }
134: }
135: ```
136: 
137: #### Theme Variants
138: ```typescript
139: import { cva } from 'class-variance-authority'
140: 
141: export const componentVariants = cva(
142:   'base-styles',
143:   {
144:     variants: {
145:       variant: {
146:         default: 'default-styles',
147:         primary: 'primary-styles',
148:       },
149:       size: {
150:         sm: 'small-styles',
151:         md: 'medium-styles',
152:         lg: 'large-styles',
153:       },
154:     },
155:     defaultVariants: {
156:       variant: 'default',
157:       size: 'md',
158:     },
159:   }
160: )
161: ```
162: 
163: ## Component Library
164: 
165: ### Base Components
166: - Button
167: - Input
168: - Select
169: - Checkbox
170: - Radio
171: - Switch
172: - Textarea
173: - Dialog
174: - Popover
175: - Tooltip
176: - Tabs
177: - Card
178: - Badge
179: 
180: ### Custom Components
181: - MessageInput
182: - LoadingSpinner
183: - ThemeToggle
184: - ErrorBoundary
185: - CodeBlock
186: - IconButton
187: 
188: ## Development
189: 
190: ### Adding New Components
191: 
192: 1. Use shadcn CLI:
193: ```bash
194: pnpm dlx shadcn@latest add [component-name]
195: ```
196: 
197: 2. Create wrapper (if needed):
198: ```typescript
199: // src/components/custom/my-component.tsx
200: import { Button } from '../ui/button'
201: 
202: export function MyComponent() {
203:   return <Button>Custom Button</Button>
204: }
205: ```
206: 
207: ### Testing
208: ```bash
209: pnpm test
210: pnpm test:watch
211: ```
212: 
213: ### Storybook
214: ```bash
215: pnpm storybook
216: pnpm build-storybook
217: ```
218: 
219: ### Linting
220: ```bash
221: pnpm lint
222: pnpm type-check
223: ```
224: 
225: ## Troubleshooting
226: 
227: ### Common Issues
228: 1. **Style Conflicts**: Check Tailwind class order
229: 2. **Type Errors**: Verify prop types
230: 3. **Theme Issues**: Check CSS variables
231: 4. **Build Errors**: Check dependencies
232: 
233: ### Debug Tools
234: - React DevTools
235: - Tailwind CSS Inspector
236: - Chrome DevTools
237: - Storybook
238: 
239: ## Additional Resources
240: 
241: - [Component Documentation](../../docs/COMPONENTS.md)
242: - [Design System Guide](../../docs/DESIGN_SYSTEM.md)
243: - [Theme Customization](../../docs/THEMING.md)
244: - [Accessibility Guide](../../docs/ACCESSIBILITY.md)
```

## File: packages/ui/tailwind.config.js
```javascript
 1: /** @type {import('tailwindcss').Config} */
 2: module.exports = {
 3:   darkMode: ["class"],
 4:   content: ["./src/**/*.{ts,tsx}"],
 5:   prefix: "",
 6:   theme: {
 7:   	container: {
 8:   		center: true,
 9:   		padding: '2rem',
10:   		screens: {
11:   			'2xl': '1400px'
12:   		}
13:   	},
14:   	extend: {
15:   		fontFamily: {
16:   			sans: [
17:   				'var(--font-sans)'
18:   			],
19:   			mono: [
20:   				'var(--font-mono)'
21:   			]
22:   		},
23:   		colors: {
24:   			border: 'hsl(var(--border))',
25:   			input: 'hsl(var(--input))',
26:   			ring: 'hsl(var(--ring))',
27:   			background: 'hsl(var(--background))',
28:   			foreground: 'hsl(var(--foreground))',
29:   			primary: {
30:   				DEFAULT: 'hsl(var(--primary))',
31:   				foreground: 'hsl(var(--primary-foreground))'
32:   			},
33:   			secondary: {
34:   				DEFAULT: 'hsl(var(--secondary))',
35:   				foreground: 'hsl(var(--secondary-foreground))'
36:   			},
37:   			destructive: {
38:   				DEFAULT: 'hsl(var(--destructive))',
39:   				foreground: 'hsl(var(--destructive-foreground))'
40:   			},
41:   			muted: {
42:   				DEFAULT: 'hsl(var(--muted))',
43:   				foreground: 'hsl(var(--muted-foreground))'
44:   			},
45:   			accent: {
46:   				DEFAULT: 'hsl(var(--accent))',
47:   				foreground: 'hsl(var(--accent-foreground))'
48:   			},
49:   			popover: {
50:   				DEFAULT: 'hsl(var(--popover))',
51:   				foreground: 'hsl(var(--popover-foreground))'
52:   			},
53:   			card: {
54:   				DEFAULT: 'hsl(var(--card))',
55:   				foreground: 'hsl(var(--card-foreground))'
56:   			},
57:   			sidebar: {
58:   				DEFAULT: 'hsl(var(--sidebar-background))',
59:   				foreground: 'hsl(var(--sidebar-foreground))',
60:   				primary: 'hsl(var(--sidebar-primary))',
61:   				'primary-foreground': 'hsl(var(--sidebar-primary-foreground))',
62:   				accent: 'hsl(var(--sidebar-accent))',
63:   				'accent-foreground': 'hsl(var(--sidebar-accent-foreground))',
64:   				border: 'hsl(var(--sidebar-border))',
65:   				ring: 'hsl(var(--sidebar-ring))'
66:   			}
67:   		},
68:   		borderRadius: {
69:   			lg: 'var(--radius)',
70:   			md: 'calc(var(--radius) - 2px)',
71:   			sm: 'calc(var(--radius) - 4px)'
72:   		},
73:   		keyframes: {
74:   			'accordion-down': {
75:   				from: {
76:   					height: '0'
77:   				},
78:   				to: {
79:   					height: 'var(--radix-accordion-content-height)'
80:   				}
81:   			},
82:   			'accordion-up': {
83:   				from: {
84:   					height: 'var(--radix-accordion-content-height)'
85:   				},
86:   				to: {
87:   					height: '0'
88:   				}
89:   			}
90:   		},
91:   		animation: {
92:   			'accordion-down': 'accordion-down 0.2s ease-out',
93:   			'accordion-up': 'accordion-up 0.2s ease-out'
94:   		}
95:   	}
96:   },
97:   plugins: [require("tailwindcss-animate")],
98: }
```

## File: packages/ui/tsconfig.json
```json
 1: {
 2:   "extends": "@danky/typescript-config/react-library.json",
 3:   "compilerOptions": {
 4:     "baseUrl": ".",
 5:     "declarationDir": "./dist",
 6:     "paths": {
 7:       "@/*": ["./src/*"]
 8:     },
 9:     "types": ["node", "react", "react-dom"],
10:     "jsx": "react-jsx",
11:     "jsxImportSource": "react",
12:     "moduleResolution": "bundler",
13:     "allowImportingTsExtensions": true,
14:     "resolveJsonModule": true,
15:     "isolatedModules": true,
16:     "noEmit": true,
17:     "strict": true
18:   },
19:   "include": ["src", "tsup.config.ts", "turbo/**/*.ts"],
20:   "exclude": ["node_modules", "dist"]
21: }
```

## File: packages/ui/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup'
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: {
 7:     resolve: true,
 8:   },
 9:   clean: true,
10:   external: [
11:     'react',
12:     'react-dom',
13:     '@radix-ui/*',
14:     'cmdk',
15:     'react-day-picker',
16:     'recharts',
17:     'next-themes',
18:     'sonner',
19:     'lucide-react'
20:   ],
21:   treeshake: true,
22:   sourcemap: true,
23: })
```

## File: .env.example
```
 1: # Database Configuration
 2: POSTGRES_USER=postgres
 3: POSTGRES_PASSWORD=postgres
 4: POSTGRES_DB=danky
 5: DATABASE_URL=postgresql://postgres:postgres@localhost:6432/danky
 6: 
 7: # Redis Configuration
 8: REDIS_HOST=localhost
 9: REDIS_PORT=6379
10: REDIS_PASSWORD=redis
11: REDIS_URL=redis://:redis@localhost:6379
12: 
13: # Qdrant Configuration
14: QDRANT_HOST=localhost
15: QDRANT_PORT=6333
16: QDRANT_GRPC_PORT=6334
17: QDRANT_URL=http://localhost:6333
18: 
19: # PgBouncer Configuration
20: PGBOUNCER_PORT=6432
21: PGBOUNCER_MAX_CLIENT_CONN=1000
22: PGBOUNCER_DEFAULT_POOL_SIZE=20
23: 
24: # API Keys
25: ANTHROPIC_API_KEY=your-anthropic-api-key
26: BRAVE_API_KEY=your-brave-api-key
```

## File: .npmrc
```
 1: auto-install-peers=true
 2: dedupe-peer-dependents=true
 3: enable-pre-post-scripts=true
 4: node-linker=hoisted
 5: public-hoist-pattern[]=*eslint*
 6: public-hoist-pattern[]=*prettier*
 7: shamefully-hoist=false
 8: strict-peer-dependencies=false
 9: use-node-version=20.11.1
10: 
11: # Prevent accidental package.json modifications
12: save-workspace-protocol=false
13: save-prefix=""
14: 
15: # Prevent accidental publishing
16: publish-branch=false
17: 
18: # Prevent installing from non-workspace packages
19: prefer-workspace-packages=true
20: link-workspace-packages=true
21: 
22: # Prevent direct package installations in packages/*
23: shell-emulator=true
24: ignore-workspace-root-check=false
```

## File: ARCHITECTURE.md
```markdown
  1: # Danky AI Chatbot - Architecture Guide
  2: 
  3: ## Project Structure
  4: 
  5: ```
  6: danky/
  7:  apps/
  8:     web/              # Next.js web application
  9:         src/
 10:            app/      # Next.js App Router pages
 11:            components/
 12:               chat/     # Chat-specific components
 13:               mcp/      # MCP (Model Context Protocol) components
 14:               sidebar/  # Navigation and layout components
 15:               theme/    # Theme-related components
 16:            hooks/    # React hooks
 17:            lib/      # Shared utilities
 18:                actions/   # Server actions
 19:                config/    # App configuration
 20:                db/        # Database utilities
 21:                services/  # Service layer
 22:                stores/    # Client-side state
 23:                validations/ # Schema validations
 24:         docs/         # Component and feature documentation
 25:  packages/
 26:     ui/              # Shared UI components (shadcn/ui)
 27:     mcp/             # Model Context Protocol implementation
 28:     db/              # Database schema and utilities
 29:     schema/          # Shared type definitions and validations
 30:     logger/          # Structured logging utilities
 31:     eslint-config/   # Shared ESLint configurations
 32:     typescript-config/ # Shared TypeScript configurations
 33:  docs/                # Project-wide documentation
 34: ```
 35: 
 36: ## Package Responsibilities
 37: 
 38: ### Core Packages
 39: - **@danky/ui**: Reusable UI components built with shadcn/ui
 40: - **@danky/mcp**: Model Context Protocol for AI interactions
 41: - **@danky/db**: Database schema, migrations, and type definitions
 42: - **@danky/schema**: Shared type definitions and Zod schemas
 43: - **@danky/logger**: Structured logging with Pino
 44: 
 45: ### Infrastructure Packages
 46: - **@danky/eslint-config**: Shared ESLint rules
 47: - **@danky/typescript-config**: Base TypeScript configurations
 48: 
 49: ## Key Concepts
 50: 
 51: ### Component Organization
 52: - **Feature-based Structure**: Components are organized by feature (chat, mcp, etc.)
 53: - **Shared vs App-specific**: Common components live in `packages/ui`, app-specific in `apps/web/src/components`
 54: - **Server vs Client**: Server components are default, marked with 'use client' when needed
 55: 
 56: ### State Management
 57: - **Server State**: Handled through Server Components and Server Actions
 58: - **Client State**: Managed with Zustand stores in `lib/stores`
 59: - **Form State**: Uses react-hook-form with zod validation
 60: 
 61: ### Styling
 62: - **Tailwind CSS**: Primary styling solution
 63: - **CSS Variables**: Theme values in `globals.css`
 64: - **shadcn/ui**: Component library with consistent styling
 65: - **CSS Modules**: Used for component-specific styles when needed
 66: 
 67: ### Type Safety
 68: - **TypeScript**: Strict mode enabled
 69: - **Zod**: Runtime type validation
 70: - **Path Aliases**: Configured for clean imports
 71: 
 72: ## Development Guidelines
 73: 
 74: ### Adding New Features
 75: 1. Determine if the feature belongs in `packages/` or `apps/`
 76: 2. Create a new directory under appropriate location
 77: 3. Add documentation in the feature's directory
 78: 4. Update this guide if architecture changes
 79: 
 80: ### Component Guidelines
 81: - Keep components under 200 lines
 82: - Split large components into smaller ones
 83: - Use composition over inheritance
 84: - Document complex components with comments
 85: - Add `.md` files for component documentation
 86: 
 87: ### File Naming Conventions
 88: - React components: `component-name.tsx`
 89: - Utilities: `utility-name.ts`
 90: - Types: `types.ts` in feature directories
 91: - Constants: `constants.ts`
 92: - Hooks: `use-feature-name.ts`
 93: 
 94: ### Import Organization
 95: ```typescript
 96: // External imports
 97: import { useState } from 'react'
 98: import { useQuery } from '@tanstack/react-query'
 99: 
100: // Internal package imports
101: import { Button } from '@danky/ui'
102: import { type Tool } from '@danky/mcp'
103: 
104: // Local imports
105: import { useChat } from '@/hooks/use-chat'
106: import { cn } from '@/lib/utils'
107: ```
108: 
109: ## AI Assistant Guidelines
110: 
111: ### Key Files for Context
112: - `apps/web/src/app/layout.tsx` - Root layout and providers
113: - `apps/web/src/components/chat/types.ts` - Chat-related types
114: - `packages/mcp/src/types.ts` - MCP core types
115: - `apps/web/src/lib/stores/chat-store.ts` - Chat state management
116: 
117: ### Common Operations
118: - Adding UI components: `pnpm ui:add [component-name]`
119: - Linting: `pnpm lint`
120: - Type checking: `pnpm type-check`
121: 
122: ### Feature Locations
123: - Chat functionality: `apps/web/src/components/chat`
124: - MCP tools: `apps/web/src/components/mcp`
125: - UI components: `packages/ui/src/components`
126: - Server actions: `apps/web/src/lib/actions`
127: 
128: ### Configuration Files
129: - ESLint: `apps/web/eslint.config.js`
130: - TypeScript: `apps/web/tsconfig.json`
131: - Tailwind: `apps/web/tailwind.config.js`
132: - Next.js: `apps/web/next.config.js`
133: 
134: ## Best Practices
135: 
136: ### Performance
137: - Use React Suspense boundaries
138: - Implement proper loading states
139: - Optimize images and assets
140: - Use proper caching strategies
141: 
142: ### Accessibility
143: - Follow ARIA best practices
144: - Use semantic HTML
145: - Ensure keyboard navigation
146: - Maintain proper contrast ratios
147: 
148: ### Security
149: - Validate all inputs
150: - Use proper auth checks
151: - Handle errors gracefully
152: - Sanitize user content
153: 
154: ### Testing
155: - Write unit tests for utilities
156: - Add component tests for complex features
157: - Use proper mocking strategies
158: - Test error scenarios
159: 
160: ## Troubleshooting
161: 
162: ### Common Issues
163: 1. **Type Errors**: Check `tsconfig.json` and path aliases
164: 2. **Build Errors**: Verify package versions in `package.json`
165: 3. **Style Issues**: Check Tailwind classes and CSS modules
166: 4. **State Issues**: Verify store implementations
167: 
168: ### Debug Tools
169: - React DevTools
170: - Next.js DevTools
171: - Chrome DevTools
172: - VSCode Debugger
173: 
174: ## Contributing
175: 
176: 1. Follow the file organization
177: 2. Add proper documentation
178: 3. Use conventional commits
179: 4. Update relevant docs
180: 5. Add tests for new features
181: 
182: ## AI Development Guidelines
183: 
184: ### Type Resolution
185: When working with types, check these locations in order:
186: 1. Local `types.ts` in feature directory
187: 2. `@danky/schema` package for shared types
188: 3. `@danky/db` for database types
189: 4. `@danky/mcp` for AI interaction types
190: 
191: ### Component Resolution
192: When adding/modifying components:
193: 1. Check `packages/ui` for existing components
194: 2. Use `pnpm ui:add` for new shadcn/ui components
195: 3. Create in feature directory if specific to one feature
196: 4. Create in `packages/ui` if shared across features
197: 
198: ### Database Operations
199: All database operations should:
200: 1. Use types from `@danky/db`
201: 2. Validate input with `@danky/schema`
202: 3. Include proper error handling
203: 4. Log operations with `@danky/logger`
204: 
205: ### AI Integration Points
206: Key areas for AI functionality:
207: 1. `packages/mcp/src/tools/` - Tool implementations
208: 2. `apps/web/src/components/chat/` - Chat interface
209: 3. `apps/web/src/lib/actions/` - Server actions
210: 4. `packages/schema/src/ai/` - AI-related types
211: 
212: ## Code Organization
213: 
214: ### Feature Structure
215: A typical feature should follow this structure:
216: ```
217: feature/
218:  components/     # UI components
219:     index.ts   # Public exports
220:     types.ts   # Component types
221:  hooks/         # Feature-specific hooks
222:  utils/         # Helper functions
223:  constants.ts   # Feature constants
224:  types.ts       # Feature-wide types
225:  README.md      # Feature documentation
226: ```
227: 
228: ### Component Structure
229: Components should follow this pattern:
230: ```typescript
231: // Type imports
232: import type { ComponentProps } from '@/types'
233: import type { Tool } from '@danky/mcp'
234: 
235: // External imports
236: import { useState } from 'react'
237: 
238: // Internal package imports
239: import { Button } from '@danky/ui'
240: 
241: // Local imports
242: import { useFeature } from '../hooks/use-feature'
243: 
244: // Component definition
245: export function FeatureComponent({ prop }: ComponentProps) {
246:   // Implementation
247: }
248: ```
249: 
250: ## Common Patterns
251: 
252: ### Error Handling
253: ```typescript
254: import { logger } from '@danky/logger'
255: import { DatabaseError } from '@danky/db'
256: 
257: try {
258:   // Operation
259: } catch (error) {
260:   if (error instanceof DatabaseError) {
261:     logger.error({ error }, 'Database operation failed')
262:     // Handle database error
263:   }
264:   // Re-throw unknown errors
265:   throw error
266: }
267: ```
268: 
269: ### Data Validation
270: ```typescript
271: import { userSchema } from '@danky/schema'
272: import { logger } from '@danky/logger'
273: 
274: export async function createUser(data: unknown) {
275:   const parsed = userSchema.parse(data)
276:   logger.info({ userId: parsed.id }, 'Creating user')
277:   // Proceed with validated data
278: }
279: ```
280: 
281: ### State Management
282: ```typescript
283: import { create } from 'zustand'
284: import type { FeatureState } from '@danky/schema'
285: 
286: export const useFeatureStore = create<FeatureState>((set) => ({
287:   // State implementation
288: }))
289: ```
290: 
291: ## AI Assistance Notes
292: 
293: ### Key Type Locations
294: - Database types: `packages/db/src/types.ts`
295: - Schema types: `packages/schema/src/types.ts`
296: - MCP types: `packages/mcp/src/types.ts`
297: - Component types: `packages/ui/src/types.ts`
298: 
299: ### Common Operations
300: - Adding UI components: `pnpm ui:add [component-name]`
301: - Database migrations: `pnpm db:migrate`
302: - Type checking: `pnpm type-check`
303: - Linting: `pnpm lint`
304: 
305: ### Important Context Files
306: - `apps/web/src/app/layout.tsx` - Root layout
307: - `packages/mcp/src/config.ts` - MCP configuration
308: - `packages/db/src/schema.ts` - Database schema
309: - `packages/schema/src/index.ts` - Shared types
```

## File: package.json
```json
 1: {
 2:   "name": "danky",
 3:   "private": true,
 4:   "type": "module",
 5:   "scripts": {
 6:     "build": "turbo build",
 7:     "dev": "turbo dev",
 8:     "lint": "turbo lint",
 9:     "type-check": "turbo type-check",
10:     "clean": "turbo clean",
11:     "format": "prettier --write \"**/*.{ts,tsx,md,json,js,jsx}\"",
12:     "format:check": "prettier --check \"**/*.{ts,tsx,md,json,js,jsx}\"",
13:     "changeset": "changeset",
14:     "version-packages": "changeset version",
15:     "release": "turbo build --filter=docs^... && changeset publish",
16:     "lint:fix": "turbo lint -- --fix",
17:     "prepare": "husky install"
18:   },
19:   "devDependencies": {
20:     "@changesets/cli": "^2.27.1",
21:     "@danky/eslint-config": "workspace:*",
22:     "@danky/typescript-config": "workspace:*",
23:     "@types/node": "^20.11.24",
24:     "@types/react": "^19.0.0",
25:     "@types/react-dom": "^19.0.0",
26:     "eslint": "^9.17.0",
27:     "husky": "^9.0.11",
28:     "lint-staged": "^15.2.2",
29:     "prettier": "^3.2.5",
30:     "prettier-plugin-tailwindcss": "^0.5.11",
31:     "turbo": "^1.12.4"
32:   },
33:   "packageManager": "pnpm@8.15.4",
34:   "engines": {
35:     "node": ">=20.11.1"
36:   },
37:   "dependencies": {
38:     "@radix-ui/react-accordion": "^1.1.2",
39:     "@radix-ui/react-alert-dialog": "^1.0.5",
40:     "@radix-ui/react-avatar": "^1.0.4",
41:     "@radix-ui/react-checkbox": "^1.0.4",
42:     "@radix-ui/react-context-menu": "^2.1.5",
43:     "@radix-ui/react-dialog": "^1.0.5",
44:     "@radix-ui/react-dropdown-menu": "^2.0.6",
45:     "@radix-ui/react-hover-card": "^1.0.7",
46:     "@radix-ui/react-label": "^2.0.2",
47:     "@radix-ui/react-menubar": "^1.0.4",
48:     "@radix-ui/react-navigation-menu": "^1.1.4",
49:     "@radix-ui/react-popover": "^1.0.7",
50:     "@radix-ui/react-progress": "^1.0.3",
51:     "@radix-ui/react-radio-group": "^1.1.3",
52:     "@radix-ui/react-scroll-area": "^1.0.5",
53:     "@radix-ui/react-select": "^2.0.0",
54:     "@radix-ui/react-separator": "^1.0.3",
55:     "@radix-ui/react-slider": "^1.1.2",
56:     "@radix-ui/react-slot": "^1.0.2",
57:     "@radix-ui/react-switch": "^1.0.3",
58:     "@radix-ui/react-tabs": "^1.0.4",
59:     "@radix-ui/react-toast": "^1.1.5",
60:     "@radix-ui/react-toggle": "^1.0.3",
61:     "@radix-ui/react-toggle-group": "^1.0.4",
62:     "@radix-ui/react-tooltip": "^1.0.7",
63:     "react": "^19.0.0",
64:     "react-dom": "^19.0.0"
65:   },
66:   "lint-staged": {
67:     "*.{js,jsx,ts,tsx}": [
68:       "prettier --write",
69:       "eslint --fix"
70:     ],
71:     "*.{json,md}": [
72:       "prettier --write"
73:     ]
74:   }
75: }
```

## File: pnpm-workspace.yaml
```yaml
1: packages:
2:   - "apps/web"
3:   - "apps/bot/mcp"
4:   - "packages/*"
```

## File: README.md
```markdown
  1: # Danky AI Chatbot
  2: 
  3: A modern, extensible AI chatbot platform built with TypeScript, Next.js, and the Model Context Protocol (MCP).
  4: 
  5: ## Overview
  6: 
  7: Danky is a sophisticated AI chatbot platform that leverages the power of various language models (OpenAI, Anthropic, Groq) through a unified interface. It features a modern web interface built with Next.js and shadcn/ui components, while utilizing the Model Context Protocol (MCP) for robust AI model integration.
  8: 
  9: ## Features
 10: 
 11: -  Multi-model support (OpenAI, Anthropic, Groq)
 12: -  Modern UI with shadcn/ui components
 13: -  Real-time chat interactions
 14: -  File system integration
 15: -  Extensible tool system
 16: -  Secure credential management
 17: -  Built-in logging and monitoring
 18: -  Dark/Light mode support
 19: 
 20: ## Tech Stack
 21: 
 22: - **Frontend**: Next.js, React, TypeScript
 23: - **UI Components**: shadcn/ui, Tailwind CSS
 24: - **State Management**: Zustand
 25: - **AI Integration**: Model Context Protocol (MCP)
 26: - **Package Management**: pnpm
 27: - **Development Tools**: ESLint, Prettier, TypeScript
 28: 
 29: ## Project Structure
 30: 
 31: ```
 32: .
 33:  apps/
 34:     web/               # Main web application
 35:     bot/              # MCP bot implementation
 36:     docs/             # Documentation site
 37:  packages/
 38:     ui/               # Shared UI components
 39:     eslint-config/    # Shared ESLint configuration
 40:     typescript-config/ # Shared TypeScript configuration
 41:     types/            # Shared TypeScript types
 42: ```
 43: 
 44: ## Getting Started
 45: 
 46: ### Prerequisites
 47: 
 48: - Node.js 20.11.0 or higher
 49: - pnpm 8.x or higher
 50: - Git
 51: 
 52: ### Installation
 53: 
 54: 1. Clone the repository:
 55:    ```bash
 56:    git clone https://github.com/jmagar/danky.git
 57:    cd danky
 58:    ```
 59: 
 60: 2. Install dependencies:
 61:    ```bash
 62:    pnpm install
 63:    ```
 64: 
 65: 3. Copy the environment template and configure your environment variables:
 66:    ```bash
 67:    cp .env.template .env
 68:    ```
 69: 
 70: 4. Start the development server:
 71:    ```bash
 72:    pnpm dev
 73:    ```
 74: 
 75: ### Environment Variables
 76: 
 77: Required environment variables:
 78: 
 79: - `OPENAI_API_KEY`: OpenAI API key
 80: - `ANTHROPIC_API_KEY`: Anthropic API key
 81: - `GROQ_API_KEY`: Groq API key
 82: 
 83: Optional environment variables:
 84: - `BRAVE_API_KEY`: Brave Search API key
 85: 
 86: ## Development
 87: 
 88: ### Commands
 89: 
 90: - `pnpm dev` - Start development server
 91: - `pnpm build` - Build for production
 92: - `pnpm lint` - Run ESLint
 93: - `pnpm type-check` - Run TypeScript checks
 94: - `pnpm test` - Run tests
 95: 
 96: ### Adding New Components
 97: 
 98: 1. Use the shadcn CLI to add new components:
 99:    ```bash
100:    pnpm dlx shadcn@latest add [component-name]
101:    ```
102: 
103: 2. Create wrapper components for customizations in `packages/ui/src/components/`
104: 
105: ### Code Style
106: 
107: - Follow the TypeScript guidelines in `.cursorrules`
108: - Keep components focused and small
109: - Use Server Components by default
110: - Add 'use client' only when necessary
111: - Follow the monorepo package boundaries
112: 
113: ## Contributing
114: 
115: 1. Fork the repository
116: 2. Create your feature branch (`git checkout -b feature/amazing-feature`)
117: 3. Commit your changes (`git commit -m 'Add some amazing feature'`)
118: 4. Push to the branch (`git push origin feature/amazing-feature`)
119: 5. Open a Pull Request
120: 
121: ## License
122: 
123: This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
124: 
125: ## Acknowledgments
126: 
127: - [Model Context Protocol](https://modelcontextprotocol.io)
128: - [shadcn/ui](https://ui.shadcn.com)
129: - [Next.js](https://nextjs.org)
130: - [Tailwind CSS](https://tailwindcss.com)
```

## File: repomix.config.json
```json
 1: {
 2:   "output": {
 3:     "filePath": "dank-context.md",
 4:     "style": "markdown",
 5:     "headerText": "# Danky AI Chatbot Codebase\nThis is a Next.js monorepo project using TypeScript, Drizzle, and MCP for AI interactions.",
 6:     "removeComments": false,
 7:     "removeEmptyLines": false,
 8:     "showLineNumbers": true,
 9:     "copyToClipboard": false,
10:     "topFilesLength": 10,
11:     "includeEmptyDirectories": true
12:   },
13:   "include": [
14:     "apps/**/*",
15:     "packages/**/*",
16:     "*.json",
17:     "*.md",
18:     ".env.example",
19:     ".npmrc",
20:     "pnpm-workspace.yaml",
21:     "turbo.json"
22:   ],
23:   "ignore": {
24:     "useGitignore": true,
25:     "useDefaultPatterns": true,
26:     "customPatterns": [
27:       "**/node_modules/**",
28:       "**/.next/**",
29:       "**/.turbo/**",
30:       "**/dist/**",
31:       "**/.env",
32:       "**/coverage/**",
33:       "**/test-results/**",
34:       "**/*.log",
35:       "**/.DS_Store"
36:     ]
37:   },
38:   "security": {
39:     "enableSecurityCheck": true
40:   }
41: }
```

## File: turbo.json
```json
 1: {
 2:   "$schema": "https://turbo.build/schema.json",
 3:   "tasks": {
 4:     "build": {
 5:       "dependsOn": [
 6:         "^build"
 7:       ],
 8:       "inputs": [
 9:         "$TURBO_DEFAULT$",
10:         ".env*"
11:       ],
12:       "outputs": [
13:         ".next/**",
14:         "!.next/cache/**",
15:         "dist/**"
16:       ]
17:     },
18:     "lint": {
19:       "dependsOn": [
20:         "^lint"
21:       ]
22:     },
23:     "type-check": {
24:       "dependsOn": [
25:         "^type-check"
26:       ]
27:     },
28:     "dev": {
29:       "cache": false,
30:       "persistent": true
31:     },
32:     "clean": {
33:       "cache": false
34:     }
35:   }
36: }
```

## File: VERSION_REQUIREMENTS.md
```markdown
 1: # Version Requirements
 2: 
 3: This document outlines the version requirements for key dependencies in the project.
 4: 
 5: ## Core Dependencies
 6: 
 7: - React: `^19.0.0` (Current: 19.0.0, can upgrade but never downgrade)
 8: - Next.js: `^15.1.4` (Current: 15.1.4, can upgrade but never downgrade)
 9:   - `@next/eslint-plugin-next`: `^15.1.4`
10:   - `eslint-config-next`: `^15.1.4`
11: - ESLint: `^9.17.0` (Current: 9.17.0, can upgrade but never downgrade)
12: 
13: ## Rationale
14: 
15: - **React 19**: Required for latest features and performance improvements including pre-warming for suspended trees and new React DOM static APIs
16: - **Next.js 15.1**: Required for compatibility with React 19 and latest features including improved performance and stability. All Next.js related packages (including ESLint plugins) must match this version
17: - **ESLint 9**: Required for modern JavaScript/TypeScript linting capabilities
18: 
19: ## Upgrade Policy
20: 
21: These versions are minimum requirements. You can:
22: 
23: -  Upgrade to newer versions
24: -  Never downgrade below these versions
25: 
26: Downgrading will break functionality and compatibility within the project.
```
