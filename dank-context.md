This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2025-01-12T02:44:59.142Z

# File Summary

## Purpose
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
- Pay special attention to the Repository Description. These contain important context and guidelines specific to this project.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

- Line numbers have been added to the beginning of each line.

## Additional Info
### User Provided Header
# Danky AI Chatbot Codebase
This is a Next.js monorepo project using TypeScript, Drizzle, and MCP for AI interactions.

# Directory Structure
```
apps/
  web/
    .vscode/
      settings.json
    app/
      providers.tsx
    docs/
      config-standarization.md
      ESLINT.md
    lib/
      ai/
        providers/
          anthropic.ts
      socket/
        client.ts
        server.ts
    public/
      file-text.svg
      globe.svg
      next.svg
      turborepo-dark.svg
      turborepo-light.svg
      vercel.svg
      window.svg
    src/
      app/
        api/
          actions/
            chat/
              batch-operations.ts
              create-message.ts
              create-session.ts
              delete-session.ts
              index.ts
              list-messages.ts
              list-sessions.ts
              types.ts
              update-session.ts
            chat.ts
            mcp.ts
          chat/
            sessions/
              [sessionId]/
                messages/
                  route.ts
              route.ts
            route.ts
          routes/
            chat.ts
        chat/
          page.tsx
        error.tsx
        globals.css
        layout.tsx
        not-found.tsx
        page.module.css
        page.tsx
        providers.tsx
      components/
        chat/
          attachment-button.tsx
          chat-input.tsx
          chat-layout.tsx
          chat-messages.tsx
          message-content.tsx
          message.tsx
          notifications-popover.tsx
          README.md
          search.tsx
          session-list.tsx
          sidebar.tsx
          tools-dropdown.tsx
          types.ts
          user-nav.tsx
          utils.ts
        mcp/
          servers/
            server-card.tsx
            server-list.tsx
          tools/
            tool-card.tsx
            tool-list.tsx
          index.ts
          mcp-panel.tsx
          README.md
          tools-button.tsx
        sidebar/
          index.tsx
          sidebar-content.tsx
          sidebar-context.tsx
          sidebar-group.tsx
          sidebar-item.tsx
          sidebar-layout.tsx
          sidebar-menu-extras.tsx
          sidebar-menu-sub.tsx
          sidebar-menu.tsx
          sidebar-search.tsx
          sidebar-section.tsx
          sidebar-sections.tsx
          sidebar-toggle.tsx
          sidebar-trigger.tsx
          sidebar-types.ts
          sidebar.tsx
        theme/
          theme-provider.tsx
          theme-toggle.tsx
        providers.tsx
      hooks/
        use-mobile.tsx
        use-toast.ts
      lib/
        actions/
          mcp-actions.ts
        config/
        db/
          chat/
            batch-sessions.ts
            batch.ts
          chat.ts
          transaction.ts
        services/
          init-chat-model.ts
          load-config.ts
        stores/
          chat-store.ts
          mcp-store.ts
        validations/
          chat.ts
        errors.ts
        session.ts
        utils.ts
      types/
        env.d.ts
        websocket.d.ts
        ws.d.ts
    .gitignore
    components.json
    env.ts
    mcp-server-guide.md
    next.config.js
    package.json
    postcss.config.js
    README.md
    tailwind.config.js
    tsconfig.json
    types.d.ts
packages/
  build-config/
    src/
      base.ts
      index.ts
      node-library.ts
      react-library.ts
    package.json
    tsconfig.json
  db/
    drizzle/
      meta/
        _journal.json
        0000_snapshot.json
      0000_noisy_phil_sheldon.sql
      0001_chat_schema_improvements.sql
    src/
      migrations/
        0000_initial.ts
        0001_vector_schema.ts
      schema/
        attachments.ts
        auth.ts
        cache.ts
        chat.ts
        index.ts
        sessions.ts
        users.ts
        vector.ts
        vectors.ts
      client.ts
      env.ts
      index.ts
      migrate.ts
      seed.ts
    drizzle.config.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
    tsup.config.bundled_tcbbkimm6si.mjs
    tsup.config.bundled_txmawbqz3cg.mjs
    tsup.config.ts
  eslint-config/
    base.js
    index.js
    next.js
    package.json
    react-internal.js
    README.md
  logger/
    src/
      env.ts
      index.ts
      logger.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
    tsup.config.ts
  mcp/
    src/
      servers/
      index.ts
      init-chat-model.ts
      load-config.ts
      logger.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
  next-config/
    src/
      base.ts
      index.ts
    package.json
    tsconfig.json
  qdrant/
    src/
      client.ts
      env.ts
      index.ts
    eslint.config.js
    package.json
    tsconfig.json
    tsup.config.ts
  redis/
    src/
      client.ts
      env.ts
      index.ts
    eslint.config.js
    package.json
    tsconfig.json
    tsup.config.ts
  schema/
    src/
      chat-batch.ts
      chat-session.ts
      chat.ts
      index.ts
      metadata.ts
      test-eslint.ts
      types.ts
      vector.ts
    eslint.config.js
    package.json
    README.md
    tsconfig.json
    tsup.config.ts
  tailwind-config/
    src/
      applications.ts
      base.ts
      components.ts
      index.ts
    package.json
    tsconfig.json
  typescript-config/
    base.json
    nextjs.json
    package.json
    react-library.json
  ui/
    @danky/
      ui/
        components/
          accordion.tsx
          alert-dialog.tsx
          alert.tsx
          aspect-ratio.tsx
          avatar.tsx
          badge.tsx
          button.tsx
          calendar.tsx
    packages/
    src/
      components/
        ui/
          accordion.tsx
          alert-dialog.tsx
          alert.tsx
          aspect-ratio.tsx
          avatar.tsx
          badge.tsx
          button.tsx
          calendar.tsx
        accordion.tsx
        alert-dialog.tsx
        alert.tsx
        aspect-ratio.tsx
        avatar.tsx
        badge.tsx
        breadcrumb.tsx
        button.tsx
        calendar.tsx
        card.tsx
        carousel.tsx
        chart.tsx
        checkbox.tsx
        collapsible.tsx
        command.tsx
        context-menu.tsx
        dialog.tsx
        drawer.tsx
        dropdown-menu.tsx
        form.tsx
        hover-card.tsx
        input-otp.tsx
        input.tsx
        label.tsx
        loading-spinner.tsx
        menubar.tsx
        navigation-menu.tsx
        pagination.tsx
        popover.tsx
        progress.tsx
        radio-group.tsx
        resizable.tsx
        scroll-area.tsx
        select.tsx
        separator.tsx
        sheet.tsx
        sidebar.tsx
        skeleton.tsx
        slider.tsx
        sonner.tsx
        switch.tsx
        table.tsx
        tabs.tsx
        textarea.tsx
        toast.tsx
        toaster.tsx
        toggle-group.tsx
        toggle.tsx
        tooltip.tsx
      hooks/
        use-mobile.ts
        use-toast.ts
      lib/
        utils.ts
      styles/
        fonts.ts
        globals.css
      button.tsx
      card.tsx
      code.tsx
      index.ts
      types.ts
    turbo/
      generators/
        templates/
          component.hbs
        config.ts
    components.json
    eslint.config.js
    package.json
    README.md
    tailwind.config.js
    tsconfig.json
    tsup.config.ts
.env.example
.npmrc
ARCHITECTURE.md
package.json
pnpm-workspace.yaml
README.md
repomix.config.json
turbo.json
VERSION_REQUIREMENTS.md
```

# Files

## File: apps/web/.vscode/settings.json
```json
 1: {
 2:   "editor.codeActionsOnSave": {
 3:     "source.fixAll.eslint": true,
 4:     "source.organizeImports": false
 5:   },
 6:   "editor.defaultFormatter": "esbenp.prettier-vscode",
 7:   "editor.formatOnSave": true,
 8:   "editor.rulers": [80, 100],
 9:   "editor.tabSize": 2,
10:   "eslint.enable": true,
11:   "eslint.format.enable": true,
12:   "eslint.validate": [
13:     "javascript",
14:     "javascriptreact",
15:     "typescript",
16:     "typescriptreact"
17:   ],
18:   "files.associations": {
19:     "*.css": "tailwindcss"
20:   },
21:   "files.eol": "\n",
22:   "files.trimTrailingWhitespace": true,
23:   "typescript.preferences.importModuleSpecifier": "non-relative",
24:   "typescript.tsdk": "node_modules/typescript/lib",
25:   "typescript.enablePromptUseWorkspaceTsdk": true,
26:   "[javascript]": {
27:     "editor.defaultFormatter": "esbenp.prettier-vscode"
28:   },
29:   "[typescript]": {
30:     "editor.defaultFormatter": "esbenp.prettier-vscode"
31:   },
32:   "[typescriptreact]": {
33:     "editor.defaultFormatter": "esbenp.prettier-vscode"
34:   },
35:   "tailwindCSS.experimental.classRegex": [
36:     ["cva\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"],
37:     ["cn\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"]
38:   ],
39:   "tailwindCSS.includeLanguages": {
40:     "typescript": "javascript",
41:     "typescriptreact": "javascript"
42:   }
43: }
```

## File: apps/web/app/providers.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ThemeProvider } from 'next-themes'
 4: import { type PropsWithChildren } from 'react'
 5: 
 6: export function Providers({ children }: PropsWithChildren) {
 7:   return (
 8:     <ThemeProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:     >
14:       {children}
15:     </ThemeProvider>
16:   )
17: }
```

## File: apps/web/docs/config-standarization.md
```markdown
  1: # Configuration Standardization Guide
  2: 
  3: This document outlines the standardization of configurations across the Danky monorepo. Each section details a specific configuration type, its purpose, and implementation details.
  4: 
  5: ## Build Configuration (@danky/build-config)
  6: 
  7: ### Purpose
  8: 
  9: Standardize build configurations across all packages using tsup, ensuring consistent output formats, type generation, and external dependency handling.
 10: 
 11: ### Implementation Details
 12: 
 13: 1. **Package Structure**
 14: 
 15:    ```
 16:    packages/build-config/
 17:    ├── package.json
 18:    ├── tsconfig.json
 19:    ├── src/
 20:    │   ├── index.ts
 21:    │   ├── base.ts
 22:    │   ├── react-library.ts
 23:    │   └── node-library.ts
 24:    ```
 25: 
 26: 2. **Base Configuration (`base.ts`)**
 27: 
 28:    ```typescript
 29:    import { Options } from 'tsup';
 30: 
 31:    export interface BaseConfig extends Options {
 32:      entry: string[];
 33:      format: ['esm'];
 34:      dts: true;
 35:      sourcemap: true;
 36:      clean: true;
 37:    }
 38: 
 39:    export const baseConfig: BaseConfig = {
 40:      entry: ['src/index.ts'],
 41:      format: ['esm'],
 42:      dts: true,
 43:      sourcemap: true,
 44:      clean: true,
 45:    };
 46:    ```
 47: 
 48: 3. **React Library Configuration (`react-library.ts`)**
 49: 
 50:    ```typescript
 51:    import { Options } from 'tsup';
 52:    import { baseConfig } from './base';
 53: 
 54:    export const reactLibraryConfig: Options = {
 55:      ...baseConfig,
 56:      external: [
 57:        'react',
 58:        'react-dom',
 59:        '@radix-ui/*',
 60:        'class-variance-authority',
 61:        'clsx',
 62:        'tailwind-merge',
 63:      ],
 64:    };
 65:    ```
 66: 
 67: 4. **Node Library Configuration (`node-library.ts`)**
 68: 
 69:    ```typescript
 70:    import { Options } from 'tsup';
 71:    import { baseConfig } from './base';
 72: 
 73:    export const nodeLibraryConfig: Options = {
 74:      ...baseConfig,
 75:      platform: 'node',
 76:      target: 'node18',
 77:    };
 78:    ```
 79: 
 80: 5. **Usage in Packages**
 81: 
 82:    ```typescript
 83:    // Example tsup.config.ts in a React library package
 84:    import { reactLibraryConfig } from '@danky/build-config/react-library';
 85:    import { defineConfig } from 'tsup';
 86: 
 87:    export default defineConfig({
 88:      ...reactLibraryConfig,
 89:      // Package-specific overrides here
 90:    });
 91:    ```
 92: 
 93: ## Styling Configuration (@danky/tailwind-config)
 94: 
 95: ### Purpose
 96: 
 97: Standardize Tailwind CSS configurations across the UI package and web applications, ensuring consistent theming, animations, and utility classes.
 98: 
 99: ### Implementation Details
100: 
101: 1. **Package Structure**
102: 
103:    ```
104:    packages/tailwind-config/
105:    ├── package.json
106:    ├── src/
107:    │   ├── index.ts
108:    │   ├── base.ts
109:    │   ├── components.ts
110:    │   └── applications.ts
111:    ```
112: 
113: 2. **Base Configuration (`base.ts`)**
114: 
115:    ```typescript
116:    import type { Config } from 'tailwindcss';
117: 
118:    export const baseConfig: Partial<Config> = {
119:      darkMode: ['class'],
120:      content: [],
121:      theme: {
122:        container: {
123:          center: true,
124:          padding: '2rem',
125:          screens: {
126:            '2xl': '1400px',
127:          },
128:        },
129:        extend: {
130:          colors: {
131:            border: 'hsl(var(--border))',
132:            input: 'hsl(var(--input))',
133:            ring: 'hsl(var(--ring))',
134:            background: 'hsl(var(--background))',
135:            foreground: 'hsl(var(--foreground))',
136:            primary: {
137:              DEFAULT: 'hsl(var(--primary))',
138:              foreground: 'hsl(var(--primary-foreground))',
139:            },
140:            // ... other color definitions
141:          },
142:          borderRadius: {
143:            lg: 'var(--radius)',
144:            md: 'calc(var(--radius) - 2px)',
145:            sm: 'calc(var(--radius) - 4px)',
146:          },
147:          keyframes: {
148:            // ... keyframe definitions
149:          },
150:          animation: {
151:            // ... animation definitions
152:          },
153:        },
154:      },
155:    };
156:    ```
157: 
158: 3. **Components Configuration (`components.ts`)**
159: 
160:    ```typescript
161:    import { baseConfig } from './base';
162:    import type { Config } from 'tailwindcss';
163: 
164:    export const componentsConfig: Partial<Config> = {
165:      ...baseConfig,
166:      content: ['./src/**/*.{ts,tsx}'],
167:      plugins: [require('tailwindcss-animate')],
168:    };
169:    ```
170: 
171: 4. **Applications Configuration (`applications.ts`)**
172: 
173:    ```typescript
174:    import { baseConfig } from './base';
175:    import type { Config } from 'tailwindcss';
176: 
177:    export const applicationsConfig: Partial<Config> = {
178:      ...baseConfig,
179:      content: ['./src/**/*.{ts,tsx}', '../../packages/ui/src/**/*.{ts,tsx}'],
180:      plugins: [require('tailwindcss-animate'), require('@tailwindcss/typography')],
181:    };
182:    ```
183: 
184: 5. **Usage in Packages/Apps**
185: 
186:    ```javascript
187:    // Example tailwind.config.js in UI package
188:    import { componentsConfig } from '@danky/tailwind-config/components';
189: 
190:    export default {
191:      ...componentsConfig,
192:      // Package-specific overrides here
193:    };
194:    ```
195: 
196: ## Next.js Configuration (@danky/next-config)
197: 
198: ### Purpose
199: 
200: Standardize Next.js configurations across web applications, ensuring consistent module resolution, transpilation, and optimization settings.
201: 
202: ### Implementation Details
203: 
204: 1. **Package Structure**
205: 
206:    ```
207:    packages/next-config/
208:    ├── package.json
209:    ├── src/
210:    │   ├── index.ts
211:    │   ├── base.ts
212:    │   └── webpack.ts
213:    ```
214: 
215: 2. **Base Configuration (`base.ts`)**
216: 
217:    ```typescript
218:    import type { NextConfig } from 'next';
219:    import { webpackConfig } from './webpack';
220: 
221:    export const baseConfig: NextConfig = {
222:      reactStrictMode: true,
223:      transpilePackages: [
224:        '@danky/ui',
225:        '@danky/logger',
226:        '@danky/db',
227:        '@danky/redis',
228:        '@danky/schema',
229:      ],
230:      experimental: {
231:        serverActions: true,
232:      },
233:      webpack: webpackConfig,
234:    };
235:    ```
236: 
237: 3. **Webpack Configuration (`webpack.ts`)**
238: 
239:    ```typescript
240:    import type { Configuration } from 'webpack';
241: 
242:    export function webpackConfig(config: Configuration) {
243:      // Polyfill node modules
244:      config.resolve.fallback = {
245:        ...config.resolve.fallback,
246:        fs: false,
247:        net: false,
248:        tls: false,
249:        crypto: false,
250:      };
251: 
252:      // Add source maps
253:      config.module.rules.push({
254:        test: /\.js$/,
255:        enforce: 'pre',
256:        use: ['source-map-loader'],
257:      });
258: 
259:      return config;
260:    }
261:    ```
262: 
263: 4. **Usage in Applications**
264: 
265:    ```typescript
266:    // Example next.config.js
267:    import { baseConfig } from '@danky/next-config';
268: 
269:    export default {
270:      ...baseConfig,
271:      // App-specific overrides here
272:    };
273:    ```
274: 
275: ## PostCSS Configuration (@danky/postcss-config)
276: 
277: ### Purpose
278: 
279: Standardize PostCSS configurations across packages and applications, ensuring consistent CSS processing and optimization.
280: 
281: ### Implementation Details
282: 
283: 1. **Package Structure**
284: 
285:    ```
286:    packages/postcss-config/
287:    ├── package.json
288:    ├── src/
289:    │   ├── index.ts
290:    │   ├── base.ts
291:    │   └── tailwind.ts
292:    ```
293: 
294: 2. **Base Configuration (`base.ts`)**
295: 
296:    ```typescript
297:    export const baseConfig = {
298:      plugins: {
299:        'postcss-import': {},
300:        'postcss-preset-env': {
301:          stage: 3,
302:          features: {
303:            'nesting-rules': true,
304:          },
305:        },
306:      },
307:    };
308:    ```
309: 
310: 3. **Tailwind Configuration (`tailwind.ts`)**
311: 
312:    ```typescript
313:    import { baseConfig } from './base';
314: 
315:    export const tailwindConfig = {
316:      ...baseConfig,
317:      plugins: {
318:        ...baseConfig.plugins,
319:        tailwindcss: {},
320:        autoprefixer: {},
321:      },
322:    };
323:    ```
324: 
325: 4. **Usage in Packages/Apps**
326: 
327:    ```javascript
328:    // Example postcss.config.js
329:    import { tailwindConfig } from '@danky/postcss-config/tailwind';
330: 
331:    export default tailwindConfig;
332:    ```
333: 
334: ## Implementation Steps
335: 
336: 1. Create each configuration package with proper `package.json` setup
337: 2. Implement base configurations and specialized variants
338: 3. Update all packages to use the standardized configurations
339: 4. Add documentation for each configuration package
340: 5. Set up proper exports and types
341: 6. Add validation for configuration overrides
342: 7. Implement CI checks for configuration consistency
343: 
344: ## Migration Guide
345: 
346: 1. **For Build Configuration**
347: 
348:    - Replace individual tsup configs with standardized ones
349:    - Update package.json build scripts if needed
350:    - Test builds across all packages
351: 
352: 2. **For Styling Configuration**
353: 
354:    - Move existing theme variables to shared config
355:    - Update content paths in Tailwind configs
356:    - Test styling consistency across components
357: 
358: 3. **For Next.js Configuration**
359: 
360:    - Replace app-specific Next.js configs
361:    - Test webpack configurations
362:    - Verify module resolution and transpilation
363: 
364: 4. **For PostCSS Configuration**
365:    - Replace individual PostCSS configs
366:    - Test CSS processing and optimization
367:    - Verify Tailwind integration
368: 
369: ## Maintenance Guidelines
370: 
371: 1. **Adding New Configurations**
372: 
373:    - Create new configuration variant in appropriate package
374:    - Document usage and options
375:    - Update tests and validation
376: 
377: 2. **Updating Existing Configurations**
378: 
379:    - Follow semantic versioning
380:    - Document breaking changes
381:    - Update all dependent packages
382: 
383: 3. **Configuration Validation**
384:    - Add runtime validation using Zod
385:    - Implement CI checks for config consistency
386:    - Add type checking for configuration overrides
```

## File: apps/web/docs/ESLINT.md
```markdown
 1: # ESLint Configuration
 2: 
 3: This project uses ESLint 9 with the new flat config system for code quality and consistency.
 4: 
 5: ## Setup
 6: 
 7: The ESLint configuration is defined in `eslint.config.js` and uses the following key features:
 8: 
 9: - TypeScript support with strict type checking
10: - React and React Hooks rules
11: - Next.js specific rules
12: - Import organization and sorting
13: - Path alias resolution
14: 
15: ## Key Rules
16: 
17: ### TypeScript
18: - Enforces consistent type imports
19: - Prevents floating promises
20: - Disallows explicit `any`
21: - Warns about unused variables
22: - Enforces proper type inference
23: 
24: ### React
25: - Enforces key prop usage
26: - Prevents undefined JSX elements
27: - Warns about unused prop types
28: - Enforces proper hooks usage
29: 
30: ### Import Organization
31: - Prevents circular dependencies
32: - Enforces import sorting
33: - Groups imports by type
34: - Maintains consistent spacing
35: 
36: ## Scripts
37: 
38: ```bash
39: # Run ESLint
40: pnpm lint
41: 
42: # Fix auto-fixable issues
43: pnpm lint:fix
44: 
45: # Type check
46: pnpm type-check
47: ```
48: 
49: ## VSCode Integration
50: 
51: Install the ESLint extension and use the following workspace settings:
52: 
53: ```json
54: {
55:   "editor.codeActionsOnSave": {
56:     "source.fixAll.eslint": true
57:   },
58:   "editor.defaultFormatter": "esbenp.prettier-vscode",
59:   "editor.formatOnSave": true,
60:   "eslint.enable": true,
61:   "eslint.format.enable": true,
62:   "eslint.validate": [
63:     "javascript",
64:     "javascriptreact",
65:     "typescript",
66:     "typescriptreact"
67:   ]
68: }
69: ```
70: 
71: ## Path Aliases
72: 
73: The configuration supports the following path aliases:
74: - `@/*` - Points to src directory
75: - `@/lib/*` - Points to lib directory
76: - `@/components/*` - Points to components directory
77: - `@/app/*` - Points to app directory
78: - `@/hooks/*` - Points to hooks directory
79: - `@danky/ui` - Points to UI package
80: - `@danky/mcp` - Points to MCP package
```

## File: apps/web/lib/ai/providers/anthropic.ts
```typescript
 1: import Anthropic from '@anthropic-ai/sdk';
 2: import { env } from '@/env';
 3: import { createLogger } from '@danky/logger';
 4: 
 5: const logger = createLogger('anthropic');
 6: 
 7: export const anthropic = new Anthropic({
 8:   apiKey: env.ANTHROPIC_API_KEY,
 9: });
10: 
11: export async function streamCompletion(
12:   messages: Array<{ role: string; content: string }>,
13:   options: {
14:     model?: string;
15:     temperature?: number;
16:     maxTokens?: number;
17:   } = {}
18: ) {
19:   const { model = 'claude-3-opus-20240229', temperature = 0.7, maxTokens = 4096 } = options;
20: 
21:   try {
22:     const response = await anthropic.messages.create({
23:       model,
24:       messages: messages.map(m => ({
25:         role: m.role === 'user' ? 'user' : 'assistant',
26:         content: m.content,
27:       })),
28:       temperature,
29:       max_tokens: maxTokens,
30:       stream: true,
31:     });
32: 
33:     return response;
34:   } catch (error) {
35:     logger.error({ error }, 'Anthropic completion failed');
36:     throw error;
37:   }
38: }
```

## File: apps/web/lib/socket/client.ts
```typescript
 1: import { createLogger } from '@danky/logger';
 2: 
 3: const logger = createLogger('websocket-client');
 4: 
 5: export class WebSocketClient {
 6:   private ws: WebSocket | null = null;
 7:   private reconnectAttempts = 0;
 8:   private maxReconnectAttempts = 5;
 9:   private reconnectTimeout = 1000;
10:   private messageHandlers = new Set<(data: unknown) => void>();
11: 
12:   constructor(private url: string) {}
13: 
14:   public connect() {
15:     try {
16:       this.ws = new WebSocket(this.url);
17:       this.ws.onopen = this.handleOpen.bind(this);
18:       this.ws.onmessage = this.handleMessage.bind(this);
19:       this.ws.onclose = this.handleClose.bind(this);
20:       this.ws.onerror = this.handleError.bind(this);
21:     } catch (error) {
22:       logger.error({ error }, 'Failed to connect to WebSocket');
23:     }
24:   }
25: 
26:   private handleOpen() {
27:     logger.info('WebSocket connected');
28:     this.reconnectAttempts = 0;
29:   }
30: 
31:   private handleMessage(event: MessageEvent) {
32:     try {
33:       const data = JSON.parse(event.data);
34:       this.messageHandlers.forEach(handler => handler(data));
35:     } catch (error) {
36:       logger.error({ error }, 'Failed to handle WebSocket message');
37:     }
38:   }
39: 
40:   private handleClose() {
41:     logger.info('WebSocket closed');
42:     this.attemptReconnect();
43:   }
44: 
45:   private handleError(error: Event) {
46:     logger.error({ error }, 'WebSocket error');
47:   }
48: 
49:   private attemptReconnect() {
50:     if (this.reconnectAttempts < this.maxReconnectAttempts) {
51:       this.reconnectAttempts++;
52:       setTimeout(() => {
53:         logger.info({ attempt: this.reconnectAttempts }, 'Attempting to reconnect');
54:         this.connect();
55:       }, this.reconnectTimeout * this.reconnectAttempts);
56:     }
57:   }
58: 
59:   public send(data: unknown) {
60:     if (this.ws?.readyState === WebSocket.OPEN) {
61:       this.ws.send(JSON.stringify(data));
62:     }
63:   }
64: 
65:   public onMessage(handler: (data: unknown) => void) {
66:     this.messageHandlers.add(handler);
67:     return () => this.messageHandlers.delete(handler);
68:   }
69: 
70:   public disconnect() {
71:     this.ws?.close();
72:   }
73: }
```

## File: apps/web/lib/socket/server.ts
```typescript
 1: import { WebSocketServer } from 'ws';
 2: import type { WebSocket, Data } from 'ws';
 3: import type { IncomingMessage, Server } from 'http';
 4: import type { Duplex } from 'stream';
 5: import { createLogger } from '@danky/logger';
 6: import { redis } from '@danky/redis';
 7: 
 8: const logger = createLogger('websocket');
 9: 
10: interface WebSocketMessage {
11:   type: string;
12:   payload: unknown;
13: }
14: 
15: const WS_OPEN = 1; // WebSocket.OPEN constant
16: 
17: export class SocketServer {
18:   private readonly wss: WebSocketServer;
19:   private readonly clients: Map<string, WebSocket>;
20: 
21:   constructor() {
22:     this.wss = new WebSocketServer({ noServer: true });
23:     this.clients = new Map();
24: 
25:     this.wss.on('connection', this.handleConnection.bind(this));
26: 
27:     // Subscribe to Redis for pub/sub
28:     const sub = redis.duplicate();
29:     sub.subscribe('chat');
30:     sub.on('message', this.handleRedisMessage.bind(this));
31:   }
32: 
33:   private handleConnection(ws: WebSocket, req: IncomingMessage): void {
34:     const clientId = req.headers['x-client-id'] as string;
35:     this.clients.set(clientId, ws);
36: 
37:     ws.on('message', this.handleMessage.bind(this));
38:     ws.on('close', () => this.handleClose(clientId));
39:   }
40: 
41:   private handleRedisMessage(_channel: string, message: string): void {
42:     this.broadcast(message);
43:   }
44: 
45:   private handleMessage(data: Data): void {
46:     try {
47:       const message = JSON.parse(data.toString()) as WebSocketMessage;
48:       logger.debug({ message }, 'Received WebSocket message');
49:       // Handle different message types
50:     } catch (error) {
51:       logger.error({ error }, 'Failed to handle WebSocket message');
52:     }
53:   }
54: 
55:   private handleClose(clientId: string): void {
56:     this.clients.delete(clientId);
57:     logger.info({ clientId }, 'Client disconnected');
58:   }
59: 
60:   private broadcast(message: string): void {
61:     this.clients.forEach(client => {
62:       if (client.readyState === WS_OPEN) {
63:         client.send(message);
64:       }
65:     });
66:   }
67: 
68:   public attach(server: Server): void {
69:     server.on('upgrade', async (request: IncomingMessage, socket: Duplex, head: Buffer) => {
70:       const shouldHandle = await this.wss.shouldHandle(request);
71:       if (shouldHandle) {
72:         this.wss.handleUpgrade(request, socket, head, ws => {
73:           this.wss.emit('connection', ws, request);
74:         });
75:       }
76:     });
77:   }
78: }
79: 
80: // Export singleton instance
81: export const wsServer = new SocketServer();
```

## File: apps/web/public/file-text.svg
```
1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
2: <path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM13 13.5V6.5H9.5H8V5V1.5H3V13.5C3 14.0523 3.44772 14.5 4 14.5H12C12.5523 14.5 13 14.0523 13 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM5.13 5.00062H4.505V6.25062H5.13H6H6.625V5.00062H6H5.13ZM4.505 8H5.13H11H11.625V9.25H11H5.13H4.505V8ZM5.13 11H4.505V12.25H5.13H11H11.625V11H11H5.13Z" fill="#666666"/>
3: </svg>
```

## File: apps/web/public/globe.svg
```
 1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <g clip-path="url(#clip0_868_525)">
 3: <path fill-rule="evenodd" clip-rule="evenodd" d="M10.268 14.0934C11.9051 13.4838 13.2303 12.2333 13.9384 10.6469C13.1192 10.7941 12.2138 10.9111 11.2469 10.9925C11.0336 12.2005 10.695 13.2621 10.268 14.0934ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8.48347 14.4823C8.32384 14.494 8.16262 14.5 8 14.5C7.83738 14.5 7.67616 14.494 7.51654 14.4823C7.5132 14.4791 7.50984 14.4759 7.50647 14.4726C7.2415 14.2165 6.94578 13.7854 6.67032 13.1558C6.41594 12.5744 6.19979 11.8714 6.04101 11.0778C6.67605 11.1088 7.33104 11.125 8 11.125C8.66896 11.125 9.32395 11.1088 9.95899 11.0778C9.80021 11.8714 9.58406 12.5744 9.32968 13.1558C9.05422 13.7854 8.7585 14.2165 8.49353 14.4726C8.49016 14.4759 8.4868 14.4791 8.48347 14.4823ZM11.4187 9.72246C12.5137 9.62096 13.5116 9.47245 14.3724 9.28806C14.4561 8.87172 14.5 8.44099 14.5 8C14.5 7.55901 14.4561 7.12828 14.3724 6.71194C13.5116 6.52755 12.5137 6.37904 11.4187 6.27753C11.4719 6.83232 11.5 7.40867 11.5 8C11.5 8.59133 11.4719 9.16768 11.4187 9.72246ZM10.1525 6.18401C10.2157 6.75982 10.25 7.36805 10.25 8C10.25 8.63195 10.2157 9.24018 10.1525 9.81598C9.46123 9.85455 8.7409 9.875 8 9.875C7.25909 9.875 6.53877 9.85455 5.84749 9.81598C5.7843 9.24018 5.75 8.63195 5.75 8C5.75 7.36805 5.7843 6.75982 5.84749 6.18401C6.53877 6.14545 7.25909 6.125 8 6.125C8.74091 6.125 9.46123 6.14545 10.1525 6.18401ZM11.2469 5.00748C12.2138 5.08891 13.1191 5.20593 13.9384 5.35306C13.2303 3.7667 11.9051 2.51622 10.268 1.90662C10.695 2.73788 11.0336 3.79953 11.2469 5.00748ZM8.48347 1.51771C8.4868 1.52089 8.49016 1.52411 8.49353 1.52737C8.7585 1.78353 9.05422 2.21456 9.32968 2.84417C9.58406 3.42562 9.80021 4.12856 9.95899 4.92219C9.32395 4.89118 8.66896 4.875 8 4.875C7.33104 4.875 6.67605 4.89118 6.04101 4.92219C6.19978 4.12856 6.41594 3.42562 6.67032 2.84417C6.94578 2.21456 7.2415 1.78353 7.50647 1.52737C7.50984 1.52411 7.51319 1.52089 7.51653 1.51771C7.67615 1.50597 7.83738 1.5 8 1.5C8.16262 1.5 8.32384 1.50597 8.48347 1.51771ZM5.73202 1.90663C4.0949 2.51622 2.76975 3.7667 2.06159 5.35306C2.88085 5.20593 3.78617 5.08891 4.75309 5.00748C4.96639 3.79953 5.30497 2.73788 5.73202 1.90663ZM4.58133 6.27753C3.48633 6.37904 2.48837 6.52755 1.62761 6.71194C1.54392 7.12828 1.5 7.55901 1.5 8C1.5 8.44099 1.54392 8.87172 1.62761 9.28806C2.48837 9.47245 3.48633 9.62096 4.58133 9.72246C4.52807 9.16768 4.5 8.59133 4.5 8C4.5 7.40867 4.52807 6.83232 4.58133 6.27753ZM4.75309 10.9925C3.78617 10.9111 2.88085 10.7941 2.06159 10.6469C2.76975 12.2333 4.0949 13.4838 5.73202 14.0934C5.30497 13.2621 4.96639 12.2005 4.75309 10.9925Z" fill="#666666"/>
 4: </g>
 5: <defs>
 6: <clipPath id="clip0_868_525">
 7: <rect width="16" height="16" fill="white"/>
 8: </clipPath>
 9: </defs>
10: </svg>
```

## File: apps/web/public/next.svg
```
1: <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
```

## File: apps/web/public/turborepo-dark.svg
```
 1: <svg width="473" height="76" viewBox="0 0 473 76" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <path d="M130.998 30.6565V22.3773H91.0977V30.6565H106.16V58.1875H115.935V30.6565H130.998Z" fill="black"/>
 3: <path d="M153.542 58.7362C165.811 58.7362 172.544 52.5018 172.544 42.2275V22.3773H162.768V41.2799C162.768 47.0155 159.776 50.2574 153.542 50.2574C147.307 50.2574 144.315 47.0155 144.315 41.2799V22.3773H134.539V42.2275C134.539 52.5018 141.272 58.7362 153.542 58.7362Z" fill="black"/>
 4: <path d="M187.508 46.3173H197.234L204.914 58.1875H216.136L207.458 45.2699C212.346 43.5243 215.338 39.634 215.338 34.3473C215.338 26.6665 209.603 22.3773 200.874 22.3773H177.732V58.1875H187.508V46.3173ZM187.508 38.5867V30.5568H200.376C203.817 30.5568 205.712 32.053 205.712 34.5967C205.712 36.9907 203.817 38.5867 200.376 38.5867H187.508Z" fill="black"/>
 5: <path d="M219.887 58.1875H245.472C253.452 58.1875 258.041 54.397 258.041 48.0629C258.041 43.8235 255.348 40.9308 252.156 39.634C254.35 38.5867 257.043 36.0929 257.043 32.1528C257.043 25.8187 252.555 22.3773 244.625 22.3773H219.887V58.1875ZM229.263 36.3922V30.3074H243.627C246.32 30.3074 247.817 31.3548 247.817 33.3498C247.817 35.3448 246.32 36.3922 243.627 36.3922H229.263ZM229.263 43.7238H244.525C247.168 43.7238 248.615 45.0205 248.615 46.9657C248.615 48.9108 247.168 50.2075 244.525 50.2075H229.263V43.7238Z" fill="black"/>
 6: <path d="M281.942 21.7788C269.423 21.7788 260.396 29.6092 260.396 40.2824C260.396 50.9557 269.423 58.786 281.942 58.786C294.461 58.786 303.438 50.9557 303.438 40.2824C303.438 29.6092 294.461 21.7788 281.942 21.7788ZM281.942 30.2575C288.525 30.2575 293.463 34.1478 293.463 40.2824C293.463 46.417 288.525 50.3073 281.942 50.3073C275.359 50.3073 270.421 46.417 270.421 40.2824C270.421 34.1478 275.359 30.2575 281.942 30.2575Z" fill="black"/>
 7: <path d="M317.526 46.3173H327.251L334.932 58.1875H346.154L337.476 45.2699C342.364 43.5243 345.356 39.634 345.356 34.3473C345.356 26.6665 339.62 22.3773 330.892 22.3773H307.75V58.1875H317.526V46.3173ZM317.526 38.5867V30.5568H330.394C333.835 30.5568 335.73 32.053 335.73 34.5967C335.73 36.9907 333.835 38.5867 330.394 38.5867H317.526Z" fill="black"/>
 8: <path d="M349.904 22.3773V58.1875H384.717V49.9083H359.48V44.0729H381.874V35.9932H359.48V30.6565H384.717V22.3773H349.904Z" fill="black"/>
 9: <path d="M399.204 46.7662H412.221C420.95 46.7662 426.685 42.5767 426.685 34.5967C426.685 26.5668 420.95 22.3773 412.221 22.3773H389.428V58.1875H399.204V46.7662ZM399.204 38.6365V30.5568H411.673C415.164 30.5568 417.059 32.053 417.059 34.5967C417.059 37.0904 415.164 38.6365 411.673 38.6365H399.204Z" fill="black"/>
10: <path d="M450.948 21.7788C438.43 21.7788 429.402 29.6092 429.402 40.2824C429.402 50.9557 438.43 58.786 450.948 58.786C463.467 58.786 472.444 50.9557 472.444 40.2824C472.444 29.6092 463.467 21.7788 450.948 21.7788ZM450.948 30.2575C457.532 30.2575 462.469 34.1478 462.469 40.2824C462.469 46.417 457.532 50.3073 450.948 50.3073C444.365 50.3073 439.427 46.417 439.427 40.2824C439.427 34.1478 444.365 30.2575 450.948 30.2575Z" fill="black"/>
11: <path d="M38.5017 18.0956C27.2499 18.0956 18.0957 27.2498 18.0957 38.5016C18.0957 49.7534 27.2499 58.9076 38.5017 58.9076C49.7535 58.9076 58.9077 49.7534 58.9077 38.5016C58.9077 27.2498 49.7535 18.0956 38.5017 18.0956ZM38.5017 49.0618C32.6687 49.0618 27.9415 44.3346 27.9415 38.5016C27.9415 32.6686 32.6687 27.9414 38.5017 27.9414C44.3347 27.9414 49.0619 32.6686 49.0619 38.5016C49.0619 44.3346 44.3347 49.0618 38.5017 49.0618Z" fill="black"/>
12: <path fill-rule="evenodd" clip-rule="evenodd" d="M40.2115 14.744V7.125C56.7719 8.0104 69.9275 21.7208 69.9275 38.5016C69.9275 55.2824 56.7719 68.989 40.2115 69.8782V62.2592C52.5539 61.3776 62.3275 51.0644 62.3275 38.5016C62.3275 25.9388 52.5539 15.6256 40.2115 14.744ZM20.5048 54.0815C17.233 50.3043 15.124 45.4935 14.7478 40.2115H7.125C7.5202 47.6025 10.4766 54.3095 15.1088 59.4737L20.501 54.0815H20.5048ZM36.7916 69.8782V62.2592C31.5058 61.883 26.695 59.7778 22.9178 56.5022L17.5256 61.8944C22.6936 66.5304 29.4006 69.483 36.7878 69.8782H36.7916Z" fill="url(#paint0_linear_2028_278)"/>
13: <defs>
14: <linearGradient id="paint0_linear_2028_278" x1="41.443" y1="11.5372" x2="10.5567" y2="42.4236" gradientUnits="userSpaceOnUse">
15: <stop stop-color="#0096FF"/>
16: <stop offset="1" stop-color="#FF1E56"/>
17: </linearGradient>
18: </defs>
19: </svg>
```

## File: apps/web/public/turborepo-light.svg
```
 1: <svg width="473" height="76" viewBox="0 0 473 76" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <path d="M130.998 30.6566V22.3773H91.0977V30.6566H106.16V58.1876H115.935V30.6566H130.998Z" fill="white"/>
 3: <path d="M153.542 58.7362C165.811 58.7362 172.544 52.5018 172.544 42.2276V22.3773H162.768V41.2799C162.768 47.0156 159.776 50.2574 153.542 50.2574C147.307 50.2574 144.315 47.0156 144.315 41.2799V22.3773H134.539V42.2276C134.539 52.5018 141.272 58.7362 153.542 58.7362Z" fill="white"/>
 4: <path d="M187.508 46.3173H197.234L204.914 58.1876H216.136L207.458 45.2699C212.346 43.5243 215.338 39.6341 215.338 34.3473C215.338 26.6666 209.603 22.3773 200.874 22.3773H177.732V58.1876H187.508V46.3173ZM187.508 38.5867V30.5568H200.376C203.817 30.5568 205.712 32.0531 205.712 34.5967C205.712 36.9907 203.817 38.5867 200.376 38.5867H187.508Z" fill="white"/>
 5: <path d="M219.887 58.1876H245.472C253.452 58.1876 258.041 54.3971 258.041 48.0629C258.041 43.8236 255.348 40.9308 252.156 39.6341C254.35 38.5867 257.043 36.0929 257.043 32.1528C257.043 25.8187 252.555 22.3773 244.625 22.3773H219.887V58.1876ZM229.263 36.3922V30.3074H243.627C246.32 30.3074 247.817 31.3548 247.817 33.3498C247.817 35.3448 246.32 36.3922 243.627 36.3922H229.263ZM229.263 43.7238H244.525C247.168 43.7238 248.615 45.0206 248.615 46.9657C248.615 48.9108 247.168 50.2076 244.525 50.2076H229.263V43.7238Z" fill="white"/>
 6: <path d="M281.942 21.7788C269.423 21.7788 260.396 29.6092 260.396 40.2824C260.396 50.9557 269.423 58.7861 281.942 58.7861C294.461 58.7861 303.438 50.9557 303.438 40.2824C303.438 29.6092 294.461 21.7788 281.942 21.7788ZM281.942 30.2576C288.525 30.2576 293.463 34.1478 293.463 40.2824C293.463 46.4171 288.525 50.3073 281.942 50.3073C275.359 50.3073 270.421 46.4171 270.421 40.2824C270.421 34.1478 275.359 30.2576 281.942 30.2576Z" fill="white"/>
 7: <path d="M317.526 46.3173H327.251L334.932 58.1876H346.154L337.476 45.2699C342.364 43.5243 345.356 39.6341 345.356 34.3473C345.356 26.6666 339.62 22.3773 330.892 22.3773H307.75V58.1876H317.526V46.3173ZM317.526 38.5867V30.5568H330.394C333.835 30.5568 335.73 32.0531 335.73 34.5967C335.73 36.9907 333.835 38.5867 330.394 38.5867H317.526Z" fill="white"/>
 8: <path d="M349.904 22.3773V58.1876H384.717V49.9083H359.48V44.0729H381.874V35.9932H359.48V30.6566H384.717V22.3773H349.904Z" fill="white"/>
 9: <path d="M399.204 46.7662H412.221C420.95 46.7662 426.685 42.5767 426.685 34.5967C426.685 26.5668 420.95 22.3773 412.221 22.3773H389.428V58.1876H399.204V46.7662ZM399.204 38.6366V30.5568H411.673C415.164 30.5568 417.059 32.0531 417.059 34.5967C417.059 37.0904 415.164 38.6366 411.673 38.6366H399.204Z" fill="white"/>
10: <path d="M450.948 21.7788C438.43 21.7788 429.402 29.6092 429.402 40.2824C429.402 50.9557 438.43 58.7861 450.948 58.7861C463.467 58.7861 472.444 50.9557 472.444 40.2824C472.444 29.6092 463.467 21.7788 450.948 21.7788ZM450.948 30.2576C457.532 30.2576 462.469 34.1478 462.469 40.2824C462.469 46.4171 457.532 50.3073 450.948 50.3073C444.365 50.3073 439.427 46.4171 439.427 40.2824C439.427 34.1478 444.365 30.2576 450.948 30.2576Z" fill="white"/>
11: <path d="M38.5017 18.0956C27.2499 18.0956 18.0957 27.2498 18.0957 38.5016C18.0957 49.7534 27.2499 58.9076 38.5017 58.9076C49.7535 58.9076 58.9077 49.7534 58.9077 38.5016C58.9077 27.2498 49.7535 18.0956 38.5017 18.0956ZM38.5017 49.0618C32.6687 49.0618 27.9415 44.3346 27.9415 38.5016C27.9415 32.6686 32.6687 27.9414 38.5017 27.9414C44.3347 27.9414 49.0619 32.6686 49.0619 38.5016C49.0619 44.3346 44.3347 49.0618 38.5017 49.0618Z" fill="white"/>
12: <path fill-rule="evenodd" clip-rule="evenodd" d="M40.2115 14.744V7.125C56.7719 8.0104 69.9275 21.7208 69.9275 38.5016C69.9275 55.2824 56.7719 68.989 40.2115 69.8782V62.2592C52.5539 61.3776 62.3275 51.0644 62.3275 38.5016C62.3275 25.9388 52.5539 15.6256 40.2115 14.744ZM20.5048 54.0815C17.233 50.3043 15.124 45.4935 14.7478 40.2115H7.125C7.5202 47.6025 10.4766 54.3095 15.1088 59.4737L20.501 54.0815H20.5048ZM36.7916 69.8782V62.2592C31.5058 61.883 26.695 59.7778 22.9178 56.5022L17.5256 61.8944C22.6936 66.5304 29.4006 69.483 36.7878 69.8782H36.7916Z" fill="url(#paint0_linear_2028_477)"/>
13: <defs>
14: <linearGradient id="paint0_linear_2028_477" x1="41.443" y1="11.5372" x2="10.5567" y2="42.4236" gradientUnits="userSpaceOnUse">
15: <stop stop-color="#0096FF"/>
16: <stop offset="1" stop-color="#FF1E56"/>
17: </linearGradient>
18: </defs>
19: </svg>
```

## File: apps/web/public/vercel.svg
```
 1: <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
 2: <g clip-path="url(#clip0_977_547)">
 3: <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 3L18.5 17H2.5L10.5 3Z" fill="white"/>
 4: </g>
 5: <defs>
 6: <clipPath id="clip0_977_547">
 7: <rect width="16" height="16" fill="white" transform="translate(2.5 2)"/>
 8: </clipPath>
 9: </defs>
10: </svg>
```

## File: apps/web/public/window.svg
```
1: <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
2: <path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5H14.5V12.5C14.5 13.0523 14.0523 13.5 13.5 13.5H2.5C1.94772 13.5 1.5 13.0523 1.5 12.5V2.5ZM0 1H1.5H14.5H16V2.5V12.5C16 13.8807 14.8807 15 13.5 15H2.5C1.11929 15 0 13.8807 0 12.5V2.5V1ZM3.75 5.5C4.16421 5.5 4.5 5.16421 4.5 4.75C4.5 4.33579 4.16421 4 3.75 4C3.33579 4 3 4.33579 3 4.75C3 5.16421 3.33579 5.5 3.75 5.5ZM7 4.75C7 5.16421 6.66421 5.5 6.25 5.5C5.83579 5.5 5.5 5.16421 5.5 4.75C5.5 4.33579 5.83579 4 6.25 4C6.66421 4 7 4.33579 7 4.75ZM8.75 5.5C9.16421 5.5 9.5 5.16421 9.5 4.75C9.5 4.33579 9.16421 4 8.75 4C8.33579 4 8 4.33579 8 4.75C8 5.16421 8.33579 5.5 8.75 5.5Z" fill="#666666"/>
3: </svg>
```

## File: apps/web/src/app/api/actions/chat/batch-operations.ts
```typescript
  1: 'use server';
  2: 
  3: import { z } from 'zod';
  4: import {
  5:   batchDeleteSessionsRequestSchema,
  6:   batchDeleteSessionsResponseSchema,
  7:   batchRestoreSessionsRequestSchema,
  8:   batchRestoreSessionsResponseSchema,
  9:   batchArchiveSessionsRequestSchema,
 10:   batchArchiveSessionsResponseSchema,
 11:   batchUpdateSessionsRequestSchema,
 12:   batchUpdateSessionsResponseSchema,
 13:   batchDeleteMessagesRequestSchema,
 14:   batchDeleteMessagesResponseSchema,
 15:   batchRestoreMessagesRequestSchema,
 16:   batchRestoreMessagesResponseSchema,
 17:   batchCreateMessagesRequestSchema,
 18:   batchCreateMessagesResponseSchema,
 19:   type Message,
 20: } from '@danky/schema';
 21: import {
 22:   batchDeleteSessions,
 23:   batchRestoreSessions,
 24:   batchArchiveSessions,
 25:   batchUpdateSessions,
 26: } from '@/lib/db/chat/batch-sessions';
 27: import {
 28:   batchDeleteMessages,
 29:   batchRestoreMessages,
 30:   batchCreateMessages,
 31: } from '@/lib/db/chat/batch';
 32: import { withUser } from '@/lib/session';
 33: import { withErrorHandling } from '@/lib/errors';
 34: 
 35: // Helper to transform DB message to API message
 36: function transformMessage(m: any): Message {
 37:   return {
 38:     id: m.id,
 39:     role: m.role,
 40:     content: [
 41:       {
 42:         type: m.contentType,
 43:         content: m.content,
 44:         language: m.language,
 45:       },
 46:     ],
 47:     sessionId: m.conversationId,
 48:     metadata: m.metadata || {},
 49:     createdAt: m.createdAt,
 50:     updatedAt: m.updatedAt,
 51:   };
 52: }
 53: 
 54: // Session batch operations
 55: async function batchDeleteSessionsHandler(input: z.infer<typeof batchDeleteSessionsRequestSchema>) {
 56:   return withUser(async user => {
 57:     // Delete sessions
 58:     const deleted = await batchDeleteSessions(
 59:       { ids: input.ids, permanent: input.permanent },
 60:       user.id
 61:     );
 62: 
 63:     // Return success response
 64:     return batchDeleteSessionsResponseSchema.parse({
 65:       success: true,
 66:       data: {
 67:         deletedCount: deleted.length,
 68:         deletedIds: deleted.map(s => s.id),
 69:       },
 70:     });
 71:   });
 72: }
 73: 
 74: async function batchRestoreSessionsHandler(
 75:   input: z.infer<typeof batchRestoreSessionsRequestSchema>
 76: ) {
 77:   return withUser(async user => {
 78:     // Restore sessions
 79:     const restored = await batchRestoreSessions({ ids: input.ids }, user.id);
 80: 
 81:     // Return success response
 82:     return batchRestoreSessionsResponseSchema.parse({
 83:       success: true,
 84:       data: {
 85:         restoredCount: restored.length,
 86:         restoredSessions: restored,
 87:       },
 88:     });
 89:   });
 90: }
 91: 
 92: async function batchArchiveSessionsHandler(
 93:   input: z.infer<typeof batchArchiveSessionsRequestSchema>
 94: ) {
 95:   return withUser(async user => {
 96:     // Archive/unarchive sessions
 97:     const updated = await batchArchiveSessions({ ids: input.ids, archive: input.archive }, user.id);
 98: 
 99:     // Return success response
100:     return batchArchiveSessionsResponseSchema.parse({
101:       success: true,
102:       data: {
103:         updatedCount: updated.length,
104:         updatedIds: updated.map(s => s.id),
105:       },
106:     });
107:   });
108: }
109: 
110: async function batchUpdateSessionsHandler(input: z.infer<typeof batchUpdateSessionsRequestSchema>) {
111:   return withUser(async user => {
112:     // Update sessions
113:     const updated = await batchUpdateSessions(input, user.id);
114: 
115:     // Return success response
116:     return batchUpdateSessionsResponseSchema.parse({
117:       success: true,
118:       data: {
119:         updatedCount: updated.length,
120:         updatedSessions: updated,
121:       },
122:     });
123:   });
124: }
125: 
126: // Message batch operations
127: async function batchDeleteMessagesHandler(input: z.infer<typeof batchDeleteMessagesRequestSchema>) {
128:   return withUser(async user => {
129:     // Delete messages
130:     const deleted = await batchDeleteMessages(
131:       { ids: input.ids, permanent: input.permanent },
132:       user.id
133:     );
134: 
135:     // Return success response
136:     return batchDeleteMessagesResponseSchema.parse({
137:       success: true,
138:       data: {
139:         deletedCount: deleted.length,
140:         deletedIds: deleted.map(m => m.id),
141:       },
142:     });
143:   });
144: }
145: 
146: async function batchRestoreMessagesHandler(
147:   input: z.infer<typeof batchRestoreMessagesRequestSchema>
148: ) {
149:   return withUser(async user => {
150:     // Restore messages
151:     const restored = await batchRestoreMessages({ ids: input.ids }, user.id);
152: 
153:     // Return success response
154:     return batchRestoreMessagesResponseSchema.parse({
155:       success: true,
156:       data: {
157:         restoredCount: restored.length,
158:         restoredIds: restored.map(m => m.id),
159:       },
160:     });
161:   });
162: }
163: 
164: async function batchCreateMessagesHandler(input: z.infer<typeof batchCreateMessagesRequestSchema>) {
165:   return withUser(async user => {
166:     // Create messages
167:     const messages = await batchCreateMessages(input, user.id);
168: 
169:     // Return success response
170:     return batchCreateMessagesResponseSchema.parse({
171:       success: true,
172:       data: {
173:         createdCount: messages.length,
174:         messages: messages.map(transformMessage),
175:       },
176:     });
177:   });
178: }
179: 
180: // Export wrapped handlers with error handling
181: export const batchDeleteChatSessions = withErrorHandling(
182:   batchDeleteSessionsHandler,
183:   batchDeleteSessionsResponseSchema,
184:   'batchDeleteSessions'
185: );
186: 
187: export const batchRestoreChatSessions = withErrorHandling(
188:   batchRestoreSessionsHandler,
189:   batchRestoreSessionsResponseSchema,
190:   'batchRestoreSessions'
191: );
192: 
193: export const batchArchiveChatSessions = withErrorHandling(
194:   batchArchiveSessionsHandler,
195:   batchArchiveSessionsResponseSchema,
196:   'batchArchiveSessions'
197: );
198: 
199: export const batchUpdateChatSessions = withErrorHandling(
200:   batchUpdateSessionsHandler,
201:   batchUpdateSessionsResponseSchema,
202:   'batchUpdateSessions'
203: );
204: 
205: export const batchDeleteChatMessages = withErrorHandling(
206:   batchDeleteMessagesHandler,
207:   batchDeleteMessagesResponseSchema,
208:   'batchDeleteMessages'
209: );
210: 
211: export const batchRestoreChatMessages = withErrorHandling(
212:   batchRestoreMessagesHandler,
213:   batchRestoreMessagesResponseSchema,
214:   'batchRestoreMessages'
215: );
216: 
217: export const batchCreateChatMessages = withErrorHandling(
218:   batchCreateMessagesHandler,
219:   batchCreateMessagesResponseSchema,
220:   'batchCreateMessages'
221: );
```

## File: apps/web/src/app/api/actions/chat/create-message.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { createMessageRequestSchema, createMessageResponseSchema } from '@danky/schema';
 5: import { createMessage } from '@/lib/db/chat';
 6: import { withUser } from '@/lib/session';
 7: import { withErrorHandling } from '@/lib/errors';
 8: 
 9: async function createMessageHandler(input: z.infer<typeof createMessageRequestSchema>) {
10:   return withUser(async (user) => {
11:     // Validate input
12:     const validatedInput = createMessageRequestSchema.parse(input);
13: 
14:     // Create message in database
15:     const message = await createMessage(validatedInput, user.id);
16: 
17:     // Transform message to match our schema
18:     const transformedMessage = {
19:       id: message.id,
20:       role: message.role,
21:       content: [{
22:         type: message.contentType,
23:         content: message.content,
24:         language: message.language,
25:       }],
26:       sessionId: message.conversationId,
27:       metadata: message.metadata,
28:       createdAt: message.createdAt,
29:       updatedAt: message.updatedAt,
30:     };
31: 
32:     // Return success response
33:     return createMessageResponseSchema.parse({
34:       success: true,
35:       data: transformedMessage,
36:     });
37:   });
38: }
39: 
40: // Export the wrapped handler with error handling
41: export const createChatMessage = withErrorHandling(
42:   createMessageHandler,
43:   createMessageResponseSchema,
44:   'createMessage'
45: );
```

## File: apps/web/src/app/api/actions/chat/create-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { createSessionRequestSchema, createSessionResponseSchema } from '@danky/schema';
 5: import { createSession } from '@/lib/db/chat';
 6: 
 7: export async function createChatSession(input: z.infer<typeof createSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = createSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Create session in database
16:     const session = await createSession(validatedInput, userId);
17: 
18:     // Transform session to match our schema
19:     const transformedSession = {
20:       id: session.id,
21:       name: session.title,
22:       modelId: input.modelId,
23:       metadata: session.metadata,
24:       createdAt: session.createdAt,
25:       updatedAt: session.updatedAt,
26:     };
27: 
28:     // Return success response
29:     return createSessionResponseSchema.parse({
30:       success: true,
31:       data: transformedSession,
32:     });
33:   } catch (error) {
34:     // Handle validation errors
35:     if (error instanceof z.ZodError) {
36:       return createSessionResponseSchema.parse({
37:         success: false,
38:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
39:       });
40:     }
41: 
42:     // Handle other errors
43:     console.error('Error creating session:', error);
44:     return createSessionResponseSchema.parse({
45:       success: false,
46:       error: 'Failed to create session',
47:     });
48:   }
49: }
```

## File: apps/web/src/app/api/actions/chat/delete-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { deleteSessionRequestSchema, deleteSessionResponseSchema } from '@danky/schema';
 5: import { deleteSession } from '@/lib/db/chat';
 6: 
 7: export async function deleteChatSession(input: z.infer<typeof deleteSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = deleteSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Delete session from database
16:     const session = await deleteSession(validatedInput, userId);
17: 
18:     if (!session) {
19:       return deleteSessionResponseSchema.parse({
20:         success: false,
21:         error: 'Session not found or you do not have permission to delete it',
22:       });
23:     }
24: 
25:     // Return success response
26:     return deleteSessionResponseSchema.parse({
27:       success: true,
28:       message: 'Session deleted successfully',
29:     });
30:   } catch (error) {
31:     // Handle validation errors
32:     if (error instanceof z.ZodError) {
33:       return deleteSessionResponseSchema.parse({
34:         success: false,
35:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
36:       });
37:     }
38: 
39:     // Handle other errors
40:     console.error('Error deleting session:', error);
41:     return deleteSessionResponseSchema.parse({
42:       success: false,
43:       error: 'Failed to delete session',
44:     });
45:   }
46: }
```

## File: apps/web/src/app/api/actions/chat/index.ts
```typescript
 1: // Export types
 2: export * from './types';
 3: 
 4: // Message operations
 5: export { listMessages, type ListMessagesParams } from './list-messages';
 6: export { createChatMessage } from './create-message';
 7: 
 8: // Session operations
 9: export { createChatSession } from './create-session';
10: export { listChatSessions } from './list-sessions';
11: export { updateChatSession } from './update-session';
12: export { deleteChatSession } from './delete-session';
13: 
14: // Batch operations
15: export {
16:   batchDeleteChatSessions,
17:   batchArchiveChatSessions,
18:   batchCreateChatMessages,
19: } from './batch-operations';
```

## File: apps/web/src/app/api/actions/chat/list-messages.ts
```typescript
 1: 'use server';
 2: 
 3: import { listMessagesResponseSchema } from '@danky/schema';
 4: import { webListMessagesSchema, type WebListMessagesParams } from '@/lib/validations/chat';
 5: import { getMessages } from '@/lib/db/chat';
 6: import { withUser } from '@/lib/session';
 7: import { withErrorHandling } from '@/lib/errors';
 8: 
 9: // Export the request schema type for client usage
10: export type ListMessagesParams = WebListMessagesParams;
11: 
12: async function listMessagesHandler(input: string) {
13:   return withUser(async _user => {
14:     // Parse and validate input
15:     const params = JSON.parse(input);
16:     const validatedInput = webListMessagesSchema.parse(params);
17: 
18:     // Query messages from database
19:     const { messages, pagination } = await getMessages(validatedInput);
20: 
21:     // Transform messages to match our schema
22:     const transformedMessages = messages.map(msg => ({
23:       id: msg.id,
24:       role: msg.role,
25:       content: [
26:         {
27:           type: 'text',
28:           content: msg.content,
29:         },
30:       ],
31:       sessionId: msg.sessionId,
32:       metadata: msg.metadata,
33:       createdAt: msg.createdAt,
34:       updatedAt: msg.updatedAt,
35:       deletedAt: msg.deletedAt,
36:     }));
37: 
38:     // Return success response
39:     return listMessagesResponseSchema.parse({
40:       success: true,
41:       data: {
42:         messages: transformedMessages,
43:         pagination,
44:       },
45:     });
46:   });
47: }
48: 
49: // Export the wrapped handler with error handling
50: export const listMessages = withErrorHandling(
51:   listMessagesHandler,
52:   listMessagesResponseSchema,
53:   'listMessages'
54: );
```

## File: apps/web/src/app/api/actions/chat/list-sessions.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { listSessionsRequestSchema, listSessionsResponseSchema } from '@danky/schema';
 5: import { getSessions } from '@/lib/db/chat';
 6: import { withUser } from '@/lib/session';
 7: import { withErrorHandling } from '@/lib/errors';
 8: 
 9: async function listChatSessionsHandler(input: z.infer<typeof listSessionsRequestSchema>) {
10:   return withUser(async (user) => {
11:     // Validate input
12:     const validatedInput = listSessionsRequestSchema.parse(input);
13: 
14:     // Get sessions from database
15:     const { sessions, pagination } = await getSessions(validatedInput, user.id);
16: 
17:     // Transform sessions to match our schema
18:     const transformedSessions = sessions.map(session => ({
19:       id: session.id,
20:       name: session.title,
21:       modelId: session.modelId,
22:       description: session.description ?? undefined,
23:       metadata: session.metadata,
24:       createdAt: session.createdAt,
25:       updatedAt: session.updatedAt,
26:     }));
27: 
28:     // Return success response
29:     return listSessionsResponseSchema.parse({
30:       success: true,
31:       data: transformedSessions,
32:       pagination,
33:     });
34:   });
35: }
36: 
37: // Export the wrapped handler with error handling
38: export const listChatSessions = withErrorHandling(
39:   listChatSessionsHandler,
40:   listSessionsResponseSchema,
41:   'listChatSessions'
42: );
```

## File: apps/web/src/app/api/actions/chat/types.ts
```typescript
1: import { z } from 'zod';
2: import { webListMessagesSchema } from '@/lib/validations/chat';
3: 
4: // Re-export the type from list-messages.ts instead of duplicating it
5: export type { ListMessagesParams } from './list-messages';
```

## File: apps/web/src/app/api/actions/chat/update-session.ts
```typescript
 1: 'use server';
 2: 
 3: import { z } from 'zod';
 4: import { updateSessionRequestSchema, updateSessionResponseSchema } from '@danky/schema';
 5: import { updateSession } from '@/lib/db/chat';
 6: 
 7: export async function updateChatSession(input: z.infer<typeof updateSessionRequestSchema>) {
 8:   try {
 9:     // Validate input
10:     const validatedInput = updateSessionRequestSchema.parse(input);
11: 
12:     // TODO: Get actual user ID from session
13:     const userId = 'temp-user-id';
14: 
15:     // Update session in database
16:     const session = await updateSession(validatedInput, userId);
17: 
18:     if (!session) {
19:       return updateSessionResponseSchema.parse({
20:         success: false,
21:         error: 'Session not found or you do not have permission to update it',
22:       });
23:     }
24: 
25:     // Transform session to match our schema
26:     const transformedSession = {
27:       id: session.id,
28:       name: session.title,
29:       modelId: session.metadata?.modelId ?? 'default-model',
30:       description: session.metadata?.description,
31:       metadata: session.metadata,
32:       createdAt: session.createdAt,
33:       updatedAt: session.updatedAt,
34:     };
35: 
36:     // Return success response
37:     return updateSessionResponseSchema.parse({
38:       success: true,
39:       data: transformedSession,
40:     });
41:   } catch (error) {
42:     // Handle validation errors
43:     if (error instanceof z.ZodError) {
44:       return updateSessionResponseSchema.parse({
45:         success: false,
46:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
47:       });
48:     }
49: 
50:     // Handle other errors
51:     console.error('Error updating session:', error);
52:     return updateSessionResponseSchema.parse({
53:       success: false,
54:       error: 'Failed to update session',
55:     });
56:   }
57: }
```

## File: apps/web/src/app/api/actions/chat.ts
```typescript
  1: 'use server';
  2: 
  3: import { z } from 'zod';
  4: import {
  5:   createMessageRequestSchema,
  6:   createMessageResponseSchema,
  7:   chatMessageSchema,
  8:   messageContentSchema,
  9:   messageMetadataSchema,
 10:   sessionMetadataSchema
 11: } from '@danky/schema';
 12: import { webCreateMessageSchema } from '@/lib/validations/chat';
 13: import { db } from '@/lib/db';
 14: import { messages, sessions } from '@danky/db';
 15: import { eq } from 'drizzle-orm';
 16: 
 17: // Helper to create a text content object
 18: const createTextContent = (text: string) => ({
 19:   type: 'text' as const,
 20:   content: text
 21: });
 22: 
 23: export async function createMessage(input: z.infer<typeof webCreateMessageSchema>) {
 24:   try {
 25:     // Validate input
 26:     const validatedInput = webCreateMessageSchema.parse(input);
 27: 
 28:     // Convert string content to content array if needed
 29:     const content = typeof validatedInput.content === 'string'
 30:       ? [createTextContent(validatedInput.content)]
 31:       : validatedInput.content;
 32: 
 33:     // Create message in database
 34:     const [message] = await db.insert(messages)
 35:       .values({
 36:         role: validatedInput.role,
 37:         content,
 38:         sessionId: validatedInput.sessionId,
 39:         metadata: validatedInput.metadata,
 40:       })
 41:       .returning();
 42: 
 43:     // Update session's last message
 44:     await db.update(sessions)
 45:       .set({
 46:         lastMessage: content[0].content,
 47:         updatedAt: new Date()
 48:       })
 49:       .where(eq(sessions.id, validatedInput.sessionId));
 50: 
 51:     // Return success response
 52:     return createMessageResponseSchema.parse({
 53:       success: true,
 54:       data: message
 55:     });
 56:   } catch (error) {
 57:     // Handle validation errors
 58:     if (error instanceof z.ZodError) {
 59:       return createMessageResponseSchema.parse({
 60:         success: false,
 61:         error: 'Invalid input: ' + error.errors.map(e => e.message).join(', '),
 62:       });
 63:     }
 64: 
 65:     // Handle other errors
 66:     console.error('Error creating message:', error);
 67:     return createMessageResponseSchema.parse({
 68:       success: false,
 69:       error: 'Failed to create message',
 70:     });
 71:   }
 72: }
 73: 
 74: export async function listMessages(sessionId: string, page = 1, limit = 50) {
 75:   try {
 76:     const offset = (page - 1) * limit;
 77: 
 78:     // Get messages for session
 79:     const messagesList = await db.select()
 80:       .from(messages)
 81:       .where(eq(messages.sessionId, sessionId))
 82:       .orderBy(messages.createdAt)
 83:       .limit(limit)
 84:       .offset(offset);
 85: 
 86:     // Get total count
 87:     const [{ count }] = await db.select({
 88:       count: db.fn.count()
 89:     })
 90:     .from(messages)
 91:     .where(eq(messages.sessionId, sessionId));
 92: 
 93:     const totalPages = Math.ceil(Number(count) / limit);
 94: 
 95:     return {
 96:       success: true,
 97:       data: {
 98:         messages: messagesList,
 99:         pagination: {
100:           page,
101:           limit,
102:           totalPages,
103:           totalItems: Number(count)
104:         }
105:       }
106:     };
107:   } catch (error) {
108:     console.error('Error listing messages:', error);
109:     return {
110:       success: false,
111:       error: 'Failed to list messages'
112:     };
113:   }
114: }
115: 
116: export async function deleteMessage(id: string, permanent = false) {
117:   try {
118:     if (permanent) {
119:       await db.delete(messages).where(eq(messages.id, id));
120:     } else {
121:       await db.update(messages)
122:         .set({ deletedAt: new Date() })
123:         .where(eq(messages.id, id));
124:     }
125: 
126:     return {
127:       success: true,
128:       data: { id, deletedAt: new Date() }
129:     };
130:   } catch (error) {
131:     console.error('Error deleting message:', error);
132:     return {
133:       success: false,
134:       error: 'Failed to delete message'
135:     };
136:   }
137: }
138: 
139: export async function restoreMessage(id: string) {
140:   try {
141:     const [message] = await db.update(messages)
142:       .set({ deletedAt: null })
143:       .where(eq(messages.id, id))
144:       .returning();
145: 
146:     return {
147:       success: true,
148:       data: message
149:     };
150:   } catch (error) {
151:     console.error('Error restoring message:', error);
152:     return {
153:       success: false,
154:       error: 'Failed to restore message'
155:     };
156:   }
157: }
```

## File: apps/web/src/app/api/actions/mcp.ts
```typescript
 1: 'use server'
 2: 
 3: import { MCPService } from '@danky/mcp'
 4: 
 5: let mcpService: MCPService | null = null
 6: 
 7: async function getMCPService() {
 8:   if (!mcpService) {
 9:     mcpService = new MCPService()
10:     await mcpService.initialize()
11:   }
12:   return mcpService
13: }
14: 
15: export async function initialize() {
16:   try {
17:     const service = await getMCPService()
18:     return { success: true }
19:   } catch (error) {
20:     console.error('Failed to initialize MCP service:', error)
21:     return { success: false, error: error instanceof Error ? error.message : String(error) }
22:   }
23: }
24: 
25: export async function getStatus() {
26:   try {
27:     const service = await getMCPService()
28:     return { success: true, status: { isInitialized: true } }
29:   } catch (error) {
30:     console.error('Failed to get MCP service status:', error)
31:     return { success: false, error: error instanceof Error ? error.message : String(error) }
32:   }
33: }
34: 
35: export async function getTools() {
36:   try {
37:     const service = await getMCPService()
38:     return { success: true, tools: [] }
39:   } catch (error) {
40:     console.error('Failed to get MCP tools:', error)
41:     return { success: false, error: error instanceof Error ? error.message : String(error) }
42:   }
43: }
44: 
45: export async function processMessage(message: string) {
46:   try {
47:     const service = await getMCPService()
48:     const response = await service.processMessage(message)
49:     return { success: true, response }
50:   } catch (error) {
51:     console.error('Failed to process message:', error)
52:     return { success: false, error: error instanceof Error ? error.message : String(error) }
53:   }
54: }
55: 
56: export async function shutdown() {
57:   try {
58:     if (mcpService) {
59:       await mcpService.shutdown()
60:       mcpService = null
61:     }
62:     return { success: true }
63:   } catch (error) {
64:     console.error('Failed to shutdown MCP service:', error)
65:     return { success: false, error: error instanceof Error ? error.message : String(error) }
66:   }
67: }
```

## File: apps/web/src/app/api/chat/sessions/[sessionId]/messages/route.ts
```typescript
 1: import { type NextRequest } from 'next/server'
 2: import { z } from 'zod'
 3: 
 4: // Mock data for development
 5: const messages = [
 6:   {
 7:     id: "1",
 8:     content: "Hello!",
 9:     role: "user",
10:     timestamp: new Date().toISOString()
11:   }
12: ]
13: 
14: const sessionParamsSchema = z.object({
15:   sessionId: z.string()
16: })
17: 
18: type RouteContext = {
19:   params: Promise<{ sessionId: string }>
20: }
21: 
22: export async function GET(
23:   request: Request,
24:   context: RouteContext
25: ): Promise<Response> {
26:   try {
27:     const { sessionId } = await context.params
28:     sessionParamsSchema.parse({ sessionId })
29:     
30:     // Mock response for development
31:     return Response.json({ messages })
32:   } catch (error) {
33:     console.error("Error fetching messages:", error)
34:     if (error instanceof z.ZodError) {
35:       return Response.json(
36:         { error: "Invalid session ID", details: error.errors },
37:         { status: 400 }
38:       )
39:     }
40:     return Response.json(
41:       { error: "Failed to fetch messages" },
42:       { status: 500 }
43:     )
44:   }
45: }
46: 
47: const messageSchema = z.object({
48:   content: z.string(),
49:   role: z.enum(["user", "assistant"])
50: })
51: 
52: export async function POST(
53:   request: Request,
54:   context: RouteContext
55: ): Promise<Response> {
56:   try {
57:     const { sessionId } = await context.params
58:     sessionParamsSchema.parse({ sessionId })
59:     
60:     const body = await request.json()
61:     const message = messageSchema.parse(body)
62:     
63:     // Mock response for development
64:     return Response.json({
65:       message: {
66:         ...message,
67:         id: Math.random().toString(),
68:         timestamp: new Date().toISOString()
69:       }
70:     })
71:   } catch (error) {
72:     console.error("Error adding message:", error)
73:     if (error instanceof z.ZodError) {
74:       return Response.json(
75:         { error: "Invalid message", details: error.errors },
76:         { status: 400 }
77:       )
78:     }
79:     return Response.json(
80:       { error: "Failed to add message" },
81:       { status: 500 }
82:     )
83:   }
84: }
```

## File: apps/web/src/app/api/chat/sessions/route.ts
```typescript
 1: import { type NextRequest, NextResponse } from 'next/server'
 2: import { z } from 'zod'
 3: 
 4: // In-memory storage for development
 5: const sessions: Array<{
 6:   id: string
 7:   title: string
 8:   lastMessage: string
 9:   timestamp: Date
10: }> = [
11:   {
12:     id: "1",
13:     title: "General Chat",
14:     lastMessage: "Hello! How can I help you today?",
15:     timestamp: new Date()
16:   }
17: ]
18: 
19: const createSessionSchema = z.object({
20:   title: z.string(),
21:   lastMessage: z.string()
22: })
23: 
24: export async function GET(_request: NextRequest) {
25:   return NextResponse.json({ 
26:     sessions: sessions.map(session => ({
27:       ...session,
28:       timestamp: session.timestamp.toISOString()
29:     }))
30:   })
31: }
32: 
33: export async function POST(request: NextRequest) {
34:   try {
35:     const body = await request.json()
36:     const { title, lastMessage } = createSessionSchema.parse(body)
37:     
38:     const session = {
39:       id: Date.now().toString(),
40:       title,
41:       lastMessage,
42:       timestamp: new Date()
43:     }
44:     
45:     sessions.unshift(session)
46:     
47:     return NextResponse.json({ 
48:       sessionId: session.id,
49:       session: {
50:         ...session,
51:         timestamp: session.timestamp.toISOString()
52:       }
53:     })
54:   } catch (error) {
55:     console.error("Error creating session:", error)
56:     if (error instanceof z.ZodError) {
57:       return NextResponse.json(
58:         { error: "Invalid request", details: error.errors },
59:         { status: 400 }
60:       )
61:     }
62:     return NextResponse.json(
63:       { error: "Failed to create session" },
64:       { status: 500 }
65:     )
66:   }
67: }
```

## File: apps/web/src/app/api/chat/route.ts
```typescript
 1: import { NextResponse } from 'next/server'
 2: import { createLogger } from '@danky/mcp'
 3: import { MCPService } from '@danky/mcp'
 4: import path from 'path'
 5: 
 6: const logger = createLogger({ level: 'debug' })
 7: const mcpService = new MCPService({
 8:   configPath: path.join(process.cwd(), '../../mcp-config.json5'),
 9:   logger
10: })
11: 
12: export async function POST(request: Request) {
13:   try {
14:     const { message } = await request.json()
15:     
16:     if (!message || typeof message !== 'string') {
17:       logger.error('Invalid message format:', { message })
18:       return NextResponse.json(
19:         { error: 'Invalid message format' },
20:         { status: 400 }
21:       )
22:     }
23: 
24:     logger.debug('Processing message:', { message })
25:     const response = await mcpService.processMessage(message)
26:     logger.debug('Response:', { response })
27:     
28:     return NextResponse.json({ response })
29:   } catch (error) {
30:     logger.error('Error processing message:', {
31:       error: error instanceof Error ? {
32:         name: error.name,
33:         message: error.message,
34:         stack: error.stack
35:       } : String(error)
36:     })
37:     return NextResponse.json(
38:       { error: error instanceof Error ? error.message : String(error) },
39:       { status: 500 }
40:     )
41:   }
42: }
43: 
44: export async function GET() {
45:   try {
46:     logger.debug('Initializing MCP service')
47:     await mcpService.initialize()
48:     logger.debug('MCP service initialized')
49:     
50:     return NextResponse.json({ status: 'ready' })
51:   } catch (error) {
52:     logger.error('Error initializing chat:', {
53:       error: error instanceof Error ? {
54:         name: error.name,
55:         message: error.message,
56:         stack: error.stack
57:       } : String(error)
58:     })
59:     return NextResponse.json(
60:       { error: error instanceof Error ? error.message : String(error) },
61:       { status: 500 }
62:     )
63:   }
64: }
```

## File: apps/web/src/app/api/routes/chat.ts
```typescript
 1: import { NextRequest } from 'next/server';
 2: import {
 3:   createChatSession,
 4:   listChatSessions,
 5:   updateChatSession,
 6:   deleteChatSession,
 7:   batchDeleteChatSessions,
 8:   batchRestoreChatSessions,
 9:   batchArchiveChatSessions,
10:   batchUpdateChatSessions,
11:   batchDeleteChatMessages,
12:   batchRestoreChatMessages,
13:   batchCreateChatMessages,
14: } from '../actions/chat';
15: 
16: // Main route handlers
17: export async function POST(request: NextRequest) {
18:   const body = await request.json();
19:   return createChatSession(body);
20: }
21: 
22: export async function GET(request: NextRequest) {
23:   const searchParams = request.nextUrl.searchParams;
24:   const page = parseInt(searchParams.get('page') || '1', 10);
25:   const limit = parseInt(searchParams.get('limit') || '50', 10);
26:   const search = searchParams.get('search') || undefined;
27: 
28:   return listChatSessions({ page, limit, search });
29: }
30: 
31: export async function PUT(request: NextRequest) {
32:   const body = await request.json();
33:   return updateChatSession(body);
34: }
35: 
36: export async function DELETE(request: NextRequest) {
37:   const searchParams = request.nextUrl.searchParams;
38:   const id = searchParams.get('id');
39: 
40:   if (!id) {
41:     return new Response('Missing session ID', { status: 400 });
42:   }
43: 
44:   return deleteChatSession({ id });
45: }
46: 
47: // Batch operations route handlers
48: export const batch = {
49:   async DELETE(request: NextRequest) {
50:     const body = await request.json();
51:     return batchDeleteChatSessions(body);
52:   },
53: 
54:   async POST(request: NextRequest) {
55:     const body = await request.json();
56:     const action = request.headers.get('x-batch-action');
57: 
58:     switch (action) {
59:       case 'restore':
60:         return batchRestoreChatSessions(body);
61:       case 'archive':
62:         return batchArchiveChatSessions(body);
63:       case 'update':
64:         return batchUpdateChatSessions(body);
65:       default:
66:         return new Response('Invalid batch action', { status: 400 });
67:     }
68:   }
69: };
70: 
71: // Batch message operations route handlers
72: export const messages = {
73:   async DELETE(request: NextRequest) {
74:     const body = await request.json();
75:     return batchDeleteChatMessages(body);
76:   },
77: 
78:   async POST(request: NextRequest) {
79:     const body = await request.json();
80:     const action = request.headers.get('x-batch-action');
81: 
82:     switch (action) {
83:       case 'restore':
84:         return batchRestoreChatMessages(body);
85:       case 'create':
86:         return batchCreateChatMessages(body);
87:       default:
88:         return new Response('Invalid batch action', { status: 400 });
89:     }
90:   }
91: };
```

## File: apps/web/src/app/chat/page.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect } from 'react'
 4: import { useChatStore } from '@/lib/stores/chat-store'
 5: import { ChatInput } from '@/components/chat/chat-input'
 6: import { ChatMessages } from '@/components/chat/chat-messages'
 7: import { LoadingSpinner } from '@/components/ui/loading-spinner'
 8: import { ChatLayout } from '@/components/chat/chat-layout'
 9: import { Sidebar } from '@/components/chat/sidebar'
10: import { type ChatSession, type Server } from '@/components/chat/types'
11: import { Alert, AlertDescription } from '@danky/ui'
12: import { AlertCircle } from 'lucide-react'
13: 
14: // Mock data for models - replace with real data later
15: const mockModels = [
16:   { id: 'gpt-4', name: 'GPT-4', isFavorite: true },
17:   { id: 'gpt-3.5', name: 'GPT-3.5', isFavorite: true },
18:   { id: 'claude-2', name: 'Claude 2', isFavorite: false },
19:   { id: 'llama-2', name: 'Llama 2', isFavorite: false },
20: ]
21: 
22: export default function ChatPage() {
23:   const { 
24:     messages, 
25:     isInitializing, 
26:     isProcessing, 
27:     error, 
28:     initialize, 
29:     clearError 
30:   } = useChatStore()
31: 
32:   useEffect(() => {
33:     void initialize();
34:   }, [initialize]);
35: 
36:   if (isInitializing) {
37:     return (
38:       <div className="h-full flex items-center justify-center">
39:         <LoadingSpinner />
40:       </div>
41:     )
42:   }
43: 
44:   return (
45:     <div className="h-full">
46:       <ChatLayout
47:         sidebar={
48:           <Sidebar
49:             models={mockModels}
50:             currentModel="claude-2"
51:             onModelSelect={() => {}}
52:             onToggleFavorite={() => {}}
53:             user={{
54:               name: "John Doe",
55:               email: "john@example.com",
56:               isAdmin: true,
57:             }}
58:           />
59:         }
60:       >
61:         <div className="flex h-full flex-col">
62:           {error && (
63:             <Alert variant="destructive" className="m-4">
64:               <AlertCircle className="h-4 w-4" />
65:               <AlertDescription>
66:                 {error}
67:                 <button 
68:                   onClick={clearError}
69:                   className="ml-2 underline hover:no-underline"
70:                 >
71:                   Dismiss
72:                 </button>
73:               </AlertDescription>
74:             </Alert>
75:           )}
76:           <div className="flex-1 overflow-y-auto p-4">
77:             <ChatMessages messages={messages} />
78:           </div>
79:           <div className="border-t p-4">
80:             <ChatInput 
81:               isProcessing={isProcessing}
82:               servers={[]}
83:               onToolSelect={() => {}}
84:             />
85:           </div>
86:         </div>
87:       </ChatLayout>
88:     </div>
89:   )
90: }
```

## File: apps/web/src/app/error.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect } from 'react'
 4: 
 5: export default function Error({
 6:   error,
 7:   reset,
 8: }: {
 9:   error: Error & { digest?: string }
10:   reset: () => void
11: }) {
12:   useEffect(() => {
13:     console.error('Error:', error)
14:   }, [error])
15: 
16:   return (
17:     <div className="flex flex-col items-center justify-center min-h-screen">
18:       <h2 className="text-2xl font-bold mb-4">Something went wrong!</h2>
19:       <button
20:         onClick={() => reset()}
21:         className="px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90"
22:       >
23:         Try again
24:       </button>
25:     </div>
26:   )
27: }
```

## File: apps/web/src/app/globals.css
```css
 1: @tailwind base;
 2: @tailwind components;
 3: @tailwind utilities;
 4: 
 5: @layer base {
 6:   :root {
 7:     --background: 0 0% 100%;
 8:     --foreground: 222.2 84% 4.9%;
 9: 
10:     --card: 0 0% 100%;
11:     --card-foreground: 222.2 84% 4.9%;
12: 
13:     --popover: 0 0% 100%;
14:     --popover-foreground: 222.2 84% 4.9%;
15: 
16:     --primary: 222.2 47.4% 11.2%;
17:     --primary-foreground: 210 40% 98%;
18: 
19:     --secondary: 210 40% 96.1%;
20:     --secondary-foreground: 222.2 47.4% 11.2%;
21: 
22:     --muted: 210 40% 96.1%;
23:     --muted-foreground: 215.4 16.3% 46.9%;
24: 
25:     --accent: 210 40% 96.1%;
26:     --accent-foreground: 222.2 47.4% 11.2%;
27: 
28:     --destructive: 0 84.2% 60.2%;
29:     --destructive-foreground: 210 40% 98%;
30: 
31:     --border: 214.3 31.8% 91.4%;
32:     --input: 214.3 31.8% 91.4%;
33:     --ring: 222.2 84% 4.9%;
34: 
35:     --radius: 0.5rem;
36: 
37:     /* Sidebar specific theme variables */
38:     --sidebar-background: 0 0% 98%;
39:     --sidebar-foreground: 240 5.3% 26.1%;
40:     --sidebar-primary: 240 5.9% 10%;
41:     --sidebar-primary-foreground: 0 0% 98%;
42:     --sidebar-accent: 240 4.8% 95.9%;
43:     --sidebar-accent-foreground: 240 5.9% 10%;
44:     --sidebar-border: 220 13% 91%;
45:     --sidebar-ring: 217.2 91.2% 59.8%;
46:   }
47: 
48:   .dark {
49:     --background: 222.2 84% 4.9%;
50:     --foreground: 210 40% 98%;
51: 
52:     --card: 222.2 84% 4.9%;
53:     --card-foreground: 210 40% 98%;
54: 
55:     --popover: 222.2 84% 4.9%;
56:     --popover-foreground: 210 40% 98%;
57: 
58:     --primary: 210 40% 98%;
59:     --primary-foreground: 222.2 47.4% 11.2%;
60: 
61:     --secondary: 217.2 32.6% 17.5%;
62:     --secondary-foreground: 210 40% 98%;
63: 
64:     --muted: 217.2 32.6% 17.5%;
65:     --muted-foreground: 215 20.2% 65.1%;
66: 
67:     --accent: 217.2 32.6% 17.5%;
68:     --accent-foreground: 210 40% 98%;
69: 
70:     --destructive: 0 62.8% 30.6%;
71:     --destructive-foreground: 210 40% 98%;
72: 
73:     --border: 217.2 32.6% 17.5%;
74:     --input: 217.2 32.6% 17.5%;
75:     --ring: 212.7 26.8% 83.9%;
76: 
77:     /* Sidebar specific dark theme variables */
78:     --sidebar-background: 240 5.9% 10%;
79:     --sidebar-foreground: 240 4.8% 95.9%;
80:     --sidebar-primary: 224.3 76.3% 48%;
81:     --sidebar-primary-foreground: 0 0% 100%;
82:     --sidebar-accent: 240 3.7% 15.9%;
83:     --sidebar-accent-foreground: 240 4.8% 95.9%;
84:     --sidebar-border: 240 3.7% 15.9%;
85:     --sidebar-ring: 217.2 91.2% 59.8%;
86:   }
87: }
88: 
89: @layer base {
90:   * {
91:     @apply border-border;
92:   }
93:   body {
94:     @apply bg-background text-foreground;
95:   }
96: }
```

## File: apps/web/src/app/layout.tsx
```typescript
 1: import React from 'react';
 2: import { Noto_Sans } from 'next/font/google';
 3: import { Metadata, Viewport } from 'next';
 4: import { cn } from '@danky/ui';
 5: import { Providers } from '../components/providers';
 6: import './globals.css';
 7: 
 8: const notoSans = Noto_Sans({
 9:   subsets: ['latin'],
10:   weight: ['400', '500', '600', '700'],
11:   variable: '--font-sans',
12: });
13: 
14: export const metadata: Metadata = {
15:   title: 'Danky',
16:   description: 'AI-powered chat interface',
17: };
18: 
19: export const viewport: Viewport = {
20:   width: 'device-width',
21:   initialScale: 1,
22: };
23: 
24: export default function RootLayout({ children }: { children: React.ReactNode }) {
25:   return (
26:     <html lang="en" suppressHydrationWarning className="h-full">
27:       <head />
28:       <body
29:         className={cn(notoSans.variable, 'bg-background font-sans antialiased', 'h-full w-full')}
30:       >
31:         <Providers>{children}</Providers>
32:       </body>
33:     </html>
34:   );
35: }
```

## File: apps/web/src/app/not-found.tsx
```typescript
1: export default function NotFound() {
2:   return (
3:     <div className="flex flex-col items-center justify-center min-h-screen">
4:       <h2 className="text-2xl font-bold mb-4">404 - Page Not Found</h2>
5:       <p className="text-muted-foreground">The page you're looking for doesn't exist.</p>
6:     </div>
7:   )
8: }
```

## File: apps/web/src/app/page.module.css
```css
  1: .page {
  2:   --gray-rgb: 0, 0, 0;
  3:   --gray-alpha-200: rgba(var(--gray-rgb), 0.08);
  4:   --gray-alpha-100: rgba(var(--gray-rgb), 0.05);
  5: 
  6:   --button-primary-hover: #383838;
  7:   --button-secondary-hover: #f2f2f2;
  8: 
  9:   display: grid;
 10:   grid-template-rows: 20px 1fr 20px;
 11:   align-items: center;
 12:   justify-items: center;
 13:   min-height: 100svh;
 14:   padding: 80px;
 15:   gap: 64px;
 16:   font-synthesis: none;
 17: }
 18: 
 19: @media (prefers-color-scheme: dark) {
 20:   .page {
 21:     --gray-rgb: 255, 255, 255;
 22:     --gray-alpha-200: rgba(var(--gray-rgb), 0.145);
 23:     --gray-alpha-100: rgba(var(--gray-rgb), 0.06);
 24: 
 25:     --button-primary-hover: #ccc;
 26:     --button-secondary-hover: #1a1a1a;
 27:   }
 28: }
 29: 
 30: .main {
 31:   display: flex;
 32:   flex-direction: column;
 33:   gap: 32px;
 34:   grid-row-start: 2;
 35: }
 36: 
 37: .main ol {
 38:   font-family: var(--font-geist-mono);
 39:   padding-left: 0;
 40:   margin: 0;
 41:   font-size: 14px;
 42:   line-height: 24px;
 43:   letter-spacing: -0.01em;
 44:   list-style-position: inside;
 45: }
 46: 
 47: .main li:not(:last-of-type) {
 48:   margin-bottom: 8px;
 49: }
 50: 
 51: .main code {
 52:   font-family: inherit;
 53:   background: var(--gray-alpha-100);
 54:   padding: 2px 4px;
 55:   border-radius: 4px;
 56:   font-weight: 600;
 57: }
 58: 
 59: .ctas {
 60:   display: flex;
 61:   gap: 16px;
 62: }
 63: 
 64: .ctas a {
 65:   appearance: none;
 66:   border-radius: 128px;
 67:   height: 48px;
 68:   padding: 0 20px;
 69:   border: none;
 70:   font-family: var(--font-geist-sans);
 71:   border: 1px solid transparent;
 72:   transition: background 0.2s, color 0.2s, border-color 0.2s;
 73:   cursor: pointer;
 74:   display: flex;
 75:   align-items: center;
 76:   justify-content: center;
 77:   font-size: 16px;
 78:   line-height: 20px;
 79:   font-weight: 500;
 80: }
 81: 
 82: a.primary {
 83:   background: var(--foreground);
 84:   color: var(--background);
 85:   gap: 8px;
 86: }
 87: 
 88: a.secondary {
 89:   border-color: var(--gray-alpha-200);
 90:   min-width: 180px;
 91: }
 92: 
 93: button.secondary {
 94:   appearance: none;
 95:   border-radius: 128px;
 96:   height: 48px;
 97:   padding: 0 20px;
 98:   border: none;
 99:   font-family: var(--font-geist-sans);
100:   border: 1px solid transparent;
101:   transition: background 0.2s, color 0.2s, border-color 0.2s;
102:   cursor: pointer;
103:   display: flex;
104:   align-items: center;
105:   justify-content: center;
106:   font-size: 16px;
107:   line-height: 20px;
108:   font-weight: 500;
109:   background: transparent;
110:   border-color: var(--gray-alpha-200);
111:   min-width: 180px;
112: }
113: 
114: .footer {
115:   font-family: var(--font-geist-sans);
116:   grid-row-start: 3;
117:   display: flex;
118:   gap: 24px;
119: }
120: 
121: .footer a {
122:   display: flex;
123:   align-items: center;
124:   gap: 8px;
125: }
126: 
127: .footer img {
128:   flex-shrink: 0;
129: }
130: 
131: /* Enable hover only on non-touch devices */
132: @media (hover: hover) and (pointer: fine) {
133:   a.primary:hover {
134:     background: var(--button-primary-hover);
135:     border-color: transparent;
136:   }
137: 
138:   a.secondary:hover {
139:     background: var(--button-secondary-hover);
140:     border-color: transparent;
141:   }
142: 
143:   .footer a:hover {
144:     text-decoration: underline;
145:     text-underline-offset: 4px;
146:   }
147: }
148: 
149: @media (max-width: 600px) {
150:   .page {
151:     padding: 32px;
152:     padding-bottom: 80px;
153:   }
154: 
155:   .main {
156:     align-items: center;
157:   }
158: 
159:   .main ol {
160:     text-align: center;
161:   }
162: 
163:   .ctas {
164:     flex-direction: column;
165:   }
166: 
167:   .ctas a {
168:     font-size: 14px;
169:     height: 40px;
170:     padding: 0 16px;
171:   }
172: 
173:   a.secondary {
174:     min-width: auto;
175:   }
176: 
177:   .footer {
178:     flex-wrap: wrap;
179:     align-items: center;
180:     justify-content: center;
181:   }
182: }
183: 
184: @media (prefers-color-scheme: dark) {
185:   .logo {
186:     filter: invert();
187:   }
188: }
```

## File: apps/web/src/app/page.tsx
```typescript
1: import { redirect } from 'next/navigation'
2: 
3: export default function RootPage() {
4:   redirect('/chat')
5: }
```

## File: apps/web/src/app/providers.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ThemeProvider } from 'next-themes'
 4: import { type PropsWithChildren } from 'react'
 5: 
 6: export function Providers({ children }: PropsWithChildren) {
 7:   return (
 8:     <ThemeProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:     >
14:       {children}
15:     </ThemeProvider>
16:   )
17: }
```

## File: apps/web/src/components/chat/attachment-button.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import {
  5:   Button,
  6:   Dialog,
  7:   DialogContent,
  8:   DialogDescription,
  9:   DialogFooter,
 10:   DialogHeader,
 11:   DialogTitle,
 12:   DialogTrigger,
 13:   ScrollArea,
 14: } from '@danky/ui';
 15: import { type DialogProps } from '@radix-ui/react-dialog';
 16: import { Paperclip, File, Folder, X, Upload } from 'lucide-react';
 17: 
 18: interface FilePreview {
 19:   name: string;
 20:   size: number;
 21:   type: string;
 22: }
 23: 
 24: interface AttachmentButtonProps {
 25:   onUpload?: (files: File[]) => Promise<void>;
 26:   maxFiles?: number;
 27:   maxSize?: number; // in bytes
 28:   accept?: string;
 29: }
 30: 
 31: export function AttachmentButton({
 32:   onUpload,
 33:   maxFiles = 10,
 34:   maxSize = 10 * 1024 * 1024, // 10MB
 35:   accept = '*',
 36: }: AttachmentButtonProps) {
 37:   const [files, setFiles] = React.useState<FilePreview[]>([]);
 38:   const [open, setOpen] = React.useState(false);
 39:   const [uploading, setUploading] = React.useState(false);
 40:   const fileInputRef = React.useRef<HTMLInputElement>(null);
 41:   const folderInputRef = React.useRef<HTMLInputElement>(null);
 42: 
 43:   const handleFileChange = React.useCallback(
 44:     (e: React.ChangeEvent<HTMLInputElement>) => {
 45:       const selectedFiles = Array.from(e.target.files || []);
 46:       const validFiles = selectedFiles.filter(file => {
 47:         // Check file size
 48:         if (file.size > maxSize) {
 49:           console.warn(`File ${file.name} is too large (max ${formatFileSize(maxSize)})`);
 50:           return false;
 51:         }
 52:         return true;
 53:       });
 54: 
 55:       if (files.length + validFiles.length > maxFiles) {
 56:         console.warn(`Cannot add more than ${maxFiles} files`);
 57:         return;
 58:       }
 59: 
 60:       const newFiles = validFiles.map(file => ({
 61:         name: file.name,
 62:         size: file.size,
 63:         type: file.type,
 64:       }));
 65: 
 66:       setFiles(prev => [...prev, ...newFiles]);
 67:     },
 68:     [files.length, maxFiles, maxSize]
 69:   );
 70: 
 71:   const removeFile = React.useCallback((fileName: string) => {
 72:     setFiles(files => files.filter(file => file.name !== fileName));
 73:   }, []);
 74: 
 75:   const handleUpload = React.useCallback(async () => {
 76:     if (!onUpload) return;
 77: 
 78:     try {
 79:       setUploading(true);
 80:       // Get the actual File objects from the input refs
 81:       const fileList = fileInputRef.current?.files || [];
 82:       const folderList = folderInputRef.current?.files || [];
 83:       const allFiles = [...Array.from(fileList), ...Array.from(folderList)];
 84: 
 85:       // Filter to only the files that are in our preview list
 86:       const filesToUpload = allFiles.filter(file =>
 87:         files.some(preview => preview.name === file.name)
 88:       );
 89: 
 90:       await onUpload(filesToUpload);
 91:       setFiles([]);
 92:       setOpen(false);
 93:     } catch (error) {
 94:       console.error('Error uploading files:', error);
 95:     } finally {
 96:       setUploading(false);
 97:     }
 98:   }, [files, onUpload]);
 99: 
100:   const formatFileSize = React.useCallback((bytes: number) => {
101:     if (bytes === 0) return '0 Bytes';
102:     const k = 1024;
103:     const sizes = ['Bytes', 'KB', 'MB', 'GB'];
104:     const i = Math.floor(Math.log(bytes) / Math.log(k));
105:     return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
106:   }, []);
107: 
108:   return (
109:     <Dialog open={open} onOpenChange={setOpen}>
110:       <DialogTrigger asChild>
111:         <Button variant="ghost" size="icon" className="h-8 w-8">
112:           <Paperclip className="h-4 w-4" />
113:           <span className="sr-only">Attach files</span>
114:         </Button>
115:       </DialogTrigger>
116:       <DialogContent className="sm:max-w-[425px]">
117:         <DialogHeader>
118:           <DialogTitle>Attach Files</DialogTitle>
119:           <DialogDescription>
120:             Upload files or folders to share in the chat. Maximum {formatFileSize(maxSize)} per
121:             file, {maxFiles} files total.
122:           </DialogDescription>
123:         </DialogHeader>
124:         <div className="grid gap-4 py-4">
125:           <div className="flex items-center gap-4">
126:             <input
127:               type="file"
128:               ref={fileInputRef}
129:               onChange={handleFileChange}
130:               className="hidden"
131:               multiple
132:               accept={accept}
133:             />
134:             <input
135:               type="file"
136:               ref={folderInputRef}
137:               onChange={handleFileChange}
138:               className="hidden"
139:               {...{ webkitdirectory: '', directory: '' }}
140:             />
141:             <Button
142:               variant="secondary"
143:               onClick={() => fileInputRef.current?.click()}
144:               className="flex-1"
145:               disabled={files.length >= maxFiles}
146:             >
147:               <File className="mr-2 h-4 w-4" />
148:               Choose Files
149:             </Button>
150:             <Button
151:               variant="secondary"
152:               onClick={() => folderInputRef.current?.click()}
153:               className="flex-1"
154:               disabled={files.length >= maxFiles}
155:             >
156:               <Folder className="mr-2 h-4 w-4" />
157:               Choose Folder
158:             </Button>
159:           </div>
160:           {files.length > 0 && (
161:             <ScrollArea className="h-[200px] w-full rounded-md border p-4">
162:               <div className="space-y-2">
163:                 {files.map(file => (
164:                   <div
165:                     key={file.name}
166:                     className="flex items-center justify-between gap-2 rounded-lg border p-2 text-sm"
167:                   >
168:                     <div className="flex items-center gap-2 overflow-hidden">
169:                       <File className="h-4 w-4 flex-shrink-0" />
170:                       <span className="truncate">{file.name}</span>
171:                       <span className="text-muted-foreground text-xs">
172:                         ({formatFileSize(file.size)})
173:                       </span>
174:                     </div>
175:                     <Button
176:                       variant="ghost"
177:                       size="icon"
178:                       className="h-6 w-6"
179:                       onClick={() => removeFile(file.name)}
180:                     >
181:                       <X className="h-4 w-4" />
182:                       <span className="sr-only">Remove file</span>
183:                     </Button>
184:                   </div>
185:                 ))}
186:               </div>
187:             </ScrollArea>
188:           )}
189:         </div>
190:         <DialogFooter>
191:           <Button
192:             onClick={() => void handleUpload()}
193:             disabled={files.length === 0 || uploading}
194:             className="w-full sm:w-auto"
195:           >
196:             {uploading ? (
197:               <>Uploading...</>
198:             ) : (
199:               <>
200:                 <Upload className="mr-2 h-4 w-4" />
201:                 Upload {files.length} {files.length === 1 ? 'file' : 'files'}
202:               </>
203:             )}
204:           </Button>
205:         </DialogFooter>
206:       </DialogContent>
207:     </Dialog>
208:   );
209: }
```

## File: apps/web/src/components/chat/chat-input.tsx
```typescript
 1: 'use client';
 2: 
 3: import React from 'react';
 4: import { useState } from 'react';
 5: import { useChatStore } from '@/lib/stores/chat-store';
 6: import { Textarea, buttonVariants, cn } from '@danky/ui';
 7: import { SendHorizontal, Loader2 } from 'lucide-react';
 8: import { AttachmentButton } from './attachment-button';
 9: import { ToolsDropdown } from './tools-dropdown';
10: import { type Server } from './types';
11: 
12: interface ChatInputProps {
13:   isProcessing: boolean;
14:   servers?: Server[];
15:   onToolSelect?: (serverId: string, toolId: string) => void;
16: }
17: 
18: export function ChatInput({ isProcessing, servers = [], onToolSelect = () => {} }: ChatInputProps) {
19:   const [input, setInput] = useState('');
20:   const sendMessage = useChatStore(state => state.sendMessage);
21: 
22:   const handleSubmit = async (event: React.FormEvent) => {
23:     event.preventDefault();
24:     if (!input.trim() || isProcessing) return;
25: 
26:     const message = input.trim();
27:     setInput('');
28:     await sendMessage(message);
29:   };
30: 
31:   const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {
32:     if (e.key === 'Enter' && !e.shiftKey) {
33:       e.preventDefault();
34:       void handleSubmit(e);
35:     }
36:   };
37: 
38:   return (
39:     <form onSubmit={handleSubmit} className="relative flex items-center gap-2">
40:       <AttachmentButton />
41:       <div className="relative flex-1">
42:         <Textarea
43:           value={input}
44:           onChange={e => setInput(e.target.value)}
45:           onKeyDown={handleKeyDown}
46:           placeholder="Type a message..."
47:           disabled={isProcessing}
48:           className="min-h-[48px] w-full resize-none rounded-lg pr-24"
49:         />
50:         <div className="absolute bottom-2 right-2 flex items-center gap-2">
51:           <ToolsDropdown servers={servers} onToolSelect={onToolSelect} isLoading={isProcessing} />
52:           <button
53:             type="submit"
54:             disabled={isProcessing || !input.trim()}
55:             className={cn(buttonVariants({ variant: 'default', size: 'icon' }), 'h-8 w-8')}
56:           >
57:             {isProcessing ? (
58:               <Loader2 className="h-4 w-4 animate-spin" />
59:             ) : (
60:               <SendHorizontal className="h-4 w-4" />
61:             )}
62:             <span className="sr-only">Send message</span>
63:           </button>
64:         </div>
65:       </div>
66:     </form>
67:   );
68: }
```

## File: apps/web/src/components/chat/chat-layout.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ReactNode } from 'react'
 4: 
 5: interface ChatLayoutProps {
 6:   children: ReactNode
 7:   sidebar: ReactNode
 8: }
 9: 
10: export function ChatLayout({ children, sidebar }: ChatLayoutProps) {
11:   return (
12:     <div className="flex h-screen">
13:       <div className="w-64 border-r bg-background">
14:         {sidebar}
15:       </div>
16:       <div className="flex-1">
17:         {children}
18:       </div>
19:     </div>
20:   )
21: }
```

## File: apps/web/src/components/chat/chat-messages.tsx
```typescript
 1: 'use client';
 2: 
 3: import React from 'react';
 4: import { ScrollArea } from '@danky/ui';
 5: import { Message } from './message';
 6: import { useChat } from '@/hooks/use-chat';
 7: 
 8: export function ChatMessages() {
 9:   const { messages } = useChat();
10: 
11:   return (
12:     <ScrollArea className="flex-1 p-4">
13:       {messages.map(message => (
14:         <Message key={message.id} message={message} />
15:       ))}
16:     </ScrollArea>
17:   );
18: }
```

## File: apps/web/src/components/chat/message-content.tsx
```typescript
 1: "use client"
 2: 
 3: import { getHighlighter, type Highlighter, bundledLanguages } from 'shiki'
 4: import { useTheme } from 'next-themes'
 5: import { useEffect, useState } from 'react'
 6: 
 7: interface MessageContentProps {
 8:   content: string
 9:   language?: string
10:   fileName?: string
11:   lineNumbers?: boolean
12: }
13: 
14: export function MessageContent({
15:   content,
16:   language = 'text',
17:   fileName,
18:   lineNumbers = true
19: }: MessageContentProps) {
20:   const { theme } = useTheme()
21:   const [highlighter, setHighlighter] = useState<Highlighter | null>(null)
22: 
23:   useEffect(() => {
24:     getHighlighter({
25:       themes: [theme === 'dark' ? 'github-dark' : 'github-light'],
26:       langs: Object.keys(bundledLanguages),
27:     }).then(setHighlighter)
28:   }, [theme])
29: 
30:   if (!highlighter) {
31:     return (
32:       <pre className="whitespace-pre-wrap break-words">
33:         <code>{content}</code>
34:       </pre>
35:     )
36:   }
37: 
38:   const html = highlighter.codeToHtml(content, {
39:     lang: language,
40:     theme: theme === 'dark' ? 'github-dark' : 'github-light',
41:   })
42: 
43:   return (
44:     <div className="relative rounded-lg bg-muted/50 p-4">
45:       {fileName && (
46:         <div className="mb-2 text-sm text-muted-foreground">
47:           {fileName}
48:         </div>
49:       )}
50:       <div
51:         dangerouslySetInnerHTML={{ __html: html }}
52:         className="not-prose overflow-x-auto"
53:         style={{
54:           maxHeight: '400px',
55:         }}
56:       />
57:     </div>
58:   )
59: }
```

## File: apps/web/src/components/chat/message.tsx
```typescript
 1: 'use client';
 2: 
 3: import React from 'react';
 4: import { cn } from '@danky/ui';
 5: import { MessageContent } from './message-content';
 6: import type { Message as MessageType } from './types';
 7: 
 8: interface MessageProps {
 9:   message: MessageType;
10:   className?: string;
11: }
12: 
13: export function Message({ message, className }: MessageProps) {
14:   const isUser = message.role === 'user';
15: 
16:   return (
17:     <div
18:       className={cn('flex w-full gap-2 py-2', isUser ? 'flex-row-reverse' : 'flex-row', className)}
19:     >
20:       <div
21:         className={cn(
22:           'flex max-w-[80%] flex-col gap-2 rounded-lg p-4',
23:           isUser ? 'bg-primary text-primary-foreground' : 'bg-muted'
24:         )}
25:       >
26:         <MessageContent content={message.content} />
27:       </div>
28:     </div>
29:   );
30: }
```

## File: apps/web/src/components/chat/notifications-popover.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { Bell } from 'lucide-react';
 5: import { Popover, PopoverContent, PopoverTrigger, Button, ScrollArea } from '@danky/ui';
 6: import { type PopoverProps } from '@radix-ui/react-popover';
 7: 
 8: export function NotificationsPopover() {
 9:   const [isOpen, setIsOpen] = React.useState(false);
10: 
11:   return (
12:     <Popover open={isOpen} onOpenChange={setIsOpen}>
13:       <PopoverTrigger asChild>
14:         <Button
15:           variant="ghost"
16:           size="icon"
17:           className="relative h-8 w-8"
18:           aria-label="Open notifications"
19:         >
20:           <Bell className="h-4 w-4" />
21:           {/* Add notification badge here when needed */}
22:         </Button>
23:       </PopoverTrigger>
24:       <PopoverContent className="w-[380px] p-0" align="end">
25:         <div className="flex items-center justify-between border-b px-4 py-2">
26:           <h4 className="font-semibold">Notifications</h4>
27:           <Button variant="ghost" className="text-xs" onClick={() => setIsOpen(false)}>
28:             Mark all as read
29:           </Button>
30:         </div>
31:         <ScrollArea className="h-[400px]">
32:           <div className="flex flex-col gap-1 p-2">
33:             {/* Add notification items here */}
34:             <div className="text-muted-foreground p-4 text-center text-sm">
35:               No new notifications
36:             </div>
37:           </div>
38:         </ScrollArea>
39:       </PopoverContent>
40:     </Popover>
41:   );
42: }
```

## File: apps/web/src/components/chat/README.md
```markdown
  1: # Chat Components
  2: 
  3: React components for the chat interface in the Danky AI Chatbot platform.
  4: 
  5: ## Overview
  6: 
  7: The chat components handle the real-time chat interface, message rendering, input handling, and chat-specific UI elements.
  8: 
  9: ## Components
 10: 
 11: ### Core Components
 12: - `ChatLayout`: Main chat interface layout
 13: - `ChatMessages`: Message list container
 14: - `Message`: Individual message component
 15: - `MessageContent`: Message content renderer
 16: - `ChatInput`: Message input component
 17: 
 18: ### Supporting Components
 19: - `AttachmentButton`: File attachment handling
 20: - `ToolsDropdown`: AI tool selection
 21: - `NotificationsPopover`: Chat notifications
 22: - `SessionList`: Chat session management
 23: - `ThemeToggle`: Theme switching
 24: 
 25: ## State Management
 26: 
 27: ### Chat Store
 28: ```typescript
 29: interface ChatState {
 30:   messages: Message[]
 31:   sessions: Session[]
 32:   currentSession: Session | null
 33:   isLoading: boolean
 34:   error: Error | null
 35: }
 36: ```
 37: 
 38: ### Actions
 39: - `sendMessage`: Send new message
 40: - `loadSession`: Load chat session
 41: - `clearSession`: Clear current session
 42: - `attachFile`: Handle file attachments
 43: - `selectTool`: Select AI tool
 44: 
 45: ## AI Development Notes
 46: 
 47: ### Key Concepts
 48: 
 49: 1. **Message Handling**
 50:    - Message formatting
 51:    - Markdown support
 52:    - Code highlighting
 53:    - File attachments
 54: 
 55: 2. **Session Management**
 56:    - Session persistence
 57:    - Session switching
 58:    - Session metadata
 59:    - Session cleanup
 60: 
 61: 3. **Tool Integration**
 62:    - Tool selection
 63:    - Tool execution
 64:    - Tool results
 65:    - Error handling
 66: 
 67: ### Common Patterns
 68: 
 69: #### Message Rendering
 70: ```tsx
 71: function Message({ message }: { message: Message }) {
 72:   return (
 73:     <div className="message">
 74:       <Avatar user={message.user} />
 75:       <MessageContent content={message.content} />
 76:       <MessageActions message={message} />
 77:     </div>
 78:   )
 79: }
 80: ```
 81: 
 82: #### Input Handling
 83: ```tsx
 84: function ChatInput({ onSubmit }: { onSubmit: (text: string) => void }) {
 85:   const [text, setText] = useState('')
 86: 
 87:   const handleSubmit = (e: FormEvent) => {
 88:     e.preventDefault()
 89:     onSubmit(text)
 90:     setText('')
 91:   }
 92: 
 93:   return (
 94:     <form onSubmit={handleSubmit}>
 95:       <textarea value={text} onChange={(e) => setText(e.target.value)} />
 96:       <button type="submit">Send</button>
 97:     </form>
 98:   )
 99: }
100: ```
101: 
102: #### Session Loading
103: ```tsx
104: function SessionList() {
105:   const sessions = useStore(state => state.sessions)
106:   const loadSession = useStore(state => state.loadSession)
107: 
108:   return (
109:     <div className="sessions">
110:       {sessions.map(session => (
111:         <button key={session.id} onClick={() => loadSession(session.id)}>
112:           {session.title}
113:         </button>
114:       ))}
115:     </div>
116:   )
117: }
118: ```
119: 
120: ## Component Library
121: 
122: ### Message Components
123: - `Message`: Base message component
124: - `UserMessage`: User message variant
125: - `AIMessage`: AI message variant
126: - `SystemMessage`: System message variant
127: - `ErrorMessage`: Error message variant
128: 
129: ### Input Components
130: - `ChatInput`: Main input component
131: - `AttachmentButton`: File upload button
132: - `ToolsDropdown`: Tool selection dropdown
133: - `SendButton`: Message send button
134: - `CancelButton`: Cancel operation button
135: 
136: ### Session Components
137: - `SessionList`: Session list component
138: - `SessionItem`: Individual session item
139: - `SessionHeader`: Session header with metadata
140: - `SessionActions`: Session action buttons
141: - `NewSessionButton`: Create new session
142: 
143: ## Development
144: 
145: ### Adding New Components
146: 
147: 1. Create component file:
148: ```tsx
149: // src/components/chat/my-component.tsx
150: export function MyComponent() {
151:   return <div>New Component</div>
152: }
153: ```
154: 
155: 2. Add to index:
156: ```typescript
157: // src/components/chat/index.ts
158: export * from './my-component'
159: ```
160: 
161: ### Testing
162: ```bash
163: pnpm test
164: pnpm test:watch
165: ```
166: 
167: ### Storybook
168: ```bash
169: pnpm storybook
170: ```
171: 
172: ## Styling
173: 
174: ### CSS Modules
175: ```css
176: /* styles.module.css */
177: .message {
178:   @apply flex items-start gap-4 p-4;
179: }
180: 
181: .userMessage {
182:   @apply bg-primary/10;
183: }
184: 
185: .aiMessage {
186:   @apply bg-secondary/10;
187: }
188: ```
189: 
190: ### Theme Variables
191: ```css
192: :root {
193:   --chat-bg: hsl(var(--background));
194:   --message-bg: hsl(var(--secondary));
195:   --input-bg: hsl(var(--background));
196: }
197: ```
198: 
199: ## Additional Resources
200: 
201: - [Chat System Design](../../../docs/CHAT_SYSTEM.md)
202: - [Message Format Spec](../../../docs/MESSAGE_FORMAT.md)
203: - [Tool Integration Guide](../../../docs/TOOLS.md)
204: - [Session Management](../../../docs/SESSIONS.md)
```

## File: apps/web/src/components/chat/search.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import {
  5:   CommandDialog,
  6:   CommandEmpty,
  7:   CommandGroup,
  8:   CommandInput,
  9:   CommandItem,
 10:   CommandList,
 11:   CommandSeparator,
 12:   Button,
 13:   DialogTitle,
 14: } from "@danky/ui"
 15: import { type DialogProps } from "@radix-ui/react-dialog"
 16: import { Search as SearchIcon } from "lucide-react"
 17: 
 18: interface SearchResult {
 19:   id: string
 20:   title: string
 21:   type: 'conversation' | 'tool'
 22:   category?: string
 23: }
 24: 
 25: interface SearchProps {
 26:   recentConversations?: SearchResult[]
 27:   availableTools?: SearchResult[]
 28:   onSelect?: (result: SearchResult) => void
 29: }
 30: 
 31: export function Search({
 32:   recentConversations = [],
 33:   availableTools = [],
 34:   onSelect = () => {},
 35: }: SearchProps) {
 36:   const [open, setOpen] = React.useState(false)
 37: 
 38:   React.useEffect(() => {
 39:     const down = (e: KeyboardEvent) => {
 40:       if (e.key === "k" && (e.metaKey || e.ctrlKey)) {
 41:         e.preventDefault()
 42:         setOpen((open) => !open)
 43:       }
 44:     }
 45:     document.addEventListener("keydown", down)
 46:     return () => document.removeEventListener("keydown", down)
 47:   }, [])
 48: 
 49:   const handleSelect = React.useCallback((result: SearchResult) => {
 50:     onSelect(result)
 51:     setOpen(false)
 52:   }, [onSelect])
 53: 
 54:   return (
 55:     <>
 56:       <Button
 57:         variant="outline"
 58:         className="relative h-8 w-full justify-start text-sm text-muted-foreground
 59:           hover:border-muted-foreground/50 transition-colors
 60:           focus-visible:ring-offset-2 focus-visible:ring-2 focus-visible:ring-ring
 61:           group"
 62:         onClick={() => setOpen(true)}
 63:       >
 64:         <SearchIcon className="mr-2 h-4 w-4 shrink-0 group-hover:text-foreground/80 transition-colors" />
 65:         <span className="inline-flex items-center">
 66:           Search messages...
 67:           <span className="ml-2 text-xs text-muted-foreground/50">
 68:             (Press ⌘K)
 69:           </span>
 70:         </span>
 71:         <kbd className="pointer-events-none absolute right-1.5 top-1.5 hidden h-5 select-none items-center gap-1 rounded border bg-muted/50 px-1.5 font-mono text-[10px] font-medium opacity-100 transition-colors group-hover:bg-muted sm:flex">
 72:           <span className="text-xs">⌘</span>K
 73:         </kbd>
 74:       </Button>
 75:       <CommandDialog open={open} onOpenChange={setOpen}>
 76:         <DialogTitle className="sr-only">Search</DialogTitle>
 77:         <CommandInput
 78:           placeholder="Type a command or search..."
 79:           className="border-none focus-visible:ring-0"
 80:         />
 81:         <CommandList>
 82:           <CommandEmpty>No results found.</CommandEmpty>
 83:           {recentConversations.length > 0 && (
 84:             <>
 85:               <CommandGroup heading="Recent Conversations">
 86:                 {recentConversations.map((conversation) => (
 87:                   <CommandItem
 88:                     key={conversation.id}
 89:                     className="hover:bg-muted/80 cursor-pointer"
 90:                     onSelect={() => handleSelect(conversation)}
 91:                   >
 92:                     {conversation.title}
 93:                   </CommandItem>
 94:                 ))}
 95:               </CommandGroup>
 96:               <CommandSeparator className="bg-border/50" />
 97:             </>
 98:           )}
 99:           {availableTools.length > 0 && (
100:             <CommandGroup heading="Tools">
101:               {availableTools.map((tool) => (
102:                 <CommandItem
103:                   key={tool.id}
104:                   className="hover:bg-muted/80 cursor-pointer"
105:                   onSelect={() => handleSelect(tool)}
106:                 >
107:                   {tool.title}
108:                 </CommandItem>
109:               ))}
110:             </CommandGroup>
111:           )}
112:         </CommandList>
113:       </CommandDialog>
114:     </>
115:   )
116: }
```

## File: apps/web/src/components/chat/session-list.tsx
```typescript
 1: "use client"
 2: 
 3: import { ScrollArea, cn } from "@danky/ui"
 4: import { type ChatSession } from "./types"
 5: import { MessageSquare } from "lucide-react"
 6: 
 7: interface ChatSessionListProps {
 8:   sessions: ChatSession[]
 9:   onSelectSession?: (session: ChatSession) => void
10:   currentSessionId?: string
11: }
12: 
13: export function ChatSessionList({ 
14:   sessions, 
15:   onSelectSession,
16:   currentSessionId 
17: }: ChatSessionListProps) {
18:   return (
19:     <ScrollArea className="h-full">
20:       <div className="flex flex-col gap-0.5 p-2">
21:         {sessions.map((session) => (
22:           <button
23:             key={session.id}
24:             onClick={() => onSelectSession?.(session)}
25:             className={cn(
26:               "flex items-start gap-3 p-3 w-full text-left rounded-lg transition-colors",
27:               "hover:bg-accent/50",
28:               session.id === currentSessionId && "bg-accent",
29:               "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
30:             )}
31:           >
32:             <MessageSquare className="h-5 w-5 mt-0.5 text-muted-foreground shrink-0" />
33:             <div className="min-w-0 flex-1">
34:               <div className="mb-1 font-medium truncate">
35:                 {session.title}
36:               </div>
37:               <div className="text-sm text-muted-foreground truncate">
38:                 {session.lastMessage}
39:               </div>
40:             </div>
41:           </button>
42:         ))}
43:       </div>
44:     </ScrollArea>
45:   )
46: }
```

## File: apps/web/src/components/chat/sidebar.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import {
  5:   Button,
  6:   DropdownMenu,
  7:   DropdownMenuContent,
  8:   DropdownMenuItem,
  9:   DropdownMenuLabel,
 10:   DropdownMenuSeparator,
 11:   DropdownMenuTrigger,
 12:   ScrollArea,
 13:   Avatar,
 14:   AvatarFallback,
 15:   AvatarImage,
 16:   type ButtonProps,
 17:   type DropdownMenuContentProps,
 18:   type DropdownMenuItemProps,
 19:   type DropdownMenuLabelProps,
 20:   type AvatarProps,
 21:   type AvatarImageProps,
 22:   type AvatarFallbackProps,
 23:   type ScrollAreaProps,
 24: } from "@danky/ui"
 25: import {
 26:   ChevronDown,
 27:   Star,
 28:   MessageSquare,
 29:   LayoutDashboard,
 30:   Brain,
 31:   Sparkles,
 32:   ListTodo,
 33:   FileText,
 34:   Settings,
 35:   Shield,
 36:   LogOut,
 37: } from "lucide-react"
 38: import { cn } from "@danky/ui/utils"
 39: import Link from "next/link"
 40: import { usePathname } from "next/navigation"
 41: 
 42: interface NavItem {
 43:   title: string
 44:   href: string
 45:   icon: React.ReactNode
 46: }
 47: 
 48: interface Model {
 49:   id: string
 50:   name: string
 51:   isFavorite: boolean
 52: }
 53: 
 54: interface SidebarProps {
 55:   user?: {
 56:     name: string
 57:     email: string
 58:     image?: string
 59:     isAdmin?: boolean
 60:   }
 61:   models?: Model[]
 62:   currentModel?: string
 63:   onModelSelect?: (modelId: string) => void
 64:   onToggleFavorite?: (modelId: string) => void
 65: }
 66: 
 67: const navItems: NavItem[] = [
 68:   {
 69:     title: "Messages",
 70:     href: "/chat",
 71:     icon: <MessageSquare className="h-4 w-4" />,
 72:   },
 73:   {
 74:     title: "Dashboard",
 75:     href: "/dashboard",
 76:     icon: <LayoutDashboard className="h-4 w-4" />,
 77:   },
 78:   {
 79:     title: "Knowledge",
 80:     href: "/knowledge",
 81:     icon: <Brain className="h-4 w-4" />,
 82:   },
 83:   {
 84:     title: "Prompts",
 85:     href: "/prompts",
 86:     icon: <Sparkles className="h-4 w-4" />,
 87:   },
 88:   {
 89:     title: "Tasks",
 90:     href: "/tasks",
 91:     icon: <ListTodo className="h-4 w-4" />,
 92:   },
 93:   {
 94:     title: "Documentation",
 95:     href: "/docs",
 96:     icon: <FileText className="h-4 w-4" />,
 97:   },
 98: ]
 99: 
100: export function Sidebar({
101:   user = {
102:     name: "John Doe",
103:     email: "john@example.com",
104:     isAdmin: true,
105:   },
106:   models = [],
107:   currentModel = "",
108:   onModelSelect = () => {},
109:   onToggleFavorite = () => {},
110: }: SidebarProps) {
111:   const pathname = usePathname()
112: 
113:   const favoriteModels = models.filter(m => m.isFavorite)
114:   const otherModels = models.filter(m => !m.isFavorite)
115:   const currentModelData = models.find(m => m.id === currentModel)
116: 
117:   const handleToggleFavorite = React.useCallback((e: React.MouseEvent<SVGElement>, modelId: string) => {
118:     e.stopPropagation()
119:     onToggleFavorite(modelId)
120:   }, [onToggleFavorite])
121: 
122:   return (
123:     <div className="flex h-full flex-col gap-2">
124:       <div className="flex flex-col gap-2 p-4">
125:         <DropdownMenu>
126:           <DropdownMenuTrigger asChild>
127:             <Button
128:               variant="ghost"
129:               className="h-10 w-full justify-between px-4 hover:bg-accent"
130:             >
131:               <div className="flex items-center gap-2">
132:                 <Avatar className="h-6 w-6">
133:                   <AvatarImage src="/bot-avatar.png" alt="AI Model" />
134:                   <AvatarFallback>AI</AvatarFallback>
135:                 </Avatar>
136:                 <span className="text-sm font-medium">
137:                   {currentModelData?.name || "Select Model"}
138:                 </span>
139:               </div>
140:               <ChevronDown className="h-4 w-4 opacity-50" />
141:             </Button>
142:           </DropdownMenuTrigger>
143:           <DropdownMenuContent className="w-[240px]" align="start">
144:             <DropdownMenuLabel>AI Models</DropdownMenuLabel>
145:             <DropdownMenuSeparator />
146:             {favoriteModels.length > 0 && (
147:               <>
148:                 <DropdownMenuLabel className="text-xs font-normal text-muted-foreground">
149:                   Favorites
150:                 </DropdownMenuLabel>
151:                 {favoriteModels.map((model) => (
152:                   <DropdownMenuItem
153:                     key={model.id}
154:                     onClick={() => onModelSelect(model.id)}
155:                     className="justify-between"
156:                   >
157:                     <span>{model.name}</span>
158:                     <Star
159:                       className="h-4 w-4 text-yellow-400 cursor-pointer"
160:                       onClick={(e) => handleToggleFavorite(e, model.id)}
161:                       fill="currentColor"
162:                     />
163:                   </DropdownMenuItem>
164:                 ))}
165:                 <DropdownMenuSeparator />
166:               </>
167:             )}
168:             {otherModels.map((model) => (
169:               <DropdownMenuItem
170:                 key={model.id}
171:                 onClick={() => onModelSelect(model.id)}
172:                 className="justify-between"
173:               >
174:                 <span>{model.name}</span>
175:                 <Star
176:                   className="h-4 w-4 text-muted-foreground cursor-pointer hover:text-yellow-400"
177:                   onClick={(e) => handleToggleFavorite(e, model.id)}
178:                 />
179:               </DropdownMenuItem>
180:             ))}
181:           </DropdownMenuContent>
182:         </DropdownMenu>
183:       </div>
184: 
185:       <ScrollArea className="flex-1 px-2">
186:         <div className="space-y-1 p-2">
187:           {navItems.map((item) => (
188:             <Link key={item.href} href={item.href}>
189:               <Button
190:                 variant="ghost"
191:                 className={cn(
192:                   "w-full justify-start",
193:                   pathname === item.href && "bg-accent"
194:                 )}
195:               >
196:                 {item.icon}
197:                 <span className="ml-2">{item.title}</span>
198:               </Button>
199:             </Link>
200:           ))}
201:         </div>
202:       </ScrollArea>
203: 
204:       <div className="mt-auto p-4">
205:         <DropdownMenu>
206:           <DropdownMenuTrigger asChild>
207:             <Button
208:               variant="ghost"
209:               className="h-12 w-full justify-start px-4 hover:bg-accent"
210:             >
211:               <Avatar className="h-8 w-8">
212:                 <AvatarImage src={user.image} alt={user.name} />
213:                 <AvatarFallback>
214:                   {user.name
215:                     .split(" ")
216:                     .map((n) => n[0])
217:                     .join("")}
218:                 </AvatarFallback>
219:               </Avatar>
220:               <div className="ml-2 flex flex-col items-start text-left">
221:                 <span className="text-sm font-medium">{user.name}</span>
222:                 <span className="text-xs text-muted-foreground">
223:                   {user.email}
224:                 </span>
225:               </div>
226:             </Button>
227:           </DropdownMenuTrigger>
228:           <DropdownMenuContent className="w-[240px]" align="end">
229:             <DropdownMenuItem>
230:               <Settings className="mr-2 h-4 w-4" />
231:               <span>Settings</span>
232:             </DropdownMenuItem>
233:             {user.isAdmin && (
234:               <DropdownMenuItem>
235:                 <Shield className="mr-2 h-4 w-4" />
236:                 <span>Admin Panel</span>
237:               </DropdownMenuItem>
238:             )}
239:             <DropdownMenuSeparator />
240:             <DropdownMenuItem className="text-red-600">
241:               <LogOut className="mr-2 h-4 w-4" />
242:               <span>Log out</span>
243:             </DropdownMenuItem>
244:           </DropdownMenuContent>
245:         </DropdownMenu>
246:       </div>
247:     </div>
248:   )
249: }
```

## File: apps/web/src/components/chat/tools-dropdown.tsx
```typescript
  1: "use client"
  2: 
  3: import {
  4:   DropdownMenu,
  5:   DropdownMenuContent,
  6:   DropdownMenuItem,
  7:   DropdownMenuTrigger,
  8:   DropdownMenuSeparator,
  9:   Button,
 10:   Badge,
 11: } from "@danky/ui"
 12: import { cn } from "@danky/ui/utils"
 13: import { type Server } from "./types"
 14: import { Wrench, CircleDot, Loader2, AlertCircle } from "lucide-react"
 15: 
 16: interface ToolsDropdownProps {
 17:   servers: Server[]
 18:   onToolSelect: (serverId: string, toolId: string) => void
 19:   isLoading?: boolean
 20: }
 21: 
 22: export function ToolsDropdown({ servers, onToolSelect, isLoading = false }: ToolsDropdownProps) {
 23:   const hasServers = servers.length > 0
 24:   const connectedServers = servers.filter(s => s.status === "connected")
 25: 
 26:   return (
 27:     <DropdownMenu>
 28:       <DropdownMenuTrigger asChild>
 29:         <Button
 30:           variant="outline"
 31:           size="icon"
 32:           className={cn(
 33:             "relative transition-colors",
 34:             hasServers && "text-primary border-primary hover:bg-primary/10"
 35:           )}
 36:           disabled={isLoading}
 37:         >
 38:           {isLoading ? (
 39:             <Loader2 className="h-4 w-4 animate-spin" />
 40:           ) : (
 41:             <>
 42:               <Wrench className="h-4 w-4" />
 43:               {hasServers && (
 44:                 <Badge
 45:                   variant="default"
 46:                   className={cn(
 47:                     "absolute -top-1 -right-1 h-4 w-4 p-0 flex items-center justify-center",
 48:                     "animate-in zoom-in-50 duration-300"
 49:                   )}
 50:                 >
 51:                   {connectedServers.length}
 52:                 </Badge>
 53:               )}
 54:             </>
 55:           )}
 56:           <span className="sr-only">Available tools</span>
 57:         </Button>
 58:       </DropdownMenuTrigger>
 59: 
 60:       <DropdownMenuContent
 61:         align="end"
 62:         className="w-72"
 63:         sideOffset={8}
 64:       >
 65:         {isLoading ? (
 66:           <div className="p-4 text-sm text-center flex items-center justify-center gap-2">
 67:             <Loader2 className="h-4 w-4 animate-spin" />
 68:             <span>Connecting to servers...</span>
 69:           </div>
 70:         ) : !hasServers ? (
 71:           <div className="p-4 text-sm text-center flex flex-col items-center gap-2 text-muted-foreground">
 72:             <AlertCircle className="h-5 w-5" />
 73:             <span>No servers available</span>
 74:           </div>
 75:         ) : connectedServers.length === 0 ? (
 76:           <div className="p-4 text-sm text-center flex flex-col items-center gap-2 text-muted-foreground">
 77:             <Loader2 className="h-5 w-5 animate-spin" />
 78:             <span>Waiting for servers to connect...</span>
 79:           </div>
 80:         ) : (
 81:           <>
 82:             {connectedServers.map((server) => (
 83:               <div key={server.id} className="animate-in fade-in-50 duration-200">
 84:                 <div className="px-2 py-1.5 text-sm font-medium flex items-center gap-2">
 85:                   <CircleDot className="h-3 w-3 text-primary animate-pulse" />
 86:                   {server.name}
 87:                 </div>
 88: 
 89:                 {server.tools.map((tool) => (
 90:                   <DropdownMenuItem
 91:                     key={tool.id}
 92:                     onClick={() => onToolSelect(server.id, tool.id)}
 93:                     className="flex flex-col items-start gap-0.5 pl-7 cursor-pointer"
 94:                   >
 95:                     <span className="font-medium">{tool.name}</span>
 96:                     <span className="text-xs text-muted-foreground line-clamp-2">
 97:                       {tool.description}
 98:                     </span>
 99:                   </DropdownMenuItem>
100:                 ))}
101:                 <DropdownMenuSeparator />
102:               </div>
103:             ))}
104:           </>
105:         )}
106:       </DropdownMenuContent>
107:     </DropdownMenu>
108:   )
109: }
```

## File: apps/web/src/components/chat/types.ts
```typescript
 1: import { type MessageRole } from '@danky/schema'
 2: 
 3: export type ContentType =
 4:   | { type: 'text'; content: string }
 5:   | { type: 'code'; content: string; language: string; fileName?: string; lineNumbers?: boolean }
 6:   | { type: 'image'; content: string; mimeType: string; width?: number; height?: number; altText?: string }
 7:   | { type: 'file'; content: string; mimeType: string; fileName: string; fileSize: number; checksum?: string }
 8: 
 9: export interface Message {
10:   role: MessageRole
11:   content: ContentType[]
12:   timestamp: Date
13: }
14: 
15: export interface ChatSession {
16:   id: string
17:   title: string
18:   lastMessage: string
19:   timestamp: Date
20: }
21: 
22: export interface Tool {
23:   id: string
24:   name: string
25:   description: string
26:   category?: string
27:   icon?: string
28: }
29: 
30: export interface Server {
31:   id: string
32:   name: string
33:   status: "connected" | "disconnected" | "error"
34:   tools: Tool[]
35:   error?: string
36: }
37: 
38: export type ChatStatus = "idle" | "loading" | "error"
39: 
40: export interface ChatState {
41:   messages: Message[]
42:   sessions: ChatSession[]
43:   currentSession: string | null
44:   status: ChatStatus
45:   error: string | null
46: }
47: 
48: export interface ChatAction {
49:   type:
50:     | "SET_MESSAGES"
51:     | "ADD_MESSAGE"
52:     | "SET_SESSIONS"
53:     | "ADD_SESSION"
54:     | "SET_CURRENT_SESSION"
55:     | "SET_STATUS"
56:     | "SET_ERROR"
57:   payload: unknown
58: }
```

## File: apps/web/src/components/chat/user-nav.tsx
```typescript
  1: "use client"
  2: 
  3: import {
  4:   Avatar,
  5:   AvatarFallback,
  6:   AvatarImage,
  7:   Button,
  8:   DropdownMenu,
  9:   DropdownMenuContent,
 10:   DropdownMenuGroup,
 11:   DropdownMenuItem,
 12:   DropdownMenuLabel,
 13:   DropdownMenuSeparator,
 14:   DropdownMenuShortcut,
 15:   DropdownMenuTrigger,
 16: } from "@danky/ui"
 17: import {
 18:   User,
 19:   Settings,
 20:   FileText,
 21:   Shield,
 22:   LogOut,
 23:   HelpCircle,
 24: } from "lucide-react"
 25: 
 26: interface UserNavProps {
 27:   user?: {
 28:     name: string
 29:     email: string
 30:     image?: string
 31:     isAdmin?: boolean
 32:   }
 33:   onLogout?: () => void
 34:   onProfileClick?: () => void
 35:   onSettingsClick?: () => void
 36: }
 37: 
 38: export function UserNav({
 39:   user = {
 40:     name: "John Doe",
 41:     email: "john@example.com",
 42:     isAdmin: true,
 43:   },
 44:   onLogout = () => {},
 45:   onProfileClick = () => {},
 46:   onSettingsClick = () => {},
 47: }: UserNavProps) {
 48:   return (
 49:     <DropdownMenu>
 50:       <DropdownMenuTrigger asChild>
 51:         <Button variant="ghost" className="relative h-8 w-8 rounded-full">
 52:           <Avatar className="h-8 w-8">
 53:             <AvatarImage src={user.image || "/avatar.png"} alt={`${user.name}'s avatar`} />
 54:             <AvatarFallback>
 55:               {user.name
 56:                 .split(" ")
 57:                 .map((n) => n[0])
 58:                 .join("")}
 59:             </AvatarFallback>
 60:           </Avatar>
 61:         </Button>
 62:       </DropdownMenuTrigger>
 63:       <DropdownMenuContent className="w-56" align="end" forceMount>
 64:         <DropdownMenuLabel className="font-normal">
 65:           <div className="flex flex-col space-y-1">
 66:             <p className="text-sm font-medium leading-none">{user.name}</p>
 67:             <p className="text-xs leading-none text-muted-foreground">
 68:               {user.email}
 69:             </p>
 70:           </div>
 71:         </DropdownMenuLabel>
 72:         <DropdownMenuSeparator />
 73:         <DropdownMenuGroup>
 74:           <DropdownMenuItem onClick={onProfileClick}>
 75:             <User className="mr-2 h-4 w-4" />
 76:             <span>Profile</span>
 77:             <DropdownMenuShortcut className="ml-auto">⇧⌘P</DropdownMenuShortcut>
 78:           </DropdownMenuItem>
 79:           <DropdownMenuItem onClick={onSettingsClick}>
 80:             <Settings className="mr-2 h-4 w-4" />
 81:             <span>Settings</span>
 82:             <DropdownMenuShortcut className="ml-auto">⌘S</DropdownMenuShortcut>
 83:           </DropdownMenuItem>
 84:           <DropdownMenuItem>
 85:             <FileText className="mr-2 h-4 w-4" />
 86:             <span>Documentation</span>
 87:             <DropdownMenuShortcut className="ml-auto">⌘D</DropdownMenuShortcut>
 88:           </DropdownMenuItem>
 89:           <DropdownMenuItem>
 90:             <HelpCircle className="mr-2 h-4 w-4" />
 91:             <span>Support</span>
 92:           </DropdownMenuItem>
 93:         </DropdownMenuGroup>
 94:         <DropdownMenuSeparator />
 95:         {user.isAdmin && (
 96:           <>
 97:             <DropdownMenuItem>
 98:               <Shield className="mr-2 h-4 w-4" />
 99:               <span>Admin Panel</span>
100:             </DropdownMenuItem>
101:             <DropdownMenuSeparator />
102:           </>
103:         )}
104:         <DropdownMenuItem onClick={onLogout} className="text-red-600">
105:           <LogOut className="mr-2 h-4 w-4" />
106:           <span>Log out</span>
107:           <DropdownMenuShortcut className="ml-auto">⇧⌘Q</DropdownMenuShortcut>
108:         </DropdownMenuItem>
109:       </DropdownMenuContent>
110:     </DropdownMenu>
111:   )
112: }
```

## File: apps/web/src/components/chat/utils.ts
```typescript
 1: export const formatTime = (date: Date) => {
 2:   const now = new Date()
 3:   const messageDate = new Date(date)
 4:   
 5:   // If the message is from today, just show the time
 6:   if (messageDate.toDateString() === now.toDateString()) {
 7:     return new Intl.DateTimeFormat("en", {
 8:       hour: "numeric",
 9:       minute: "numeric",
10:       hour12: true
11:     }).format(messageDate)
12:   }
13:   
14:   // If the message is from this year, show the month and day
15:   if (messageDate.getFullYear() === now.getFullYear()) {
16:     return new Intl.DateTimeFormat("en", {
17:       month: "short",
18:       day: "numeric",
19:       hour: "numeric",
20:       minute: "numeric",
21:       hour12: true
22:     }).format(messageDate)
23:   }
24:   
25:   // Otherwise show the full date
26:   return new Intl.DateTimeFormat("en", {
27:     year: "numeric",
28:     month: "short",
29:     day: "numeric",
30:     hour: "numeric",
31:     minute: "numeric",
32:     hour12: true
33:   }).format(messageDate)
34: }
35: 
36: export const detectCodeLanguage = (str: string): string => {
37:   if (str.includes('interface ') || str.includes('type ') || str.includes(': string') || str.includes(': number')) {
38:     return 'typescript'
39:   }
40:   if (str.includes('func ') || str.includes('package ')) {
41:     return 'go'
42:   }
43:   if (str.includes('def ') || str.includes('class ') || str.includes('import ')) {
44:     return 'python'
45:   }
46:   if (str.includes('<?php') || str.includes('namespace ')) {
47:     return 'php'
48:   }
49:   if (str.includes('public class') || str.includes('private void')) {
50:     return 'java'
51:   }
52:   return 'javascript' // default to javascript
53: }
54: 
55: export const isCodeLike = (str: string): boolean => {
56:   const codeIndicators = [
57:     /^import\s+.*from/m,           // imports
58:     /^const\s+.*=/m,               // const declarations
59:     /^let\s+.*=/m,                 // let declarations
60:     /^function\s+\w+\s*\(/m,       // function declarations
61:     /^class\s+\w+/m,               // class declarations
62:     /^if\s*\(/m,                   // if statements
63:     /^for\s*\(/m,                  // for loops
64:     /^while\s*\(/m,                // while loops
65:     /^async\s+function/m,          // async functions
66:     /=>/m,                         // arrow functions
67:     /\{\s*[\r\n]/m,               // opening brackets with newline
68:     /^\s*return\s+/m,             // return statements
69:     /^export\s+/m,                 // exports
70:     /^interface\s+\w+/m,           // TypeScript interfaces
71:     /^type\s+\w+/m,                // TypeScript types
72:   ]
73:   return codeIndicators.some(pattern => pattern.test(str))
74: }
```

## File: apps/web/src/components/mcp/servers/server-card.tsx
```typescript
 1: 'use client'
 2: 
 3: import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../card'
 4: import { Badge } from '../../ui/badge'
 5: 
 6: export interface ServerCardProps {
 7:   serverId: string
 8:   status: 'connected' | 'disconnected' | 'error'
 9:   description?: string
10:   onSelect?: () => void
11: }
12: 
13: export function ServerCard({ serverId, status, description, onSelect }: ServerCardProps) {
14:   const statusColors = {
15:     connected: 'bg-green-500',
16:     disconnected: 'bg-gray-500',
17:     error: 'bg-red-500',
18:   }
19: 
20:   return (
21:     <Card
22:       className="cursor-pointer hover:border-primary transition-colors"
23:       onClick={onSelect}
24:     >
25:       <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
26:         <CardTitle className="text-sm font-medium">
27:           {serverId}
28:         </CardTitle>
29:         <Badge variant="outline" className={statusColors[status]}>
30:           {status}
31:         </Badge>
32:       </CardHeader>
33:       {description && (
34:         <CardContent>
35:           <CardDescription>{description}</CardDescription>
36:         </CardContent>
37:       )}
38:     </Card>
39:   )
40: }
```

## File: apps/web/src/components/mcp/servers/server-list.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ServerCard } from './server-card'
 4: 
 5: export interface ServerListProps {
 6:   servers: Array<{
 7:     id: string
 8:     status: 'connected' | 'disconnected' | 'error'
 9:     description?: string
10:   }>
11:   onServerSelect?: (serverId: string) => void
12: }
13: 
14: export function ServerList({ servers, onServerSelect }: ServerListProps) {
15:   if (!servers.length) {
16:     return (
17:       <div className="text-center text-muted-foreground p-4">
18:         No MCP servers available
19:       </div>
20:     )
21:   }
22: 
23:   return (
24:     <div className="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
25:       {servers.map((server) => (
26:         <ServerCard
27:           key={server.id}
28:           serverId={server.id}
29:           status={server.status}
30:           description={server.description}
31:           onSelect={() => onServerSelect?.(server.id)}
32:         />
33:       ))}
34:     </div>
35:   )
36: }
```

## File: apps/web/src/components/mcp/tools/tool-card.tsx
```typescript
 1: import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
 2: import { cn } from "@/lib/utils";
 3: 
 4: interface ToolCardProps {
 5:   title: string;
 6:   description: string;
 7:   className?: string;
 8:   onClick?: () => void;
 9: }
10: 
11: export function ToolCard({
12:   title,
13:   description,
14:   className,
15:   onClick,
16: }: ToolCardProps) {
17:   return (
18:     <Card
19:       className={cn(
20:         "hover:bg-accent/50 cursor-pointer transition-colors",
21:         className
22:       )}
23:       onClick={onClick}
24:     >
25:       <CardHeader>
26:         <CardTitle className="text-lg">{title}</CardTitle>
27:       </CardHeader>
28:       <CardContent>
29:         <p className="text-sm text-muted-foreground">{description}</p>
30:       </CardContent>
31:     </Card>
32:   );
33: }
```

## File: apps/web/src/components/mcp/tools/tool-list.tsx
```typescript
 1: 'use client'
 2: 
 3: import { ToolCard } from './tool-card'
 4: 
 5: export interface ToolListProps {
 6:   tools: Array<{
 7:     serverId: string
 8:     toolId: string
 9:     name: string
10:     description: string
11:   }>
12:   onToolSelect?: (serverId: string, toolId: string) => void
13: }
14: 
15: export function ToolList({ tools, onToolSelect }: ToolListProps) {
16:   if (!tools.length) {
17:     return (
18:       <div className="text-center text-muted-foreground p-4">
19:         No MCP tools available
20:       </div>
21:     )
22:   }
23: 
24:   return (
25:     <div className="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
26:       {tools.map((tool) => (
27:         <ToolCard
28:           key={`${tool.serverId}-${tool.toolId}`}
29:           serverId={tool.serverId}
30:           toolId={tool.toolId}
31:           name={tool.name}
32:           description={tool.description}
33:           onSelect={() => onToolSelect?.(tool.serverId, tool.toolId)}
34:         />
35:       ))}
36:     </div>
37:   )
38: }
```

## File: apps/web/src/components/mcp/index.ts
```typescript
1: export * from './servers/server-card'
2: export * from './servers/server-list'
3: export * from './tools/tool-card'
4: export * from './tools/tool-list'
```

## File: apps/web/src/components/mcp/mcp-panel.tsx
```typescript
 1: 'use client'
 2: 
 3: import { useEffect, useState } from 'react'
 4: import { ServerList } from './servers/server-list'
 5: import { ToolList } from './tools/tool-list'
 6: import { Card, CardContent, CardHeader, CardTitle } from '../card'
 7: import { Tabs, TabsContent, TabsList, TabsTrigger } from '../tabs'
 8: import { useToast } from '../../hooks/use-toast'
 9: 
10: interface MCPPanelProps {
11:   onToolSelect?: (serverId: string, toolId: string) => void
12: }
13: 
14: export function MCPPanel({ onToolSelect }: MCPPanelProps) {
15:   const [servers, setServers] = useState<Array<{
16:     id: string
17:     status: 'connected' | 'disconnected' | 'error'
18:     description?: string
19:   }>>([])
20:   
21:   const [tools, setTools] = useState<Array<{
22:     serverId: string
23:     toolId: string
24:     name: string
25:     description: string
26:   }>>([])
27: 
28:   const { toast } = useToast()
29: 
30:   useEffect(() => {
31:     const fetchData = async () => {
32:       try {
33:         // Fetch server status
34:         const serverRes = await fetch('/api/actions/mcp/status')
35:         const serverData = await serverRes.json()
36:         if (serverData.success) {
37:           setServers(Object.entries(serverData.status).map(([id, status]) => ({
38:             id,
39:             status: status as 'connected' | 'disconnected' | 'error'
40:           })))
41:         }
42: 
43:         // Fetch available tools
44:         const toolsRes = await fetch('/api/actions/mcp/tools')
45:         const toolsData = await toolsRes.json()
46:         if (toolsData.success) {
47:           setTools(toolsData.tools)
48:         }
49:       } catch (error) {
50:         toast.error('Failed to fetch MCP data')
51:       }
52:     }
53: 
54:     // Initial fetch
55:     fetchData()
56: 
57:     // Set up polling for updates every 30 seconds
58:     const interval = setInterval(fetchData, 30000)
59: 
60:     return () => clearInterval(interval)
61:   }, [toast])
62: 
63:   return (
64:     <Card>
65:       <CardHeader>
66:         <CardTitle>MCP Integration</CardTitle>
67:       </CardHeader>
68:       <CardContent>
69:         <Tabs defaultValue="servers">
70:           <TabsList className="grid w-full grid-cols-2">
71:             <TabsTrigger value="servers">Servers</TabsTrigger>
72:             <TabsTrigger value="tools">Tools</TabsTrigger>
73:           </TabsList>
74:           <TabsContent value="servers" className="mt-4">
75:             <ServerList 
76:               servers={servers}
77:               onServerSelect={(serverId) => {
78:                 toast.success(`Connected to ${serverId}`)
79:               }}
80:             />
81:           </TabsContent>
82:           <TabsContent value="tools" className="mt-4">
83:             <ToolList 
84:               tools={tools}
85:               onToolSelect={onToolSelect}
86:             />
87:           </TabsContent>
88:         </Tabs>
89:       </CardContent>
90:     </Card>
91:   )
92: }
```

## File: apps/web/src/components/mcp/README.md
```markdown
  1: # MCP Components
  2: 
  3: React components for Model Context Protocol (MCP) integration in the Danky AI Chatbot platform.
  4: 
  5: ## Overview
  6: 
  7: The MCP components handle the integration between the chat interface and the Model Context Protocol, managing tool execution, model responses, and AI interactions.
  8: 
  9: ## Components
 10: 
 11: ### Core Components
 12: - `MCPProvider`: MCP context provider
 13: - `MCPPanel`: Tool execution panel
 14: - `ToolList`: Available tools list
 15: - `ToolCard`: Individual tool component
 16: - `ModelSelector`: AI model selection
 17: 
 18: ### Supporting Components
 19: - `ToolResults`: Tool execution results
 20: - `ModelConfig`: Model configuration
 21: - `ExecutionStatus`: Tool status display
 22: - `ErrorDisplay`: Error handling UI
 23: - `LoadingState`: Loading indicators
 24: 
 25: ## State Management
 26: 
 27: ### MCP Store
 28: ```typescript
 29: interface MCPState {
 30:   tools: Tool[]
 31:   selectedModel: Model
 32:   currentExecution: Execution | null
 33:   history: ExecutionHistory[]
 34:   error: Error | null
 35: }
 36: ```
 37: 
 38: ### Actions
 39: - `executeTool`: Run selected tool
 40: - `selectModel`: Change AI model
 41: - `cancelExecution`: Stop current execution
 42: - `clearHistory`: Clear execution history
 43: - `updateConfig`: Update model config
 44: 
 45: ## AI Development Notes
 46: 
 47: ### Key Concepts
 48: 
 49: 1. **Tool Execution**
 50:    - Tool registration
 51:    - Parameter validation
 52:    - Result handling
 53:    - Error recovery
 54: 
 55: 2. **Model Management**
 56:    - Model selection
 57:    - Configuration
 58:    - Token counting
 59:    - Rate limiting
 60: 
 61: 3. **State Handling**
 62:    - Execution state
 63:    - History tracking
 64:    - Error handling
 65:    - Recovery flows
 66: 
 67: ### Common Patterns
 68: 
 69: #### Tool Registration
 70: ```tsx
 71: function ToolRegistration() {
 72:   const registerTool = useStore(state => state.registerTool)
 73: 
 74:   const handleRegister = async (tool: Tool) => {
 75:     try {
 76:       await registerTool(tool)
 77:     } catch (error) {
 78:       console.error('Tool registration failed:', error)
 79:     }
 80:   }
 81: 
 82:   return (
 83:     <form onSubmit={handleSubmit}>
 84:       <ToolForm onSubmit={handleRegister} />
 85:     </form>
 86:   )
 87: }
 88: ```
 89: 
 90: #### Execution Handling
 91: ```tsx
 92: function ToolExecution({ tool }: { tool: Tool }) {
 93:   const execute = useStore(state => state.executeTool)
 94:   const status = useStore(state => state.status)
 95: 
 96:   const handleExecute = async (params: unknown) => {
 97:     try {
 98:       await execute(tool.name, params)
 99:     } catch (error) {
100:       console.error('Tool execution failed:', error)
101:     }
102:   }
103: 
104:   return (
105:     <div className="tool-execution">
106:       <ToolParams tool={tool} onSubmit={handleExecute} />
107:       <ExecutionStatus status={status} />
108:     </div>
109:   )
110: }
111: ```
112: 
113: #### Model Configuration
114: ```tsx
115: function ModelConfig() {
116:   const config = useStore(state => state.modelConfig)
117:   const updateConfig = useStore(state => state.updateConfig)
118: 
119:   return (
120:     <div className="model-config">
121:       <select
122:         value={config.model}
123:         onChange={(e) => updateConfig({ model: e.target.value })}
124:       >
125:         <option value="gpt-4">GPT-4</option>
126:         <option value="claude-3">Claude 3</option>
127:       </select>
128:       <ConfigOptions config={config} onChange={updateConfig} />
129:     </div>
130:   )
131: }
132: ```
133: 
134: ## Component Library
135: 
136: ### Tool Components
137: - `ToolCard`: Tool display card
138: - `ToolParams`: Parameter input form
139: - `ToolResults`: Result display
140: - `ToolHistory`: Execution history
141: - `ToolDocs`: Tool documentation
142: 
143: ### Model Components
144: - `ModelSelector`: Model selection
145: - `ModelConfig`: Configuration panel
146: - `TokenCounter`: Token usage display
147: - `RateLimit`: Rate limit indicator
148: - `CostEstimate`: Usage cost display
149: 
150: ### Execution Components
151: - `ExecutionPanel`: Main execution UI
152: - `StatusIndicator`: Execution status
153: - `ProgressBar`: Operation progress
154: - `ErrorBoundary`: Error handling
155: - `RetryButton`: Retry failed operations
156: 
157: ## Development
158: 
159: ### Adding New Tools
160: 
161: 1. Create tool definition:
162: ```typescript
163: // src/components/mcp/tools/my-tool.ts
164: import { type Tool } from '@danky/mcp'
165: 
166: export const myTool: Tool = {
167:   name: 'myTool',
168:   description: 'Does something useful',
169:   parameters: {
170:     // Zod schema
171:   },
172:   handler: async (params) => {
173:     // Implementation
174:   }
175: }
176: ```
177: 
178: 2. Register tool:
179: ```typescript
180: // src/components/mcp/tools/index.ts
181: export const tools = [myTool]
182: ```
183: 
184: ### Testing
185: ```bash
186: pnpm test
187: pnpm test:watch
188: ```
189: 
190: ### Storybook
191: ```bash
192: pnpm storybook
193: ```
194: 
195: ## Styling
196: 
197: ### CSS Modules
198: ```css
199: /* styles.module.css */
200: .toolCard {
201:   @apply rounded-lg border p-4;
202: }
203: 
204: .executing {
205:   @apply bg-primary/10;
206: }
207: 
208: .error {
209:   @apply bg-destructive/10;
210: }
211: ```
212: 
213: ### Theme Variables
214: ```css
215: :root {
216:   --tool-bg: hsl(var(--card));
217:   --executing-bg: hsl(var(--primary));
218:   --error-bg: hsl(var(--destructive));
219: }
220: ```
221: 
222: ## Additional Resources
223: 
224: - [MCP Integration Guide](../../../docs/MCP.md)
225: - [Tool Development Guide](../../../docs/TOOLS.md)
226: - [Model Configuration](../../../docs/MODELS.md)
227: - [Error Handling](../../../docs/ERRORS.md)
```

## File: apps/web/src/components/mcp/tools-button.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import { Wrench } from 'lucide-react';
  5: import {
  6:   Button,
  7:   Dialog,
  8:   DialogContent,
  9:   DialogHeader,
 10:   DialogTitle,
 11:   DialogTrigger,
 12:   ScrollArea,
 13:   Badge,
 14:   cn,
 15: } from '@danky/ui';
 16: 
 17: interface Server {
 18:   id: string;
 19:   name: string;
 20:   status: 'connected' | 'disconnected' | 'error';
 21:   tools: Tool[];
 22: }
 23: 
 24: interface Tool {
 25:   id: string;
 26:   name: string;
 27:   description: string;
 28:   icon?: React.ReactNode;
 29: }
 30: 
 31: interface ToolsButtonProps {
 32:   servers: Server[];
 33:   onToolSelect: (serverId: string, toolId: string) => void;
 34:   className?: string;
 35: }
 36: 
 37: export function ToolsButton({ servers, onToolSelect, className }: ToolsButtonProps) {
 38:   const [isOpen, setIsOpen] = React.useState(false);
 39:   const [selectedServer, setSelectedServer] = React.useState<Server | null>(null);
 40: 
 41:   return (
 42:     <Dialog open={isOpen} onOpenChange={setIsOpen}>
 43:       <DialogTrigger asChild>
 44:         <Button size="icon" variant="ghost" className={cn('absolute bottom-4 right-8', className)}>
 45:           <Wrench className="h-4 w-4" />
 46:         </Button>
 47:       </DialogTrigger>
 48:       <DialogContent className="sm:max-w-[425px]">
 49:         <DialogHeader>
 50:           <DialogTitle>{selectedServer ? selectedServer.name : 'Available Servers'}</DialogTitle>
 51:         </DialogHeader>
 52:         <ScrollArea className="mt-4 h-[60vh]">
 53:           <div className="space-y-4">
 54:             {selectedServer ? (
 55:               <div className="animate-in slide-in-from-right duration-200">
 56:                 <Button variant="ghost" className="mb-4" onClick={() => setSelectedServer(null)}>
 57:                   ← Back to Servers
 58:                 </Button>
 59:                 {selectedServer.tools.map(tool => (
 60:                   <div
 61:                     key={tool.id}
 62:                     className="hover:bg-accent flex cursor-pointer items-center space-x-4 rounded-lg border p-4 transition-colors"
 63:                     onClick={() => {
 64:                       onToolSelect(selectedServer.id, tool.id);
 65:                       setIsOpen(false);
 66:                       setSelectedServer(null);
 67:                     }}
 68:                   >
 69:                     {tool.icon}
 70:                     <div className="flex-1">
 71:                       <h4 className="font-medium">{tool.name}</h4>
 72:                       <p className="text-muted-foreground text-sm">{tool.description}</p>
 73:                     </div>
 74:                   </div>
 75:                 ))}
 76:               </div>
 77:             ) : (
 78:               <div className="animate-in slide-in-from-left duration-200">
 79:                 {servers.map(server => (
 80:                   <div
 81:                     key={server.id}
 82:                     className="hover:bg-accent flex cursor-pointer items-center space-x-4 rounded-lg border p-4 transition-colors"
 83:                     onClick={() => setSelectedServer(server)}
 84:                   >
 85:                     <div className="flex-1">
 86:                       <div className="flex items-center gap-2">
 87:                         <h4 className="font-medium">{server.name}</h4>
 88:                         <Badge
 89:                           variant={
 90:                             server.status === 'connected'
 91:                               ? 'default'
 92:                               : server.status === 'error'
 93:                                 ? 'destructive'
 94:                                 : 'secondary'
 95:                           }
 96:                         >
 97:                           {server.status}
 98:                         </Badge>
 99:                       </div>
100:                       <p className="text-muted-foreground text-sm">
101:                         {server.tools.length} tools available
102:                       </p>
103:                     </div>
104:                   </div>
105:                 ))}
106:               </div>
107:             )}
108:           </div>
109:         </ScrollArea>
110:       </DialogContent>
111:     </Dialog>
112:   );
113: }
```

## File: apps/web/src/components/sidebar/index.tsx
```typescript
 1: export { Sidebar } from "./sidebar";
 2: export { SidebarProvider, useSidebar } from "./sidebar-context";
 3: export { SidebarTrigger } from "./sidebar-trigger";
 4: export { SidebarSearch } from "./sidebar-search";
 5: export { SidebarContent } from "./sidebar-content";
 6: export {
 7:   SidebarGroup,
 8:   SidebarGroupLabel,
 9:   SidebarGroupAction,
10:   SidebarGroupContent,
11: } from "./sidebar-group";
12: export {
13:   SidebarMenu,
14:   SidebarMenuItem,
15:   SidebarMenuButton,
16:   SidebarMenuAction,
17: } from "./sidebar-menu";
18: export {
19:   SidebarMenuSub,
20:   SidebarMenuSubItem,
21:   SidebarMenuSubButton,
22: } from "./sidebar-menu-sub";
23: export {
24:   SidebarMenuBadge,
25:   SidebarMenuSkeleton,
26: } from "./sidebar-menu-extras";
27: export {
28:   SidebarSection,
29:   SidebarSectionTitle,
30:   SidebarSectionContent,
31:   SidebarSectionSeparator,
32: } from "./sidebar-section";
33: export { SidebarItem, SidebarItemSkeleton } from "./sidebar-item";
34: export { SidebarRail, SidebarInset } from "./sidebar-layout";
35: export {
36:   SidebarInput,
37:   SidebarHeader,
38:   SidebarFooter,
39:   SidebarSeparator,
40: } from "./sidebar-sections";
41: export type { SidebarContext, SidebarState } from "./sidebar-types";
```

## File: apps/web/src/components/sidebar/sidebar-content.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { cn } from "@/lib/utils";
 5: import { useSidebar } from "./sidebar-context";
 6: 
 7: export const SidebarContent = React.forwardRef<
 8:   HTMLDivElement,
 9:   React.ComponentProps<"div">
10: >(({ className, ...props }, ref) => {
11:   const { isOpen } = useSidebar();
12: 
13:   return (
14:     <div
15:       ref={ref}
16:       data-sidebar="content"
17:       data-state={isOpen ? "open" : "closed"}
18:       className={cn(
19:         "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
20:         "h-full w-[300px] border-r bg-background transition-all duration-300 ease-in-out data-[state=closed]:w-[0px] data-[state=closed]:opacity-0",
21:         className
22:       )}
23:       {...props}
24:     />
25:   );
26: });
```

## File: apps/web/src/components/sidebar/sidebar-context.tsx
```typescript
 1: 'use client';
 2: 
 3: import React from 'react';
 4: import { type SidebarContextType } from './sidebar-types';
 5: 
 6: const SidebarContext = React.createContext<SidebarContextType | undefined>(undefined);
 7: 
 8: export function useSidebarContext() {
 9:   const context = React.useContext(SidebarContext);
10:   if (!context) {
11:     throw new Error('useSidebarContext must be used within a SidebarProvider');
12:   }
13:   return context;
14: }
15: 
16: interface SidebarProviderProps {
17:   children: React.ReactNode;
18:   defaultOpen?: boolean;
19: }
20: 
21: export function SidebarProvider({ children, defaultOpen = false }: SidebarProviderProps) {
22:   const [isOpen, setIsOpen] = React.useState(defaultOpen);
23: 
24:   const toggle = React.useCallback(() => {
25:     setIsOpen(prev => !prev);
26:   }, []);
27: 
28:   return <SidebarContext.Provider value={{ isOpen, toggle }}>{children}</SidebarContext.Provider>;
29: }
30: 
31: export { SidebarContext };
```

## File: apps/web/src/components/sidebar/sidebar-group.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cn } from "@/lib/utils";
 6: 
 7: export const SidebarGroup = React.forwardRef<
 8:   HTMLDivElement,
 9:   React.ComponentProps<"div">
10: >(({ className, ...props }, ref) => {
11:   return (
12:     <div
13:       ref={ref}
14:       data-sidebar="group"
15:       className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
16:       {...props}
17:     />
18:   );
19: });
20: 
21: export const SidebarGroupLabel = React.forwardRef<
22:   HTMLDivElement,
23:   React.ComponentProps<"div"> & { asChild?: boolean }
24: >(({ className, asChild = false, ...props }, ref) => {
25:   const Comp = asChild ? Slot : "div";
26: 
27:   return (
28:     <Comp
29:       ref={ref}
30:       data-sidebar="group-label"
31:       className={cn(
32:         "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
33:         "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
34:         className
35:       )}
36:       {...props}
37:     />
38:   );
39: });
40: 
41: export const SidebarGroupAction = React.forwardRef<
42:   HTMLButtonElement,
43:   React.ComponentProps<"button"> & { asChild?: boolean }
44: >(({ className, asChild = false, ...props }, ref) => {
45:   const Comp = asChild ? Slot : "button";
46: 
47:   return (
48:     <Comp
49:       ref={ref}
50:       data-sidebar="group-action"
51:       className={cn(
52:         "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
53:         "after:absolute after:-inset-2 after:md:hidden",
54:         "group-data-[collapsible=icon]:hidden",
55:         className
56:       )}
57:       {...props}
58:     />
59:   );
60: });
61: 
62: export const SidebarGroupContent = React.forwardRef<
63:   HTMLDivElement,
64:   React.ComponentProps<"div">
65: >(({ className, ...props }, ref) => (
66:   <div
67:     ref={ref}
68:     data-sidebar="group-content"
69:     className={cn("w-full text-sm", className)}
70:     {...props}
71:   />
72: ));
```

## File: apps/web/src/components/sidebar/sidebar-item.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cva, type VariantProps } from "class-variance-authority";
 6: import { cn } from "@/lib/utils";
 7: import { Skeleton } from "../skeleton";
 8: import {
 9:   Tooltip,
10:   TooltipContent,
11:   TooltipTrigger,
12: } from "../tooltip";
13: import { useSidebar } from "./sidebar-context";
14: 
15: const sidebarItemVariants = cva(
16:   "group/sidebar-item relative flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",
17:   {
18:     variants: {
19:       size: {
20:         sm: "gap-1.5 px-1.5 py-1 text-xs",
21:         md: "gap-2 px-2 py-1.5 text-sm",
22:         lg: "gap-2.5 px-2.5 py-2 text-base",
23:       },
24:     },
25:     defaultVariants: {
26:       size: "md",
27:     },
28:   }
29: );
30: 
31: export interface SidebarItemProps
32:   extends React.HTMLAttributes<HTMLAnchorElement>,
33:     VariantProps<typeof sidebarItemVariants> {
34:   asChild?: boolean;
35:   isActive?: boolean;
36: }
37: 
38: export const SidebarItem = React.forwardRef<HTMLAnchorElement, SidebarItemProps>(
39:   ({ className, asChild = false, size, isActive, ...props }, ref) => {
40:     const Comp = asChild ? Slot : "a";
41:     const { state } = useSidebar();
42: 
43:     const content = (
44:       <Comp
45:         ref={ref}
46:         className={cn(
47:           sidebarItemVariants({ size }),
48:           isActive && "bg-accent text-accent-foreground",
49:           className
50:         )}
51:         {...props}
52:       />
53:     );
54: 
55:     if (state === "collapsed") {
56:       return (
57:         <Tooltip>
58:           <TooltipTrigger asChild>{content}</TooltipTrigger>
59:           <TooltipContent side="right" sideOffset={20}>
60:             {props.children}
61:           </TooltipContent>
62:         </Tooltip>
63:       );
64:     }
65: 
66:     return content;
67:   }
68: );
69: 
70: export const SidebarItemSkeleton = React.forwardRef<
71:   HTMLDivElement,
72:   React.ComponentPropsWithoutRef<typeof Skeleton> & { size?: "sm" | "md" | "lg" }
73: >(({ size = "md", className, ...props }, ref) => {
74:   return (
75:     <Skeleton
76:       ref={ref}
77:       className={cn(
78:         "w-full",
79:         size === "sm" && "h-6",
80:         size === "md" && "h-8",
81:         size === "lg" && "h-10",
82:         className
83:       )}
84:       {...props}
85:     />
86:   );
87: });
```

## File: apps/web/src/components/sidebar/sidebar-layout.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { cn } from '@/lib/utils';
 5: import { useSidebarContext } from './sidebar-context';
 6: 
 7: export const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<'button'>>(
 8:   ({ className, ...props }, ref) => {
 9:     const { toggleSidebar } = useSidebarContext();
10: 
11:     return (
12:       <button
13:         ref={ref}
14:         data-sidebar="rail"
15:         aria-label="Toggle Sidebar"
16:         tabIndex={-1}
17:         onClick={toggleSidebar}
18:         title="Toggle Sidebar"
19:         className={cn(
20:           'hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex',
21:           '[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize',
22:           '[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize',
23:           'group-data-[collapsible=offcanvas]:hover:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full',
24:           '[[data-side=left][data-collapsible=offcanvas]_&]:-right-2',
25:           '[[data-side=right][data-collapsible=offcanvas]_&]:-left-2',
26:           className
27:         )}
28:         {...props}
29:       />
30:     );
31:   }
32: );
33: 
34: export const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<'main'>>(
35:   ({ className, ...props }, ref) => {
36:     return (
37:       <main
38:         ref={ref}
39:         className={cn(
40:           'bg-background relative flex min-h-svh flex-1 flex-col',
41:           'peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow',
42:           className
43:         )}
44:         {...props}
45:       />
46:     );
47:   }
48: );
```

## File: apps/web/src/components/sidebar/sidebar-menu-extras.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { cn } from '@/lib/utils';
 5: import { Skeleton } from '@danky/ui';
 6: 
 7: export const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
 8:   ({ className, ...props }, ref) => (
 9:     <div
10:       ref={ref}
11:       data-sidebar="menu-badge"
12:       className={cn(
13:         'text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums',
14:         'peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',
15:         'peer-data-[size=sm]/menu-button:top-1',
16:         'peer-data-[size=default]/menu-button:top-1.5',
17:         'peer-data-[size=lg]/menu-button:top-2.5',
18:         'group-data-[collapsible=icon]:hidden',
19:         className
20:       )}
21:       {...props}
22:     />
23:   )
24: );
25: 
26: export const SidebarMenuSkeleton = React.forwardRef<
27:   HTMLDivElement,
28:   React.ComponentProps<'div'> & {
29:     showIcon?: boolean;
30:   }
31: >(({ className, showIcon = false, ...props }, ref) => {
32:   // Random width between 50 to 90%.
33:   const width = React.useMemo(() => {
34:     return `${Math.floor(Math.random() * 40) + 50}%`;
35:   }, []);
36: 
37:   return (
38:     <div
39:       ref={ref}
40:       data-sidebar="menu-skeleton"
41:       className={cn('flex h-8 items-center gap-2 rounded-md px-2', className)}
42:       {...props}
43:     >
44:       {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
45:       <Skeleton
46:         className="h-4 max-w-[--skeleton-width] flex-1"
47:         data-sidebar="menu-skeleton-text"
48:         style={
49:           {
50:             '--skeleton-width': width,
51:           } as React.CSSProperties
52:         }
53:       />
54:     </div>
55:   );
56: });
```

## File: apps/web/src/components/sidebar/sidebar-menu-sub.tsx
```typescript
 1: "use client";
 2: 
 3: import * as React from "react";
 4: import { Slot } from "@radix-ui/react-slot";
 5: import { cn } from "@/lib/utils";
 6: 
 7: export const SidebarMenuSub = React.forwardRef<
 8:   HTMLUListElement,
 9:   React.ComponentProps<"ul">
10: >(({ className, ...props }, ref) => (
11:   <ul
12:     ref={ref}
13:     data-sidebar="menu-sub"
14:     className={cn(
15:       "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
16:       "group-data-[collapsible=icon]:hidden",
17:       className
18:     )}
19:     {...props}
20:   />
21: ));
22: 
23: export const SidebarMenuSubItem = React.forwardRef<
24:   HTMLLIElement,
25:   React.ComponentProps<"li">
26: >(({ ...props }, ref) => <li ref={ref} {...props} />);
27: 
28: export const SidebarMenuSubButton = React.forwardRef<
29:   HTMLAnchorElement,
30:   React.ComponentProps<"a"> & {
31:     asChild?: boolean;
32:     size?: "sm" | "md";
33:     isActive?: boolean;
34:   }
35: >(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
36:   const Comp = asChild ? Slot : "a";
37: 
38:   return (
39:     <Comp
40:       ref={ref}
41:       data-sidebar="menu-sub-button"
42:       data-size={size}
43:       data-active={isActive}
44:       className={cn(
45:         "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
46:         "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
47:         size === "sm" && "text-xs",
48:         size === "md" && "text-sm",
49:         "group-data-[collapsible=icon]:hidden",
50:         className
51:       )}
52:       {...props}
53:     />
54:   );
55: });
```

## File: apps/web/src/components/sidebar/sidebar-menu.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import { Slot } from '@radix-ui/react-slot';
  5: import { cva, type VariantProps } from 'class-variance-authority';
  6: import { cn } from '@/lib/utils';
  7: import { Tooltip, TooltipContent, TooltipTrigger } from '@danky/ui';
  8: import { useSidebarContext } from './sidebar-context';
  9: 
 10: export const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
 11:   ({ className, ...props }, ref) => (
 12:     <ul
 13:       ref={ref}
 14:       data-sidebar="menu"
 15:       className={cn('flex w-full min-w-0 flex-col gap-1', className)}
 16:       {...props}
 17:     />
 18:   )
 19: );
 20: 
 21: export const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
 22:   ({ className, ...props }, ref) => (
 23:     <li
 24:       ref={ref}
 25:       data-sidebar="menu-item"
 26:       className={cn('group/menu-item relative', className)}
 27:       {...props}
 28:     />
 29:   )
 30: );
 31: 
 32: const sidebarMenuButtonVariants = cva(
 33:   'peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
 34:   {
 35:     variants: {
 36:       variant: {
 37:         default: 'hover:bg-sidebar-accent hover:text-sidebar-accent-foreground',
 38:         outline:
 39:           'bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]',
 40:       },
 41:       size: {
 42:         default: 'h-8 text-sm',
 43:         sm: 'h-7 text-xs',
 44:         lg: 'h-12 text-sm group-data-[collapsible=icon]:!p-0',
 45:       },
 46:     },
 47:     defaultVariants: {
 48:       variant: 'default',
 49:       size: 'default',
 50:     },
 51:   }
 52: );
 53: 
 54: export interface SidebarMenuButtonProps
 55:   extends React.ComponentProps<'button'>,
 56:     VariantProps<typeof sidebarMenuButtonVariants> {
 57:   asChild?: boolean;
 58:   isActive?: boolean;
 59:   tooltip?: string | React.ComponentProps<typeof TooltipContent>;
 60: }
 61: 
 62: export const SidebarMenuButton = React.forwardRef<HTMLButtonElement, SidebarMenuButtonProps>(
 63:   (
 64:     {
 65:       asChild = false,
 66:       isActive = false,
 67:       variant = 'default',
 68:       size = 'default',
 69:       tooltip,
 70:       className,
 71:       ...props
 72:     },
 73:     ref
 74:   ) => {
 75:     const Comp = asChild ? Slot : 'button';
 76:     const { isMobile, state } = useSidebarContext();
 77: 
 78:     const button = (
 79:       <Comp
 80:         ref={ref}
 81:         data-sidebar="menu-button"
 82:         data-size={size}
 83:         data-active={isActive}
 84:         className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
 85:         {...props}
 86:       />
 87:     );
 88: 
 89:     if (!tooltip) {
 90:       return button;
 91:     }
 92: 
 93:     if (typeof tooltip === 'string') {
 94:       tooltip = {
 95:         children: tooltip,
 96:       };
 97:     }
 98: 
 99:     return (
100:       <Tooltip>
101:         <TooltipTrigger asChild>{button}</TooltipTrigger>
102:         <TooltipContent
103:           side="right"
104:           align="center"
105:           hidden={state !== 'collapsed' || isMobile}
106:           {...tooltip}
107:         />
108:       </Tooltip>
109:     );
110:   }
111: );
112: 
113: export const SidebarMenuAction = React.forwardRef<
114:   HTMLButtonElement,
115:   React.ComponentProps<'button'> & {
116:     asChild?: boolean;
117:     showOnHover?: boolean;
118:   }
119: >(({ className, asChild = false, showOnHover = true, ...props }, ref) => {
120:   const Comp = asChild ? Slot : 'button';
121: 
122:   return (
123:     <Comp
124:       ref={ref}
125:       data-sidebar="menu-action"
126:       className={cn(
127:         'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-none transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
128:         'after:absolute after:-inset-2 after:md:hidden',
129:         'peer-data-[size=sm]/menu-button:top-1',
130:         'peer-data-[size=default]/menu-button:top-1.5',
131:         'peer-data-[size=lg]/menu-button:top-2.5',
132:         'group-data-[collapsible=icon]:hidden',
133:         showOnHover &&
134:           'peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0',
135:         className
136:       )}
137:       {...props}
138:     />
139:   );
140: });
```

## File: apps/web/src/components/sidebar/sidebar-search.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { Input } from '@danky/ui';
 5: import { cn } from '@/lib/utils';
 6: 
 7: export const SidebarSearch = React.forwardRef<
 8:   HTMLInputElement,
 9:   React.ComponentPropsWithoutRef<typeof Input>
10: >(({ className, ...props }, ref) => {
11:   return (
12:     <div className="px-4 py-2">
13:       <Input
14:         ref={ref}
15:         type="search"
16:         placeholder="Search..."
17:         className={cn('bg-background h-8 w-full px-3', className)}
18:         {...props}
19:       />
20:     </div>
21:   );
22: });
```

## File: apps/web/src/components/sidebar/sidebar-section.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { Slot } from '@radix-ui/react-slot';
 5: import { cn } from '@/lib/utils';
 6: import { Separator } from '@danky/ui';
 7: 
 8: export const SidebarSection = React.forwardRef<
 9:   HTMLDivElement,
10:   React.HTMLAttributes<HTMLDivElement>
11: >(({ className, ...props }, ref) => {
12:   return <div ref={ref} className={cn('flex flex-col gap-2 px-2 py-2', className)} {...props} />;
13: });
14: 
15: export const SidebarSectionTitle = React.forwardRef<
16:   HTMLDivElement,
17:   React.HTMLAttributes<HTMLDivElement>
18: >(({ className, ...props }, ref) => {
19:   return (
20:     <div
21:       ref={ref}
22:       className={cn('text-muted-foreground px-2 text-xs font-semibold', className)}
23:       {...props}
24:     />
25:   );
26: });
27: 
28: export const SidebarSectionContent = React.forwardRef<
29:   HTMLDivElement,
30:   React.HTMLAttributes<HTMLDivElement> & { asChild?: boolean }
31: >(({ className, asChild = false, ...props }, ref) => {
32:   const Comp = asChild ? Slot : 'div';
33: 
34:   return <Comp ref={ref} className={cn('flex flex-col gap-1', className)} {...props} />;
35: });
36: 
37: export const SidebarSectionSeparator = React.forwardRef<
38:   HTMLDivElement,
39:   React.ComponentPropsWithoutRef<typeof Separator>
40: >(({ className, ...props }, ref) => {
41:   return <Separator ref={ref} className={cn('my-2', className)} {...props} />;
42: });
```

## File: apps/web/src/components/sidebar/sidebar-sections.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { cn } from '@/lib/utils';
 5: import { Input, Separator } from '@danky/ui';
 6: 
 7: export const SidebarInput = React.forwardRef<
 8:   React.ElementRef<typeof Input>,
 9:   React.ComponentPropsWithoutRef<typeof Input>
10: >(({ className, ...props }, ref) => {
11:   return (
12:     <Input
13:       ref={ref}
14:       data-sidebar="input"
15:       className={cn(
16:         'bg-background focus-visible:ring-sidebar-ring h-8 w-full shadow-none focus-visible:ring-2',
17:         className
18:       )}
19:       {...props}
20:     />
21:   );
22: });
23: 
24: SidebarInput.displayName = 'SidebarInput';
25: 
26: export const SidebarHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
27:   ({ className, ...props }, ref) => {
28:     return (
29:       <div
30:         ref={ref}
31:         data-sidebar="header"
32:         className={cn('flex flex-col gap-2 p-2', className)}
33:         {...props}
34:       />
35:     );
36:   }
37: );
38: 
39: SidebarHeader.displayName = 'SidebarHeader';
40: 
41: export const SidebarFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
42:   ({ className, ...props }, ref) => {
43:     return (
44:       <div
45:         ref={ref}
46:         data-sidebar="footer"
47:         className={cn('flex flex-col gap-2 p-2', className)}
48:         {...props}
49:       />
50:     );
51:   }
52: );
53: 
54: SidebarFooter.displayName = 'SidebarFooter';
55: 
56: export const SidebarSeparator = React.forwardRef<
57:   React.ElementRef<typeof Separator>,
58:   React.ComponentPropsWithoutRef<typeof Separator>
59: >(({ className, ...props }, ref) => {
60:   return (
61:     <Separator
62:       ref={ref}
63:       data-sidebar="separator"
64:       className={cn('bg-sidebar-border mx-2 w-auto', className)}
65:       {...props}
66:     />
67:   );
68: });
69: 
70: SidebarSeparator.displayName = 'SidebarSeparator';
```

## File: apps/web/src/components/sidebar/sidebar-toggle.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { cn } from '@/lib/utils';
 5: import { useSidebarContext } from './sidebar-context';
 6: 
 7: export function SidebarToggle({ className }: React.HTMLAttributes<HTMLButtonElement>) {
 8:   const { toggleSidebar } = useSidebarContext();
 9: 
10:   return (
11:     <button
12:       onClick={toggleSidebar}
13:       className={cn(
14:         'bg-background absolute -right-4 top-4 z-50 flex h-8 w-8 items-center justify-center rounded-full border shadow-sm',
15:         className
16:       )}
17:     >
18:       <svg
19:         xmlns="http://www.w3.org/2000/svg"
20:         width="24"
21:         height="24"
22:         viewBox="0 0 24 24"
23:         fill="none"
24:         stroke="currentColor"
25:         strokeWidth="2"
26:         strokeLinecap="round"
27:         strokeLinejoin="round"
28:         className="h-4 w-4"
29:       >
30:         <path d="m9 18 6-6-6-6" />
31:       </svg>
32:     </button>
33:   );
34: }
```

## File: apps/web/src/components/sidebar/sidebar-trigger.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { PanelLeft } from 'lucide-react';
 5: import { Button } from '@danky/ui';
 6: import { useSidebarContext } from './sidebar-context';
 7: 
 8: export const SidebarTrigger = React.forwardRef<
 9:   React.ElementRef<typeof Button>,
10:   React.ComponentPropsWithoutRef<typeof Button>
11: >(({ className, onClick, ...props }, ref) => {
12:   const { toggleSidebar } = useSidebarContext();
13: 
14:   return (
15:     <Button
16:       variant="ghost"
17:       size="icon"
18:       className={className}
19:       onClick={e => {
20:         onClick?.(e);
21:         toggleSidebar();
22:       }}
23:       ref={ref}
24:       {...props}
25:     >
26:       <PanelLeft className="h-4 w-4" aria-hidden="true" />
27:       <span className="sr-only">Toggle sidebar</span>
28:     </Button>
29:   );
30: });
31: 
32: SidebarTrigger.displayName = 'SidebarTrigger';
```

## File: apps/web/src/components/sidebar/sidebar-types.ts
```typescript
 1: export const SIDEBAR_COOKIE_NAME = "sidebar:state";
 2: export const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7; // 7 days
 3: export const SIDEBAR_WIDTH = "16rem";
 4: export const SIDEBAR_WIDTH_MOBILE = "18rem";
 5: export const SIDEBAR_WIDTH_ICON = "3rem";
 6: export const SIDEBAR_KEYBOARD_SHORTCUT = "b";
 7: 
 8: export type SidebarContext = {
 9:   state: "expanded" | "collapsed";
10:   isOpen: boolean;
11:   setOpen: (open: boolean) => void;
12:   openMobile: boolean;
13:   setOpenMobile: (open: boolean) => void;
14:   isMobile: boolean;
15:   toggleSidebar: () => void;
16: };
17: 
18: export type SidebarState = {
19:   isOpen: boolean;
20:   openMobile: boolean;
21:   isMobile: boolean;
22: };
```

## File: apps/web/src/components/sidebar/sidebar.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import type { ComponentPropsWithoutRef, ElementRef } from 'react';
  5: import { Slot } from '@radix-ui/react-slot';
  6: import type { VariantProps } from 'class-variance-authority';
  7: import { cva } from 'class-variance-authority';
  8: import { PanelLeft } from 'lucide-react';
  9: import * as RadixTooltip from '@radix-ui/react-tooltip';
 10: import * as RadixDialog from '@radix-ui/react-dialog';
 11: 
 12: import { useIsMobile } from '@/hooks/use-mobile';
 13: import { cn } from '@/lib/utils';
 14: import {
 15:   Button,
 16:   Input,
 17:   Separator,
 18:   Sheet,
 19:   SheetContent,
 20:   Skeleton,
 21:   Tooltip,
 22:   TooltipContent,
 23:   TooltipProvider,
 24:   TooltipTrigger,
 25: } from '@danky/ui';
 26: 
 27: type ButtonProps = ComponentPropsWithoutRef<typeof Button>;
 28: type InputProps = ComponentPropsWithoutRef<typeof Input>;
 29: type SeparatorProps = ComponentPropsWithoutRef<typeof Separator>;
 30: type SheetProps = ComponentPropsWithoutRef<typeof Sheet>;
 31: type SkeletonProps = ComponentPropsWithoutRef<typeof Skeleton>;
 32: type TooltipProps = ComponentPropsWithoutRef<typeof Tooltip>;
 33: type TooltipContentProps = ComponentPropsWithoutRef<typeof TooltipContent>;
 34: type TooltipProviderProps = ComponentPropsWithoutRef<typeof TooltipProvider>;
 35: type TooltipTriggerProps = ComponentPropsWithoutRef<typeof TooltipTrigger>;
 36: 
 37: const SIDEBAR_COOKIE_NAME = 'sidebar:state';
 38: const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
 39: const SIDEBAR_WIDTH = '16rem';
 40: const SIDEBAR_WIDTH_MOBILE = '18rem';
 41: const SIDEBAR_WIDTH_ICON = '3rem';
 42: const SIDEBAR_KEYBOARD_SHORTCUT = 'b';
 43: 
 44: type SidebarContext = {
 45:   state: 'expanded' | 'collapsed';
 46:   isOpen: boolean;
 47:   setOpen: (open: boolean) => void;
 48:   openMobile: boolean;
 49:   setOpenMobile: (open: boolean) => void;
 50:   isMobile: boolean;
 51:   toggleSidebar: () => void;
 52: };
 53: 
 54: const SidebarContext = React.createContext<SidebarContext | null>(null);
 55: 
 56: function useSidebar() {
 57:   const context = React.useContext(SidebarContext);
 58:   if (!context) {
 59:     throw new Error('useSidebar must be used within a SidebarProvider.');
 60:   }
 61: 
 62:   return context;
 63: }
 64: 
 65: const SidebarProvider = React.forwardRef<
 66:   HTMLDivElement,
 67:   React.ComponentProps<'div'> & {
 68:     defaultOpen?: boolean;
 69:     open?: boolean;
 70:     onOpenChange?: (open: boolean) => void;
 71:   }
 72: >(
 73:   (
 74:     {
 75:       defaultOpen = true,
 76:       open: openProp,
 77:       onOpenChange: setOpenProp,
 78:       className,
 79:       style,
 80:       children,
 81:       ...props
 82:     },
 83:     ref
 84:   ) => {
 85:     const isMobile = useIsMobile();
 86:     const [openMobile, setOpenMobile] = React.useState(false);
 87: 
 88:     // This is the internal state of the sidebar.
 89:     // We use openProp and setOpenProp for control from outside the component.
 90:     const [_open, _setOpen] = React.useState(defaultOpen);
 91:     const open = openProp ?? _open;
 92:     const setOpen = React.useCallback(
 93:       (value: boolean | ((value: boolean) => boolean)) => {
 94:         const openState = typeof value === 'function' ? value(open) : value;
 95:         if (setOpenProp) {
 96:           setOpenProp(openState);
 97:         } else {
 98:           _setOpen(openState);
 99:         }
100: 
101:         // This sets the cookie to keep the sidebar state.
102:         document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
103:       },
104:       [setOpenProp, open]
105:     );
106: 
107:     // Helper to toggle the sidebar.
108:     const toggleSidebar = React.useCallback(() => {
109:       return isMobile ? setOpenMobile(open => !open) : setOpen(open => !open);
110:     }, [isMobile, setOpen, setOpenMobile]);
111: 
112:     // Adds a keyboard shortcut to toggle the sidebar.
113:     React.useEffect(() => {
114:       const handleKeyDown = (event: KeyboardEvent) => {
115:         if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
116:           event.preventDefault();
117:           toggleSidebar();
118:         }
119:       };
120: 
121:       window.addEventListener('keydown', handleKeyDown);
122:       return () => window.removeEventListener('keydown', handleKeyDown);
123:     }, [toggleSidebar]);
124: 
125:     // We add a state so that we can do data-state="expanded" or "collapsed".
126:     // This makes it easier to style the sidebar with Tailwind classes.
127:     const state = open ? 'expanded' : 'collapsed';
128: 
129:     const contextValue = React.useMemo<SidebarContext>(
130:       () => ({
131:         state,
132:         isOpen: open,
133:         setOpen,
134:         isMobile,
135:         openMobile,
136:         setOpenMobile,
137:         toggleSidebar,
138:       }),
139:       [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
140:     );
141: 
142:     return (
143:       <SidebarContext.Provider value={contextValue}>
144:         <TooltipProvider delayDuration={0}>
145:           <div
146:             style={
147:               {
148:                 '--sidebar-width': SIDEBAR_WIDTH,
149:                 '--sidebar-width-icon': SIDEBAR_WIDTH_ICON,
150:                 ...style,
151:               } as React.CSSProperties
152:             }
153:             className={cn(
154:               'group/sidebar-wrapper has-[[data-variant=inset]]:bg-sidebar flex min-h-svh w-full',
155:               className
156:             )}
157:             ref={ref}
158:             {...props}
159:           >
160:             {children}
161:           </div>
162:         </TooltipProvider>
163:       </SidebarContext.Provider>
164:     );
165:   }
166: );
167: SidebarProvider.displayName = 'SidebarProvider';
168: 
169: const Sidebar = React.forwardRef<
170:   HTMLDivElement,
171:   React.ComponentProps<'div'> & {
172:     side?: 'left' | 'right';
173:     variant?: 'sidebar' | 'floating' | 'inset';
174:     collapsible?: 'offcanvas' | 'icon' | 'none';
175:   }
176: >(
177:   (
178:     {
179:       side = 'left',
180:       variant = 'sidebar',
181:       collapsible = 'offcanvas',
182:       className,
183:       children,
184:       ...props
185:     },
186:     ref
187:   ) => {
188:     const { isMobile, state, openMobile, setOpenMobile } = useSidebar();
189: 
190:     if (collapsible === 'none') {
191:       return (
192:         <div
193:           className={cn(
194:             'bg-sidebar text-sidebar-foreground flex h-full w-[--sidebar-width] flex-col',
195:             className
196:           )}
197:           ref={ref}
198:           {...props}
199:         >
200:           {children}
201:         </div>
202:       );
203:     }
204: 
205:     if (isMobile) {
206:       return (
207:         <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
208:           <SheetContent
209:             data-sidebar="sidebar"
210:             data-mobile="true"
211:             className="bg-sidebar text-sidebar-foreground w-[--sidebar-width] p-0 [&>button]:hidden"
212:             style={
213:               {
214:                 '--sidebar-width': SIDEBAR_WIDTH_MOBILE,
215:               } as React.CSSProperties
216:             }
217:             side={side}
218:           >
219:             <div className="flex h-full w-full flex-col">{children}</div>
220:           </SheetContent>
221:         </Sheet>
222:       );
223:     }
224: 
225:     return (
226:       <div
227:         ref={ref}
228:         className="text-sidebar-foreground group peer hidden md:block"
229:         data-state={state}
230:         data-collapsible={state === 'collapsed' ? collapsible : ''}
231:         data-variant={variant}
232:         data-side={side}
233:       >
234:         {/* This is what handles the sidebar gap on desktop */}
235:         <div
236:           className={cn(
237:             'relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear',
238:             'group-data-[collapsible=offcanvas]:w-0',
239:             'group-data-[side=right]:rotate-180',
240:             variant === 'floating' || variant === 'inset'
241:               ? 'group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]'
242:               : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon]'
243:           )}
244:         />
245:         <div
246:           className={cn(
247:             'fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex',
248:             side === 'left'
249:               ? 'left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]'
250:               : 'right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]',
251:             // Adjust the padding for floating and inset variants.
252:             variant === 'floating' || variant === 'inset'
253:               ? 'p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]'
254:               : 'group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l',
255:             className
256:           )}
257:           {...props}
258:         >
259:           <div
260:             data-sidebar="sidebar"
261:             className="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow"
262:           >
263:             {children}
264:           </div>
265:         </div>
266:       </div>
267:     );
268:   }
269: );
270: Sidebar.displayName = 'Sidebar';
271: 
272: const SidebarTrigger = React.forwardRef<
273:   React.ElementRef<typeof Button>,
274:   React.ComponentProps<typeof Button>
275: >(({ className, onClick, ...props }, ref) => {
276:   const { toggleSidebar } = useSidebar();
277: 
278:   return (
279:     <Button
280:       ref={ref}
281:       data-sidebar="trigger"
282:       variant="ghost"
283:       size="icon"
284:       className={cn('h-7 w-7', className)}
285:       onClick={event => {
286:         onClick?.(event);
287:         toggleSidebar();
288:       }}
289:       {...props}
290:     >
291:       <PanelLeft />
292:       <span className="sr-only">Toggle Sidebar</span>
293:     </Button>
294:   );
295: });
296: SidebarTrigger.displayName = 'SidebarTrigger';
297: 
298: const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<'button'>>(
299:   ({ className, ...props }, ref) => {
300:     const { toggleSidebar } = useSidebar();
301: 
302:     return (
303:       <button
304:         ref={ref}
305:         data-sidebar="rail"
306:         aria-label="Toggle Sidebar"
307:         tabIndex={-1}
308:         onClick={toggleSidebar}
309:         title="Toggle Sidebar"
310:         className={cn(
311:           'hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex',
312:           '[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize',
313:           '[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize',
314:           'group-data-[collapsible=offcanvas]:hover:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full',
315:           '[[data-side=left][data-collapsible=offcanvas]_&]:-right-2',
316:           '[[data-side=right][data-collapsible=offcanvas]_&]:-left-2',
317:           className
318:         )}
319:         {...props}
320:       />
321:     );
322:   }
323: );
324: SidebarRail.displayName = 'SidebarRail';
325: 
326: const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<'main'>>(
327:   ({ className, ...props }, ref) => {
328:     return (
329:       <main
330:         ref={ref}
331:         className={cn(
332:           'bg-background relative flex min-h-svh flex-1 flex-col',
333:           'peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow',
334:           className
335:         )}
336:         {...props}
337:       />
338:     );
339:   }
340: );
341: SidebarInset.displayName = 'SidebarInset';
342: 
343: const SidebarInput = React.forwardRef<
344:   React.ElementRef<typeof Input>,
345:   React.ComponentProps<typeof Input>
346: >(({ className, ...props }, ref) => {
347:   return (
348:     <Input
349:       ref={ref}
350:       data-sidebar="input"
351:       className={cn(
352:         'bg-background focus-visible:ring-sidebar-ring h-8 w-full shadow-none focus-visible:ring-2',
353:         className
354:       )}
355:       {...props}
356:     />
357:   );
358: });
359: SidebarInput.displayName = 'SidebarInput';
360: 
361: const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
362:   ({ className, ...props }, ref) => {
363:     return (
364:       <div
365:         ref={ref}
366:         data-sidebar="header"
367:         className={cn('flex flex-col gap-2 p-2', className)}
368:         {...props}
369:       />
370:     );
371:   }
372: );
373: SidebarHeader.displayName = 'SidebarHeader';
374: 
375: const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
376:   ({ className, ...props }, ref) => {
377:     return (
378:       <div
379:         ref={ref}
380:         data-sidebar="footer"
381:         className={cn('flex flex-col gap-2 p-2', className)}
382:         {...props}
383:       />
384:     );
385:   }
386: );
387: SidebarFooter.displayName = 'SidebarFooter';
388: 
389: const SidebarSeparator = React.forwardRef<
390:   React.ElementRef<typeof Separator>,
391:   React.ComponentProps<typeof Separator>
392: >(({ className, ...props }, ref) => {
393:   return (
394:     <Separator
395:       ref={ref}
396:       data-sidebar="separator"
397:       className={cn('bg-sidebar-border mx-2 w-auto', className)}
398:       {...props}
399:     />
400:   );
401: });
402: SidebarSeparator.displayName = 'SidebarSeparator';
403: 
404: const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
405:   ({ className, ...props }, ref) => {
406:     return (
407:       <div
408:         ref={ref}
409:         data-sidebar="content"
410:         className={cn(
411:           'flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden',
412:           className
413:         )}
414:         {...props}
415:       />
416:     );
417:   }
418: );
419: SidebarContent.displayName = 'SidebarContent';
420: 
421: const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
422:   ({ className, ...props }, ref) => {
423:     return (
424:       <div
425:         ref={ref}
426:         data-sidebar="group"
427:         className={cn('relative flex w-full min-w-0 flex-col p-2', className)}
428:         {...props}
429:       />
430:     );
431:   }
432: );
433: SidebarGroup.displayName = 'SidebarGroup';
434: 
435: const SidebarGroupLabel = React.forwardRef<
436:   HTMLDivElement,
437:   React.ComponentProps<'div'> & { asChild?: boolean }
438: >(({ className, asChild = false, ...props }, ref) => {
439:   const Comp = asChild ? Slot : 'div';
440: 
441:   return (
442:     <Comp
443:       ref={ref}
444:       data-sidebar="group-label"
445:       className={cn(
446:         'text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-none transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
447:         'group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0',
448:         className
449:       )}
450:       {...props}
451:     />
452:   );
453: });
454: SidebarGroupLabel.displayName = 'SidebarGroupLabel';
455: 
456: const SidebarGroupAction = React.forwardRef<
457:   HTMLButtonElement,
458:   React.ComponentProps<'button'> & { asChild?: boolean }
459: >(({ className, asChild = false, ...props }, ref) => {
460:   const Comp = asChild ? Slot : 'button';
461: 
462:   return (
463:     <Comp
464:       ref={ref}
465:       data-sidebar="group-action"
466:       className={cn(
467:         'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-none transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
468:         // Increases the hit area of the button on mobile.
469:         'after:absolute after:-inset-2 after:md:hidden',
470:         'group-data-[collapsible=icon]:hidden',
471:         className
472:       )}
473:       {...props}
474:     />
475:   );
476: });
477: SidebarGroupAction.displayName = 'SidebarGroupAction';
478: 
479: const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
480:   ({ className, ...props }, ref) => (
481:     <div
482:       ref={ref}
483:       data-sidebar="group-content"
484:       className={cn('w-full text-sm', className)}
485:       {...props}
486:     />
487:   )
488: );
489: SidebarGroupContent.displayName = 'SidebarGroupContent';
490: 
491: const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
492:   ({ className, ...props }, ref) => (
493:     <ul
494:       ref={ref}
495:       data-sidebar="menu"
496:       className={cn('flex w-full min-w-0 flex-col gap-1', className)}
497:       {...props}
498:     />
499:   )
500: );
501: SidebarMenu.displayName = 'SidebarMenu';
502: 
503: const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
504:   ({ className, ...props }, ref) => (
505:     <li
506:       ref={ref}
507:       data-sidebar="menu-item"
508:       className={cn('group/menu-item relative', className)}
509:       {...props}
510:     />
511:   )
512: );
513: SidebarMenuItem.displayName = 'SidebarMenuItem';
514: 
515: const sidebarMenuButtonVariants = cva(
516:   'peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
517:   {
518:     variants: {
519:       variant: {
520:         default: 'hover:bg-sidebar-accent hover:text-sidebar-accent-foreground',
521:         outline:
522:           'bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]',
523:       },
524:       size: {
525:         default: 'h-8 text-sm',
526:         sm: 'h-7 text-xs',
527:         lg: 'h-12 text-sm group-data-[collapsible=icon]:!p-0',
528:       },
529:     },
530:     defaultVariants: {
531:       variant: 'default',
532:       size: 'default',
533:     },
534:   }
535: );
536: 
537: const SidebarMenuButton = React.forwardRef<
538:   HTMLButtonElement,
539:   React.ComponentProps<'button'> & {
540:     asChild?: boolean;
541:     isActive?: boolean;
542:     tooltip?: string | React.ComponentProps<typeof TooltipContent>;
543:   } & VariantProps<typeof sidebarMenuButtonVariants>
544: >(
545:   (
546:     {
547:       asChild = false,
548:       isActive = false,
549:       variant = 'default',
550:       size = 'default',
551:       tooltip,
552:       className,
553:       ...props
554:     },
555:     ref
556:   ) => {
557:     const Comp = asChild ? Slot : 'button';
558:     const { isMobile, state } = useSidebar();
559: 
560:     const button = (
561:       <Comp
562:         ref={ref}
563:         data-sidebar="menu-button"
564:         data-size={size}
565:         data-active={isActive}
566:         className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
567:         {...props}
568:       />
569:     );
570: 
571:     if (!tooltip) {
572:       return button;
573:     }
574: 
575:     if (typeof tooltip === 'string') {
576:       tooltip = {
577:         children: tooltip,
578:       };
579:     }
580: 
581:     return (
582:       <Tooltip>
583:         <TooltipTrigger asChild>{button}</TooltipTrigger>
584:         <TooltipContent
585:           side="right"
586:           align="center"
587:           hidden={state !== 'collapsed' || isMobile}
588:           {...tooltip}
589:         />
590:       </Tooltip>
591:     );
592:   }
593: );
594: SidebarMenuButton.displayName = 'SidebarMenuButton';
595: 
596: const SidebarMenuAction = React.forwardRef<
597:   HTMLButtonElement,
598:   React.ComponentProps<'button'> & {
599:     asChild?: boolean;
600:     showOnHover?: boolean;
601:   }
602: >(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
603:   const Comp = asChild ? Slot : 'button';
604: 
605:   return (
606:     <Comp
607:       ref={ref}
608:       data-sidebar="menu-action"
609:       className={cn(
610:         'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-none transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
611:         // Increases the hit area of the button on mobile.
612:         'after:absolute after:-inset-2 after:md:hidden',
613:         'peer-data-[size=sm]/menu-button:top-1',
614:         'peer-data-[size=default]/menu-button:top-1.5',
615:         'peer-data-[size=lg]/menu-button:top-2.5',
616:         'group-data-[collapsible=icon]:hidden',
617:         showOnHover &&
618:           'peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0',
619:         className
620:       )}
621:       {...props}
622:     />
623:   );
624: });
625: SidebarMenuAction.displayName = 'SidebarMenuAction';
626: 
627: const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
628:   ({ className, ...props }, ref) => (
629:     <div
630:       ref={ref}
631:       data-sidebar="menu-badge"
632:       className={cn(
633:         'text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums',
634:         'peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',
635:         'peer-data-[size=sm]/menu-button:top-1',
636:         'peer-data-[size=default]/menu-button:top-1.5',
637:         'peer-data-[size=lg]/menu-button:top-2.5',
638:         'group-data-[collapsible=icon]:hidden',
639:         className
640:       )}
641:       {...props}
642:     />
643:   )
644: );
645: SidebarMenuBadge.displayName = 'SidebarMenuBadge';
646: 
647: const SidebarMenuSkeleton = React.forwardRef<
648:   HTMLDivElement,
649:   React.ComponentProps<'div'> & {
650:     showIcon?: boolean;
651:   }
652: >(({ className, showIcon = false, ...props }, ref) => {
653:   // Random width between 50 to 90%.
654:   const width = React.useMemo(() => {
655:     return `${Math.floor(Math.random() * 40) + 50}%`;
656:   }, []);
657: 
658:   return (
659:     <div
660:       ref={ref}
661:       data-sidebar="menu-skeleton"
662:       className={cn('flex h-8 items-center gap-2 rounded-md px-2', className)}
663:       {...props}
664:     >
665:       {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
666:       <Skeleton
667:         className="h-4 max-w-[--skeleton-width] flex-1"
668:         data-sidebar="menu-skeleton-text"
669:         style={
670:           {
671:             '--skeleton-width': width,
672:           } as React.CSSProperties
673:         }
674:       />
675:     </div>
676:   );
677: });
678: SidebarMenuSkeleton.displayName = 'SidebarMenuSkeleton';
679: 
680: const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
681:   ({ className, ...props }, ref) => (
682:     <ul
683:       ref={ref}
684:       data-sidebar="menu-sub"
685:       className={cn(
686:         'border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5',
687:         'group-data-[collapsible=icon]:hidden',
688:         className
689:       )}
690:       {...props}
691:     />
692:   )
693: );
694: SidebarMenuSub.displayName = 'SidebarMenuSub';
695: 
696: const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
697:   ({ ...props }, ref) => <li ref={ref} {...props} />
698: );
699: SidebarMenuSubItem.displayName = 'SidebarMenuSubItem';
700: 
701: const SidebarMenuSubButton = React.forwardRef<
702:   HTMLAnchorElement,
703:   React.ComponentProps<'a'> & {
704:     asChild?: boolean;
705:     size?: 'sm' | 'md';
706:     isActive?: boolean;
707:   }
708: >(({ asChild = false, size = 'md', isActive, className, ...props }, ref) => {
709:   const Comp = asChild ? Slot : 'a';
710: 
711:   return (
712:     <Comp
713:       ref={ref}
714:       data-sidebar="menu-sub-button"
715:       data-size={size}
716:       data-active={isActive}
717:       className={cn(
718:         'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
719:         'data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground',
720:         size === 'sm' && 'text-xs',
721:         size === 'md' && 'text-sm',
722:         'group-data-[collapsible=icon]:hidden',
723:         className
724:       )}
725:       {...props}
726:     />
727:   );
728: });
729: SidebarMenuSubButton.displayName = 'SidebarMenuSubButton';
730: 
731: export {
732:   Sidebar,
733:   SidebarContent,
734:   SidebarFooter,
735:   SidebarGroup,
736:   SidebarGroupAction,
737:   SidebarGroupContent,
738:   SidebarGroupLabel,
739:   SidebarHeader,
740:   SidebarInput,
741:   SidebarInset,
742:   SidebarMenu,
743:   SidebarMenuAction,
744:   SidebarMenuBadge,
745:   SidebarMenuButton,
746:   SidebarMenuItem,
747:   SidebarMenuSkeleton,
748:   SidebarMenuSub,
749:   SidebarMenuSubButton,
750:   SidebarMenuSubItem,
751:   SidebarProvider,
752:   SidebarRail,
753:   SidebarSeparator,
754:   SidebarTrigger,
755:   useSidebar,
756: };
```

## File: apps/web/src/components/theme/theme-provider.tsx
```typescript
 1: "use client";
 2: 
 3: import { ThemeProvider as NextThemesProvider } from "next-themes";
 4: import { type ThemeProviderProps } from "next-themes/dist/types";
 5: 
 6: export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
 7:   return (
 8:     <NextThemesProvider
 9:       attribute="class"
10:       defaultTheme="system"
11:       enableSystem
12:       disableTransitionOnChange
13:       {...props}
14:     >
15:       {children}
16:     </NextThemesProvider>
17:   );
18: }
19: 
20: ThemeProvider.displayName = "ThemeProvider";
```

## File: apps/web/src/components/theme/theme-toggle.tsx
```typescript
 1: "use client";
 2: 
 3: import { Moon, Sun } from "lucide-react";
 4: import { useTheme } from "next-themes";
 5: import { Button } from "./button";
 6: 
 7: export function ThemeToggle() {
 8:   const { setTheme, theme } = useTheme();
 9: 
10:   return (
11:     <Button
12:       variant="ghost"
13:       size="icon"
14:       onClick={() => setTheme(theme === "light" ? "dark" : "light")}
15:     >
16:       <div className="relative">
17:         <Sun className="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
18:         <Moon className="absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
19:       </div>
20:       <span className="sr-only">Toggle theme</span>
21:     </Button>
22:   );
23: }
```

## File: apps/web/src/components/providers.tsx
```typescript
 1: 'use client';
 2: 
 3: import React from 'react';
 4: import { ThemeProvider } from 'next-themes';
 5: 
 6: interface ProvidersProps {
 7:   children: React.ReactNode;
 8: }
 9: 
10: export function Providers({ children }: ProvidersProps) {
11:   return (
12:     <ThemeProvider attribute="class" defaultTheme="system" enableSystem disableTransitionOnChange>
13:       {children}
14:     </ThemeProvider>
15:   );
16: }
```

## File: apps/web/src/hooks/use-mobile.tsx
```typescript
 1: import * as React from "react"
 2: 
 3: const MOBILE_BREAKPOINT = 768
 4: 
 5: export function useIsMobile() {
 6:   const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)
 7: 
 8:   React.useEffect(() => {
 9:     const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
10:     const onChange = () => {
11:       setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
12:     }
13:     mql.addEventListener("change", onChange)
14:     setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
15:     return () => mql.removeEventListener("change", onChange)
16:   }, [])
17: 
18:   return !!isMobile
19: }
```

## File: apps/web/src/hooks/use-toast.ts
```typescript
  1: 'use client';
  2: 
  3: // Inspired by react-hot-toast library
  4: import * as React from 'react';
  5: import type { ToastActionElement, ToastProps } from '@danky/ui';
  6: 
  7: const TOAST_LIMIT = 1;
  8: const TOAST_REMOVE_DELAY = 1000000;
  9: 
 10: type ToasterToast = ToastProps & {
 11:   id: string;
 12:   title?: React.ReactNode;
 13:   description?: React.ReactNode;
 14:   action?: ToastActionElement;
 15: };
 16: 
 17: const actionTypes = {
 18:   ADD_TOAST: 'ADD_TOAST',
 19:   UPDATE_TOAST: 'UPDATE_TOAST',
 20:   DISMISS_TOAST: 'DISMISS_TOAST',
 21:   REMOVE_TOAST: 'REMOVE_TOAST',
 22: } as const;
 23: 
 24: let count = 0;
 25: 
 26: function genId() {
 27:   count = (count + 1) % Number.MAX_SAFE_INTEGER;
 28:   return count.toString();
 29: }
 30: 
 31: type ActionType = typeof actionTypes;
 32: 
 33: type Action =
 34:   | {
 35:       type: ActionType['ADD_TOAST'];
 36:       toast: ToasterToast;
 37:     }
 38:   | {
 39:       type: ActionType['UPDATE_TOAST'];
 40:       toast: Partial<ToasterToast>;
 41:     }
 42:   | {
 43:       type: ActionType['DISMISS_TOAST'];
 44:       toastId?: ToasterToast['id'];
 45:     }
 46:   | {
 47:       type: ActionType['REMOVE_TOAST'];
 48:       toastId?: ToasterToast['id'];
 49:     };
 50: 
 51: interface State {
 52:   toasts: ToasterToast[];
 53: }
 54: 
 55: const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();
 56: 
 57: const addToRemoveQueue = (toastId: string) => {
 58:   if (toastTimeouts.has(toastId)) {
 59:     return;
 60:   }
 61: 
 62:   const timeout = setTimeout(() => {
 63:     toastTimeouts.delete(toastId);
 64:     dispatch({
 65:       type: 'REMOVE_TOAST',
 66:       toastId: toastId,
 67:     });
 68:   }, TOAST_REMOVE_DELAY);
 69: 
 70:   toastTimeouts.set(toastId, timeout);
 71: };
 72: 
 73: export const reducer = (state: State, action: Action): State => {
 74:   switch (action.type) {
 75:     case 'ADD_TOAST':
 76:       return {
 77:         ...state,
 78:         toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
 79:       };
 80: 
 81:     case 'UPDATE_TOAST':
 82:       return {
 83:         ...state,
 84:         toasts: state.toasts.map(t => (t.id === action.toast.id ? { ...t, ...action.toast } : t)),
 85:       };
 86: 
 87:     case 'DISMISS_TOAST': {
 88:       const { toastId } = action;
 89: 
 90:       // ! Side effects ! - This could be extracted into a dismissToast() action,
 91:       // but I'll keep it here for simplicity
 92:       if (toastId) {
 93:         addToRemoveQueue(toastId);
 94:       } else {
 95:         state.toasts.forEach(toast => {
 96:           addToRemoveQueue(toast.id);
 97:         });
 98:       }
 99: 
100:       return {
101:         ...state,
102:         toasts: state.toasts.map(t =>
103:           t.id === toastId || toastId === undefined
104:             ? {
105:                 ...t,
106:                 open: false,
107:               }
108:             : t
109:         ),
110:       };
111:     }
112:     case 'REMOVE_TOAST':
113:       if (action.toastId === undefined) {
114:         return {
115:           ...state,
116:           toasts: [],
117:         };
118:       }
119:       return {
120:         ...state,
121:         toasts: state.toasts.filter(t => t.id !== action.toastId),
122:       };
123:   }
124: };
125: 
126: const listeners: Array<(state: State) => void> = [];
127: 
128: let memoryState: State = { toasts: [] };
129: 
130: function dispatch(action: Action) {
131:   memoryState = reducer(memoryState, action);
132:   listeners.forEach(listener => {
133:     listener(memoryState);
134:   });
135: }
136: 
137: type Toast = Omit<ToasterToast, 'id'>;
138: 
139: function toast({ ...props }: Toast) {
140:   const id = genId();
141: 
142:   const update = (props: ToasterToast) =>
143:     dispatch({
144:       type: 'UPDATE_TOAST',
145:       toast: { ...props, id },
146:     });
147:   const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id });
148: 
149:   dispatch({
150:     type: 'ADD_TOAST',
151:     toast: {
152:       ...props,
153:       id,
154:       open: true,
155:       onOpenChange: open => {
156:         if (!open) dismiss();
157:       },
158:     },
159:   });
160: 
161:   return {
162:     id: id,
163:     dismiss,
164:     update,
165:   };
166: }
167: 
168: function useToast() {
169:   const [state, setState] = React.useState<State>(memoryState);
170: 
171:   React.useEffect(() => {
172:     listeners.push(setState);
173:     return () => {
174:       const index = listeners.indexOf(setState);
175:       if (index > -1) {
176:         listeners.splice(index, 1);
177:       }
178:     };
179:   }, [state]);
180: 
181:   return {
182:     ...state,
183:     toast,
184:     dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),
185:   };
186: }
187: 
188: export { useToast, toast };
```

## File: apps/web/src/lib/actions/mcp-actions.ts
```typescript
 1: 'use server';
 2: 
 3: import { convertMcpToLangchainTools } from '@h1deya/langchain-mcp-tools';
 4: import { DynamicStructuredTool } from '@langchain/core/tools';
 5: import { ChatOpenAI } from '@langchain/openai';
 6: import { initializeAgentExecutorWithOptions, AgentExecutor } from 'langchain/agents';
 7: 
 8: type ServerStatus = 'connected' | 'disconnected' | 'error';
 9: 
10: interface Tool {
11:   serverId: string;
12:   toolId: string;
13:   name: string;
14:   description: string;
15: }
16: 
17: interface InitializeResult {
18:   isInitialized: boolean;
19:   serverStatus: Record<string, ServerStatus>;
20:   availableTools: Tool[];
21:   error: string | null;
22: }
23: 
24: let agent: AgentExecutor | null = null;
25: let cleanup: (() => Promise<void>) | null = null;
26: 
27: export async function initialize(): Promise<InitializeResult> {
28:   try {
29:     const model = new ChatOpenAI({
30:       modelName: 'gpt-4-turbo-preview',
31:       temperature: 0,
32:     });
33: 
34:     const { tools, cleanup: cleanupFn } = await convertMcpToLangchainTools({
35:       mcp: {
36:         command: 'node',
37:         args: ['server.js'],
38:         env: {
39:           MCP_SERVER_URL: process.env.MCP_SERVER_URL || 'http://localhost:3001',
40:         },
41:       },
42:     });
43: 
44:     cleanup = cleanupFn;
45:     agent = await initializeAgentExecutorWithOptions(tools, model, {
46:       agentType: 'chat-conversational-react-description',
47:       verbose: true,
48:     });
49: 
50:     return {
51:       isInitialized: true,
52:       serverStatus: {
53:         mcp: 'connected',
54:       },
55:       availableTools: tools.map((tool: DynamicStructuredTool) => ({
56:         serverId: 'mcp',
57:         toolId: tool.name,
58:         name: tool.name,
59:         description: tool.description,
60:       })),
61:       error: null,
62:     };
63:   } catch (error) {
64:     console.error('Failed to initialize MCP service:', error);
65:     return {
66:       isInitialized: false,
67:       serverStatus: {},
68:       availableTools: [],
69:       error: error instanceof Error ? error.message : String(error),
70:     };
71:   }
72: }
73: 
74: export async function processMessage(message: string) {
75:   if (!agent) {
76:     throw new Error('Agent not initialized');
77:   }
78: 
79:   try {
80:     const result = await agent.call({ input: message });
81:     return result.output;
82:   } catch (error) {
83:     console.error('Failed to process message:', error);
84:     throw error;
85:   }
86: }
87: 
88: export async function shutdown() {
89:   if (cleanup) {
90:     await cleanup();
91:     cleanup = null;
92:   }
93:   agent = null;
94: }
```

## File: apps/web/src/lib/db/chat/batch-sessions.ts
```typescript
  1: import { z } from 'zod';
  2: import { db } from '@danky/db';
  3: import { conversations } from '@danky/db/schema/chat';
  4: import { and, eq, sql, inArray } from 'drizzle-orm';
  5: import { withBatchTransaction } from '../transaction';
  6: import { handlePartialSuccess } from '../../errors';
  7: import { logger } from '@danky/logger';
  8: import {
  9:   batchDeleteSessionsRequestSchema,
 10:   batchRestoreSessionsRequestSchema,
 11:   batchArchiveSessionsRequestSchema,
 12:   batchUpdateSessionsRequestSchema,
 13: } from '@danky/schema';
 14: 
 15: // Batch delete sessions
 16: export async function batchDeleteSessions(
 17:   input: z.infer<typeof batchDeleteSessionsRequestSchema>,
 18:   userId: string
 19: ) {
 20:   return withBatchTransaction(
 21:     [async (tx) => {
 22:       // Verify user has access to all sessions
 23:       const sessionsToDelete = await tx
 24:         .select()
 25:         .from(conversations)
 26:         .where(and(
 27:           inArray(conversations.id, input.sessionIds),
 28:           eq(conversations.userId, userId),
 29:           sql`${conversations.deletedAt} IS NULL`
 30:         ))
 31:         .execute();
 32: 
 33:       const foundIds = new Set(sessionsToDelete.map(s => s.id));
 34:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
 35: 
 36:       if (notFound.length > 0) {
 37:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
 38:       }
 39: 
 40:       // Delete sessions
 41:       const deleted = await tx
 42:         .update(conversations)
 43:         .set(
 44:           input.permanent
 45:             ? { deletedAt: new Date() }
 46:             : { softDeletedAt: new Date() }
 47:         )
 48:         .where(inArray(conversations.id, input.sessionIds))
 49:         .returning()
 50:         .execute();
 51: 
 52:       return deleted;
 53:     }]
 54:   );
 55: }
 56: 
 57: // Batch restore sessions
 58: export async function batchRestoreSessions(
 59:   input: z.infer<typeof batchRestoreSessionsRequestSchema>,
 60:   userId: string
 61: ) {
 62:   return withBatchTransaction(
 63:     [async (tx) => {
 64:       // Verify user has access to all sessions
 65:       const sessionsToRestore = await tx
 66:         .select()
 67:         .from(conversations)
 68:         .where(and(
 69:           inArray(conversations.id, input.sessionIds),
 70:           eq(conversations.userId, userId),
 71:           sql`${conversations.deletedAt} IS NOT NULL`
 72:         ))
 73:         .execute();
 74: 
 75:       const foundIds = new Set(sessionsToRestore.map(s => s.id));
 76:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
 77: 
 78:       if (notFound.length > 0) {
 79:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
 80:       }
 81: 
 82:       // Restore sessions
 83:       const restored = await tx
 84:         .update(conversations)
 85:         .set({
 86:           deletedAt: null,
 87:           softDeletedAt: null,
 88:         })
 89:         .where(inArray(conversations.id, input.sessionIds))
 90:         .returning()
 91:         .execute();
 92: 
 93:       return restored;
 94:     }]
 95:   );
 96: }
 97: 
 98: // Batch archive sessions
 99: export async function batchArchiveSessions(
100:   input: z.infer<typeof batchArchiveSessionsRequestSchema>,
101:   userId: string
102: ) {
103:   return withBatchTransaction(
104:     [async (tx) => {
105:       // Verify user has access to all sessions
106:       const sessionsToArchive = await tx
107:         .select()
108:         .from(conversations)
109:         .where(and(
110:           inArray(conversations.id, input.sessionIds),
111:           eq(conversations.userId, userId),
112:           sql`${conversations.deletedAt} IS NULL`
113:         ))
114:         .execute();
115: 
116:       const foundIds = new Set(sessionsToArchive.map(s => s.id));
117:       const notFound = input.sessionIds.filter(id => !foundIds.has(id));
118: 
119:       if (notFound.length > 0) {
120:         throw new Error(`Sessions not found or access denied: ${notFound.join(', ')}`);
121:       }
122: 
123:       // Archive/unarchive sessions
124:       const updated = await tx
125:         .update(conversations)
126:         .set({
127:           isArchived: input.archive,
128:           updatedAt: new Date(),
129:         })
130:         .where(inArray(conversations.id, input.sessionIds))
131:         .returning()
132:         .execute();
133: 
134:       return updated;
135:     }]
136:   );
137: }
138: 
139: // Batch update sessions
140: export async function batchUpdateSessions(
141:   input: z.infer<typeof batchUpdateSessionsRequestSchema>,
142:   userId: string
143: ) {
144:   return withBatchTransaction(
145:     input.sessions.map((session) => async (tx) => {
146:       // Verify user has access to the session
147:       const [existing] = await tx
148:         .select()
149:         .from(conversations)
150:         .where(and(
151:           eq(conversations.id, session.id),
152:           eq(conversations.userId, userId),
153:           sql`${conversations.deletedAt} IS NULL`
154:         ))
155:         .execute();
156: 
157:       if (!existing) {
158:         throw new Error(`Session not found or access denied: ${session.id}`);
159:       }
160: 
161:       // Build update object with only provided fields
162:       const updateData: Record<string, unknown> = {
163:         updatedAt: new Date(),
164:       };
165: 
166:       if (session.name) updateData.title = session.name;
167:       if (session.description !== undefined) updateData.description = session.description;
168:       if (session.modelId) updateData.modelId = session.modelId;
169:       if (session.isArchived !== undefined) updateData.isArchived = session.isArchived;
170:       if (session.metadata) updateData.metadata = session.metadata;
171: 
172:       // Update session
173:       const [updated] = await tx
174:         .update(conversations)
175:         .set(updateData)
176:         .where(eq(conversations.id, session.id))
177:         .returning()
178:         .execute();
179: 
180:       return updated;
181:     })
182:   );
183: }
```

## File: apps/web/src/lib/db/chat/batch.ts
```typescript
  1: import { z } from 'zod';
  2: import { db } from '@danky/db';
  3: import { messages, conversations } from '@danky/db/schema/chat';
  4: import { and, eq, sql, inArray } from 'drizzle-orm';
  5: import { withBatchTransaction } from '../transaction';
  6: import { handlePartialSuccess } from '../../errors';
  7: import { logger } from '@danky/logger';
  8: import {
  9:   batchCreateMessagesRequestSchema,
 10:   batchDeleteMessagesRequestSchema,
 11:   batchRestoreMessagesRequestSchema,
 12: } from '@danky/schema';
 13: 
 14: // Batch create messages
 15: export async function batchCreateMessages(
 16:   input: z.infer<typeof batchCreateMessagesRequestSchema>,
 17:   userId: string
 18: ) {
 19:   return withBatchTransaction(
 20:     input.messages.map((message) => async (tx) => {
 21:       // First verify the user has access to the conversation
 22:       const [conversation] = await tx
 23:         .select()
 24:         .from(conversations)
 25:         .where(and(
 26:           eq(conversations.id, input.sessionId),
 27:           eq(conversations.userId, userId),
 28:           sql`${conversations.deletedAt} IS NULL`
 29:         ))
 30:         .execute();
 31: 
 32:       if (!conversation) {
 33:         throw new Error('Conversation not found or access denied');
 34:       }
 35: 
 36:       // Create message with all content blocks
 37:       const results = await Promise.all(
 38:         message.content.map(async (content) => {
 39:           const [result] = await tx
 40:             .insert(messages)
 41:             .values({
 42:               conversationId: input.sessionId,
 43:               role: message.role,
 44:               content: content.content,
 45:               contentType: content.type,
 46:               language: content.language,
 47:               metadata: message.metadata,
 48:             })
 49:             .returning()
 50:             .execute();
 51: 
 52:           return result;
 53:         })
 54:       );
 55: 
 56:       // Update conversation's updatedAt
 57:       await tx
 58:         .update(conversations)
 59:         .set({ updatedAt: new Date() })
 60:         .where(eq(conversations.id, input.sessionId))
 61:         .execute();
 62: 
 63:       return results[0]; // Return first message for consistency
 64:     })
 65:   );
 66: }
 67: 
 68: // Batch delete messages
 69: export async function batchDeleteMessages(
 70:   input: z.infer<typeof batchDeleteMessagesRequestSchema>,
 71:   userId: string
 72: ) {
 73:   return withBatchTransaction(
 74:     [async (tx) => {
 75:       // Verify user has access to all messages
 76:       const messagesToDelete = await tx
 77:         .select({
 78:           id: messages.id,
 79:           conversationId: messages.conversationId,
 80:         })
 81:         .from(messages)
 82:         .innerJoin(
 83:           conversations,
 84:           eq(messages.conversationId, conversations.id)
 85:         )
 86:         .where(and(
 87:           inArray(messages.id, input.messageIds),
 88:           eq(conversations.userId, userId),
 89:           sql`${messages.deletedAt} IS NULL`
 90:         ))
 91:         .execute();
 92: 
 93:       const foundIds = new Set(messagesToDelete.map(m => m.id));
 94:       const notFound = input.messageIds.filter(id => !foundIds.has(id));
 95: 
 96:       if (notFound.length > 0) {
 97:         throw new Error(`Messages not found or access denied: ${notFound.join(', ')}`);
 98:       }
 99: 
100:       // Delete messages
101:       const deleted = await tx
102:         .update(messages)
103:         .set(
104:           input.permanent
105:             ? { deletedAt: new Date() }
106:             : { softDeletedAt: new Date() }
107:         )
108:         .where(inArray(messages.id, input.messageIds))
109:         .returning()
110:         .execute();
111: 
112:       // Update conversations' updatedAt
113:       const conversationIds = [...new Set(messagesToDelete.map(m => m.conversationId))];
114:       await Promise.all(
115:         conversationIds.map(conversationId =>
116:           tx
117:             .update(conversations)
118:             .set({ updatedAt: new Date() })
119:             .where(eq(conversations.id, conversationId))
120:             .execute()
121:         )
122:       );
123: 
124:       return deleted;
125:     }]
126:   );
127: }
128: 
129: // Batch restore messages
130: export async function batchRestoreMessages(
131:   input: z.infer<typeof batchRestoreMessagesRequestSchema>,
132:   userId: string
133: ) {
134:   return withBatchTransaction(
135:     [async (tx) => {
136:       // Verify user has access to all messages
137:       const messagesToRestore = await tx
138:         .select({
139:           id: messages.id,
140:           conversationId: messages.conversationId,
141:         })
142:         .from(messages)
143:         .innerJoin(
144:           conversations,
145:           eq(messages.conversationId, conversations.id)
146:         )
147:         .where(and(
148:           inArray(messages.id, input.messageIds),
149:           eq(conversations.userId, userId),
150:           sql`${messages.deletedAt} IS NOT NULL`
151:         ))
152:         .execute();
153: 
154:       const foundIds = new Set(messagesToRestore.map(m => m.id));
155:       const notFound = input.messageIds.filter(id => !foundIds.has(id));
156: 
157:       if (notFound.length > 0) {
158:         throw new Error(`Messages not found or access denied: ${notFound.join(', ')}`);
159:       }
160: 
161:       // Restore messages
162:       const restored = await tx
163:         .update(messages)
164:         .set({
165:           deletedAt: null,
166:           softDeletedAt: null,
167:         })
168:         .where(inArray(messages.id, input.messageIds))
169:         .returning()
170:         .execute();
171: 
172:       // Update conversations' updatedAt
173:       const conversationIds = [...new Set(messagesToRestore.map(m => m.conversationId))];
174:       await Promise.all(
175:         conversationIds.map(conversationId =>
176:           tx
177:             .update(conversations)
178:             .set({ updatedAt: new Date() })
179:             .where(eq(conversations.id, conversationId))
180:             .execute()
181:         )
182:       );
183: 
184:       return restored;
185:     }]
186:   );
187: }
```

## File: apps/web/src/lib/db/chat.ts
```typescript
  1: import { z } from 'zod';
  2: import { chats, sessions } from '@danky/db';
  3: import { and, desc, eq, sql, ilike, isNull } from 'drizzle-orm';
  4: import { webListMessagesSchema } from '../validations/chat';
  5: import {
  6:   createSessionRequestSchema,
  7:   listSessionsRequestSchema,
  8:   updateSessionRequestSchema,
  9:   deleteSessionRequestSchema,
 10:   createMessageRequestSchema,
 11: } from '@danky/schema';
 12: import { withWriteTransaction, withReadOnlyTransaction } from './transaction';
 13: import { ForbiddenError, NotFoundError } from '../errors';
 14: 
 15: export async function getMessages(input: z.infer<typeof webListMessagesSchema>) {
 16:   return withReadOnlyTransaction(async tx => {
 17:     const { sessionId, page, limit, includeDeleted, sortOrder } = input;
 18:     const offset = (page - 1) * limit;
 19: 
 20:     // Verify user has access to the session
 21:     const [session] = await tx
 22:       .select()
 23:       .from(sessions)
 24:       .where(and(eq(sessions.id, sessionId), isNull(sessions.deletedAt)))
 25:       .execute();
 26: 
 27:     if (!session) {
 28:       throw new NotFoundError('Session not found or access denied');
 29:     }
 30: 
 31:     // Build where clause
 32:     const whereClause = and(
 33:       eq(chats.sessionId, sessionId),
 34:       includeDeleted ? undefined : isNull(chats.deletedAt)
 35:     );
 36: 
 37:     // Get total count first
 38:     const [countResult] = await tx
 39:       .select({ count: sql<number>`count(*)` })
 40:       .from(chats)
 41:       .where(whereClause)
 42:       .execute();
 43: 
 44:     const totalItems = Number(countResult?.count ?? 0);
 45:     const totalPages = Math.ceil(totalItems / limit);
 46: 
 47:     // Get paginated messages
 48:     const results = await tx
 49:       .select({
 50:         id: chats.id,
 51:         role: chats.role,
 52:         content: chats.content,
 53:         sessionId: chats.sessionId,
 54:         metadata: chats.metadata,
 55:         createdAt: chats.createdAt,
 56:         updatedAt: chats.updatedAt,
 57:         deletedAt: chats.deletedAt,
 58:       })
 59:       .from(chats)
 60:       .where(whereClause)
 61:       .orderBy(sortOrder === 'desc' ? desc(chats.createdAt) : chats.createdAt)
 62:       .limit(limit)
 63:       .offset(offset)
 64:       .execute();
 65: 
 66:     return {
 67:       messages: results,
 68:       pagination: {
 69:         page,
 70:         limit,
 71:         totalPages,
 72:         totalItems,
 73:       },
 74:     };
 75:   });
 76: }
 77: 
 78: export async function createSession(
 79:   input: z.infer<typeof createSessionRequestSchema>,
 80:   userId: string
 81: ) {
 82:   return withWriteTransaction(async tx => {
 83:     const result = await tx
 84:       .insert(sessions)
 85:       .values({
 86:         title: input.title,
 87:         userId,
 88:         modelId: input.modelId,
 89:         description: input.description,
 90:         isArchived: false,
 91:         metadata: JSON.stringify(input.metadata),
 92:       })
 93:       .returning()
 94:       .execute();
 95: 
 96:     return result[0];
 97:   });
 98: }
 99: 
100: export async function getSessions(
101:   input: z.infer<typeof listSessionsRequestSchema>,
102:   userId: string
103: ) {
104:   return withReadOnlyTransaction(async tx => {
105:     const { page, limit, search } = input;
106:     const offset = (page - 1) * limit;
107: 
108:     // Build where clause
109:     const whereClause = and(
110:       eq(sessions.userId, userId),
111:       isNull(sessions.deletedAt),
112:       search ? ilike(sessions.title, `%${search}%`) : undefined
113:     );
114: 
115:     // Get total count first
116:     const [countResult] = await tx
117:       .select({ count: sql<number>`count(*)` })
118:       .from(sessions)
119:       .where(whereClause)
120:       .execute();
121: 
122:     const totalItems = Number(countResult?.count ?? 0);
123:     const totalPages = Math.ceil(totalItems / limit);
124: 
125:     // Get paginated sessions
126:     const results = await tx
127:       .select()
128:       .from(sessions)
129:       .where(whereClause)
130:       .orderBy(desc(sessions.updatedAt))
131:       .limit(limit)
132:       .offset(offset)
133:       .execute();
134: 
135:     return {
136:       sessions: results,
137:       pagination: {
138:         page,
139:         limit,
140:         totalPages,
141:         totalItems,
142:       },
143:     };
144:   });
145: }
146: 
147: export async function updateSession(
148:   input: z.infer<typeof updateSessionRequestSchema>,
149:   userId: string
150: ) {
151:   return withWriteTransaction(async tx => {
152:     // Verify session exists and user has access
153:     const [existingSession] = await tx
154:       .select()
155:       .from(sessions)
156:       .where(
157:         and(eq(sessions.id, input.id), eq(sessions.userId, userId), isNull(sessions.deletedAt))
158:       )
159:       .execute();
160: 
161:     if (!existingSession) {
162:       throw new NotFoundError('Session not found or access denied');
163:     }
164: 
165:     // Build update object with only provided fields
166:     const updateData: Record<string, unknown> = {};
167:     if (input.title) updateData.title = input.title;
168:     if (input.description !== undefined) updateData.description = input.description;
169:     if (input.modelId) updateData.modelId = input.modelId;
170:     if (input.metadata) updateData.metadata = JSON.stringify(input.metadata);
171: 
172:     // Update session
173:     const [updated] = await tx
174:       .update(sessions)
175:       .set(updateData)
176:       .where(eq(sessions.id, input.id))
177:       .returning()
178:       .execute();
179: 
180:     return updated;
181:   });
182: }
183: 
184: export async function deleteSession(
185:   input: z.infer<typeof deleteSessionRequestSchema>,
186:   userId: string
187: ) {
188:   return withWriteTransaction(async tx => {
189:     // Verify session exists and user has access
190:     const [existingSession] = await tx
191:       .select()
192:       .from(sessions)
193:       .where(
194:         and(eq(sessions.id, input.id), eq(sessions.userId, userId), isNull(sessions.deletedAt))
195:       )
196:       .execute();
197: 
198:     if (!existingSession) {
199:       throw new NotFoundError('Session not found or access denied');
200:     }
201: 
202:     // Soft delete the session
203:     const [deleted] = await tx
204:       .update(sessions)
205:       .set({
206:         deletedAt: new Date(),
207:         isArchived: true,
208:       })
209:       .where(eq(sessions.id, input.id))
210:       .returning()
211:       .execute();
212: 
213:     return deleted;
214:   });
215: }
216: 
217: // Batch operations
218: export async function batchDeleteSessions(sessionIds: string[], userId: string) {
219:   return withWriteTransaction(async tx => {
220:     // Verify all sessions exist and user has access
221:     const existingSessions = await tx
222:       .select()
223:       .from(sessions)
224:       .where(and(eq(sessions.userId, userId), isNull(sessions.deletedAt)))
225:       .execute();
226: 
227:     const sessionSet = new Set(existingSessions.map(s => s.id));
228:     const invalidSessions = sessionIds.filter(id => !sessionSet.has(id));
229: 
230:     if (invalidSessions.length > 0) {
231:       throw new NotFoundError(
232:         `Some sessions not found or access denied: ${invalidSessions.join(', ')}`
233:       );
234:     }
235: 
236:     // Soft delete all sessions
237:     const deleted = await tx
238:       .update(sessions)
239:       .set({
240:         deletedAt: new Date(),
241:         isArchived: true,
242:       })
243:       .where(and(sql`${sessions.id} = ANY(${sessionIds})`, eq(sessions.userId, userId)))
244:       .returning()
245:       .execute();
246: 
247:     return deleted;
248:   });
249: }
250: 
251: export async function batchArchiveSessions(sessionIds: string[], userId: string, archive: boolean) {
252:   return withWriteTransaction(async tx => {
253:     // Verify all sessions exist and user has access
254:     const existingSessions = await tx
255:       .select()
256:       .from(sessions)
257:       .where(and(eq(sessions.userId, userId), isNull(sessions.deletedAt)))
258:       .execute();
259: 
260:     const sessionSet = new Set(existingSessions.map(s => s.id));
261:     const invalidSessions = sessionIds.filter(id => !sessionSet.has(id));
262: 
263:     if (invalidSessions.length > 0) {
264:       throw new NotFoundError(
265:         `Some sessions not found or access denied: ${invalidSessions.join(', ')}`
266:       );
267:     }
268: 
269:     // Update archive status
270:     const updated = await tx
271:       .update(sessions)
272:       .set({ isArchived: archive })
273:       .where(and(sql`${sessions.id} = ANY(${sessionIds})`, eq(sessions.userId, userId)))
274:       .returning()
275:       .execute();
276: 
277:     return updated;
278:   });
279: }
280: 
281: export async function createMessage(
282:   input: z.infer<typeof createMessageRequestSchema>,
283:   userId: string
284: ) {
285:   return withWriteTransaction(async tx => {
286:     // First verify the user has access to the session
287:     const [session] = await tx
288:       .select()
289:       .from(sessions)
290:       .where(
291:         and(
292:           eq(sessions.id, input.sessionId),
293:           eq(sessions.userId, userId),
294:           isNull(sessions.deletedAt)
295:         )
296:       )
297:       .execute();
298: 
299:     if (!session) {
300:       throw new NotFoundError('Session not found');
301:     }
302: 
303:     if (session.deletedAt) {
304:       throw new ForbiddenError('Cannot add messages to a deleted session');
305:     }
306: 
307:     // Create messages
308:     const messages = await Promise.all(
309:       input.content.map(async content => {
310:         const [message] = await tx
311:           .insert(chats)
312:           .values({
313:             sessionId: input.sessionId,
314:             role: input.role,
315:             content: content.content,
316:             metadata: JSON.stringify(input.metadata),
317:           })
318:           .returning()
319:           .execute();
320: 
321:         return message;
322:       })
323:     );
324: 
325:     // Update session's updatedAt
326:     await tx
327:       .update(sessions)
328:       .set({ updatedAt: new Date() })
329:       .where(eq(sessions.id, input.sessionId))
330:       .execute();
331: 
332:     return messages;
333:   });
334: }
```

## File: apps/web/src/lib/db/transaction.ts
```typescript
  1: import { db } from '@danky/db';
  2: import { handleDatabaseError } from '../errors';
  3: import { logger } from '@danky/logger';
  4: import { sql } from 'drizzle-orm';
  5: 
  6: // Transaction options type
  7: interface TransactionOptions {
  8:   maxRetries?: number;
  9:   retryDelay?: number;
 10:   timeout?: number;
 11: }
 12: 
 13: // Default options
 14: const DEFAULT_OPTIONS: Required<TransactionOptions> = {
 15:   maxRetries: 3,
 16:   retryDelay: 100,
 17:   timeout: 30000,
 18: };
 19: 
 20: // Helper to wait between retries
 21: const wait = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));
 22: 
 23: // Helper to check if error is retryable
 24: function isRetryableError(error: unknown): boolean {
 25:   if (!(error instanceof Error)) return false;
 26: 
 27:   const message = error.message.toLowerCase();
 28:   return (
 29:     message.includes('deadlock') ||
 30:     message.includes('lock timeout') ||
 31:     message.includes('serialization') ||
 32:     message.includes('too many connections') ||
 33:     message.includes('connection terminated')
 34:   );
 35: }
 36: 
 37: // Generic transaction executor with retries
 38: async function executeTransaction<T>(
 39:   operation: (tx: typeof db) => Promise<T>,
 40:   options: TransactionOptions = {}
 41: ): Promise<T> {
 42:   const { maxRetries, retryDelay, timeout } = { ...DEFAULT_OPTIONS, ...options };
 43:   let attempt = 0;
 44: 
 45:   while (true) {
 46:     attempt++;
 47: 
 48:     try {
 49:       // Start transaction with timeout
 50:       const result = await Promise.race([
 51:         db.transaction(async tx => {
 52:           return operation(tx);
 53:         }),
 54:         new Promise((_, reject) =>
 55:           setTimeout(() => reject(new Error('Transaction timeout')), timeout)
 56:         ),
 57:       ]);
 58: 
 59:       return result as T;
 60:     } catch (error) {
 61:       logger.error({
 62:         operation: 'transaction',
 63:         attempt,
 64:         error: error instanceof Error ? error.message : 'Unknown error',
 65:       });
 66: 
 67:       if (attempt >= maxRetries || !isRetryableError(error)) {
 68:         return handleDatabaseError(error);
 69:       }
 70: 
 71:       // Wait before retrying
 72:       await wait(retryDelay * attempt);
 73:     }
 74:   }
 75: }
 76: 
 77: // Read-only transaction wrapper
 78: export async function withReadOnlyTransaction<T>(
 79:   operation: (tx: typeof db) => Promise<T>,
 80:   options?: TransactionOptions
 81: ): Promise<T> {
 82:   return executeTransaction(async tx => {
 83:     // Set transaction to read only
 84:     await tx.execute(sql`SET TRANSACTION READ ONLY`);
 85:     return operation(tx);
 86:   }, options);
 87: }
 88: 
 89: // Write transaction wrapper
 90: export async function withWriteTransaction<T>(
 91:   operation: (tx: typeof db) => Promise<T>,
 92:   options?: TransactionOptions
 93: ): Promise<T> {
 94:   return executeTransaction(async tx => {
 95:     // Set transaction isolation level
 96:     await tx.execute(sql`SET TRANSACTION ISOLATION LEVEL SERIALIZABLE`);
 97:     return operation(tx);
 98:   }, options);
 99: }
100: 
101: // Batch operation wrapper
102: export async function withBatchTransaction<T>(
103:   operations: Array<(tx: typeof db) => Promise<T>>,
104:   options?: TransactionOptions
105: ): Promise<T[]> {
106:   return executeTransaction(async tx => {
107:     const results: T[] = [];
108:     const errors: Error[] = [];
109: 
110:     for (const operation of operations) {
111:       try {
112:         const result = await operation(tx);
113:         results.push(result);
114:       } catch (error) {
115:         errors.push(error as Error);
116:         // Don't break the transaction for partial failures
117:         logger.error({
118:           operation: 'batchOperation',
119:           error: error instanceof Error ? error.message : 'Unknown error',
120:         });
121:       }
122:     }
123: 
124:     // If all operations failed, throw error
125:     if (errors.length === operations.length) {
126:       throw new Error('All batch operations failed');
127:     }
128: 
129:     return results;
130:   }, options);
131: }
132: 
133: // Connection pool management
134: let poolSize = 10;
135: 
136: export function setPoolSize(size: number): void {
137:   poolSize = size;
138:   // Update pool size in database configuration
139:   db.execute(sql`SET max_connections = ${size}`);
140: }
141: 
142: export function getPoolSize(): number {
143:   return poolSize;
144: }
145: 
146: // Export transaction types
147: export type Transaction = typeof db;
148: export type TransactionClient = Awaited<ReturnType<typeof db.transaction>>;
```

## File: apps/web/src/lib/services/init-chat-model.ts
```typescript
 1: import { ChatOpenAI } from '@langchain/openai'
 2: import { ChatAnthropic } from '@langchain/anthropic'
 3: import { ChatGroq } from '@langchain/groq'
 4: import { type BaseChatModel } from '@langchain/core/language_models/chat_models'
 5: 
 6: type LLMConfig = {
 7:   provider: 'openai' | 'anthropic' | 'groq'
 8:   model: string
 9:   apiKey?: string
10:   temperature?: number
11:   maxTokens?: number
12: }
13: 
14: export function initChatModel(config: LLMConfig): BaseChatModel {
15:   const { provider, model, apiKey, temperature = 0.7, maxTokens = 1000 } = config
16: 
17:   switch (provider) {
18:     case 'openai':
19:       return new ChatOpenAI({
20:         modelName: model,
21:         openAIApiKey: apiKey,
22:         temperature,
23:         maxTokens,
24:       })
25:     case 'anthropic':
26:       // Use provided API key or fall back to environment variable
27:       const anthropicApiKey = apiKey || process.env.ANTHROPIC_API_KEY
28:       if (!anthropicApiKey) {
29:         throw new Error('Anthropic API key not found in config or environment')
30:       }
31:       return new ChatAnthropic({
32:         modelName: model,
33:         anthropicApiKey,
34:         temperature,
35:         maxTokens,
36:       })
37:     case 'groq':
38:       return new ChatGroq({
39:         modelName: model,
40:         apiKey: apiKey,
41:         temperature,
42:         maxTokens,
43:       })
44:     default:
45:       throw new Error(`Unsupported LLM provider: ${provider}`)
46:   }
47: }
```

## File: apps/web/src/lib/services/load-config.ts
```typescript
 1: import { z } from 'zod'
 2: import JSON5 from 'json5'
 3: import { readFileSync } from 'fs'
 4: import path from 'path'
 5: 
 6: const LLMConfigSchema = z.object({
 7:   provider: z.enum(['openai', 'anthropic', 'groq']),
 8:   model: z.string(),
 9:   apiKey: z.string().optional(),
10:   temperature: z.number().optional(),
11:   maxTokens: z.number().optional(),
12: })
13: 
14: const MCPServerConfigSchema = z.object({
15:   command: z.string(),
16:   args: z.array(z.string()),
17:   env: z.record(z.string()).optional(),
18: })
19: 
20: const MCPConfigSchema = z.object({
21:   llm: LLMConfigSchema,
22:   mcpServers: z.record(MCPServerConfigSchema),
23: })
24: 
25: export type MCPConfig = z.infer<typeof MCPConfigSchema>
26: 
27: export function loadMCPConfig(): MCPConfig {
28:   try {
29:     // Load the config file
30:     const configPath = path.resolve(process.cwd(), 'mcp-config.json5')
31:     let configStr = readFileSync(configPath, 'utf-8')
32: 
33:     // Replace environment variables in the format ${VAR_NAME} with their values
34:     Object.entries(process.env).forEach(([key, value]) => {
35:       const regex = new RegExp(`\\$\{${key}\}`, 'g')
36:       if (value) {
37:         configStr = configStr.replace(regex, value)
38:       }
39:     })
40: 
41:     // Parse the config
42:     const config = JSON5.parse(configStr)
43: 
44:     // Validate required environment variables are set
45:     if (config.llm?.apiKey?.includes('${')) {
46:       const missing = config.llm.apiKey.match(/\$\{([^}]+)\}/g)?.map((match: string) => match.slice(2, -1))
47:       throw new Error(`Environment variables not found: ${missing?.join(', ')}. Make sure these are set in the root .env file, not .env.local`)
48:     }
49: 
50:     // Update filesystem server path to be relative to the config location
51:     if (config.mcpServers?.filesystem?.args) {
52:       const args = config.mcpServers.filesystem.args
53:       const dirIndex = args.findIndex((arg: string) => arg === '.')
54:       if (dirIndex !== -1) {
55:         const newPath = path.dirname(configPath)
56:         console.log(`Updating filesystem server path from '.' to:`, newPath)
57:         args[dirIndex] = newPath
58:       }
59:     }
60: 
61:     return MCPConfigSchema.parse(config)
62:   } catch (error) {
63:     console.error('Failed to load MCP configuration:', error)
64:     throw error
65:   }
66: }
```

## File: apps/web/src/lib/stores/chat-store.ts
```typescript
  1: 'use client';
  2: 
  3: import { create } from 'zustand';
  4: import { type Message, type Session, messageContentSchema, textContentSchema } from '@danky/schema';
  5: import { createMessage, listMessages } from '@/app/api/actions/chat';
  6: import { type z } from 'zod';
  7: import { webListMessagesSchema } from '@/lib/validations/chat';
  8: 
  9: type ChatStatus = 'idle' | 'loading' | 'error';
 10: 
 11: interface ChatStore {
 12:   messages: Message[];
 13:   sessions: Session[];
 14:   currentSession: string | null;
 15:   status: ChatStatus;
 16:   isInitializing: boolean;
 17:   isProcessing: boolean;
 18:   error: string | null;
 19:   addMessage: (message: Omit<Message, 'createdAt' | 'updatedAt'>) => void;
 20:   sendMessage: (content: string) => Promise<void>;
 21:   initialize: () => Promise<void>;
 22:   createSession: () => void;
 23:   setCurrentSession: (sessionId: string) => void;
 24:   clearError: () => void;
 25: }
 26: 
 27: // Helper to create a text content object
 28: const createTextContent = (text: string): z.infer<typeof textContentSchema> => ({
 29:   type: 'text',
 30:   content: text,
 31: });
 32: 
 33: export const useChatStore = create<ChatStore>((set, get) => ({
 34:   messages: [],
 35:   sessions: [],
 36:   currentSession: null,
 37:   status: 'idle',
 38:   isInitializing: true,
 39:   isProcessing: false,
 40:   error: null,
 41: 
 42:   addMessage: (message: Omit<Message, 'createdAt' | 'updatedAt'>) => {
 43:     const now = new Date();
 44:     const newMessage = {
 45:       ...message,
 46:       createdAt: now,
 47:       updatedAt: now,
 48:       metadata: message.metadata || {},
 49:     };
 50: 
 51:     set(state => ({
 52:       messages: [...state.messages, newMessage],
 53:       sessions: state.currentSession
 54:         ? state.sessions.map(session =>
 55:             session.id === state.currentSession
 56:               ? {
 57:                   ...session,
 58:                   metadata: {
 59:                     ...session.metadata,
 60:                     lastMessage: message.content[0].content,
 61:                   },
 62:                   updatedAt: now,
 63:                 }
 64:               : session
 65:           )
 66:         : state.sessions,
 67:     }));
 68:   },
 69: 
 70:   sendMessage: async (content: string) => {
 71:     const { currentSession } = get();
 72:     if (!currentSession) {
 73:       set({ error: 'No active chat session' });
 74:       return;
 75:     }
 76: 
 77:     set({ isProcessing: true, error: null, status: 'loading' });
 78: 
 79:     try {
 80:       // Add user message to UI immediately
 81:       get().addMessage({
 82:         id: crypto.randomUUID(),
 83:         role: 'user',
 84:         content: [createTextContent(content)],
 85:         sessionId: currentSession,
 86:       });
 87: 
 88:       // Send message to API
 89:       const response = await createMessage({
 90:         sessionId: currentSession,
 91:         role: 'user',
 92:         content: [createTextContent(content)],
 93:       });
 94: 
 95:       if (!response.success || !response.data) {
 96:         throw new Error(response.error || 'Failed to send message');
 97:       }
 98: 
 99:       // Add assistant message
100:       if (response.data.role === 'assistant') {
101:         get().addMessage({
102:           id: crypto.randomUUID(),
103:           role: 'assistant',
104:           content: response.data.content.map(c => ({
105:             type: c.type,
106:             content: c.content,
107:             ...(c.type === 'code' && { language: c.language }),
108:           })) as z.infer<typeof messageContentSchema>[],
109:           sessionId: currentSession,
110:         });
111:       }
112: 
113:       set({ status: 'idle' });
114:     } catch (error) {
115:       console.error('Error processing message:', error);
116:       set({
117:         error: error instanceof Error ? error.message : String(error),
118:         status: 'error',
119:       });
120:       // Add error message to chat
121:       get().addMessage({
122:         id: crypto.randomUUID(),
123:         role: 'assistant',
124:         content: [
125:           createTextContent(`Error: ${error instanceof Error ? error.message : String(error)}`),
126:         ],
127:         sessionId: currentSession,
128:       });
129:     } finally {
130:       set({ isProcessing: false });
131:     }
132:   },
133: 
134:   initialize: async () => {
135:     set({ isInitializing: true, error: null, status: 'loading' });
136: 
137:     try {
138:       // Get initial messages if there's a current session
139:       const { currentSession } = get();
140:       if (currentSession) {
141:         const params: z.infer<typeof webListMessagesSchema> = {
142:           sessionId: currentSession,
143:           page: 1,
144:           limit: 100,
145:           includeDeleted: false,
146:           sortOrder: 'asc',
147:         };
148:         const response = await listMessages(JSON.stringify(params));
149: 
150:         if (!response.success || !response.data) {
151:           throw new Error(response.error || 'Failed to load messages');
152:         }
153: 
154:         set({
155:           messages: response.data.messages,
156:         });
157:       }
158: 
159:       set({ isInitializing: false, status: 'idle' });
160:     } catch (error) {
161:       console.error('Error initializing chat:', error);
162:       set({
163:         isInitializing: false,
164:         error: error instanceof Error ? error.message : String(error),
165:         status: 'error',
166:       });
167:     }
168:   },
169: 
170:   createSession: () => {
171:     const now = new Date();
172:     const newSession: Session = {
173:       id: crypto.randomUUID(),
174:       title: 'New Chat',
175:       modelId: 'gpt-4',
176:       createdAt: now,
177:       updatedAt: now,
178:       metadata: {
179:         lastMessage: '',
180:       },
181:     };
182: 
183:     set(state => ({
184:       sessions: [newSession, ...state.sessions],
185:       currentSession: newSession.id,
186:       messages: [], // Clear messages for new session
187:     }));
188:   },
189: 
190:   setCurrentSession: (sessionId: string) => {
191:     set({ currentSession: sessionId, messages: [] }); // Clear messages when switching sessions
192:     // Load messages for this session
193:     get().initialize();
194:   },
195: 
196:   clearError: () => {
197:     set({ error: null });
198:   },
199: }));
```

## File: apps/web/src/lib/stores/mcp-store.ts
```typescript
 1: 'use client';
 2: 
 3: import { create } from 'zustand';
 4: import * as mcpActions from '../actions/mcp-actions';
 5: 
 6: type ServerStatus = 'connected' | 'disconnected' | 'error';
 7: 
 8: interface Tool {
 9:   serverId: string;
10:   toolId: string;
11:   name: string;
12:   description: string;
13: }
14: 
15: interface MCPState {
16:   isInitialized: boolean;
17:   isInitializing: boolean;
18:   serverStatus: Record<string, ServerStatus>;
19:   availableTools: Tool[];
20:   error: string | null;
21: }
22: 
23: interface MCPActions {
24:   initialize: () => Promise<void>;
25:   processMessage: (message: string) => Promise<string>;
26:   reset: () => void;
27: }
28: 
29: type MCPStore = MCPState & MCPActions;
30: 
31: const initialState: MCPState = {
32:   isInitialized: false,
33:   isInitializing: false,
34:   serverStatus: {},
35:   availableTools: [],
36:   error: null,
37: };
38: 
39: export const useMCPStore = create<MCPStore>((set, get) => ({
40:   ...initialState,
41: 
42:   initialize: async () => {
43:     if (get().isInitialized || get().isInitializing) return;
44: 
45:     set({ isInitializing: true });
46: 
47:     try {
48:       const result = await mcpActions.initialize();
49: 
50:       set({
51:         isInitialized: result.isInitialized,
52:         serverStatus: result.serverStatus,
53:         availableTools: result.availableTools,
54:         error: result.error,
55:       });
56:     } catch (error) {
57:       set({
58:         isInitialized: false,
59:         error: error instanceof Error ? error.message : 'Failed to initialize MCP service',
60:         serverStatus: {},
61:         availableTools: [],
62:       });
63:     } finally {
64:       set({ isInitializing: false });
65:     }
66:   },
67: 
68:   processMessage: async (message: string) => {
69:     if (!get().isInitialized) {
70:       throw new Error('MCP service not initialized');
71:     }
72: 
73:     try {
74:       return await mcpActions.processMessage(message);
75:     } catch (error) {
76:       const errorMessage = error instanceof Error ? error.message : 'Failed to process message';
77:       set({ error: errorMessage });
78:       throw new Error(errorMessage);
79:     }
80:   },
81: 
82:   reset: () => {
83:     mcpActions.shutdown().catch(console.error);
84:     set(initialState);
85:   },
86: }));
```

## File: apps/web/src/lib/validations/chat.ts
```typescript
 1: import { z } from 'zod';
 2: import { createMessageRequestSchema, listMessagesRequestSchema } from '@danky/schema';
 3: 
 4: // Extend the base create message schema with app-specific fields
 5: export const webCreateMessageSchema = createMessageRequestSchema.extend({
 6:   attachments: z
 7:     .array(
 8:       z.object({
 9:         name: z.string(),
10:         url: z.string().url(),
11:         type: z.string(),
12:         size: z.number(),
13:       })
14:     )
15:     .optional(),
16: });
17: 
18: // Extend the base list messages schema with app-specific fields
19: export const webListMessagesSchema = listMessagesRequestSchema.extend({
20:   includeDeleted: z.boolean().default(false),
21:   sortOrder: z.enum(['asc', 'desc']).default('desc'),
22: });
23: 
24: // Export the list messages params type
25: export type WebListMessagesParams = z.infer<typeof webListMessagesSchema>;
26: 
27: // Chat settings schema
28: export const chatSettingsSchema = z.object({
29:   model: z.string(),
30:   temperature: z.number().min(0).max(2).default(0.7),
31:   maxTokens: z.number().positive().max(4096).default(1024),
32:   topP: z.number().min(0).max(1).default(1),
33:   frequencyPenalty: z.number().min(-2).max(2).default(0),
34:   presencePenalty: z.number().min(-2).max(2).default(0),
35: });
```

## File: apps/web/src/lib/errors.ts
```typescript
  1: import { createLogger } from '@danky/logger';
  2: import { z } from 'zod';
  3: 
  4: const logger = createLogger('error-handler');
  5: 
  6: export class AppError extends Error {
  7:   constructor(
  8:     message: string,
  9:     public code: string,
 10:     public statusCode: number = 500,
 11:     public details?: unknown
 12:   ) {
 13:     super(message);
 14:     this.name = 'AppError';
 15:   }
 16: }
 17: 
 18: export class WebSocketError extends AppError {
 19:   constructor(message: string, details?: unknown) {
 20:     super(message, 'WEBSOCKET_ERROR', 500, details);
 21:     this.name = 'WebSocketError';
 22:   }
 23: }
 24: 
 25: export class APIError extends AppError {
 26:   constructor(message: string, statusCode: number = 500, details?: unknown) {
 27:     super(message, 'API_ERROR', statusCode, details);
 28:     this.name = 'APIError';
 29:   }
 30: }
 31: 
 32: export class UnauthorizedError extends AppError {
 33:   constructor(message: string = 'Unauthorized', details?: unknown) {
 34:     super(message, 'UNAUTHORIZED', 401, details);
 35:     this.name = 'UnauthorizedError';
 36:   }
 37: }
 38: 
 39: export class ForbiddenError extends AppError {
 40:   constructor(message: string = 'Forbidden', details?: unknown) {
 41:     super(message, 'FORBIDDEN', 403, details);
 42:     this.name = 'ForbiddenError';
 43:   }
 44: }
 45: 
 46: export class NotFoundError extends AppError {
 47:   constructor(message: string = 'Not Found', details?: unknown) {
 48:     super(message, 'NOT_FOUND', 404, details);
 49:     this.name = 'NotFoundError';
 50:   }
 51: }
 52: 
 53: export function handleError(error: unknown): never {
 54:   if (error instanceof AppError) {
 55:     logger.error(
 56:       {
 57:         code: error.code,
 58:         statusCode: error.statusCode,
 59:         details: error.details,
 60:       },
 61:       error.message
 62:     );
 63:     throw error;
 64:   }
 65: 
 66:   // Handle unknown errors
 67:   logger.error({ error }, 'Unexpected error occurred');
 68:   throw new AppError('An unexpected error occurred', 'UNKNOWN_ERROR');
 69: }
 70: 
 71: export function withErrorHandling<TInput, TOutput>(
 72:   handler: (input: TInput) => Promise<TOutput>,
 73:   responseSchema: z.ZodType<TOutput>,
 74:   operationName: string
 75: ): (input: TInput) => Promise<TOutput> {
 76:   return async (input: TInput) => {
 77:     try {
 78:       const result = await handler(input);
 79:       return responseSchema.parse(result);
 80:     } catch (error) {
 81:       logger.error({ error, input, operation: operationName }, 'Operation failed');
 82: 
 83:       if (error instanceof AppError) {
 84:         // Return error response
 85:         return responseSchema.parse({
 86:           success: false,
 87:           error: error.message,
 88:         });
 89:       }
 90: 
 91:       if (error instanceof z.ZodError) {
 92:         // Return validation error response
 93:         return responseSchema.parse({
 94:           success: false,
 95:           error: `Validation failed: ${error.errors.map(e => e.message).join(', ')}`,
 96:         });
 97:       }
 98: 
 99:       // Return generic error response
100:       return responseSchema.parse({
101:         success: false,
102:         error: error instanceof Error ? error.message : 'An unexpected error occurred',
103:       });
104:     }
105:   };
106: }
107: 
108: export function handleDatabaseError(error: unknown): never {
109:   if (error instanceof AppError) {
110:     throw error;
111:   }
112: 
113:   logger.error({ error }, 'Database error occurred');
114:   throw new AppError('A database error occurred', 'DATABASE_ERROR', 500);
115: }
```

## File: apps/web/src/lib/session.ts
```typescript
  1: import { cookies } from 'next/headers';
  2: import { UnauthorizedError } from './errors';
  3: import { logger } from '@danky/logger';
  4: 
  5: // Session types
  6: interface User {
  7:   id: string;
  8:   email: string;
  9:   name: string;
 10:   role: 'user' | 'admin';
 11:   metadata?: Record<string, unknown>;
 12: }
 13: 
 14: interface Session {
 15:   user: User;
 16:   expiresAt: Date;
 17:   metadata?: Record<string, unknown>;
 18: }
 19: 
 20: // Session configuration
 21: const SESSION_COOKIE = 'auth_session';
 22: const SESSION_DURATION = 24 * 60 * 60 * 1000; // 24 hours
 23: 
 24: // Session store (replace with Redis in production)
 25: const sessions = new Map<string, Session>();
 26: 
 27: // Helper to generate session ID
 28: function generateSessionId(): string {
 29:   return crypto.randomUUID();
 30: }
 31: 
 32: // Helper to get current timestamp
 33: function getCurrentTimestamp(): Date {
 34:   return new Date();
 35: }
 36: 
 37: // Helper to check if session is expired
 38: function isSessionExpired(session: Session): boolean {
 39:   return getCurrentTimestamp() > session.expiresAt;
 40: }
 41: 
 42: // Helper to create session
 43: export async function createSession(user: User): Promise<string> {
 44:   const sessionId = generateSessionId();
 45:   const expiresAt = new Date(Date.now() + SESSION_DURATION);
 46:   
 47:   sessions.set(sessionId, {
 48:     user,
 49:     expiresAt,
 50:     metadata: {
 51:       createdAt: getCurrentTimestamp(),
 52:       lastActive: getCurrentTimestamp(),
 53:     },
 54:   });
 55:   
 56:   // Set session cookie
 57:   cookies().set(SESSION_COOKIE, sessionId, {
 58:     httpOnly: true,
 59:     secure: process.env.NODE_ENV === 'production',
 60:     sameSite: 'lax',
 61:     expires: expiresAt,
 62:   });
 63:   
 64:   return sessionId;
 65: }
 66: 
 67: // Helper to get session
 68: export async function getSession(): Promise<Session> {
 69:   const sessionId = cookies().get(SESSION_COOKIE)?.value;
 70:   
 71:   if (!sessionId) {
 72:     throw new UnauthorizedError('No session found');
 73:   }
 74:   
 75:   const session = sessions.get(sessionId);
 76:   
 77:   if (!session) {
 78:     throw new UnauthorizedError('Invalid session');
 79:   }
 80:   
 81:   if (isSessionExpired(session)) {
 82:     sessions.delete(sessionId);
 83:     throw new UnauthorizedError('Session expired');
 84:   }
 85:   
 86:   // Update last active timestamp
 87:   session.metadata = {
 88:     ...session.metadata,
 89:     lastActive: getCurrentTimestamp(),
 90:   };
 91:   
 92:   return session;
 93: }
 94: 
 95: // Helper to end session
 96: export async function endSession(): Promise<void> {
 97:   const sessionId = cookies().get(SESSION_COOKIE)?.value;
 98:   
 99:   if (sessionId) {
100:     sessions.delete(sessionId);
101:     cookies().delete(SESSION_COOKIE);
102:   }
103: }
104: 
105: // Helper to get current user
106: export async function getCurrentUser(): Promise<User> {
107:   try {
108:     const session = await getSession();
109:     return session.user;
110:   } catch (error) {
111:     throw new UnauthorizedError('Not authenticated');
112:   }
113: }
114: 
115: // Helper to require authentication
116: export async function withUser<T>(
117:   handler: (user: User) => Promise<T>
118: ): Promise<T> {
119:   try {
120:     const user = await getCurrentUser();
121:     return handler(user);
122:   } catch (error) {
123:     logger.error({
124:       operation: 'withUser',
125:       error: error instanceof Error ? error.message : 'Unknown error',
126:     });
127:     throw error;
128:   }
129: }
130: 
131: // Helper to require admin role
132: export async function withAdmin<T>(
133:   handler: (user: User) => Promise<T>
134: ): Promise<T> {
135:   return withUser(async (user) => {
136:     if (user.role !== 'admin') {
137:       throw new UnauthorizedError('Admin access required');
138:     }
139:     return handler(user);
140:   });
141: }
142: 
143: // Helper to check if user has access to a resource
144: export async function checkResourceAccess(
145:   resourceUserId: string,
146:   allowAdmin: boolean = true
147: ): Promise<void> {
148:   const user = await getCurrentUser();
149:   
150:   if (
151:     user.id !== resourceUserId &&
152:     (!allowAdmin || user.role !== 'admin')
153:   ) {
154:     throw new UnauthorizedError('Access denied');
155:   }
156: }
157: 
158: // Helper to refresh session
159: export async function refreshSession(): Promise<void> {
160:   const session = await getSession();
161:   const expiresAt = new Date(Date.now() + SESSION_DURATION);
162:   
163:   session.expiresAt = expiresAt;
164:   session.metadata = {
165:     ...session.metadata,
166:     lastActive: getCurrentTimestamp(),
167:   };
168:   
169:   // Update session cookie
170:   cookies().set(SESSION_COOKIE, cookies().get(SESSION_COOKIE)!.value, {
171:     httpOnly: true,
172:     secure: process.env.NODE_ENV === 'production',
173:     sameSite: 'lax',
174:     expires: expiresAt,
175:   });
176: }
177: 
178: // Helper to get all active sessions for a user
179: export async function getUserSessions(userId: string): Promise<Session[]> {
180:   return Array.from(sessions.values()).filter(
181:     session => session.user.id === userId && !isSessionExpired(session)
182:   );
183: }
184: 
185: // Helper to end all sessions for a user
186: export async function endUserSessions(userId: string): Promise<void> {
187:   for (const [sessionId, session] of sessions.entries()) {
188:     if (session.user.id === userId) {
189:       sessions.delete(sessionId);
190:     }
191:   }
192: }
193: 
194: // Export types
195: export type { User, Session };
```

## File: apps/web/src/lib/utils.ts
```typescript
1: import { type ClassValue, clsx } from 'clsx';
2: import { twMerge } from 'tailwind-merge';
3: 
4: export function cn(...inputs: ClassValue[]) {
5:   return twMerge(clsx(inputs));
6: }
```

## File: apps/web/src/types/env.d.ts
```typescript
 1: declare namespace NodeJS {
 2:   interface ProcessEnv {
 3:     NODE_ENV: 'development' | 'production' | 'test';
 4:     DATABASE_URL: string;
 5:     REDIS_URL: string;
 6:     QDRANT_URL: string;
 7:     OPENAI_API_KEY: string;
 8:     ANTHROPIC_API_KEY: string;
 9:     GROQ_API_KEY?: string;
10:     BRAVE_API_KEY?: string;
11:     LOG_LEVEL?: 'debug' | 'info' | 'warn' | 'error';
12:   }
13: }
```

## File: apps/web/src/types/websocket.d.ts
```typescript
 1: declare type WebSocketMessage = {
 2:   type: string;
 3:   payload: unknown;
 4: };
 5: 
 6: declare type WebSocketHandler = (data: unknown) => void;
 7: 
 8: declare type WebSocketClientConfig = {
 9:   url: string;
10:   maxReconnectAttempts?: number;
11:   reconnectTimeout?: number;
12: };
13: 
14: declare type WebSocketServerConfig = {
15:   noServer?: boolean;
16:   path?: string;
17: };
```

## File: apps/web/src/types/ws.d.ts
```typescript
 1: import type { IncomingMessage } from 'http';
 2: 
 3: declare module 'ws' {
 4:   import { EventEmitter } from 'events';
 5:   import { Duplex } from 'stream';
 6: 
 7:   export interface WebSocket extends EventEmitter {
 8:     binaryType: string;
 9:     readonly bufferedAmount: number;
10:     readonly extensions: string;
11:     readonly protocol: string;
12:     readonly readyState: number;
13:     readonly url: string;
14: 
15:     close(code?: number, data?: string | Buffer): void;
16:     ping(data?: any, mask?: boolean, cb?: (err: Error) => void): void;
17:     pong(data?: any, mask?: boolean, cb?: (err: Error) => void): void;
18:     send(data: any, cb?: (err?: Error) => void): void;
19:     terminate(): void;
20:   }
21: 
22:   export interface WebSocketServer extends EventEmitter {
23:     options: ServerOptions;
24:     path: string;
25:     clients: Set<WebSocket>;
26: 
27:     close(cb?: (err?: Error) => void): void;
28:     handleUpgrade(
29:       request: IncomingMessage,
30:       socket: Duplex,
31:       upgradeHead: Buffer,
32:       callback: (client: WebSocket, request: IncomingMessage) => void
33:     ): void;
34:     shouldHandle(request: IncomingMessage): boolean | Promise<boolean>;
35:   }
36: 
37:   export interface ServerOptions {
38:     host?: string;
39:     port?: number;
40:     backlog?: number;
41:     server?: any;
42:     verifyClient?: VerifyClientCallbackAsync | VerifyClientCallbackSync;
43:     handleProtocols?: any;
44:     path?: string;
45:     noServer?: boolean;
46:     clientTracking?: boolean;
47:     perMessageDeflate?: boolean;
48:     maxPayload?: number;
49:   }
50: 
51:   export type VerifyClientCallbackAsync = (
52:     info: { origin: string; secure: boolean; req: IncomingMessage },
53:     callback: (res: boolean, code?: number, message?: string) => void
54:   ) => void;
55: 
56:   export type VerifyClientCallbackSync = (info: {
57:     origin: string;
58:     secure: boolean;
59:     req: IncomingMessage;
60:   }) => boolean;
61: 
62:   export default class WS extends WebSocket {
63:     static readonly CONNECTING: 0;
64:     static readonly OPEN: 1;
65:     static readonly CLOSING: 2;
66:     static readonly CLOSED: 3;
67: 
68:     static Server: typeof WebSocketServer;
69:     static WebSocket: typeof WebSocket;
70:     static createWebSocketStream: any;
71:   }
72: }
```

## File: apps/web/.gitignore
```
 1: # See https://help.github.com/articles/ignoring-files/ for more about ignoring files.
 2: 
 3: # dependencies
 4: /node_modules
 5: /.pnp
 6: .pnp.js
 7: .yarn/install-state.gz
 8: 
 9: # testing
10: /coverage
11: 
12: # next.js
13: /.next/
14: /out/
15: 
16: # production
17: /build
18: 
19: # misc
20: .DS_Store
21: *.pem
22: 
23: # debug
24: npm-debug.log*
25: yarn-debug.log*
26: yarn-error.log*
27: 
28: # env files (can opt-in for commiting if needed)
29: .env*
30: 
31: # vercel
32: .vercel
33: 
34: # typescript
35: *.tsbuildinfo
36: next-env.d.ts
```

## File: apps/web/components.json
```json
 1: {
 2:   "$schema": "https://ui.shadcn.com/schema.json",
 3:   "style": "default",
 4:   "rsc": true,
 5:   "tsx": true,
 6:   "tailwind": {
 7:     "config": "tailwind.config.js",
 8:     "css": "app/globals.css",
 9:     "baseColor": "slate",
10:     "cssVariables": true
11:   },
12:   "iconLibrary": "lucide",
13:   "aliases": {
14:     "components": "@/components",
15:     "utils": "@/lib/utils",
16:     "ui": "@danky/ui/components"
17:   }
18: }
```

## File: apps/web/env.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: const envSchema = z.object({
 4:   // Database
 5:   DATABASE_URL: z.string().url(),
 6: 
 7:   // Redis
 8:   REDIS_URL: z.string().url(),
 9: 
10:   // Qdrant
11:   QDRANT_URL: z.string().url(),
12: 
13:   // API Keys
14:   OPENAI_API_KEY: z.string().min(1),
15:   ANTHROPIC_API_KEY: z.string().min(1),
16:   GROQ_API_KEY: z.string().optional(),
17:   BRAVE_API_KEY: z.string().optional(),
18: 
19:   // Environment
20:   NODE_ENV: z.enum(['development', 'test', 'production']).default('development'),
21:   LOG_LEVEL: z.enum(['debug', 'info', 'warn', 'error']).default('info'),
22: });
23: 
24: // Validate and export environment
25: export const env = envSchema.parse(process.env);
26: 
27: // Export type
28: export type Env = z.infer<typeof envSchema>;
```

## File: apps/web/mcp-server-guide.md
```markdown
 1: # Comprehensive Guide to Creating Model Context Protocol (MCP) Servers
 2: 
 3: The Model Context Protocol (MCP) is an open standard that enables developers to build secure, two-way connections between their data sources/tools and AI-powered applications like large language models.
 4: 
 5: This guide covers the key concepts and steps involved in creating your own MCP server implementation.
 6: 
 7: ## What is an MCP Server?
 8: 
 9: An MCP server exposes data, tools, APIs or custom workflows to language model clients in a standardized way using the MCP specification. It handles:
10: 
11: - Communicating with the language model client over the defined MCP protocol
12: - Interfacing with the actual data source, tool or application being exposed
13: - Translating between the MCP request/response format and the external system
14: 
15: Servers are a core component of the MCP architecture, along with clients (the language model applications) and the protocol/transport layers that enable communication between them.
16: 
17: ## Why Create an MCP Server?
18: 
19: By implementing an MCP server, you can seamlessly integrate your data, APIs or custom tools with large language models and AI applications. This allows the language models to:
20: 
21: - Access and process information from your systems in context
22: - Trigger actions, updates or workflows in your external tools/apps
23: - Combine capabilities from multiple servers for more powerful capabilities
24: 
25: MCP provides standardized interfaces that make integrating with language models much easier compared to ad-hoc integrations.
26: 
27: ## High-Level Steps
28: 
29: At a high level, creating an MCP server involves:
30: 
31: 1. **Study the MCP specification**: Understand the protocol request/response formats, communication patterns, authentication and more from the official docs.
32: 
33: 2. **Choose language/framework**: Pick your preferred programming language and frameworks. Python, Node.js/TypeScript, Rust and others have libraries/examples.
34: 
35: 3. **Implement protocol layer**: Code the logic to handle MCP protocol communication - framing messages, request/response linking, etc. Can often reuse libraries.
36: 
37: 4. **Implement transport layer**: Set up the transport mechanism for communication between your server and clients (e.g. HTTP, WebSockets, gRPC etc.)
38: 
39: 5. **Build data/tool interface**: Implement the core logic to interface with your actual data source, API, tool or custom application you are exposing.
40: 
41: 6. **Handle authentication/authz**: Build in any required authentication, authorization or usage controls for your MCP server instance.
42: 
43: 7. **Test and debug**: Thoroughly test by setting up a test language model client and ensuring all integration points work as expected.
44: 
45: 8. **Deploy and monitor**: Deploy your MCP server instance to your hosting environment and set up monitoring/logging.
46: 
47: ## Example MCP Servers 
48: 
49: To get started, consider analyzing these example open source MCP server implementations:
50: 
51: - **Airtable Server**: MCP server for Airtable data - https://github.com/modelcontextprotocol/servers/tree/main/airtable
52: 
53: - **Mongo Server**: MCP server enabling LLMs to interact with MongoDB - https://github.com/wong2/awesome-mcp-servers#mongo 
54: 
55: - **Playwright Server**: MCP server using Playwright for browser automation/scraping - https://github.com/wong2/awesome-mcp-servers#playwright-mcp-server
56: 
57: - **Brave Search Server**: Official MCP server implementation for the Brave Search API - https://github.com/modelcontextprotocol/servers/tree/main/brave-search
58: 
59: Studying the code and approach used in these examples can provide a great starting point for your own implementation.
60: 
61: ## Resources
62: 
63: - Official MCP docs and specification: https://github.com/modelcontextprotocol 
64: - Curated list of MCP server examples: https://github.com/wong2/awesome-mcp-servers
65: - Blog posts and guides on implementing MCP servers:
66:     - https://simonwillison.net/2024/Nov/25/model-context-protocol/
67:     - https://glama.ai/blog/2024-11-25-model-context-protocol-quickstart
68:     - https://medium.com/@LakshmiNarayana_U/building-a-model-context-protocol-mcp-server-for-claude-desktop-in-typescript-9022024c8949
69: 
70: With the right planning, existing resources and this guide, you should be well on your way to creating your own powerful MCP server integration!
```

## File: apps/web/next.config.js
```javascript
 1: /** @type {import('next').NextConfig} */
 2: const nextConfig = {
 3:   reactStrictMode: true,
 4:   transpilePackages: ['@danky/ui', '@danky/mcp'],
 5:   experimental: {
 6:     esmExternals: true,
 7:     serverComponentsExternalPackages: ['shiki'],
 8:   },
 9:   webpack: (config, { isServer }) => {
10:     if (!isServer) {
11:       config.resolve.fallback = {
12:         ...config.resolve.fallback,
13:         fs: false,
14:         path: false,
15:         async_hooks: false,
16:         child_process: false,
17:         net: false,
18:         tls: false,
19:         process: false,
20:       }
21:       // Handle node: protocol imports
22:       config.resolve.alias = {
23:         ...config.resolve.alias,
24:         'node:async_hooks': false,
25:         'node:child_process': false,
26:         'node:net': false,
27:         'node:tls': false,
28:         'node:process': false,
29:         'node:fs': false,
30:         'node:path': false,
31:       }
32:     }
33: 
34:     // Add module resolution aliases
35:     config.resolve.alias = {
36:       ...config.resolve.alias,
37:       '@n8n/json-schema-to-zod': '@n8n/json-schema-to-zod',
38:     }
39: 
40:     // Add extension resolution
41:     config.resolve.extensionAlias = {
42:       '.js': ['.js', '.ts', '.tsx'],
43:       '.jsx': ['.jsx', '.tsx'],
44:     }
45: 
46:     return config
47:   },
48:   eslint: {
49:     ignoreDuringBuilds: false,
50:     dirs: ['src/app', 'src/components', 'src/lib', 'src/hooks']
51:   }
52: }
53: 
54: module.exports = nextConfig
```

## File: apps/web/package.json
```json
  1: {
  2:   "name": "web",
  3:   "version": "0.1.0",
  4:   "private": true,
  5:   "type": "module",
  6:   "scripts": {
  7:     "dev": "next dev",
  8:     "build": "next build",
  9:     "start": "next start",
 10:     "lint": "eslint .",
 11:     "type-check": "tsc --noEmit"
 12:   },
 13:   "dependencies": {
 14:     "@anthropic-ai/sdk": "^0.33.1",
 15:     "@danky/logger": "workspace:*",
 16:     "@danky/qdrant": "workspace:*",
 17:     "@danky/redis": "workspace:*",
 18:     "@danky/schema": "workspace:*",
 19:     "@danky/ui": "workspace:*",
 20:     "@hookform/resolvers": "3.10.0",
 21:     "@radix-ui/react-accordion": "^1.2.2",
 22:     "@radix-ui/react-alert-dialog": "^1.1.4",
 23:     "@radix-ui/react-aspect-ratio": "1.1.1",
 24:     "@radix-ui/react-avatar": "^1.1.2",
 25:     "@radix-ui/react-checkbox": "1.1.3",
 26:     "@radix-ui/react-collapsible": "1.1.2",
 27:     "@radix-ui/react-context-menu": "2.2.4",
 28:     "@radix-ui/react-dialog": "1.1.4",
 29:     "@radix-ui/react-dropdown-menu": "2.1.4",
 30:     "@radix-ui/react-hover-card": "1.1.4",
 31:     "@radix-ui/react-label": "2.1.1",
 32:     "@radix-ui/react-menubar": "1.1.4",
 33:     "@radix-ui/react-navigation-menu": "1.2.3",
 34:     "@radix-ui/react-popover": "1.1.4",
 35:     "@radix-ui/react-progress": "1.1.1",
 36:     "@radix-ui/react-radio-group": "1.2.2",
 37:     "@radix-ui/react-scroll-area": "1.2.2",
 38:     "@radix-ui/react-select": "2.1.4",
 39:     "@radix-ui/react-separator": "1.1.1",
 40:     "@radix-ui/react-slider": "1.2.2",
 41:     "@radix-ui/react-slot": "^1.1.1",
 42:     "@radix-ui/react-switch": "1.1.2",
 43:     "@radix-ui/react-tabs": "1.1.2",
 44:     "@radix-ui/react-toast": "1.2.4",
 45:     "@radix-ui/react-toggle": "1.1.1",
 46:     "@radix-ui/react-tooltip": "1.1.6",
 47:     "clsx": "^2.1.1",
 48:     "cmdk": "^1.0.4",
 49:     "date-fns": "4.1.0",
 50:     "lucide-react": "^0.471.0",
 51:     "next": "^15.1.4",
 52:     "next-themes": "^0.4.4",
 53:     "react": "^19.0.0",
 54:     "react-dom": "^19.0.0",
 55:     "react-hook-form": "7.54.2",
 56:     "sonner": "^1.7.1",
 57:     "zod": "^3.24.1"
 58:   },
 59:   "devDependencies": {
 60:     "@danky/eslint-config": "workspace:*",
 61:     "@danky/typescript-config": "workspace:*",
 62:     "@types/node": "^22.10.5",
 63:     "@types/react": "^19.0.4",
 64:     "@types/react-dom": "^19.0.2",
 65:     "autoprefixer": "^10.4.20",
 66:     "class-variance-authority": "^0.7.0",
 67:     "eslint": "^9.17.0",
 68:     "postcss": "^8.4.49",
 69:     "tailwind-merge": "^2.6.0",
 70:     "tailwindcss": "^3.4.17",
 71:     "tailwindcss-animate": "^1.0.7",
 72:     "typescript": "^5.4.5",
 73:     "@types/d3-array": "^3.2.1",
 74:     "@types/d3-color": "^3.1.3",
 75:     "@types/d3-ease": "^3.0.2",
 76:     "@types/d3-interpolate": "^3.0.4",
 77:     "@types/d3-path": "^3.0.2",
 78:     "@types/d3-scale": "^4.0.8",
 79:     "@types/d3-shape": "^3.1.6",
 80:     "@types/d3-time": "^3.0.3",
 81:     "@types/d3-timer": "^3.0.2",
 82:     "@types/debug": "^4.1.12",
 83:     "@types/estree": "^1.0.5",
 84:     "@types/glob": "^8.1.0",
 85:     "@types/inquirer": "^9.0.7",
 86:     "@types/json-schema": "^7.0.15",
 87:     "@types/minimatch": "^5.1.2",
 88:     "@types/ms": "^0.7.34",
 89:     "@types/node-fetch": "^2.6.11",
 90:     "@types/pg": "^8.11.0",
 91:     "@types/retry": "^0.12.5",
 92:     "@types/through": "^0.0.33",
 93:     "@types/tinycolor2": "^1.4.6",
 94:     "@types/tough-cookie": "^4.0.5",
 95:     "@types/uuid": "^9.0.8",
 96:     "@types/ws": "^8.5.10",
 97:     "@types/yargs": "^17.0.32",
 98:     "@types/yargs-parser": "^21.0.3"
 99:   }
100: }
```

## File: apps/web/postcss.config.js
```javascript
1: module.exports = {
2:   plugins: {
3:     tailwindcss: {},
4:     autoprefixer: {},
5:   },
6: }
```

## File: apps/web/README.md
```markdown
  1: # Danky Web Application
  2: 
  3: The main web interface for the Danky AI Chatbot platform, built with Next.js 14, React Server Components, and shadcn/ui.
  4: 
  5: ## Directory Structure
  6: 
  7: ```
  8: src/
  9: ├── app/                # Next.js App Router pages
 10: │   ├── api/           # API routes
 11: │   ├── chat/          # Chat interface pages
 12: │   └── layout.tsx     # Root layout
 13: ├── components/        # React components
 14: │   ├── chat/         # Chat-specific components
 15: │   ├── mcp/          # MCP integration components
 16: │   ├── sidebar/      # Navigation components
 17: │   ├── theme/        # Theme components
 18: │   └── ui/           # App-specific UI components
 19: ├── hooks/            # React hooks
 20: ├── lib/              # Utilities and services
 21: │   ├── actions/      # Server actions
 22: │   ├── config/       # App configuration
 23: │   ├── db/           # Database utilities
 24: │   ├── services/     # Service layer
 25: │   ├── stores/       # Client-side state
 26: │   └── validations/  # Schema validations
 27: └── types/            # TypeScript types
 28: ```
 29: 
 30: ## Key Features
 31: 
 32: - **Chat Interface**: Real-time AI chat with multiple model support
 33: - **MCP Integration**: Model Context Protocol for AI interactions
 34: - **Theme Support**: Dark/light mode with customizable themes
 35: - **Server Components**: Optimized for performance with RSC
 36: - **Type Safety**: Full TypeScript coverage with strict mode
 37: 
 38: ## Development
 39: 
 40: ### Prerequisites
 41: 
 42: - Node.js 20.11.0+
 43: - pnpm 8.x+
 44: - PostgreSQL 15+
 45: 
 46: ### Setup
 47: 
 48: 1. Install dependencies:
 49: ```bash
 50: pnpm install
 51: ```
 52: 
 53: 2. Set up environment variables:
 54: ```bash
 55: cp .env.example .env
 56: ```
 57: 
 58: 3. Start development server:
 59: ```bash
 60: pnpm dev
 61: ```
 62: 
 63: ### AI Development Notes
 64: 
 65: #### Key Files for Context
 66: - `src/app/layout.tsx` - Root layout and providers
 67: - `src/components/chat/types.ts` - Chat-related types
 68: - `src/lib/stores/chat-store.ts` - Chat state management
 69: 
 70: #### Common Operations
 71: - Add UI component: `pnpm ui:add [component-name]`
 72: - Run type check: `pnpm type-check`
 73: - Run linter: `pnpm lint`
 74: - Run tests: `pnpm test`
 75: 
 76: #### Component Guidelines
 77: - Use Server Components by default
 78: - Add 'use client' only when needed
 79: - Keep components under 200 lines
 80: - Follow the feature-based structure
 81: 
 82: #### State Management
 83: - Server state: Server Components
 84: - Form state: react-hook-form + zod
 85: - Client state: Zustand stores
 86: - Global state: React Context
 87: 
 88: ## Configuration
 89: 
 90: ### ESLint
 91: - Uses flat config format (eslint.config.js)
 92: - Extends from @danky/eslint-config
 93: - Strict TypeScript rules enabled
 94: 
 95: ### TypeScript
 96: - Strict mode enabled
 97: - Path aliases configured
 98: - Server/client separation
 99: 
100: ### Tailwind CSS
101: - Extended theme in tailwind.config.js
102: - shadcn/ui components support
103: - Custom color schemes
104: 
105: ## Testing
106: 
107: ### Unit Tests
108: ```bash
109: pnpm test:unit
110: ```
111: 
112: ### Integration Tests
113: ```bash
114: pnpm test:integration
115: ```
116: 
117: ### E2E Tests
118: ```bash
119: pnpm test:e2e
120: ```
121: 
122: ## Deployment
123: 
124: ### Production Build
125: ```bash
126: pnpm build
127: ```
128: 
129: ### Environment Variables
130: Required:
131: - `DATABASE_URL`: PostgreSQL connection string
132: - `NEXTAUTH_SECRET`: Auth secret key
133: - `NEXTAUTH_URL`: Auth callback URL
134: 
135: Optional:
136: - `SENTRY_DSN`: Error tracking
137: - `VERCEL_URL`: Vercel deployment URL
138: 
139: ## Troubleshooting
140: 
141: ### Common Issues
142: 1. **Type Errors**: Check path aliases in tsconfig.json
143: 2. **Build Errors**: Verify package versions
144: 3. **Style Issues**: Check Tailwind classes
145: 4. **State Issues**: Verify store implementations
146: 
147: ### Debug Tools
148: - React DevTools
149: - Next.js DevTools
150: - Chrome DevTools
151: - VSCode Debugger
152: 
153: ## Additional Resources
154: 
155: - [Architecture Guide](../../docs/ARCHITECTURE.md)
156: - [Component Patterns](../../docs/PATTERNS.md)
157: - [API Documentation](../../docs/API.md)
158: - [Testing Guide](../../docs/TESTING.md)
```

## File: apps/web/tailwind.config.js
```javascript
 1: /** @type {import('tailwindcss').Config} */
 2: module.exports = {
 3:   darkMode: ['class'],
 4:   content: [
 5:     './src/app/**/*.{js,ts,jsx,tsx,mdx}',
 6:     './src/components/**/*.{js,ts,jsx,tsx,mdx}',
 7:     './src/lib/**/*.{js,ts,jsx,tsx,mdx}',
 8:     '../../packages/ui/src/**/*.{js,ts,jsx,tsx,mdx}',
 9:   ],
10:   theme: {
11:     container: {
12:       center: true,
13:       padding: '2rem',
14:       screens: {
15:         '2xl': '1400px',
16:       },
17:     },
18:     extend: {
19:       colors: {
20:         border: 'hsl(var(--border))',
21:         input: 'hsl(var(--input))',
22:         ring: 'hsl(var(--ring))',
23:         background: 'hsl(var(--background))',
24:         foreground: 'hsl(var(--foreground))',
25:         primary: {
26:           DEFAULT: 'hsl(var(--primary))',
27:           foreground: 'hsl(var(--primary-foreground))',
28:         },
29:         secondary: {
30:           DEFAULT: 'hsl(var(--secondary))',
31:           foreground: 'hsl(var(--secondary-foreground))',
32:         },
33:         destructive: {
34:           DEFAULT: 'hsl(var(--destructive))',
35:           foreground: 'hsl(var(--destructive-foreground))',
36:         },
37:         muted: {
38:           DEFAULT: 'hsl(var(--muted))',
39:           foreground: 'hsl(var(--muted-foreground))',
40:         },
41:         accent: {
42:           DEFAULT: 'hsl(var(--accent))',
43:           foreground: 'hsl(var(--accent-foreground))',
44:         },
45:         popover: {
46:           DEFAULT: 'hsl(var(--popover))',
47:           foreground: 'hsl(var(--popover-foreground))',
48:         },
49:         card: {
50:           DEFAULT: 'hsl(var(--card))',
51:           foreground: 'hsl(var(--card-foreground))',
52:         },
53:       },
54:       borderRadius: {
55:         lg: 'var(--radius)',
56:         md: 'calc(var(--radius) - 2px)',
57:         sm: 'calc(var(--radius) - 4px)',
58:       },
59:       keyframes: {
60:         'accordion-down': {
61:           from: { height: '0' },
62:           to: { height: 'var(--radix-accordion-content-height)' },
63:         },
64:         'accordion-up': {
65:           from: { height: 'var(--radix-accordion-content-height)' },
66:           to: { height: '0' },
67:         },
68:       },
69:       animation: {
70:         'accordion-down': 'accordion-down 0.2s ease-out',
71:         'accordion-up': 'accordion-up 0.2s ease-out',
72:       },
73:     },
74:   },
75:   plugins: [require('tailwindcss-animate')],
76: }
```

## File: apps/web/tsconfig.json
```json
 1: {
 2:   "extends": "../../packages/typescript-config/nextjs.json",
 3:   "compilerOptions": {
 4:     "baseUrl": ".",
 5:     "paths": {
 6:       "@/*": ["./src/*"],
 7:       "@/env": ["./env.ts"]
 8:     },
 9:     "plugins": [
10:       {
11:         "name": "next"
12:       }
13:     ]
14:   },
15:   "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts", "env.ts"],
16:   "exclude": ["node_modules", ".next", "dist"]
17: }
```

## File: apps/web/types.d.ts
```typescript
 1: declare module 'remark-math' {
 2:   const remarkMath: any
 3:   export default remarkMath
 4: }
 5: 
 6: declare module 'rehype-katex' {
 7:   const rehypeKatex: any
 8:   export default rehypeKatex
 9: }
10: 
11: declare module 'rehype-raw' {
12:   const rehypeRaw: any
13:   export default rehypeRaw
14: }
15: 
16: declare module 'remark-gfm' {
17:   const remarkGfm: any
18:   export default remarkGfm
19: }
```

## File: packages/build-config/src/base.ts
```typescript
 1: import { defineConfig, type Options } from 'tsup';
 2: 
 3: export interface BaseOptions extends Options {
 4:   entry?: string[];
 5:   format?: Options['format'];
 6:   external?: string[];
 7: }
 8: 
 9: export const baseConfig = ({
10:   entry = ['src/index.ts'],
11:   format = ['esm'],
12:   external = [],
13:   ...rest
14: }: BaseOptions = {}) =>
15:   defineConfig({
16:     entry,
17:     format,
18:     dts: true,
19:     sourcemap: true,
20:     clean: true,
21:     external,
22:     ...rest,
23:   });
```

## File: packages/build-config/src/index.ts
```typescript
1: export { baseConfig, type BaseOptions } from './base';
2: export { reactLibraryConfig, type ReactLibraryOptions } from './react-library';
3: export { nodeLibraryConfig, type NodeLibraryOptions } from './node-library';
```

## File: packages/build-config/src/node-library.ts
```typescript
 1: import { type Options } from 'tsup';
 2: import { baseConfig, type BaseOptions } from './base';
 3: 
 4: export interface NodeLibraryOptions extends BaseOptions {
 5:   entry?: string[];
 6:   format?: Options['format'];
 7:   external?: string[];
 8: }
 9: 
10: export const nodeLibraryConfig = ({
11:   entry = ['src/index.ts'],
12:   format = ['esm'],
13:   external = [],
14:   ...rest
15: }: NodeLibraryOptions = {}) =>
16:   baseConfig({
17:     entry,
18:     format,
19:     external,
20:     ...rest,
21:   });
```

## File: packages/build-config/src/react-library.ts
```typescript
 1: import { type Options } from 'tsup';
 2: import { baseConfig, type BaseOptions } from './base';
 3: 
 4: export interface ReactLibraryOptions extends BaseOptions {
 5:   entry?: string[];
 6:   format?: Options['format'];
 7:   external?: string[];
 8: }
 9: 
10: export const reactLibraryConfig = ({
11:   entry = ['src/index.ts'],
12:   format = ['esm'],
13:   external = [
14:     'react',
15:     'react-dom',
16:     '@radix-ui/*',
17:     'class-variance-authority',
18:     'clsx',
19:     'tailwind-merge',
20:   ],
21:   ...rest
22: }: ReactLibraryOptions = {}) =>
23:   baseConfig({
24:     entry,
25:     format,
26:     external,
27:     ...rest,
28:   });
```

## File: packages/build-config/package.json
```json
 1: {
 2:   "name": "@danky/build-config",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.js",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "clean": "rimraf .turbo node_modules dist",
15:     "dev": "tsup --watch",
16:     "lint": "eslint .",
17:     "type-check": "tsc --noEmit"
18:   },
19:   "dependencies": {
20:     "tsup": "^8.0.2"
21:   },
22:   "devDependencies": {
23:     "@danky/eslint-config": "workspace:*",
24:     "@danky/typescript-config": "workspace:*",
25:     "@types/node": "^20.11.24",
26:     "eslint": "^8.57.0",
27:     "rimraf": "^5.0.5",
28:     "typescript": "^5.3.3"
29:   }
30: }
```

## File: packages/build-config/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": "."
 7:   },
 8:   "include": ["src/**/*.ts"],
 9:   "exclude": ["node_modules", "dist"]
10: }
```

## File: packages/db/drizzle/meta/_journal.json
```json
 1: {
 2:   "version": "5",
 3:   "dialect": "pg",
 4:   "entries": [
 5:     {
 6:       "idx": 0,
 7:       "version": "5",
 8:       "when": 1736317617260,
 9:       "tag": "0000_noisy_phil_sheldon",
10:       "breakpoints": true
11:     }
12:   ]
13: }
```

## File: packages/db/drizzle/meta/0000_snapshot.json
```json
  1: {
  2:   "id": "d79a9af4-7cf2-4e6c-b046-d2bd3850d294",
  3:   "prevId": "00000000-0000-0000-0000-000000000000",
  4:   "version": "5",
  5:   "dialect": "pg",
  6:   "tables": {
  7:     "sessions": {
  8:       "name": "sessions",
  9:       "schema": "",
 10:       "columns": {
 11:         "id": {
 12:           "name": "id",
 13:           "type": "uuid",
 14:           "primaryKey": true,
 15:           "notNull": true
 16:         },
 17:         "user_id": {
 18:           "name": "user_id",
 19:           "type": "uuid",
 20:           "primaryKey": false,
 21:           "notNull": true
 22:         },
 23:         "refresh_token": {
 24:           "name": "refresh_token",
 25:           "type": "text",
 26:           "primaryKey": false,
 27:           "notNull": true
 28:         },
 29:         "expires_at": {
 30:           "name": "expires_at",
 31:           "type": "timestamp",
 32:           "primaryKey": false,
 33:           "notNull": true
 34:         },
 35:         "created_at": {
 36:           "name": "created_at",
 37:           "type": "timestamp",
 38:           "primaryKey": false,
 39:           "notNull": true,
 40:           "default": "now()"
 41:         },
 42:         "updated_at": {
 43:           "name": "updated_at",
 44:           "type": "timestamp",
 45:           "primaryKey": false,
 46:           "notNull": true,
 47:           "default": "now()"
 48:         }
 49:       },
 50:       "indexes": {},
 51:       "foreignKeys": {
 52:         "sessions_user_id_users_id_fk": {
 53:           "name": "sessions_user_id_users_id_fk",
 54:           "tableFrom": "sessions",
 55:           "tableTo": "users",
 56:           "columnsFrom": [
 57:             "user_id"
 58:           ],
 59:           "columnsTo": [
 60:             "id"
 61:           ],
 62:           "onDelete": "cascade",
 63:           "onUpdate": "no action"
 64:         }
 65:       },
 66:       "compositePrimaryKeys": {},
 67:       "uniqueConstraints": {}
 68:     },
 69:     "users": {
 70:       "name": "users",
 71:       "schema": "",
 72:       "columns": {
 73:         "id": {
 74:           "name": "id",
 75:           "type": "uuid",
 76:           "primaryKey": true,
 77:           "notNull": true
 78:         },
 79:         "email": {
 80:           "name": "email",
 81:           "type": "text",
 82:           "primaryKey": false,
 83:           "notNull": true
 84:         },
 85:         "hashed_password": {
 86:           "name": "hashed_password",
 87:           "type": "text",
 88:           "primaryKey": false,
 89:           "notNull": true
 90:         },
 91:         "full_name": {
 92:           "name": "full_name",
 93:           "type": "text",
 94:           "primaryKey": false,
 95:           "notNull": true
 96:         },
 97:         "is_active": {
 98:           "name": "is_active",
 99:           "type": "boolean",
100:           "primaryKey": false,
101:           "notNull": true,
102:           "default": true
103:         },
104:         "is_verified": {
105:           "name": "is_verified",
106:           "type": "boolean",
107:           "primaryKey": false,
108:           "notNull": true,
109:           "default": false
110:         },
111:         "created_at": {
112:           "name": "created_at",
113:           "type": "timestamp",
114:           "primaryKey": false,
115:           "notNull": true,
116:           "default": "now()"
117:         },
118:         "updated_at": {
119:           "name": "updated_at",
120:           "type": "timestamp",
121:           "primaryKey": false,
122:           "notNull": true,
123:           "default": "now()"
124:         }
125:       },
126:       "indexes": {},
127:       "foreignKeys": {},
128:       "compositePrimaryKeys": {},
129:       "uniqueConstraints": {
130:         "users_email_unique": {
131:           "name": "users_email_unique",
132:           "nullsNotDistinct": false,
133:           "columns": [
134:             "email"
135:           ]
136:         }
137:       }
138:     },
139:     "key_value": {
140:       "name": "key_value",
141:       "schema": "",
142:       "columns": {
143:         "id": {
144:           "name": "id",
145:           "type": "uuid",
146:           "primaryKey": true,
147:           "notNull": true
148:         },
149:         "key": {
150:           "name": "key",
151:           "type": "text",
152:           "primaryKey": false,
153:           "notNull": true
154:         },
155:         "value": {
156:           "name": "value",
157:           "type": "jsonb",
158:           "primaryKey": false,
159:           "notNull": true
160:         },
161:         "expires_at": {
162:           "name": "expires_at",
163:           "type": "timestamp",
164:           "primaryKey": false,
165:           "notNull": false
166:         },
167:         "created_at": {
168:           "name": "created_at",
169:           "type": "timestamp",
170:           "primaryKey": false,
171:           "notNull": true,
172:           "default": "now()"
173:         },
174:         "updated_at": {
175:           "name": "updated_at",
176:           "type": "timestamp",
177:           "primaryKey": false,
178:           "notNull": true,
179:           "default": "now()"
180:         }
181:       },
182:       "indexes": {},
183:       "foreignKeys": {},
184:       "compositePrimaryKeys": {},
185:       "uniqueConstraints": {
186:         "key_value_key_unique": {
187:           "name": "key_value_key_unique",
188:           "nullsNotDistinct": false,
189:           "columns": [
190:             "key"
191:           ]
192:         }
193:       }
194:     },
195:     "attachments": {
196:       "name": "attachments",
197:       "schema": "",
198:       "columns": {
199:         "id": {
200:           "name": "id",
201:           "type": "uuid",
202:           "primaryKey": true,
203:           "notNull": true
204:         },
205:         "message_id": {
206:           "name": "message_id",
207:           "type": "uuid",
208:           "primaryKey": false,
209:           "notNull": true
210:         },
211:         "file_name": {
212:           "name": "file_name",
213:           "type": "text",
214:           "primaryKey": false,
215:           "notNull": true
216:         },
217:         "file_type": {
218:           "name": "file_type",
219:           "type": "text",
220:           "primaryKey": false,
221:           "notNull": true
222:         },
223:         "file_size": {
224:           "name": "file_size",
225:           "type": "integer",
226:           "primaryKey": false,
227:           "notNull": true
228:         },
229:         "file_path": {
230:           "name": "file_path",
231:           "type": "text",
232:           "primaryKey": false,
233:           "notNull": true
234:         },
235:         "created_at": {
236:           "name": "created_at",
237:           "type": "timestamp",
238:           "primaryKey": false,
239:           "notNull": true,
240:           "default": "now()"
241:         },
242:         "updated_at": {
243:           "name": "updated_at",
244:           "type": "timestamp",
245:           "primaryKey": false,
246:           "notNull": true,
247:           "default": "now()"
248:         }
249:       },
250:       "indexes": {},
251:       "foreignKeys": {
252:         "attachments_message_id_messages_id_fk": {
253:           "name": "attachments_message_id_messages_id_fk",
254:           "tableFrom": "attachments",
255:           "tableTo": "messages",
256:           "columnsFrom": [
257:             "message_id"
258:           ],
259:           "columnsTo": [
260:             "id"
261:           ],
262:           "onDelete": "cascade",
263:           "onUpdate": "no action"
264:         }
265:       },
266:       "compositePrimaryKeys": {},
267:       "uniqueConstraints": {}
268:     },
269:     "conversations": {
270:       "name": "conversations",
271:       "schema": "",
272:       "columns": {
273:         "id": {
274:           "name": "id",
275:           "type": "uuid",
276:           "primaryKey": true,
277:           "notNull": true
278:         },
279:         "user_id": {
280:           "name": "user_id",
281:           "type": "uuid",
282:           "primaryKey": false,
283:           "notNull": true
284:         },
285:         "title": {
286:           "name": "title",
287:           "type": "text",
288:           "primaryKey": false,
289:           "notNull": true
290:         },
291:         "is_archived": {
292:           "name": "is_archived",
293:           "type": "boolean",
294:           "primaryKey": false,
295:           "notNull": true,
296:           "default": false
297:         },
298:         "created_at": {
299:           "name": "created_at",
300:           "type": "timestamp",
301:           "primaryKey": false,
302:           "notNull": true,
303:           "default": "now()"
304:         },
305:         "updated_at": {
306:           "name": "updated_at",
307:           "type": "timestamp",
308:           "primaryKey": false,
309:           "notNull": true,
310:           "default": "now()"
311:         }
312:       },
313:       "indexes": {},
314:       "foreignKeys": {
315:         "conversations_user_id_users_id_fk": {
316:           "name": "conversations_user_id_users_id_fk",
317:           "tableFrom": "conversations",
318:           "tableTo": "users",
319:           "columnsFrom": [
320:             "user_id"
321:           ],
322:           "columnsTo": [
323:             "id"
324:           ],
325:           "onDelete": "cascade",
326:           "onUpdate": "no action"
327:         }
328:       },
329:       "compositePrimaryKeys": {},
330:       "uniqueConstraints": {}
331:     },
332:     "messages": {
333:       "name": "messages",
334:       "schema": "",
335:       "columns": {
336:         "id": {
337:           "name": "id",
338:           "type": "uuid",
339:           "primaryKey": true,
340:           "notNull": true
341:         },
342:         "conversation_id": {
343:           "name": "conversation_id",
344:           "type": "uuid",
345:           "primaryKey": false,
346:           "notNull": true
347:         },
348:         "role": {
349:           "name": "role",
350:           "type": "text",
351:           "primaryKey": false,
352:           "notNull": true
353:         },
354:         "content": {
355:           "name": "content",
356:           "type": "text",
357:           "primaryKey": false,
358:           "notNull": true
359:         },
360:         "metadata": {
361:           "name": "metadata",
362:           "type": "jsonb",
363:           "primaryKey": false,
364:           "notNull": false
365:         },
366:         "created_at": {
367:           "name": "created_at",
368:           "type": "timestamp",
369:           "primaryKey": false,
370:           "notNull": true,
371:           "default": "now()"
372:         },
373:         "updated_at": {
374:           "name": "updated_at",
375:           "type": "timestamp",
376:           "primaryKey": false,
377:           "notNull": true,
378:           "default": "now()"
379:         }
380:       },
381:       "indexes": {},
382:       "foreignKeys": {
383:         "messages_conversation_id_conversations_id_fk": {
384:           "name": "messages_conversation_id_conversations_id_fk",
385:           "tableFrom": "messages",
386:           "tableTo": "conversations",
387:           "columnsFrom": [
388:             "conversation_id"
389:           ],
390:           "columnsTo": [
391:             "id"
392:           ],
393:           "onDelete": "cascade",
394:           "onUpdate": "no action"
395:         }
396:       },
397:       "compositePrimaryKeys": {},
398:       "uniqueConstraints": {}
399:     },
400:     "embeddings": {
401:       "name": "embeddings",
402:       "schema": "",
403:       "columns": {
404:         "id": {
405:           "name": "id",
406:           "type": "uuid",
407:           "primaryKey": true,
408:           "notNull": true
409:         },
410:         "content_id": {
411:           "name": "content_id",
412:           "type": "text",
413:           "primaryKey": false,
414:           "notNull": true
415:         },
416:         "content_type": {
417:           "name": "content_type",
418:           "type": "text",
419:           "primaryKey": false,
420:           "notNull": true
421:         },
422:         "embedding": {
423:           "name": "embedding",
424:           "type": "text",
425:           "primaryKey": false,
426:           "notNull": true
427:         },
428:         "metadata": {
429:           "name": "metadata",
430:           "type": "jsonb",
431:           "primaryKey": false,
432:           "notNull": false
433:         },
434:         "created_at": {
435:           "name": "created_at",
436:           "type": "timestamp",
437:           "primaryKey": false,
438:           "notNull": true,
439:           "default": "now()"
440:         },
441:         "updated_at": {
442:           "name": "updated_at",
443:           "type": "timestamp",
444:           "primaryKey": false,
445:           "notNull": true,
446:           "default": "now()"
447:         }
448:       },
449:       "indexes": {},
450:       "foreignKeys": {},
451:       "compositePrimaryKeys": {},
452:       "uniqueConstraints": {}
453:     }
454:   },
455:   "enums": {},
456:   "schemas": {},
457:   "_meta": {
458:     "columns": {},
459:     "schemas": {},
460:     "tables": {}
461:   }
462: }
```

## File: packages/db/drizzle/0000_noisy_phil_sheldon.sql
```sql
 1: CREATE TABLE IF NOT EXISTS "sessions" (
 2: 	"id" uuid PRIMARY KEY NOT NULL,
 3: 	"user_id" uuid NOT NULL,
 4: 	"refresh_token" text NOT NULL,
 5: 	"expires_at" timestamp NOT NULL,
 6: 	"created_at" timestamp DEFAULT now() NOT NULL,
 7: 	"updated_at" timestamp DEFAULT now() NOT NULL
 8: );
 9: --> statement-breakpoint
10: CREATE TABLE IF NOT EXISTS "users" (
11: 	"id" uuid PRIMARY KEY NOT NULL,
12: 	"email" text NOT NULL,
13: 	"hashed_password" text NOT NULL,
14: 	"full_name" text NOT NULL,
15: 	"is_active" boolean DEFAULT true NOT NULL,
16: 	"is_verified" boolean DEFAULT false NOT NULL,
17: 	"created_at" timestamp DEFAULT now() NOT NULL,
18: 	"updated_at" timestamp DEFAULT now() NOT NULL,
19: 	CONSTRAINT "users_email_unique" UNIQUE("email")
20: );
21: --> statement-breakpoint
22: CREATE TABLE IF NOT EXISTS "key_value" (
23: 	"id" uuid PRIMARY KEY NOT NULL,
24: 	"key" text NOT NULL,
25: 	"value" jsonb NOT NULL,
26: 	"expires_at" timestamp,
27: 	"created_at" timestamp DEFAULT now() NOT NULL,
28: 	"updated_at" timestamp DEFAULT now() NOT NULL,
29: 	CONSTRAINT "key_value_key_unique" UNIQUE("key")
30: );
31: --> statement-breakpoint
32: CREATE TABLE IF NOT EXISTS "attachments" (
33: 	"id" uuid PRIMARY KEY NOT NULL,
34: 	"message_id" uuid NOT NULL,
35: 	"file_name" text NOT NULL,
36: 	"file_type" text NOT NULL,
37: 	"file_size" integer NOT NULL,
38: 	"file_path" text NOT NULL,
39: 	"created_at" timestamp DEFAULT now() NOT NULL,
40: 	"updated_at" timestamp DEFAULT now() NOT NULL
41: );
42: --> statement-breakpoint
43: CREATE TABLE IF NOT EXISTS "conversations" (
44: 	"id" uuid PRIMARY KEY NOT NULL,
45: 	"user_id" uuid NOT NULL,
46: 	"title" text NOT NULL,
47: 	"is_archived" boolean DEFAULT false NOT NULL,
48: 	"created_at" timestamp DEFAULT now() NOT NULL,
49: 	"updated_at" timestamp DEFAULT now() NOT NULL
50: );
51: --> statement-breakpoint
52: CREATE TABLE IF NOT EXISTS "messages" (
53: 	"id" uuid PRIMARY KEY NOT NULL,
54: 	"conversation_id" uuid NOT NULL,
55: 	"role" text NOT NULL,
56: 	"content" text NOT NULL,
57: 	"metadata" jsonb,
58: 	"created_at" timestamp DEFAULT now() NOT NULL,
59: 	"updated_at" timestamp DEFAULT now() NOT NULL
60: );
61: --> statement-breakpoint
62: CREATE TABLE IF NOT EXISTS "embeddings" (
63: 	"id" uuid PRIMARY KEY NOT NULL,
64: 	"content_id" text NOT NULL,
65: 	"content_type" text NOT NULL,
66: 	"embedding" text NOT NULL,
67: 	"metadata" jsonb,
68: 	"created_at" timestamp DEFAULT now() NOT NULL,
69: 	"updated_at" timestamp DEFAULT now() NOT NULL
70: );
71: --> statement-breakpoint
72: DO $$ BEGIN
73:  ALTER TABLE "sessions" ADD CONSTRAINT "sessions_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
74: EXCEPTION
75:  WHEN duplicate_object THEN null;
76: END $$;
77: --> statement-breakpoint
78: DO $$ BEGIN
79:  ALTER TABLE "attachments" ADD CONSTRAINT "attachments_message_id_messages_id_fk" FOREIGN KEY ("message_id") REFERENCES "messages"("id") ON DELETE cascade ON UPDATE no action;
80: EXCEPTION
81:  WHEN duplicate_object THEN null;
82: END $$;
83: --> statement-breakpoint
84: DO $$ BEGIN
85:  ALTER TABLE "conversations" ADD CONSTRAINT "conversations_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
86: EXCEPTION
87:  WHEN duplicate_object THEN null;
88: END $$;
89: --> statement-breakpoint
90: DO $$ BEGIN
91:  ALTER TABLE "messages" ADD CONSTRAINT "messages_conversation_id_conversations_id_fk" FOREIGN KEY ("conversation_id") REFERENCES "conversations"("id") ON DELETE cascade ON UPDATE no action;
92: EXCEPTION
93:  WHEN duplicate_object THEN null;
94: END $$;
```

## File: packages/db/drizzle/0001_chat_schema_improvements.sql
```sql
 1: -- Add new columns to conversations
 2: ALTER TABLE conversations
 3: ADD COLUMN model_id TEXT NOT NULL DEFAULT 'gpt-4',
 4: ADD COLUMN description TEXT,
 5: ADD COLUMN deleted_at TIMESTAMP;
 6: 
 7: -- Add new columns to messages
 8: ALTER TABLE messages
 9: ADD COLUMN content_type TEXT NOT NULL DEFAULT 'text',
10: ADD COLUMN language TEXT,
11: ADD COLUMN tokens INTEGER,
12: ADD COLUMN parent_id UUID REFERENCES messages(id),
13: ADD COLUMN deleted_at TIMESTAMP;
14: 
15: -- Add new columns to attachments
16: ALTER TABLE attachments
17: ADD COLUMN mime_type TEXT NOT NULL DEFAULT 'application/octet-stream',
18: ADD COLUMN checksum TEXT,
19: ADD COLUMN metadata JSONB,
20: ADD COLUMN deleted_at TIMESTAMP;
21: 
22: -- Add indexes to conversations
23: CREATE INDEX conversations_user_id_idx ON conversations(user_id);
24: CREATE INDEX conversations_title_idx ON conversations(title);
25: CREATE INDEX conversations_status_idx ON conversations(is_archived, deleted_at);
26: CREATE INDEX conversations_model_id_idx ON conversations(model_id);
27: CREATE INDEX conversations_user_active_idx ON conversations(user_id, is_archived, deleted_at);
28: 
29: -- Add indexes to messages
30: CREATE INDEX messages_conversation_id_idx ON messages(conversation_id);
31: CREATE INDEX messages_deleted_at_idx ON messages(deleted_at);
32: CREATE INDEX messages_role_idx ON messages(role);
33: CREATE INDEX messages_content_type_idx ON messages(content_type);
34: CREATE INDEX messages_timeline_idx ON messages(conversation_id, created_at);
35: CREATE INDEX messages_thread_idx ON messages(parent_id);
36: 
37: -- Add indexes to attachments
38: CREATE INDEX attachments_message_id_idx ON attachments(message_id);
39: CREATE INDEX attachments_file_type_idx ON attachments(file_type);
40: CREATE INDEX attachments_deleted_at_idx ON attachments(deleted_at);
41: CREATE UNIQUE INDEX attachments_file_path_key ON attachments(file_path);
42: 
43: -- Create updated_at trigger function
44: CREATE OR REPLACE FUNCTION update_updated_at()
45: RETURNS TRIGGER AS $$
46: BEGIN
47:   NEW.updated_at = CURRENT_TIMESTAMP;
48:   RETURN NEW;
49: END;
50: $$ language 'plpgsql';
51: 
52: -- Add triggers to all tables
53: CREATE TRIGGER update_conversations_updated_at
54:   BEFORE UPDATE ON conversations
55:   FOR EACH ROW
56:   EXECUTE FUNCTION update_updated_at();
57: 
58: CREATE TRIGGER update_messages_updated_at
59:   BEFORE UPDATE ON messages
60:   FOR EACH ROW
61:   EXECUTE FUNCTION update_updated_at();
62: 
63: CREATE TRIGGER update_attachments_updated_at
64:   BEFORE UPDATE ON attachments
65:   FOR EACH ROW
66:   EXECUTE FUNCTION update_updated_at();
```

## File: packages/db/src/migrations/0000_initial.ts
```typescript
  1: import { sql } from 'drizzle-orm';
  2: import { pgTable, text, timestamp, uuid, integer, jsonb, boolean } from 'drizzle-orm/pg-core';
  3: 
  4: export const users = pgTable('users', {
  5:   id: uuid('id').primaryKey().defaultRandom(),
  6:   email: text('email').notNull().unique(),
  7:   name: text('name').notNull(),
  8:   avatarUrl: text('avatar_url'),
  9:   metadata: text('metadata'),
 10:   createdAt: timestamp('created_at').defaultNow().notNull(),
 11:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
 12: });
 13: 
 14: export const sessions = pgTable('sessions', {
 15:   id: uuid('id').primaryKey().defaultRandom(),
 16:   title: text('title').notNull(),
 17:   modelId: text('model_id').notNull(),
 18:   description: text('description'),
 19:   metadata: text('metadata'),
 20:   userId: uuid('user_id')
 21:     .notNull()
 22:     .references(() => users.id, { onDelete: 'cascade' }),
 23:   isArchived: boolean('is_archived').notNull().default(false),
 24:   deletedAt: timestamp('deleted_at'),
 25:   createdAt: timestamp('created_at').defaultNow().notNull(),
 26:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
 27: });
 28: 
 29: export const chats = pgTable('chats', {
 30:   id: uuid('id').primaryKey().defaultRandom(),
 31:   sessionId: uuid('session_id')
 32:     .notNull()
 33:     .references(() => sessions.id, { onDelete: 'cascade' }),
 34:   role: text('role').notNull(),
 35:   content: text('content').notNull(),
 36:   metadata: text('metadata'),
 37:   deletedAt: timestamp('deleted_at'),
 38:   createdAt: timestamp('created_at').defaultNow().notNull(),
 39:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
 40: });
 41: 
 42: export const attachments = pgTable('attachments', {
 43:   id: uuid('id').primaryKey().defaultRandom(),
 44:   chatId: uuid('chat_id')
 45:     .notNull()
 46:     .references(() => chats.id, { onDelete: 'cascade' }),
 47:   fileName: text('file_name').notNull(),
 48:   fileType: text('file_type').notNull(),
 49:   fileSize: integer('file_size').notNull(),
 50:   filePath: text('file_path').notNull().unique(),
 51:   mimeType: text('mime_type').notNull(),
 52:   checksum: text('checksum').notNull(),
 53:   metadata: text('metadata'),
 54:   createdAt: timestamp('created_at').defaultNow().notNull(),
 55:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
 56: });
 57: 
 58: export const vectors = pgTable('vectors', {
 59:   id: uuid('id').primaryKey().defaultRandom(),
 60:   chatId: uuid('chat_id')
 61:     .notNull()
 62:     .references(() => chats.id, { onDelete: 'cascade' }),
 63:   embedding: jsonb('embedding').notNull().$type<number[]>(),
 64:   metadata: text('metadata'),
 65:   createdAt: timestamp('created_at').defaultNow().notNull(),
 66:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
 67: });
 68: 
 69: // Create updated_at trigger function
 70: export const updateUpdatedAtTrigger = sql`
 71:   CREATE OR REPLACE FUNCTION update_updated_at()
 72:   RETURNS TRIGGER AS $$
 73:   BEGIN
 74:     NEW.updated_at = CURRENT_TIMESTAMP;
 75:     RETURN NEW;
 76:   END;
 77:   $$ language 'plpgsql';
 78: `;
 79: 
 80: // Create triggers for each table
 81: export const createTriggers = sql`
 82:   CREATE TRIGGER update_users_updated_at
 83:     BEFORE UPDATE ON users
 84:     FOR EACH ROW
 85:     EXECUTE FUNCTION update_updated_at();
 86: 
 87:   CREATE TRIGGER update_sessions_updated_at
 88:     BEFORE UPDATE ON sessions
 89:     FOR EACH ROW
 90:     EXECUTE FUNCTION update_updated_at();
 91: 
 92:   CREATE TRIGGER update_chats_updated_at
 93:     BEFORE UPDATE ON chats
 94:     FOR EACH ROW
 95:     EXECUTE FUNCTION update_updated_at();
 96: 
 97:   CREATE TRIGGER update_attachments_updated_at
 98:     BEFORE UPDATE ON attachments
 99:     FOR EACH ROW
100:     EXECUTE FUNCTION update_updated_at();
101: 
102:   CREATE TRIGGER update_vectors_updated_at
103:     BEFORE UPDATE ON vectors
104:     FOR EACH ROW
105:     EXECUTE FUNCTION update_updated_at();
106: `;
```

## File: packages/db/src/migrations/0001_vector_schema.ts
```typescript
 1: import { sql } from 'drizzle-orm';
 2: 
 3: // Enable pgvector extension
 4: export const enablePgvector = sql`
 5:   CREATE EXTENSION IF NOT EXISTS vector;
 6: `;
 7: 
 8: // Create vector schema
 9: export const createVectorSchema = sql`
10:   CREATE SCHEMA IF NOT EXISTS vector;
11: `;
12: 
13: // Drop old vectors table if it exists
14: export const dropOldVectors = sql`
15:   DROP TABLE IF EXISTS public.vectors;
16: `;
17: 
18: // Create new embeddings table in vector schema
19: export const createEmbeddings = sql`
20:   CREATE TABLE IF NOT EXISTS vector.embeddings (
21:     id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
22:     content_id UUID NOT NULL,
23:     content_type TEXT NOT NULL,
24:     embedding vector(1536) NOT NULL,
25:     metadata JSONB DEFAULT '{}',
26:     created_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,
27:     updated_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL
28:   );
29: `;
30: 
31: // Create indexes
32: export const createIndexes = sql`
33:   CREATE INDEX IF NOT EXISTS idx_embeddings_content
34:     ON vector.embeddings(content_id, content_type);
35: 
36:   CREATE INDEX IF NOT EXISTS idx_embeddings_vector
37:     ON vector.embeddings
38:     USING ivfflat (embedding vector_cosine_ops)
39:     WITH (lists = 100);
40: `;
41: 
42: // Create updated_at trigger
43: export const createTrigger = sql`
44:   CREATE TRIGGER update_embeddings_updated_at
45:     BEFORE UPDATE ON vector.embeddings
46:     FOR EACH ROW
47:     EXECUTE FUNCTION update_updated_at();
48: `;
```

## File: packages/db/src/schema/attachments.ts
```typescript
 1: import { pgTable, text, timestamp, uuid, integer } from 'drizzle-orm/pg-core';
 2: import { createInsertSchema, createSelectSchema } from 'drizzle-zod';
 3: import { z } from 'zod';
 4: import { chats } from './chat';
 5: 
 6: export const attachments = pgTable('attachments', {
 7:   id: uuid('id').primaryKey().defaultRandom(),
 8:   chatId: uuid('chat_id')
 9:     .notNull()
10:     .references(() => chats.id, { onDelete: 'cascade' }),
11:   fileName: text('file_name').notNull(),
12:   fileType: text('file_type').notNull(),
13:   fileSize: integer('file_size').notNull(),
14:   filePath: text('file_path').notNull().unique(),
15:   mimeType: text('mime_type').notNull(),
16:   checksum: text('checksum').notNull(),
17:   metadata: text('metadata'),
18:   createdAt: timestamp('created_at').defaultNow().notNull(),
19:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
20: });
21: 
22: export const insertAttachmentSchema = createInsertSchema(attachments, {
23:   fileName: z.string().min(1),
24:   fileType: z.string().min(1),
25:   fileSize: z.number().positive(),
26:   filePath: z.string().min(1),
27:   mimeType: z.string().min(1),
28:   checksum: z.string().min(1),
29:   metadata: z.string().optional(),
30: });
31: 
32: export const selectAttachmentSchema = createSelectSchema(attachments);
33: 
34: export type Attachment = typeof attachments.$inferSelect;
35: export type NewAttachment = typeof attachments.$inferInsert;
```

## File: packages/db/src/schema/auth.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, boolean } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const users = pgTable("users", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   email: text("email").notNull().unique(),
 7:   hashedPassword: text("hashed_password").notNull(),
 8:   fullName: text("full_name").notNull(),
 9:   isActive: boolean("is_active").notNull().default(true),
10:   isVerified: boolean("is_verified").notNull().default(false),
11:   createdAt: timestamp("created_at").notNull().defaultNow(),
12:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
13: });
14: 
15: export const sessions = pgTable("sessions", {
16:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
17:   userId: uuid("user_id")
18:     .notNull()
19:     .references(() => users.id, { onDelete: "cascade" }),
20:   refreshToken: text("refresh_token").notNull(),
21:   expiresAt: timestamp("expires_at").notNull(),
22:   createdAt: timestamp("created_at").notNull().defaultNow(),
23:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
24: });
```

## File: packages/db/src/schema/cache.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, jsonb } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const keyValue = pgTable("key_value", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   key: text("key").notNull().unique(),
 7:   value: jsonb("value").notNull(),
 8:   expiresAt: timestamp("expires_at"),
 9:   createdAt: timestamp("created_at").notNull().defaultNow(),
10:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
11: });
```

## File: packages/db/src/schema/chat.ts
```typescript
 1: import { pgTable, text, timestamp, uuid } from 'drizzle-orm/pg-core';
 2: import { createInsertSchema, createSelectSchema } from 'drizzle-zod';
 3: import { z } from 'zod';
 4: import { sessions } from './sessions';
 5: 
 6: export const chats = pgTable('chats', {
 7:   id: uuid('id').primaryKey().defaultRandom(),
 8:   sessionId: uuid('session_id')
 9:     .notNull()
10:     .references(() => sessions.id, { onDelete: 'cascade' }),
11:   role: text('role').notNull(),
12:   content: text('content').notNull(),
13:   metadata: text('metadata'),
14:   deletedAt: timestamp('deleted_at'),
15:   createdAt: timestamp('created_at').defaultNow().notNull(),
16:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
17: });
18: 
19: // Zod schemas for type validation
20: export const insertChatSchema = createInsertSchema(chats, {
21:   content: z.string().min(1),
22:   role: z.enum(['user', 'assistant', 'system']),
23:   metadata: z.string().optional(),
24:   sessionId: z.string().uuid(),
25: });
26: 
27: export const selectChatSchema = createSelectSchema(chats);
28: 
29: // TypeScript types
30: export type Chat = typeof chats.$inferSelect;
31: export type NewChat = typeof chats.$inferInsert;
```

## File: packages/db/src/schema/index.ts
```typescript
1: export * from './chat';
2: export * from './sessions';
3: export * from './users';
4: export * from './attachments';
5: export * from './vectors';
```

## File: packages/db/src/schema/sessions.ts
```typescript
 1: import { pgTable, text, timestamp, uuid, boolean } from 'drizzle-orm/pg-core';
 2: import { createInsertSchema, createSelectSchema } from 'drizzle-zod';
 3: import { z } from 'zod';
 4: import { users } from './users';
 5: 
 6: export const sessions = pgTable('sessions', {
 7:   id: uuid('id').primaryKey().defaultRandom(),
 8:   title: text('title').notNull(),
 9:   modelId: text('model_id').notNull(),
10:   description: text('description'),
11:   metadata: text('metadata'),
12:   userId: uuid('user_id')
13:     .notNull()
14:     .references(() => users.id, { onDelete: 'cascade' }),
15:   isArchived: boolean('is_archived').notNull().default(false),
16:   deletedAt: timestamp('deleted_at'),
17:   createdAt: timestamp('created_at').defaultNow().notNull(),
18:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
19: });
20: 
21: // Zod schemas for type validation
22: export const insertSessionSchema = createInsertSchema(sessions, {
23:   title: z.string().min(1),
24:   modelId: z.string().min(1),
25:   description: z.string().optional(),
26:   metadata: z.string().optional(),
27:   userId: z.string().uuid(),
28:   isArchived: z.boolean().default(false),
29: });
30: 
31: export const selectSessionSchema = createSelectSchema(sessions);
32: 
33: // TypeScript types
34: export type Session = typeof sessions.$inferSelect;
35: export type NewSession = typeof sessions.$inferInsert;
```

## File: packages/db/src/schema/users.ts
```typescript
 1: import { pgTable, text, timestamp, uuid } from 'drizzle-orm/pg-core';
 2: import { createInsertSchema, createSelectSchema } from 'drizzle-zod';
 3: import { z } from 'zod';
 4: 
 5: export const users = pgTable('users', {
 6:   id: uuid('id').primaryKey().defaultRandom(),
 7:   email: text('email').notNull().unique(),
 8:   name: text('name').notNull(),
 9:   avatarUrl: text('avatar_url'),
10:   metadata: text('metadata'),
11:   createdAt: timestamp('created_at').defaultNow().notNull(),
12:   updatedAt: timestamp('updated_at').defaultNow().notNull(),
13: });
14: 
15: export const insertUserSchema = createInsertSchema(users, {
16:   email: z.string().email(),
17:   name: z.string().min(1),
18:   avatarUrl: z.string().url().optional(),
19:   metadata: z.string().optional(),
20: });
21: 
22: export const selectUserSchema = createSelectSchema(users);
23: 
24: export type User = typeof users.$inferSelect;
25: export type NewUser = typeof users.$inferInsert;
```

## File: packages/db/src/schema/vector.ts
```typescript
 1: import { pgTable, uuid, text, timestamp, jsonb } from "drizzle-orm/pg-core";
 2: import { createId } from "@paralleldrive/cuid2";
 3: 
 4: export const embeddings = pgTable("embeddings", {
 5:   id: uuid("id").primaryKey().$defaultFn(() => createId()),
 6:   contentId: text("content_id").notNull(),
 7:   contentType: text("content_type").notNull(),
 8:   embedding: text("embedding").notNull(),
 9:   metadata: jsonb("metadata"),
10:   createdAt: timestamp("created_at").notNull().defaultNow(),
11:   updatedAt: timestamp("updated_at").notNull().defaultNow(),
12: });
```

## File: packages/db/src/schema/vectors.ts
```typescript
 1: import { pgTable, text, timestamp, uuid, jsonb } from 'drizzle-orm/pg-core';
 2: import { createInsertSchema, createSelectSchema } from 'drizzle-zod';
 3: import { z } from 'zod';
 4: import { sql } from 'drizzle-orm';
 5: 
 6: // Create the vectors table in the vector schema
 7: export const embeddings = pgTable(
 8:   'embeddings',
 9:   {
10:     id: uuid('id').primaryKey().defaultRandom(),
11:     contentId: uuid('content_id').notNull(),
12:     contentType: text('content_type').notNull(),
13:     embedding: text('embedding').notNull(),
14:     metadata: jsonb('metadata').$type<Record<string, unknown>>(),
15:     createdAt: timestamp('created_at', { withTimezone: true }).defaultNow().notNull(),
16:     updatedAt: timestamp('updated_at', { withTimezone: true }).defaultNow().notNull(),
17:   },
18:   table => ({
19:     contentIdx: sql`CREATE INDEX IF NOT EXISTS idx_embeddings_content ON ${table} (content_id, content_type)`,
20:     vectorIdx: sql`CREATE INDEX IF NOT EXISTS idx_embeddings_vector ON ${table} USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100)`,
21:   })
22: );
23: 
24: // Zod schemas for type validation
25: export const insertEmbeddingSchema = createInsertSchema(embeddings, {
26:   contentId: z.string().uuid(),
27:   contentType: z.string().min(1),
28:   embedding: z.string(),
29:   metadata: z.record(z.unknown()).optional(),
30: });
31: 
32: export const selectEmbeddingSchema = createSelectSchema(embeddings);
33: 
34: // TypeScript types
35: export type Embedding = typeof embeddings.$inferSelect;
36: export type NewEmbedding = typeof embeddings.$inferInsert;
37: 
38: // Helper function to create vector from array
39: export function createVector(array: number[]): unknown {
40:   return sql`array[${sql.join(array)}]::vector`;
41: }
42: 
43: // Helper function for vector similarity search
44: export function vectorSimilarity(column: unknown, vector: unknown) {
45:   return sql<number>`${column} <=> ${vector}`;
46: }
```

## File: packages/db/src/client.ts
```typescript
 1: import { drizzle } from 'drizzle-orm/node-postgres';
 2: import { type NodePgDatabase } from 'drizzle-orm/node-postgres';
 3: import { Pool } from 'pg';
 4: import { env } from './env';
 5: 
 6: // Configure connection pool with PgBouncer settings
 7: const pool = new Pool({
 8:   connectionString: env.DATABASE_URL,
 9:   max: 20, // Match PGBOUNCER_DEFAULT_POOL_SIZE
10:   idleTimeoutMillis: 30000,
11:   connectionTimeoutMillis: 5000,
12:   statement_timeout: 60000,
13:   query_timeout: 60000,
14: });
15: 
16: export const db = drizzle(pool, {
17:   logger: env.NODE_ENV === 'development',
18: });
19: 
20: // Export type for the database client
21: export type DrizzleClient = typeof db;
22: 
23: // Export a type-safe transaction helper
24: export async function transaction<T>(callback: (db: DrizzleClient) => Promise<T>): Promise<T> {
25:   const client = await pool.connect();
26:   try {
27:     await client.query('BEGIN');
28:     const result = await callback(drizzle(client));
29:     await client.query('COMMIT');
30:     return result;
31:   } catch (error) {
32:     await client.query('ROLLBACK');
33:     throw error;
34:   } finally {
35:     client.release();
36:   }
37: }
```

## File: packages/db/src/env.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: const envSchema = z.object({
 4:   DATABASE_URL: z.string().url(),
 5:   NODE_ENV: z.enum(['development', 'test', 'production']).default('development'),
 6: });
 7: 
 8: // Validate and export environment
 9: export const env = envSchema.parse(process.env);
10: 
11: // Export type
12: export type Env = z.infer<typeof envSchema>;
```

## File: packages/db/src/index.ts
```typescript
1: export * from './client';
2: export * from './schema';
3: export * from './env';
4: export type { Pool } from 'pg';
```

## File: packages/db/src/migrate.ts
```typescript
 1: import { drizzle } from 'drizzle-orm/node-postgres';
 2: import { migrate } from 'drizzle-orm/node-postgres/migrator';
 3: import { Pool } from 'pg';
 4: import { env } from './env';
 5: import { createLogger } from '@danky/logger';
 6: 
 7: const logger = createLogger('db-migrate');
 8: 
 9: async function runMigrations() {
10:   logger.info('Starting database migrations...');
11: 
12:   const pool = new Pool({
13:     connectionString: env.DATABASE_URL,
14:   });
15: 
16:   try {
17:     const db = drizzle(pool);
18:     await migrate(db, { migrationsFolder: './src/migrations' });
19:     logger.info('Migrations completed successfully');
20:   } catch (error) {
21:     logger.error({ error }, 'Migration failed');
22:     throw error;
23:   } finally {
24:     await pool.end();
25:   }
26: }
27: 
28: runMigrations().catch(error => {
29:   logger.error({ error }, 'Migration script failed');
30:   process.exit(1);
31: });
```

## File: packages/db/src/seed.ts
```typescript
 1: import { drizzle } from 'drizzle-orm/node-postgres';
 2: import pkg from 'pg';
 3: const { Pool } = pkg;
 4: import { createLogger } from '@danky/logger';
 5: import { users } from './schema';
 6: import * as dotenv from 'dotenv';
 7: import { resolve, dirname } from 'path';
 8: import { fileURLToPath } from 'url';
 9: import { createId } from '@paralleldrive/cuid2';
10: 
11: // Get the current file's directory
12: const __filename = fileURLToPath(import.meta.url);
13: const __dirname = dirname(__filename);
14: 
15: // Load environment variables from the root .env file
16: dotenv.config({ path: resolve(__dirname, '../../../.env') });
17: 
18: const logger = createLogger('db:seed');
19: 
20: // Construct the DATABASE_URL manually
21: const {
22:   POSTGRES_USER = 'danky',
23:   POSTGRES_PASSWORD = 'danky',
24:   POSTGRES_DB = 'danky',
25:   POSTGRES_PORT = '5432',
26: } = process.env;
27: 
28: const DATABASE_URL = `postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:${POSTGRES_PORT}/${POSTGRES_DB}`;
29: 
30: logger.info('Environment variables:', {
31:   DATABASE_URL,
32:   POSTGRES_USER,
33:   POSTGRES_PASSWORD,
34:   POSTGRES_DB,
35:   POSTGRES_PORT,
36: });
37: 
38: // Create a new pool for seeding
39: const pool = new Pool({
40:   connectionString: DATABASE_URL,
41: });
42: 
43: const db = drizzle(pool);
44: 
45: // Seed data
46: async function main() {
47:   logger.info('Seeding database...');
48: 
49:   try {
50:     // Create test user
51:     const [user] = await db
52:       .insert(users)
53:       .values({
54:         id: createId(),
55:         email: 'test@example.com',
56:         name: 'Test User',
57:         metadata: JSON.stringify({ isActive: true, isVerified: true }),
58:       })
59:       .returning();
60: 
61:     logger.info({ userId: user.id }, 'Created test user');
62:     logger.info('Seeding completed successfully');
63:   } catch (error) {
64:     logger.error({ error }, 'Seeding failed');
65:     process.exit(1);
66:   }
67: 
68:   await pool.end();
69: }
70: 
71: main().catch(error => {
72:   logger.error({ error }, 'Unhandled error in main');
73:   process.exit(1);
74: });
```

## File: packages/db/drizzle.config.ts
```typescript
 1: import type { Config } from 'drizzle-kit';
 2: import { env } from './src/env';
 3: 
 4: export default {
 5:   schema: './src/schema/*',
 6:   out: './src/migrations',
 7:   driver: 'pg',
 8:   dbCredentials: {
 9:     connectionString: env.DATABASE_URL,
10:   },
11:   verbose: true,
12:   strict: true,
13: } satisfies Config;
```

## File: packages/db/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/db/package.json
```json
 1: {
 2:   "name": "@danky/db",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "dev": "tsup --watch",
15:     "type-check": "tsc --noEmit",
16:     "lint": "eslint .",
17:     "clean": "rimraf dist",
18:     "migrate:generate": "drizzle-kit generate:pg",
19:     "migrate:push": "tsx src/migrate.ts",
20:     "studio": "drizzle-kit studio"
21:   },
22:   "dependencies": {
23:     "@danky/logger": "workspace:*",
24:     "@paralleldrive/cuid2": "^2.2.2",
25:     "drizzle-orm": "^0.38.3",
26:     "pg": "^8.13.1",
27:     "zod": "^3.24.1"
28:   },
29:   "devDependencies": {
30:     "@danky/eslint-config": "workspace:*",
31:     "@danky/typescript-config": "workspace:*",
32:     "@types/node": "^22.10.5",
33:     "@types/pg": "^8.11.10",
34:     "drizzle-kit": "^0.30.1",
35:     "drizzle-zod": "^0.6.1",
36:     "tsx": "^4.19.0",
37:     "tsup": "^8.0.2",
38:     "typescript": "^5.4.5",
39:     "rimraf": "^6.0.1"
40:   }
41: }
```

## File: packages/db/README.md
```markdown
  1: # @danky/db
  2: 
  3: Database schema, migrations, and utilities for the Danky AI Chatbot platform, built with Drizzle ORM.
  4: 
  5: ## Overview
  6: 
  7: The db package provides the database schema, migrations, and utilities for interacting with the PostgreSQL database. It uses Drizzle ORM for type-safe database operations and schema management.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13: ├── schema/          # Database schema definitions
 14: ├── migrations/      # Database migrations
 15: ├── queries/         # Reusable queries
 16: ├── utils/           # Database utilities
 17: └── types/           # TypeScript types
 18: ```
 19: 
 20: ## Key Features
 21: 
 22: - **Type Safety**: Full TypeScript coverage
 23: - **Migrations**: Automated schema migrations
 24: - **Query Builder**: Type-safe query building
 25: - **Connection Pool**: Connection management
 26: - **Error Handling**: Custom error types
 27: - **Testing**: Database test utilities
 28: 
 29: ## Usage
 30: 
 31: ### Basic Query
 32: 
 33: ```typescript
 34: import { db } from '@danky/db'
 35: import { eq } from 'drizzle-orm'
 36: import { users } from './schema'
 37: 
 38: // Find user by ID
 39: const user = await db.query.users.findFirst({
 40:   where: eq(users.id, userId),
 41: })
 42: 
 43: // Insert new user
 44: const newUser = await db.insert(users).values({
 45:   name: 'John Doe',
 46:   email: 'john@example.com',
 47: }).returning()
 48: ```
 49: 
 50: ### Transactions
 51: 
 52: ```typescript
 53: import { db } from '@danky/db'
 54: 
 55: await db.transaction(async (tx) => {
 56:   const user = await tx.insert(users).values({
 57:     name: 'John Doe',
 58:   }).returning()
 59: 
 60:   await tx.insert(profiles).values({
 61:     userId: user.id,
 62:     bio: 'Hello world',
 63:   })
 64: })
 65: ```
 66: 
 67: ## AI Development Notes
 68: 
 69: ### Key Concepts
 70: 
 71: 1. **Schema Design**
 72:    - Table definitions
 73:    - Relationships
 74:    - Indexes
 75:    - Constraints
 76: 
 77: 2. **Query Patterns**
 78:    - CRUD operations
 79:    - Joins
 80:    - Aggregations
 81:    - Transactions
 82: 
 83: 3. **Error Handling**
 84:    - Connection errors
 85:    - Query errors
 86:    - Constraint violations
 87:    - Deadlocks
 88: 
 89: ### Common Patterns
 90: 
 91: #### Table Definition
 92: ```typescript
 93: import { pgTable, text, timestamp, uuid } from 'drizzle-orm/pg-core'
 94: 
 95: export const users = pgTable('users', {
 96:   id: uuid('id').primaryKey().defaultRandom(),
 97:   name: text('name').notNull(),
 98:   email: text('email').notNull().unique(),
 99:   createdAt: timestamp('created_at').defaultNow(),
100:   updatedAt: timestamp('updated_at').defaultNow(),
101: })
102: 
103: export const profiles = pgTable('profiles', {
104:   id: uuid('id').primaryKey().defaultRandom(),
105:   userId: uuid('user_id').references(() => users.id),
106:   bio: text('bio'),
107: })
108: ```
109: 
110: #### Query Builder
111: ```typescript
112: import { and, eq, like } from 'drizzle-orm'
113: 
114: const users = await db.query.users.findMany({
115:   where: and(
116:     eq(users.role, 'admin'),
117:     like(users.email, '%@example.com')
118:   ),
119:   with: {
120:     profile: true,
121:   },
122:   orderBy: users.createdAt,
123:   limit: 10,
124: })
125: ```
126: 
127: #### Error Handling
128: ```typescript
129: import { DatabaseError } from '@danky/db'
130: import { logger } from '@danky/logger'
131: 
132: try {
133:   await db.query.users.findFirst({
134:     where: eq(users.id, userId),
135:   })
136: } catch (error) {
137:   if (error instanceof DatabaseError) {
138:     logger.error({ error }, 'Database query failed')
139:     throw new Error('Failed to fetch user')
140:   }
141:   throw error
142: }
143: ```
144: 
145: ## Database Schema
146: 
147: ### Core Tables
148: - users
149: - sessions
150: - messages
151: - tools
152: - files
153: - events
154: 
155: ### Relationships
156: - User -> Messages (1:N)
157: - User -> Sessions (1:N)
158: - Message -> Files (N:M)
159: - Tool -> Events (1:N)
160: 
161: ## Development
162: 
163: ### Migrations
164: 
165: 1. Create migration:
166: ```bash
167: pnpm db:migration:create
168: ```
169: 
170: 2. Apply migrations:
171: ```bash
172: pnpm db:migrate
173: ```
174: 
175: 3. Rollback migration:
176: ```bash
177: pnpm db:rollback
178: ```
179: 
180: ### Testing
181: ```bash
182: pnpm test
183: pnpm test:watch
184: ```
185: 
186: ### Linting
187: ```bash
188: pnpm lint
189: pnpm type-check
190: ```
191: 
192: ## Configuration
193: 
194: ### Environment Variables
195: ```env
196: DATABASE_URL=postgresql://user:pass@localhost:5432/db
197: DATABASE_POOL_SIZE=10
198: DATABASE_IDLE_TIMEOUT=10000
199: ```
200: 
201: ### Connection Options
202: ```typescript
203: {
204:   connectionString: process.env.DATABASE_URL,
205:   ssl: process.env.NODE_ENV === 'production',
206:   max: parseInt(process.env.DATABASE_POOL_SIZE || '10'),
207:   idleTimeoutMillis: parseInt(process.env.DATABASE_IDLE_TIMEOUT || '10000'),
208: }
209: ```
210: 
211: ## Troubleshooting
212: 
213: ### Common Issues
214: 1. **Connection Errors**: Check credentials
215: 2. **Migration Failures**: Check schema changes
216: 3. **Performance Issues**: Check indexes
217: 4. **Deadlocks**: Check transaction patterns
218: 
219: ### Debug Tools
220: - pg_stat_statements
221: - explain analyze
222: - pgbouncer stats
223: - connection pooler
224: 
225: ## Additional Resources
226: 
227: - [Schema Documentation](../../docs/SCHEMA.md)
228: - [Migration Guide](../../docs/MIGRATIONS.md)
229: - [Query Patterns](../../docs/QUERIES.md)
230: - [Performance Guide](../../docs/PERFORMANCE.md)
```

## File: packages/db/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/db/tsup.config.bundled_tcbbkimm6si.mjs
```
 1: // tsup.config.ts
 2: import { defineConfig } from "tsup";
 3: var tsup_config_default = defineConfig({
 4:   entry: ["src/index.ts"],
 5:   format: ["esm"],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ["pg", "drizzle-orm", "drizzle-orm/pg-core"]
10: });
11: export {
12:   tsup_config_default as default
13: };
14: //# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidHN1cC5jb25maWcudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImNvbnN0IF9faW5qZWN0ZWRfZmlsZW5hbWVfXyA9IFwiL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGIvdHN1cC5jb25maWcudHNcIjtjb25zdCBfX2luamVjdGVkX2Rpcm5hbWVfXyA9IFwiL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGJcIjtjb25zdCBfX2luamVjdGVkX2ltcG9ydF9tZXRhX3VybF9fID0gXCJmaWxlOi8vL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGIvdHN1cC5jb25maWcudHNcIjtpbXBvcnQgeyBkZWZpbmVDb25maWcgfSBmcm9tICd0c3VwJztcblxuZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29uZmlnKHtcbiAgZW50cnk6IFsnc3JjL2luZGV4LnRzJ10sXG4gIGZvcm1hdDogWydlc20nXSxcbiAgZHRzOiB0cnVlLFxuICBzb3VyY2VtYXA6IHRydWUsXG4gIGNsZWFuOiB0cnVlLFxuICBleHRlcm5hbDogWydwZycsICdkcml6emxlLW9ybScsICdkcml6emxlLW9ybS9wZy1jb3JlJ10sXG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7QUFBdVAsU0FBUyxvQkFBb0I7QUFFcFIsSUFBTyxzQkFBUSxhQUFhO0FBQUEsRUFDMUIsT0FBTyxDQUFDLGNBQWM7QUFBQSxFQUN0QixRQUFRLENBQUMsS0FBSztBQUFBLEVBQ2QsS0FBSztBQUFBLEVBQ0wsV0FBVztBQUFBLEVBQ1gsT0FBTztBQUFBLEVBQ1AsVUFBVSxDQUFDLE1BQU0sZUFBZSxxQkFBcUI7QUFDdkQsQ0FBQzsiLAogICJuYW1lcyI6IFtdCn0K
```

## File: packages/db/tsup.config.bundled_txmawbqz3cg.mjs
```
 1: // tsup.config.ts
 2: import { defineConfig } from "tsup";
 3: var tsup_config_default = defineConfig({
 4:   entry: ["src/index.ts"],
 5:   format: ["esm"],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ["pg", "drizzle-orm", "drizzle-orm/pg-core"]
10: });
11: export {
12:   tsup_config_default as default
13: };
14: //# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidHN1cC5jb25maWcudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImNvbnN0IF9faW5qZWN0ZWRfZmlsZW5hbWVfXyA9IFwiL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGIvdHN1cC5jb25maWcudHNcIjtjb25zdCBfX2luamVjdGVkX2Rpcm5hbWVfXyA9IFwiL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGJcIjtjb25zdCBfX2luamVjdGVkX2ltcG9ydF9tZXRhX3VybF9fID0gXCJmaWxlOi8vL2hvbWUvam1hZ2FyL2NvZGUvZGFua3kvcGFja2FnZXMvZGIvdHN1cC5jb25maWcudHNcIjtpbXBvcnQgeyBkZWZpbmVDb25maWcgfSBmcm9tICd0c3VwJztcblxuZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29uZmlnKHtcbiAgZW50cnk6IFsnc3JjL2luZGV4LnRzJ10sXG4gIGZvcm1hdDogWydlc20nXSxcbiAgZHRzOiB0cnVlLFxuICBzb3VyY2VtYXA6IHRydWUsXG4gIGNsZWFuOiB0cnVlLFxuICBleHRlcm5hbDogWydwZycsICdkcml6emxlLW9ybScsICdkcml6emxlLW9ybS9wZy1jb3JlJ10sXG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7QUFBdVAsU0FBUyxvQkFBb0I7QUFFcFIsSUFBTyxzQkFBUSxhQUFhO0FBQUEsRUFDMUIsT0FBTyxDQUFDLGNBQWM7QUFBQSxFQUN0QixRQUFRLENBQUMsS0FBSztBQUFBLEVBQ2QsS0FBSztBQUFBLEVBQ0wsV0FBVztBQUFBLEVBQ1gsT0FBTztBQUFBLEVBQ1AsVUFBVSxDQUFDLE1BQU0sZUFBZSxxQkFBcUI7QUFDdkQsQ0FBQzsiLAogICJuYW1lcyI6IFtdCn0K
```

## File: packages/db/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ['pg', 'drizzle-orm', 'drizzle-orm/pg-core'],
10: });
```

## File: packages/eslint-config/base.js
```javascript
  1: import js from '@eslint/js';
  2: import eslintConfigPrettier from 'eslint-config-prettier';
  3: import { FlatCompat } from '@eslint/eslintrc';
  4: import tseslint from '@typescript-eslint/eslint-plugin';
  5: import tsParser from '@typescript-eslint/parser';
  6: import onlyWarn from 'eslint-plugin-only-warn';
  7: import globals from 'globals';
  8: 
  9: const compat = new FlatCompat();
 10: 
 11: /** @type {import("eslint").Linter.FlatConfig[]} */
 12: const config = [
 13:   {
 14:     ignores: [
 15:       '**/node_modules/**',
 16:       '**/dist/**',
 17:       '**/.next/**',
 18:       '**/coverage/**',
 19:       '**/*.config.*',
 20:       '**/public/**',
 21:       '**/.turbo/**',
 22:     ],
 23:   },
 24:   js.configs.recommended,
 25:   {
 26:     files: ['**/*.{ts,tsx,js,jsx}'],
 27:     plugins: {
 28:       '@typescript-eslint': tseslint,
 29:       'only-warn': onlyWarn,
 30:     },
 31:     languageOptions: {
 32:       parser: tsParser,
 33:       parserOptions: {
 34:         project: ['./tsconfig.json', './packages/*/tsconfig.json', './apps/*/tsconfig.json'],
 35:         tsconfigRootDir: process.cwd(),
 36:       },
 37:       globals: {
 38:         ...globals.browser,
 39:         ...globals.node,
 40:         ...globals.es2021,
 41:       },
 42:     },
 43:     settings: {
 44:       // Ensure imports work across the monorepo
 45:       'import/resolver': {
 46:         typescript: {
 47:           project: ['./tsconfig.json', './packages/*/tsconfig.json', './apps/*/tsconfig.json'],
 48:         },
 49:       },
 50:     },
 51:     rules: {
 52:       ...eslintConfigPrettier.rules,
 53:       // TypeScript Rules
 54:       '@typescript-eslint/adjacent-overload-signatures': 'error',
 55:       '@typescript-eslint/ban-types': 'error',
 56:       '@typescript-eslint/no-explicit-any': 'error',
 57:       '@typescript-eslint/no-unused-vars': [
 58:         'error',
 59:         {
 60:           argsIgnorePattern: '^_',
 61:           varsIgnorePattern: '^_',
 62:           caughtErrorsIgnorePattern: '^_',
 63:         },
 64:       ],
 65:       '@typescript-eslint/consistent-type-imports': [
 66:         'error',
 67:         { prefer: 'type-imports', fixStyle: 'inline-type-imports' },
 68:       ],
 69:       '@typescript-eslint/consistent-type-assertions': 'error',
 70:       '@typescript-eslint/no-array-constructor': 'error',
 71:       '@typescript-eslint/no-empty-interface': 'error',
 72:       '@typescript-eslint/no-misused-new': 'error',
 73:       '@typescript-eslint/no-namespace': 'error',
 74:       '@typescript-eslint/no-this-alias': 'error',
 75:       '@typescript-eslint/prefer-as-const': 'error',
 76:       '@typescript-eslint/triple-slash-reference': 'error',
 77:       '@typescript-eslint/no-non-null-assertion': 'error',
 78:       '@typescript-eslint/no-inferrable-types': 'error',
 79:       '@typescript-eslint/no-unnecessary-type-assertion': 'error',
 80:       '@typescript-eslint/no-unnecessary-condition': 'error',
 81:       '@typescript-eslint/strict-boolean-expressions': 'error',
 82:       '@typescript-eslint/switch-exhaustiveness-check': 'error',
 83:       '@typescript-eslint/prefer-optional-chain': 'error',
 84:       '@typescript-eslint/prefer-nullish-coalescing': 'error',
 85:       '@typescript-eslint/no-floating-promises': 'error',
 86:       '@typescript-eslint/await-thenable': 'error',
 87:       '@typescript-eslint/no-misused-promises': 'error',
 88:       '@typescript-eslint/require-await': 'error',
 89:       // Import Rules
 90:       'no-restricted-imports': [
 91:         'error',
 92:         {
 93:           patterns: [
 94:             {
 95:               group: ['../*'],
 96:               message: 'Please use absolute imports instead of relative imports.',
 97:             },
 98:           ],
 99:         },
100:       ],
101:       // General Rules
102:       'no-console': ['error', { allow: ['warn', 'error'] }],
103:       'no-debugger': 'error',
104:       'no-alert': 'error',
105:     },
106:   },
107: ];
108: 
109: export default config;
```

## File: packages/eslint-config/index.js
```javascript
 1: import baseConfig from './base.js';
 2: import nextConfig from './next.js';
 3: import reactInternalConfig from './react-internal.js';
 4: 
 5: export { baseConfig, nextConfig, reactInternalConfig };
 6: 
 7: // Default export for backwards compatibility
 8: export default {
 9:   extends: ['./base.js'],
10: };
```

## File: packages/eslint-config/next.js
```javascript
 1: import js from '@eslint/js';
 2: import eslintConfigPrettier from 'eslint-config-prettier';
 3: import tseslint from '@typescript-eslint/eslint-plugin';
 4: import tsParser from '@typescript-eslint/parser';
 5: import pluginReactHooks from 'eslint-plugin-react-hooks';
 6: import pluginReact from 'eslint-plugin-react';
 7: import globals from 'globals';
 8: import pluginNext from '@next/eslint-plugin-next';
 9: import baseConfig from './base.js';
10: 
11: /** @type {import("eslint").Linter.FlatConfig[]} */
12: export default [
13:   ...baseConfig,
14:   {
15:     files: ['**/*.{ts,tsx,js,jsx}'],
16:     plugins: {
17:       '@typescript-eslint': tseslint,
18:       react: pluginReact,
19:       'react-hooks': pluginReactHooks,
20:       '@next/next': pluginNext,
21:     },
22:     languageOptions: {
23:       parserOptions: {
24:         ecmaFeatures: {
25:           jsx: true,
26:         },
27:       },
28:       globals: {
29:         React: 'readonly',
30:       },
31:     },
32:     settings: {
33:       react: {
34:         version: 'detect',
35:       },
36:       next: {
37:         rootDir: ['apps/*/'],
38:       },
39:     },
40:     rules: {
41:       ...pluginNext.configs.recommended.rules,
42:       ...pluginNext.configs['core-web-vitals'].rules,
43:       // React Rules
44:       'react/jsx-uses-react': 'off',
45:       'react/react-in-jsx-scope': 'off',
46:       'react/prop-types': 'off',
47:       'react/jsx-key': 'error',
48:       'react/jsx-no-duplicate-props': 'error',
49:       'react/jsx-no-undef': 'error',
50:       'react/no-children-prop': 'error',
51:       'react/no-danger-with-children': 'error',
52:       'react/no-deprecated': 'error',
53:       'react/no-direct-mutation-state': 'error',
54:       'react/no-find-dom-node': 'error',
55:       'react/no-is-mounted': 'error',
56:       'react/no-render-return-value': 'error',
57:       'react/no-string-refs': 'error',
58:       'react/no-unescaped-entities': 'error',
59:       'react/no-unknown-property': ['error', { ignore: ['cmdk-input-wrapper'] }],
60:       'react/no-unsafe': 'off',
61:       // React Hooks Rules
62:       'react-hooks/rules-of-hooks': 'error',
63:       'react-hooks/exhaustive-deps': 'error',
64:       // Next.js specific rules
65:       '@next/next/no-html-link-for-pages': ['error', 'apps/*/src/app'],
66:       '@next/next/no-img-element': 'error',
67:     },
68:   },
69: ];
```

## File: packages/eslint-config/package.json
```json
 1: {
 2:   "name": "@danky/eslint-config",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "exports": {
 7:     "./base": "./base.js",
 8:     "./react-internal": "./react-internal.js",
 9:     "./next": "./next.js"
10:   },
11:   "main": "./base.js",
12:   "files": [
13:     "base.js",
14:     "react-internal.js",
15:     "next.js"
16:   ],
17:   "dependencies": {
18:     "@eslint/eslintrc": "^3.2.0",
19:     "@eslint/js": "^9.18.0",
20:     "@typescript-eslint/eslint-plugin": "^8.19.0",
21:     "@typescript-eslint/parser": "^8.19.0",
22:     "eslint-config-prettier": "^9.1.0",
23:     "eslint-config-turbo": "^2.3.3",
24:     "eslint-plugin-only-warn": "^1.1.0",
25:     "eslint-plugin-turbo": "^2.3.3"
26:   },
27:   "peerDependencies": {
28:     "eslint": "^9.18.0",
29:     "typescript": "^5.4.5",
30:     "eslint-plugin-react": "^7.37.3",
31:     "eslint-plugin-react-hooks": "^5.1.0"
32:   },
33:   "devDependencies": {
34:     "globals": "^15.14.0"
35:   }
36: }
```

## File: packages/eslint-config/react-internal.js
```javascript
 1: import js from '@eslint/js';
 2: import eslintConfigPrettier from 'eslint-config-prettier';
 3: import tseslint from '@typescript-eslint/eslint-plugin';
 4: import tsParser from '@typescript-eslint/parser';
 5: import pluginReactHooks from 'eslint-plugin-react-hooks';
 6: import pluginReact from 'eslint-plugin-react';
 7: import globals from 'globals';
 8: import baseConfig from './base.js';
 9: 
10: /** @type {import("eslint").Linter.FlatConfig[]} */
11: const config = [
12:   ...baseConfig,
13:   {
14:     files: ['**/*.{ts,tsx,js,jsx}'],
15:     plugins: {
16:       '@typescript-eslint': tseslint,
17:       react: pluginReact,
18:       'react-hooks': pluginReactHooks,
19:     },
20:     languageOptions: {
21:       parserOptions: {
22:         ecmaFeatures: {
23:           jsx: true,
24:         },
25:       },
26:       globals: {
27:         React: 'readonly',
28:       },
29:     },
30:     settings: {
31:       react: {
32:         version: 'detect',
33:       },
34:     },
35:     rules: {
36:       ...eslintConfigPrettier.rules,
37:       // React Rules
38:       'react/jsx-uses-react': 'off',
39:       'react/react-in-jsx-scope': 'off',
40:       'react/prop-types': 'off',
41:       'react/jsx-key': 'error',
42:       'react/jsx-no-duplicate-props': 'error',
43:       'react/jsx-no-undef': 'error',
44:       'react/no-children-prop': 'error',
45:       'react/no-danger-with-children': 'error',
46:       'react/no-deprecated': 'error',
47:       'react/no-direct-mutation-state': 'error',
48:       'react/no-find-dom-node': 'error',
49:       'react/no-is-mounted': 'error',
50:       'react/no-render-return-value': 'error',
51:       'react/no-string-refs': 'error',
52:       'react/no-unescaped-entities': 'error',
53:       'react/no-unknown-property': ['error', { ignore: ['cmdk-input-wrapper'] }],
54:       'react/no-unsafe': 'off',
55:       // React Hooks Rules
56:       'react-hooks/rules-of-hooks': 'error',
57:       'react-hooks/exhaustive-deps': 'warn',
58:       // TypeScript Rules
59:       '@typescript-eslint/no-explicit-any': 'warn',
60:       '@typescript-eslint/no-unused-vars': ['warn', { argsIgnorePattern: '^_' }],
61:       '@typescript-eslint/consistent-type-imports': [
62:         'warn',
63:         { prefer: 'type-imports', fixStyle: 'inline-type-imports' },
64:       ],
65:     },
66:   },
67: ];
68: 
69: export default config;
```

## File: packages/eslint-config/README.md
```markdown
1: # `@turbo/eslint-config`
2: 
3: Collection of internal eslint configurations.
```

## File: packages/logger/src/env.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: const envSchema = z.object({
 4:   NODE_ENV: z.enum(['development', 'test', 'production']).default('development'),
 5:   LOG_LEVEL: z.enum(['debug', 'info', 'warn', 'error']).default('info'),
 6: });
 7: 
 8: // Validate and export environment
 9: export const env = envSchema.parse(process.env);
10: 
11: // Export type
12: export type Env = z.infer<typeof envSchema>;
```

## File: packages/logger/src/index.ts
```typescript
1: export * from './logger';
2: export * from './env';
3: export type { Logger } from 'pino';
```

## File: packages/logger/src/logger.ts
```typescript
 1: import type { Logger } from 'pino';
 2: import pino from 'pino';
 3: import { env } from './env';
 4: 
 5: // Configure base logger
 6: export const logger = pino({
 7:   level: env.LOG_LEVEL,
 8:   formatters: {
 9:     level: label => ({ level: label }),
10:   },
11:   timestamp: pino.stdTimeFunctions.isoTime,
12:   redact: {
13:     paths: ['*.password', '*.secret', '*.token', '*.key'],
14:     remove: true,
15:   },
16: });
17: 
18: // Create child loggers for different contexts
19: export const createLogger = (context: string): Logger => {
20:   return logger.child({ context });
21: };
22: 
23: // Export pre-configured loggers
24: export const dbLogger = createLogger('database');
25: export const apiLogger = createLogger('api');
26: export const mcpLogger = createLogger('mcp');
```

## File: packages/logger/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/logger/package.json
```json
 1: {
 2:   "name": "@danky/logger",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "dev": "tsup --watch",
15:     "type-check": "tsc --noEmit",
16:     "lint": "eslint .",
17:     "clean": "rimraf dist"
18:   },
19:   "dependencies": {
20:     "pino": "^9.6.0",
21:     "zod": "^3.24.1"
22:   },
23:   "devDependencies": {
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^22.10.5",
27:     "pino-pretty": "^13.0.0",
28:     "tsup": "^8.0.2",
29:     "typescript": "^5.4.5",
30:     "rimraf": "^6.0.1"
31:   }
32: }
```

## File: packages/logger/README.md
```markdown
  1: # @danky/logger
  2: 
  3: Structured logging utilities for the Danky AI Chatbot platform, built with Pino.
  4: 
  5: ## Overview
  6: 
  7: The logger package provides a standardized logging interface across the platform, with support for structured logging, log levels, and various transports. It's built on top of Pino for high performance.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13: ├── config/          # Logger configuration
 14: ├── transports/      # Log transports
 15: ├── formatters/      # Log formatters
 16: └── types/           # TypeScript types
 17: ```
 18: 
 19: ## Key Features
 20: 
 21: - **Structured Logging**: JSON-based log format
 22: - **Performance**: High-speed logging with Pino
 23: - **Type Safety**: Full TypeScript coverage
 24: - **Log Levels**: Configurable log levels
 25: - **Transports**: Multiple output targets
 26: - **Context**: Request-scoped logging
 27: 
 28: ## Usage
 29: 
 30: ### Basic Logging
 31: 
 32: ```typescript
 33: import { logger } from '@danky/logger'
 34: 
 35: // Simple logging
 36: logger.info('Hello world')
 37: 
 38: // With context
 39: logger.info({ userId: '123' }, 'User logged in')
 40: 
 41: // Error logging
 42: try {
 43:   throw new Error('Something went wrong')
 44: } catch (error) {
 45:   logger.error({ error }, 'Operation failed')
 46: }
 47: ```
 48: 
 49: ### Request Context
 50: 
 51: ```typescript
 52: import { withRequestContext } from '@danky/logger'
 53: 
 54: export async function handler(req: Request) {
 55:   const log = withRequestContext(req)
 56:   log.info('Processing request')
 57: 
 58:   try {
 59:     // Operation
 60:   } catch (error) {
 61:     log.error({ error }, 'Request failed')
 62:   }
 63: }
 64: ```
 65: 
 66: ## AI Development Notes
 67: 
 68: ### Key Concepts
 69: 
 70: 1. **Log Levels**
 71:    - trace: Verbose debugging
 72:    - debug: Debugging information
 73:    - info: General information
 74:    - warn: Warning messages
 75:    - error: Error messages
 76:    - fatal: Critical errors
 77: 
 78: 2. **Context Management**
 79:    - Request-scoped logging
 80:    - Error serialization
 81:    - Performance metrics
 82:    - User context
 83: 
 84: 3. **Best Practices**
 85:    - Use structured data
 86:    - Include error stacks
 87:    - Add request IDs
 88:    - Keep messages concise
 89: 
 90: ### Common Patterns
 91: 
 92: #### Error Logging
 93: ```typescript
 94: import { logger } from '@danky/logger'
 95: 
 96: try {
 97:   await operation()
 98: } catch (error) {
 99:   logger.error({
100:     error,
101:     context: {
102:       operation: 'operation_name',
103:       input: data,
104:     },
105:   }, 'Operation failed')
106:   throw error
107: }
108: ```
109: 
110: #### Performance Logging
111: ```typescript
112: import { logger } from '@danky/logger'
113: 
114: const start = performance.now()
115: try {
116:   await operation()
117: } finally {
118:   const duration = performance.now() - start
119:   logger.info({ duration }, 'Operation completed')
120: }
121: ```
122: 
123: #### Request Logging
124: ```typescript
125: import { logger } from '@danky/logger'
126: 
127: export async function middleware(req: Request) {
128:   const requestId = crypto.randomUUID()
129:   const log = logger.child({ requestId })
130: 
131:   log.info({
132:     method: req.method,
133:     url: req.url,
134:   }, 'Request received')
135: 
136:   try {
137:     const response = await handler(req)
138:     log.info({ status: response.status }, 'Request completed')
139:     return response
140:   } catch (error) {
141:     log.error({ error }, 'Request failed')
142:     throw error
143:   }
144: }
145: ```
146: 
147: ## Configuration
148: 
149: ### Environment Variables
150: ```env
151: LOG_LEVEL=info
152: LOG_PRETTY=true
153: LOG_FILE=logs/app.log
154: ```
155: 
156: ### Logger Options
157: ```typescript
158: {
159:   level: 'info',
160:   transport: {
161:     target: 'pino-pretty',
162:     options: {
163:       colorize: true,
164:     },
165:   },
166:   serializers: {
167:     error: errorSerializer,
168:     request: requestSerializer,
169:   },
170: }
171: ```
172: 
173: ## Development
174: 
175: ### Setup
176: ```bash
177: pnpm install
178: pnpm build
179: ```
180: 
181: ### Testing
182: ```bash
183: pnpm test
184: pnpm test:watch
185: ```
186: 
187: ### Linting
188: ```bash
189: pnpm lint
190: pnpm type-check
191: ```
192: 
193: ## Troubleshooting
194: 
195: ### Common Issues
196: 1. **Performance**: Check log levels
197: 2. **Memory Usage**: Monitor log size
198: 3. **Missing Context**: Verify child loggers
199: 4. **Transport Errors**: Check file permissions
200: 
201: ### Debug Tools
202: - pino-pretty for development
203: - pino-tee for splitting output
204: - pino-debug for debug logs
205: 
206: ## Additional Resources
207: 
208: - [Logging Best Practices](../../docs/LOGGING.md)
209: - [Error Handling Guide](../../docs/ERRORS.md)
210: - [Performance Guide](../../docs/PERFORMANCE.md)
211: - [Monitoring Guide](../../docs/MONITORING.md)
```

## File: packages/logger/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/logger/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ['pino', 'pino-pretty'],
10: });
```

## File: packages/mcp/src/index.ts
```typescript
  1: import { createReactAgent } from '@langchain/langgraph/prebuilt';
  2: import { MemorySaver } from '@langchain/langgraph';
  3: import { HumanMessage } from '@langchain/core/messages';
  4: import { convertMcpToLangchainTools, type McpServersConfig } from '@h1deya/langchain-mcp-tools';
  5: import { initChatModel } from './init-chat-model';
  6: import { loadConfig, type Config } from './load-config';
  7: import type { Logger } from './logger';
  8: import { createLogger } from './logger';
  9: 
 10: export interface MCPServiceOptions {
 11:   configPath?: string;
 12:   logger?: Logger;
 13: }
 14: 
 15: export class MCPService {
 16:   private config: Config | null = null;
 17:   private agent: ReturnType<typeof createReactAgent> | null = null;
 18:   private cleanup: (() => Promise<void>) | null = null;
 19:   private readonly logger: Logger;
 20:   private readonly configPath: string;
 21: 
 22:   constructor(options: MCPServiceOptions = {}) {
 23:     this.logger = options.logger ?? createLogger({ level: 'info' });
 24:     this.configPath = options.configPath ?? 'mcp-config.json5';
 25:   }
 26: 
 27:   async initialize(): Promise<void> {
 28:     try {
 29:       // Load and validate config
 30:       this.logger.info('Loading MCP configuration');
 31:       const configPath = process.env['CONFIG_FILE'] ?? this.configPath;
 32:       const config = loadConfig(configPath);
 33:       this.config = config;
 34:       this.logger.info('Configuration loaded successfully');
 35: 
 36:       // Initialize LLM
 37:       this.logger.info('Initializing LLM model');
 38:       const llmModel = initChatModel(this.config.llm);
 39:       this.logger.info('LLM model initialized successfully');
 40: 
 41:       // Initialize MCP servers
 42:       const serverCount = Object.keys(this.config.mcpServers).length;
 43:       this.logger.info(`Initializing ${serverCount} MCP server(s)...`);
 44: 
 45:       // Convert MCP servers to LangChain tools
 46:       const { tools, cleanup } = await convertMcpToLangchainTools(
 47:         this.config.mcpServers as McpServersConfig,
 48:         { logLevel: 'info' }
 49:       );
 50:       this.cleanup = cleanup;
 51:       this.logger.info(`Initialized ${tools.length} MCP tool(s)`);
 52: 
 53:       // Create React agent
 54:       this.agent = createReactAgent({
 55:         llm: llmModel,
 56:         tools,
 57:         checkpointSaver: new MemorySaver(),
 58:       });
 59:       this.logger.info('React agent created successfully');
 60:     } catch (error) {
 61:       this.logger.error('Failed to initialize MCP Service:', {
 62:         error:
 63:           error instanceof Error
 64:             ? {
 65:                 name: error.name,
 66:                 message: error.message,
 67:                 stack: error.stack,
 68:               }
 69:             : String(error),
 70:       });
 71:       throw error;
 72:     }
 73:   }
 74: 
 75:   async processMessage(message: string): Promise<string> {
 76:     if (!this.agent) {
 77:       throw new Error('MCP Service not initialized');
 78:     }
 79: 
 80:     try {
 81:       const result = await this.agent.invoke(
 82:         { messages: [new HumanMessage(message)] },
 83:         { configurable: { thread_id: 'test-thread' } }
 84:       );
 85:       const messages = result['messages'];
 86:       if (!Array.isArray(messages) || messages.length === 0) {
 87:         throw new Error('Invalid response from agent');
 88:       }
 89:       return messages[messages.length - 1].content as string;
 90:     } catch (error) {
 91:       this.logger.error('Error processing message:', {
 92:         error:
 93:           error instanceof Error
 94:             ? {
 95:                 name: error.name,
 96:                 message: error.message,
 97:                 stack: error.stack,
 98:               }
 99:             : String(error),
100:       });
101:       throw error;
102:     }
103:   }
104: 
105:   async shutdown(): Promise<void> {
106:     if (this.cleanup) {
107:       await this.cleanup();
108:       this.cleanup = null;
109:     }
110:     this.agent = null;
111:   }
112: }
113: 
114: // Remove CLI interface as it's not being used properly
115: export { type Config } from './load-config';
```

## File: packages/mcp/src/init-chat-model.ts
```typescript
 1: // Copyright (C) 2024 Hideya Kawahara
 2: // SPDX-License-Identifier: MIT
 3: 
 4: import { ChatOpenAI } from '@langchain/openai';
 5: import { ChatAnthropic } from '@langchain/anthropic';
 6: import { ChatGroq } from '@langchain/groq';
 7: import type { BaseChatModel } from '@langchain/core/language_models/chat_models';
 8: import type { LLMConfig } from './load-config';
 9: 
10: export function initChatModel(config: LLMConfig): BaseChatModel {
11:   const provider = config.provider.toLowerCase();
12:   const temperature = config.temperature ?? 0.7;
13:   const maxTokens = config.maxTokens ?? 4096;
14: 
15:   switch (provider) {
16:     case 'openai': {
17:       const openaiApiKey = config.apiKey ?? process.env['OPENAI_API_KEY'];
18:       if (typeof openaiApiKey !== 'string' || !openaiApiKey) {
19:         throw new Error('OpenAI API key not found');
20:       }
21:       return new ChatOpenAI({
22:         apiKey: openaiApiKey,
23:         modelName: config.model ?? 'gpt-4',
24:         temperature,
25:         maxTokens,
26:       });
27:     }
28: 
29:     case 'anthropic': {
30:       const anthropicApiKey = config.apiKey ?? process.env['ANTHROPIC_API_KEY'];
31:       if (typeof anthropicApiKey !== 'string' || !anthropicApiKey) {
32:         throw new Error('Anthropic API key not found');
33:       }
34:       return new ChatAnthropic({
35:         apiKey: anthropicApiKey,
36:         model: config.model ?? 'claude-3-opus-20240229',
37:         temperature,
38:         maxTokens,
39:       });
40:     }
41: 
42:     case 'groq': {
43:       const groqApiKey = config.apiKey ?? process.env['GROQ_API_KEY'];
44:       if (typeof groqApiKey !== 'string' || !groqApiKey) {
45:         throw new Error('Groq API key not found');
46:       }
47:       return new ChatGroq({
48:         apiKey: groqApiKey,
49:         model: config.model ?? 'mixtral-8x7b-32768',
50:         temperature,
51:         maxTokens,
52:       });
53:     }
54: 
55:     default:
56:       throw new Error(`Unsupported provider: ${config.provider}`);
57:   }
58: }
```

## File: packages/mcp/src/load-config.ts
```typescript
  1: // Copyright (C) 2024 Hideya Kawahara
  2: // SPDX-License-Identifier: MIT
  3: 
  4: import JSON5 from 'json5';
  5: import { readFileSync } from 'fs';
  6: 
  7: // Validate required environment variables
  8: function validateEnvironmentVariables(config: Config): void {
  9:   const missingVars = new Set<string>();
 10: 
 11:   // Check LLM API keys
 12:   if (config.llm.apiKey !== undefined && config.llm.apiKey.includes('${')) {
 13:     const matches = config.llm.apiKey.match(/\$\{([^}]+)\}/g);
 14:     if (matches !== null) {
 15:       for (const match of matches) {
 16:         const envVar = match.slice(2, -1);
 17:         if (process.env[envVar] === undefined) {
 18:           throw new Error(`Missing environment variable: ${envVar}`);
 19:         }
 20:       }
 21:     }
 22:   }
 23: 
 24:   // Check server environment variables
 25:   for (const [, server] of Object.entries(config.mcpServers)) {
 26:     const serverEnv = server.env ?? {};
 27:     for (const value of Object.values(serverEnv)) {
 28:       if (value.includes('${')) {
 29:         const matches = value.match(/\$\{([^}]+)\}/g);
 30:         if (matches !== null) {
 31:           for (const match of matches) {
 32:             const varName = match.slice(2, -1);
 33:             if (process.env[varName] === undefined) {
 34:               missingVars.add(varName);
 35:             }
 36:           }
 37:         }
 38:       }
 39:     }
 40:   }
 41: 
 42:   if (missingVars.size > 0) {
 43:     throw new Error(
 44:       `Missing required environment variables: ${Array.from(missingVars).join(', ')}. Make sure these are set in the root .env file.`
 45:     );
 46:   }
 47: }
 48: 
 49: export interface LLMConfig {
 50:   provider: string;
 51:   model?: string;
 52:   modelName?: string;
 53:   temperature?: number;
 54:   maxTokens?: number;
 55:   apiKey?: string;
 56: }
 57: 
 58: export interface MCPServerConfig {
 59:   command: string;
 60:   args: string[];
 61:   env?: Record<string, string>;
 62: }
 63: 
 64: export interface Config {
 65:   llm: LLMConfig;
 66:   mcpServers: {
 67:     [key: string]: MCPServerConfig;
 68:   };
 69: }
 70: 
 71: export function loadConfig(configPath: string): Config {
 72:   let fileContents: string;
 73:   try {
 74:     fileContents = readFileSync(configPath, 'utf-8');
 75:   } catch (error) {
 76:     throw new Error(
 77:       `Config file not found at "${configPath}". Error: ${error instanceof Error ? error.message : String(error)}`
 78:     );
 79:   }
 80: 
 81:   // Replace environment variables in the format ${VAR_NAME} with their values
 82:   const configWithEnvVars = Object.entries(process.env).reduce((acc, [key, value]) => {
 83:     if (value !== undefined) {
 84:       const regex = new RegExp(`\\$\{${key}}`, 'g');
 85:       return acc.replace(regex, value);
 86:     }
 87:     return acc;
 88:   }, fileContents);
 89: 
 90:   let config: unknown;
 91:   try {
 92:     config = JSON5.parse(configWithEnvVars);
 93:   } catch (error) {
 94:     throw new Error(
 95:       `Failed to parse config file: ${error instanceof Error ? error.message : String(error)}`
 96:     );
 97:   }
 98: 
 99:   try {
100:     // Validate required fields
101:     validateConfig(config);
102: 
103:     // Validate environment variables
104:     validateEnvironmentVariables(config);
105: 
106:     return config;
107:   } catch (error) {
108:     throw new Error(
109:       `Failed to load configuration from "${configPath}": ${error instanceof Error ? error.message : String(error)}`
110:     );
111:   }
112: }
113: 
114: function validateConfig(config: unknown): asserts config is Config {
115:   if (config === null || typeof config !== 'object') {
116:     throw new Error('Configuration must be an object');
117:   }
118: 
119:   const configObj = config as Record<string, unknown>;
120: 
121:   if (configObj.llm === null || typeof configObj.llm !== 'object') {
122:     throw new Error('LLM configuration is required and must be an object');
123:   }
124:   validateLLMConfig(configObj.llm);
125: 
126:   if (configObj.mcpServers === null || typeof configObj.mcpServers !== 'object') {
127:     throw new Error('mcpServers must be an object');
128:   }
129: 
130:   const servers = configObj.mcpServers as Record<string, unknown>;
131:   for (const [key, value] of Object.entries(servers)) {
132:     try {
133:       validateMCPServerConfig(value);
134:     } catch (error) {
135:       throw new Error(
136:         `Invalid configuration for MCP server "${key}": ${error instanceof Error ? error.message : String(error)}`
137:       );
138:     }
139:   }
140: }
141: 
142: function validateLLMConfig(llmConfig: unknown): asserts llmConfig is LLMConfig {
143:   if (llmConfig === null || typeof llmConfig !== 'object') {
144:     throw new Error('LLM configuration must be an object');
145:   }
146: 
147:   const config = llmConfig as Record<string, unknown>;
148: 
149:   if (typeof config.provider !== 'string' || config.provider === '') {
150:     throw new Error('LLM provider must be a non-empty string');
151:   }
152: 
153:   if (
154:     'model' in config &&
155:     (config.model === null || typeof config.model !== 'string' || config.model === '')
156:   ) {
157:     throw new Error('LLM model must be a non-empty string if provided');
158:   }
159: 
160:   if (
161:     'modelName' in config &&
162:     (config.modelName === null || typeof config.modelName !== 'string' || config.modelName === '')
163:   ) {
164:     throw new Error('LLM modelName must be a non-empty string if provided');
165:   }
166: 
167:   if (
168:     'temperature' in config &&
169:     (config.temperature === null || typeof config.temperature !== 'number')
170:   ) {
171:     throw new Error('LLM temperature must be a number if provided');
172:   }
173: 
174:   if (
175:     'maxTokens' in config &&
176:     (config.maxTokens === null || typeof config.maxTokens !== 'number')
177:   ) {
178:     throw new Error('LLM maxTokens must be a number if provided');
179:   }
180: 
181:   if (
182:     'apiKey' in config &&
183:     (config.apiKey === null || typeof config.apiKey !== 'string' || config.apiKey === '')
184:   ) {
185:     throw new Error('LLM apiKey must be a non-empty string if provided');
186:   }
187: }
188: 
189: function validateMCPServerConfig(serverConfig: unknown): asserts serverConfig is MCPServerConfig {
190:   if (serverConfig === null || typeof serverConfig !== 'object') {
191:     throw new Error('MCP server configuration must be an object');
192:   }
193: 
194:   const config = serverConfig as Record<string, unknown>;
195: 
196:   if (typeof config.command !== 'string' || config.command === '') {
197:     throw new Error('MCP server command must be a non-empty string');
198:   }
199: 
200:   if (!Array.isArray(config.args)) {
201:     throw new Error('MCP server args must be an array');
202:   }
203: 
204:   if (!config.args.every(arg => typeof arg === 'string' && arg !== '')) {
205:     throw new Error('All MCP server args must be non-empty strings');
206:   }
207: 
208:   if ('env' in config) {
209:     if (config.env === null || typeof config.env !== 'object') {
210:       throw new Error('MCP server env must be an object if provided');
211:     }
212: 
213:     const env = config.env as Record<string, unknown>;
214:     if (!Object.values(env).every(value => typeof value === 'string' && value !== '')) {
215:       throw new Error('All MCP server env values must be non-empty strings');
216:     }
217:   }
218: }
```

## File: packages/mcp/src/logger.ts
```typescript
  1: // Copyright (C) 2024 Hideya Kawahara
  2: // SPDX-License-Identifier: MIT
  3: 
  4: type LogLevelString = 'trace' | 'debug' | 'info' | 'warn' | 'error' | 'fatal';
  5: 
  6: const LOG_LEVEL_VALUES = {
  7:   TRACE: 0,
  8:   DEBUG: 1,
  9:   INFO: 2,
 10:   WARN: 3,
 11:   ERROR: 4,
 12:   FATAL: 5,
 13: } as const;
 14: 
 15: type LogLevel = (typeof LOG_LEVEL_VALUES)[keyof typeof LOG_LEVEL_VALUES];
 16: 
 17: const LOG_COLORS = {
 18:   [LOG_LEVEL_VALUES.TRACE]: '\x1b[90m', // Gray
 19:   [LOG_LEVEL_VALUES.DEBUG]: '\x1b[90m', // Gray
 20:   [LOG_LEVEL_VALUES.INFO]: '\x1b[90m', // Gray
 21:   [LOG_LEVEL_VALUES.WARN]: '\x1b[1;93m', // Bold bright yellow
 22:   [LOG_LEVEL_VALUES.ERROR]: '\x1b[1;91m', // Bold bright red
 23:   [LOG_LEVEL_VALUES.FATAL]: '\x1b[1;101m', // Red background, Bold text
 24: } as const;
 25: 
 26: const LOG_LEVEL_MAP: Record<LogLevelString, LogLevel> = {
 27:   trace: LOG_LEVEL_VALUES.TRACE,
 28:   debug: LOG_LEVEL_VALUES.DEBUG,
 29:   info: LOG_LEVEL_VALUES.INFO,
 30:   warn: LOG_LEVEL_VALUES.WARN,
 31:   error: LOG_LEVEL_VALUES.ERROR,
 32:   fatal: LOG_LEVEL_VALUES.FATAL,
 33: } as const;
 34: 
 35: const LOG_LEVEL_NAMES: Record<LogLevel, string> = {
 36:   [LOG_LEVEL_VALUES.TRACE]: 'trace',
 37:   [LOG_LEVEL_VALUES.DEBUG]: 'debug',
 38:   [LOG_LEVEL_VALUES.INFO]: 'info',
 39:   [LOG_LEVEL_VALUES.WARN]: 'warn',
 40:   [LOG_LEVEL_VALUES.ERROR]: 'error',
 41:   [LOG_LEVEL_VALUES.FATAL]: 'fatal',
 42: } as const;
 43: 
 44: export class Logger {
 45:   private readonly level: LogLevel;
 46:   private static readonly RESET = '\x1b[0m';
 47: 
 48:   constructor({ level = LOG_LEVEL_VALUES.INFO }: { level?: LogLevelString | LogLevel } = {}) {
 49:     this.level = this.parseLogLevel(level);
 50:   }
 51: 
 52:   private parseLogLevel(level: LogLevel | LogLevelString): LogLevel {
 53:     if (typeof level === 'number') return level;
 54:     return LOG_LEVEL_MAP[level.toLowerCase() as LogLevelString];
 55:   }
 56: 
 57:   private log(level: LogLevel, ...args: unknown[]): void {
 58:     if (level < this.level) return;
 59: 
 60:     const color = LOG_COLORS[level];
 61:     const levelStr = `[${LOG_LEVEL_NAMES[level]}]`;
 62:     const formattedArgs = args.map(this.formatValue);
 63: 
 64:     if (level >= LOG_LEVEL_VALUES.WARN) {
 65:       // Use console.warn or console.error for appropriate levels
 66:       const logMethod = level >= LOG_LEVEL_VALUES.ERROR ? console.error : console.warn;
 67:       logMethod(`${color}${levelStr}${Logger.RESET}`, ...formattedArgs);
 68:     } else {
 69:       // Use process.stdout.write for other levels to avoid console.log
 70:       const output = [`${color}${levelStr}${Logger.RESET}`, ...formattedArgs].join(' ') + '\n';
 71:       process.stdout.write(output);
 72:     }
 73:   }
 74: 
 75:   private formatValue(value: unknown): string {
 76:     if (value === null) return 'null';
 77:     if (value === undefined) return 'undefined';
 78:     return typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value);
 79:   }
 80: 
 81:   private createLogMethod(level: LogLevel) {
 82:     return (...args: unknown[]) => this.log(level, ...args);
 83:   }
 84: 
 85:   trace = this.createLogMethod(LOG_LEVEL_VALUES.TRACE);
 86:   debug = this.createLogMethod(LOG_LEVEL_VALUES.DEBUG);
 87:   info = this.createLogMethod(LOG_LEVEL_VALUES.INFO);
 88:   warn = this.createLogMethod(LOG_LEVEL_VALUES.WARN);
 89:   error = this.createLogMethod(LOG_LEVEL_VALUES.ERROR);
 90:   fatal = this.createLogMethod(LOG_LEVEL_VALUES.FATAL);
 91: }
 92: 
 93: export interface LoggerOptions {
 94:   level?: LogLevelString | LogLevel;
 95: }
 96: 
 97: export function createLogger(options: LoggerOptions = {}): Logger {
 98:   return new Logger(options);
 99: }
100: 
101: export { LOG_LEVEL_VALUES as LogLevel };
102: export type { LogLevelString };
```

## File: packages/mcp/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/mcp/package.json
```json
 1: {
 2:   "name": "@danky/mcp",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "exports": {
10:     ".": {
11:       "types": "./dist/index.d.ts",
12:       "import": "./dist/index.js",
13:       "default": "./dist/index.js"
14:     },
15:     "./servers/*": {
16:       "types": "./dist/servers/*.d.ts",
17:       "import": "./dist/servers/*.js",
18:       "default": "./dist/servers/*.js"
19:     },
20:     "./logger": {
21:       "types": "./dist/logger.d.ts",
22:       "import": "./dist/logger.js",
23:       "default": "./dist/logger.js"
24:     }
25:   },
26:   "scripts": {
27:     "build": "tsc",
28:     "dev": "tsc --watch",
29:     "lint": "eslint .",
30:     "type-check": "tsc --noEmit",
31:     "clean": "rimraf .turbo node_modules dist"
32:   },
33:   "dependencies": {
34:     "@langchain/anthropic": "^0.3.11",
35:     "@langchain/community": "^0.3.24",
36:     "@langchain/core": "^0.3.29",
37:     "@langchain/groq": "^0.1.3",
38:     "@langchain/langgraph": "^0.2.39",
39:     "@langchain/openai": "^0.3.16",
40:     "@modelcontextprotocol/sdk": "^1.1.1",
41:     "@h1deya/langchain-mcp-tools": "^0.1.4",
42:     "@n8n/json-schema-to-zod": "^1.1.0",
43:     "json5": "^2.2.3",
44:     "yargs": "^17.7.2",
45:     "zod": "^3.24.1"
46:   },
47:   "devDependencies": {
48:     "@danky/eslint-config": "workspace:*",
49:     "@danky/typescript-config": "workspace:*",
50:     "@types/yargs": "^17.0.33",
51:     "dotenv": "^16.4.7",
52:     "eslint": "^9.18.0",
53:     "rimraf": "^6.0.1",
54:     "typescript": "^5.4.5"
55:   }
56: }
```

## File: packages/mcp/README.md
```markdown
  1: # Model Context Protocol (MCP) Implementation
  2: 
  3: ## Overview
  4: 
  5: The Model Context Protocol (MCP) is a standardized interface that enables applications to provide context for LLMs in a standardized way, separating the concerns of providing context from the actual LLM interaction.
  6: 
  7: ## Architecture
  8: 
  9: MCP follows a client-host-server architecture where each host can run multiple client instances:
 10: 
 11: ```
 12: ┌─────────────────────────────────────┐
 13: │          Application Host           │
 14: │ ┌─────────┐                        │
 15: │ │  Host   │                        │
 16: │ │ ┌─────┐ ┌─────┐ ┌─────┐         │
 17: │ │ │ C1  │ │ C2  │ │ C3  │         │
 18: │ │ └─────┘ └─────┘ └─────┘         │
 19: │ └─────────┘                        │
 20: └─────────────────────────────────────┘
 21:            │     │     │
 22:            ▼     ▼     ▼
 23:     ┌─────┐ ┌─────┐ ┌─────┐
 24:     │ S1  │ │ S2  │ │ S3  │
 25:     └─────┘ └─────┘ └─────┘
 26:     Files   Database  APIs
 27: ```
 28: 
 29: ### Core Components
 30: 
 31: - **Host**: Creates and manages multiple client instances, controls permissions, enforces security policies
 32: - **Clients**: Maintain 1:1 connections with servers, handle protocol negotiation
 33: - **Servers**: Provide specialized context and capabilities through resources, tools, and prompts
 34: 
 35: ## Protocol Features
 36: 
 37: ### Base Protocol
 38: - JSON-RPC 2.0 message format
 39: - Stateful connections
 40: - Server and client capability negotiation
 41: - Bidirectional communication
 42: 
 43: ### Message Types
 44: 1. **Requests**: Bidirectional messages with method and parameters expecting a response
 45: 2. **Responses**: Successful results or errors matching specific request IDs
 46: 3. **Notifications**: One-way messages requiring no response
 47: 
 48: ### Transport Layer
 49: 
 50: MCP defines two standard transport mechanisms:
 51: 
 52: #### stdio Transport
 53: ```typescript
 54: import { Server } from "@modelcontextprotocol/sdk/server/index.js"
 55: import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js"
 56: 
 57: const server = new Server(
 58:   {
 59:     name: "example-server",
 60:     version: "0.1.0",
 61:   },
 62:   {
 63:     capabilities: {
 64:       resources: {},
 65:       tools: {},
 66:       prompts: {},
 67:     },
 68:   }
 69: )
 70: 
 71: const transport = new StdioServerTransport()
 72: await server.connect(transport)
 73: ```
 74: 
 75: #### HTTP with Server-Sent Events (SSE)
 76: ```typescript
 77: import { Server } from "@modelcontextprotocol/sdk/server/index.js"
 78: import { SSEServerTransport } from "@modelcontextprotocol/sdk/server/sse.js"
 79: 
 80: const transport = new SSEServerTransport("/message", res)
 81: const server = new Server(
 82:   {
 83:     name: "example-server",
 84:     version: "0.1.0",
 85:   },
 86:   {
 87:     capabilities: {},
 88:   }
 89: )
 90: 
 91: await server.connect(transport)
 92: ```
 93: 
 94: ## Core Capabilities
 95: 
 96: ### Resources
 97: Resources represent data that can be accessed by AI models:
 98: 
 99: ```typescript
100: server.setRequestHandler(ListResourcesRequestSchema, async () => {
101:   return {
102:     resources: [{
103:       uri: `resource://example/1`,
104:       mimeType: "text/plain",
105:       name: "Example Resource",
106:       description: "A text resource"
107:     }]
108:   }
109: })
110: ```
111: 
112: ### Tools
113: Tools enable LLMs to perform actions through your server:
114: 
115: ```typescript
116: server.setRequestHandler(CallToolRequestSchema, async (request) => {
117:   switch (request.params.name) {
118:     case "example_tool": {
119:       const title = String(request.params.arguments?.title)
120:       const content = String(request.params.arguments?.content)
121: 
122:       return {
123:         content: [{
124:           type: "text",
125:           text: `Operation completed`
126:         }]
127:       }
128:     }
129:     default:
130:       throw new Error("Unknown tool")
131:   }
132: })
133: ```
134: 
135: ### Prompts
136: Prompts define structured interactions with AI models:
137: 
138: ```typescript
139: server.setRequestHandler(ListPromptsRequestSchema, async () => {
140:   return {
141:     prompts: [
142:       {
143:         name: "example_prompt",
144:         description: "Example prompt",
145:       }
146:     ]
147:   }
148: })
149: ```
150: 
151: ## LangChain Integration
152: 
153: MCP tools can be integrated with LangChain using the `@h1deya/mcp-langchain-tools` package:
154: 
155: ```typescript
156: import { convertMCPServersToLangChainTools } from '@h1deya/mcp-langchain-tools'
157: 
158: const mcpServers = {
159:   filesystem: {
160:     command: 'npx',
161:     args: [
162:       '-y',
163:       '@modelcontextprotocol/server-filesystem',
164:       '/path/to/directory'
165:     ]
166:   }
167: }
168: 
169: const { tools, cleanup } = await convertMCPServersToLangChainTools(mcpServers)
170: ```
171: 
172: Currently supports OpenAI, Anthropic, and Groq LLMs.
173: 
174: ### Current Limitations
175: - Only text-based tool results are supported
176: 
177: ## Development
178: 
179: ### Setup
180: ```bash
181: npm install
182: npm run build
183: ```
184: 
185: ## Design Principles
186: 
187: 1. **Servers should be extremely easy to build**
188:    - Host applications handle complex orchestration
189:    - Servers focus on specific, well-defined capabilities
190:    - Simple interfaces minimize implementation overhead
191: 
192: 2. **Servers should be highly composable**
193:    - Each server provides focused functionality
194:    - Multiple servers can be combined seamlessly
195:    - Shared protocol enables interoperability
196: 
197: 3. **Servers maintain isolation**
198:    - Servers receive only necessary contextual information
199:    - Full conversation history stays with the host
200:    - Each server connection maintains isolation
201:    - Cross-server interactions are controlled by the host
202: 
203: 4. **Progressive feature adoption**
204:    - Core protocol provides minimal required functionality
205:    - Additional capabilities can be negotiated as needed
206:    - Servers and clients evolve independently
207:    - Backwards compatibility is maintained
208: 
209: ## Additional Resources
210: 
211: - [Model Context Protocol](https://modelcontextprotocol.io) - Official documentation
212: - [JSON-RPC 2.0 Specification](https://www.jsonrpc.org/specification)
213: - [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
214: - [MCP LangChain Tools](https://github.com/hideya/mcp-langchain-tools-ts)
```

## File: packages/mcp/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "dist",
 5:     "rootDir": "src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/next-config/src/base.ts
```typescript
 1: import type { NextConfig } from 'next';
 2: 
 3: export interface BaseOptions {
 4:   transpilePackages?: string[];
 5:   experimental?: NextConfig['experimental'];
 6:   reactStrictMode?: boolean;
 7: }
 8: 
 9: export function baseConfig({
10:   transpilePackages = [],
11:   experimental = {},
12:   reactStrictMode = true,
13:   ...rest
14: }: BaseOptions = {}): NextConfig {
15:   return {
16:     reactStrictMode,
17:     transpilePackages,
18:     experimental: {
19:       typedRoutes: true,
20:       serverActions: true,
21:       ...experimental,
22:     },
23:     ...rest,
24:   };
25: }
```

## File: packages/next-config/src/index.ts
```typescript
1: export { baseConfig, type BaseOptions } from './base';
```

## File: packages/next-config/package.json
```json
 1: {
 2:   "name": "@danky/next-config",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.js",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "clean": "rimraf .turbo node_modules dist",
15:     "dev": "tsup --watch",
16:     "lint": "eslint .",
17:     "type-check": "tsc --noEmit"
18:   },
19:   "dependencies": {
20:     "next": "^14.1.3",
21:     "webpack": "^5.90.3"
22:   },
23:   "devDependencies": {
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^20.11.25",
27:     "eslint": "^8.57.0",
28:     "rimraf": "^5.0.5",
29:     "tsup": "^8.0.2",
30:     "typescript": "^5.3.3"
31:   }
32: }
```

## File: packages/next-config/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": "."
 7:   },
 8:   "include": ["src/**/*.ts"],
 9:   "exclude": ["node_modules", "dist"]
10: }
```

## File: packages/qdrant/src/client.ts
```typescript
 1: import { QdrantClient } from '@qdrant/js-client-rest';
 2: import { env } from './env';
 3: import { createLogger } from '@danky/logger';
 4: 
 5: const logger = createLogger('qdrant');
 6: 
 7: export const qdrant = new QdrantClient({
 8:   url: env.QDRANT_URL,
 9:   timeout: 5000,
10: });
11: 
12: // Helper for creating collections
13: export async function ensureCollection(name: string, dimension: number) {
14:   try {
15:     await qdrant.getCollection(name);
16:     logger.info({ collection: name }, 'Collection exists');
17:   } catch (error) {
18:     await qdrant.createCollection(name, {
19:       vectors: {
20:         size: dimension,
21:         distance: 'Cosine',
22:       },
23:     });
24:     logger.info({ collection: name }, 'Created collection');
25:   }
26: }
27: 
28: // Helper for upserting points
29: export async function upsertVectors(
30:   collection: string,
31:   points: Array<{
32:     id: string;
33:     vector: number[];
34:     payload?: Record<string, unknown>;
35:   }>
36: ) {
37:   try {
38:     await qdrant.upsert(collection, {
39:       points: points.map(p => ({
40:         id: p.id,
41:         vector: p.vector,
42:         payload: p.payload,
43:       })),
44:     });
45:     logger.info({ collection, count: points.length }, 'Successfully upserted vectors');
46:   } catch (error) {
47:     logger.error({ error, collection, count: points.length }, 'Failed to upsert vectors');
48:     throw error;
49:   }
50: }
```

## File: packages/qdrant/src/env.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: const envSchema = z.object({
 4:   QDRANT_URL: z.string().url(),
 5:   NODE_ENV: z.enum(['development', 'test', 'production']).default('development'),
 6: });
 7: 
 8: // Validate and export environment
 9: export const env = envSchema.parse(process.env);
10: 
11: // Export type
12: export type Env = z.infer<typeof envSchema>;
```

## File: packages/qdrant/src/index.ts
```typescript
1: export * from './client';
2: export * from './env';
3: 
4: // Export types
5: export type { QdrantClient } from '@qdrant/js-client-rest';
```

## File: packages/qdrant/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/qdrant/package.json
```json
 1: {
 2:   "name": "@danky/qdrant",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "main": "./dist/index.js",
 6:   "module": "./dist/index.mjs",
 7:   "types": "./dist/index.d.ts",
 8:   "files": [
 9:     "dist/**"
10:   ],
11:   "scripts": {
12:     "build": "tsup",
13:     "dev": "tsup --watch",
14:     "type-check": "tsc --noEmit",
15:     "lint": "eslint ."
16:   },
17:   "dependencies": {
18:     "@danky/logger": "workspace:*",
19:     "@qdrant/js-client-rest": "^1.12.0"
20:   },
21:   "devDependencies": {
22:     "@danky/eslint-config": "workspace:*",
23:     "@danky/typescript-config": "workspace:*",
24:     "@types/node": "^22.10.5",
25:     "tsup": "^8.3.5",
26:     "typescript": "^5.4.5"
27:   }
28: }
```

## File: packages/qdrant/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/qdrant/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ['@qdrant/js-client-rest', '@danky/logger'],
10: });
```

## File: packages/redis/src/client.ts
```typescript
 1: import IORedis from 'ioredis';
 2: import { env } from './env';
 3: 
 4: const createClient = () => {
 5:   const client = new IORedis(env.REDIS_URL, {
 6:     maxRetriesPerRequest: 3,
 7:     enableReadyCheck: false,
 8:     showFriendlyErrorStack: env.NODE_ENV === 'development',
 9:   });
10: 
11:   client.on('error', error => {
12:     console.error('Redis Client Error:', error);
13:   });
14: 
15:   return client;
16: };
17: 
18: // Create shared Redis client
19: export const redis = createClient();
20: 
21: // PubSub clients need separate connections
22: export const createPubSubClient = () => {
23:   const pub = createClient();
24:   const sub = createClient();
25:   return { pub, sub };
26: };
```

## File: packages/redis/src/env.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: const envSchema = z.object({
 4:   REDIS_URL: z.string().url(),
 5:   NODE_ENV: z.enum(['development', 'test', 'production']).default('development'),
 6: });
 7: 
 8: // Validate and export environment
 9: export const env = envSchema.parse(process.env);
10: 
11: // Export type
12: export type Env = z.infer<typeof envSchema>;
```

## File: packages/redis/src/index.ts
```typescript
1: export * from './client';
2: export * from './env';
3: export type { Redis } from 'ioredis';
```

## File: packages/redis/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/redis/package.json
```json
 1: {
 2:   "name": "@danky/redis",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "dev": "tsup --watch",
15:     "type-check": "tsc --noEmit",
16:     "lint": "eslint .",
17:     "clean": "rimraf dist"
18:   },
19:   "dependencies": {
20:     "ioredis": "^5.4.2",
21:     "zod": "^3.24.1"
22:   },
23:   "devDependencies": {
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^22.10.5",
27:     "tsup": "^8.0.2",
28:     "typescript": "^5.4.5",
29:     "rimraf": "^6.0.1"
30:   }
31: }
```

## File: packages/redis/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/redis/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ['ioredis'],
10: });
```

## File: packages/schema/src/chat-batch.ts
```typescript
  1: import { z } from 'zod';
  2: import { baseResponseSchema } from './types';
  3: import { messageMetadataSchema, messageContentSchema, MODEL_IDS } from './metadata';
  4: import { messageRoleSchema } from './chat';
  5: import { chatSessionSchema } from './chat-session';
  6: 
  7: // Constants
  8: const MAX_BATCH_SIZE = 100;
  9: const MIN_BATCH_SIZE = 1;
 10: 
 11: // Base batch request schema
 12: const baseBatchRequestSchema = z.object({
 13:   ids: z.array(z.string().uuid()).min(MIN_BATCH_SIZE).max(MAX_BATCH_SIZE),
 14: });
 15: 
 16: // Batch delete sessions request
 17: export const batchDeleteSessionsRequestSchema = baseBatchRequestSchema.extend({
 18:   permanent: z.boolean().default(false),
 19: });
 20: 
 21: // Batch delete sessions response
 22: export const batchDeleteSessionsResponseSchema = baseResponseSchema.extend({
 23:   data: z
 24:     .object({
 25:       deletedCount: z.number(),
 26:       deletedIds: z.array(z.string()),
 27:       errors: z
 28:         .array(
 29:           z.object({
 30:             id: z.string(),
 31:             error: z.string(),
 32:           })
 33:         )
 34:         .optional(),
 35:     })
 36:     .optional(),
 37: });
 38: 
 39: // Batch restore sessions request
 40: export const batchRestoreSessionsRequestSchema = baseBatchRequestSchema;
 41: 
 42: // Batch restore sessions response
 43: export const batchRestoreSessionsResponseSchema = baseResponseSchema.extend({
 44:   data: z
 45:     .object({
 46:       restoredCount: z.number(),
 47:       restoredSessions: z.array(chatSessionSchema),
 48:       errors: z
 49:         .array(
 50:           z.object({
 51:             id: z.string(),
 52:             error: z.string(),
 53:           })
 54:         )
 55:         .optional(),
 56:     })
 57:     .optional(),
 58: });
 59: 
 60: // Batch archive sessions request
 61: export const batchArchiveSessionsRequestSchema = baseBatchRequestSchema.extend({
 62:   archive: z.boolean().default(true),
 63: });
 64: 
 65: // Batch archive sessions response
 66: export const batchArchiveSessionsResponseSchema = baseResponseSchema.extend({
 67:   data: z
 68:     .object({
 69:       updatedCount: z.number(),
 70:       updatedIds: z.array(z.string()),
 71:       errors: z
 72:         .array(
 73:           z.object({
 74:             id: z.string(),
 75:             error: z.string(),
 76:           })
 77:         )
 78:         .optional(),
 79:     })
 80:     .optional(),
 81: });
 82: 
 83: // Batch update sessions request
 84: export const batchUpdateSessionsRequestSchema = z.object({
 85:   sessions: z
 86:     .array(
 87:       z.object({
 88:         id: z.string().uuid(),
 89:         name: z.string().min(1).max(255).optional(),
 90:         description: z.string().max(1000).optional(),
 91:         modelId: z.enum(MODEL_IDS).optional(),
 92:         isArchived: z.boolean().optional(),
 93:         metadata: z.record(z.unknown()).optional(),
 94:       })
 95:     )
 96:     .min(MIN_BATCH_SIZE)
 97:     .max(MAX_BATCH_SIZE),
 98: });
 99: 
100: // Batch update sessions response
101: export const batchUpdateSessionsResponseSchema = baseResponseSchema.extend({
102:   data: z
103:     .object({
104:       updatedCount: z.number(),
105:       updatedSessions: z.array(chatSessionSchema),
106:       errors: z
107:         .array(
108:           z.object({
109:             id: z.string(),
110:             error: z.string(),
111:           })
112:         )
113:         .optional(),
114:     })
115:     .optional(),
116: });
117: 
118: // Batch delete messages request
119: export const batchDeleteMessagesRequestSchema = baseBatchRequestSchema.extend({
120:   permanent: z.boolean().default(false),
121: });
122: 
123: // Batch delete messages response
124: export const batchDeleteMessagesResponseSchema = baseResponseSchema.extend({
125:   data: z
126:     .object({
127:       deletedCount: z.number(),
128:       deletedIds: z.array(z.string()),
129:       errors: z
130:         .array(
131:           z.object({
132:             id: z.string(),
133:             error: z.string(),
134:           })
135:         )
136:         .optional(),
137:     })
138:     .optional(),
139: });
140: 
141: // Batch restore messages request
142: export const batchRestoreMessagesRequestSchema = baseBatchRequestSchema;
143: 
144: // Batch restore messages response
145: export const batchRestoreMessagesResponseSchema = baseResponseSchema.extend({
146:   data: z
147:     .object({
148:       restoredCount: z.number(),
149:       restoredIds: z.array(z.string()),
150:       errors: z
151:         .array(
152:           z.object({
153:             id: z.string(),
154:             error: z.string(),
155:           })
156:         )
157:         .optional(),
158:     })
159:     .optional(),
160: });
161: 
162: // Batch create messages request
163: export const batchCreateMessagesRequestSchema = z.object({
164:   sessionId: z.string().uuid(),
165:   messages: z
166:     .array(
167:       z.object({
168:         role: messageRoleSchema,
169:         content: z.array(messageContentSchema).min(1),
170:         metadata: messageMetadataSchema.optional(),
171:       })
172:     )
173:     .min(MIN_BATCH_SIZE)
174:     .max(MAX_BATCH_SIZE),
175: });
176: 
177: // Batch create messages response
178: export const batchCreateMessagesResponseSchema = baseResponseSchema.extend({
179:   data: z
180:     .object({
181:       createdCount: z.number(),
182:       messages: z.array(
183:         z.object({
184:           id: z.string(),
185:           role: messageRoleSchema,
186:           content: z.array(messageContentSchema),
187:           sessionId: z.string(),
188:           metadata: messageMetadataSchema.optional(),
189:           createdAt: z.date(),
190:           updatedAt: z.date(),
191:         })
192:       ),
193:       errors: z
194:         .array(
195:           z.object({
196:             index: z.number(),
197:             error: z.string(),
198:           })
199:         )
200:         .optional(),
201:     })
202:     .optional(),
203: });
204: 
205: // Export types
206: export type BatchDeleteSessionsRequest = z.infer<typeof batchDeleteSessionsRequestSchema>;
207: export type BatchDeleteSessionsResponse = z.infer<typeof batchDeleteSessionsResponseSchema>;
208: export type BatchRestoreSessionsRequest = z.infer<typeof batchRestoreSessionsRequestSchema>;
209: export type BatchRestoreSessionsResponse = z.infer<typeof batchRestoreSessionsResponseSchema>;
210: export type BatchArchiveSessionsRequest = z.infer<typeof batchArchiveSessionsRequestSchema>;
211: export type BatchArchiveSessionsResponse = z.infer<typeof batchArchiveSessionsResponseSchema>;
212: export type BatchUpdateSessionsRequest = z.infer<typeof batchUpdateSessionsRequestSchema>;
213: export type BatchUpdateSessionsResponse = z.infer<typeof batchUpdateSessionsResponseSchema>;
214: export type BatchDeleteMessagesRequest = z.infer<typeof batchDeleteMessagesRequestSchema>;
215: export type BatchDeleteMessagesResponse = z.infer<typeof batchDeleteMessagesResponseSchema>;
216: export type BatchRestoreMessagesRequest = z.infer<typeof batchRestoreMessagesRequestSchema>;
217: export type BatchRestoreMessagesResponse = z.infer<typeof batchRestoreMessagesResponseSchema>;
218: export type BatchCreateMessagesRequest = z.infer<typeof batchCreateMessagesRequestSchema>;
219: export type BatchCreateMessagesResponse = z.infer<typeof batchCreateMessagesResponseSchema>;
```

## File: packages/schema/src/chat-session.ts
```typescript
 1: import { z } from 'zod';
 2: import { baseResponseSchema } from './types';
 3: import { sessionMetadataSchema, MODEL_IDS } from './metadata';
 4: 
 5: // Chat session schema
 6: export const chatSessionSchema = z.object({
 7:   id: z.string().uuid(),
 8:   title: z.string().min(1).max(255),
 9:   description: z.string().max(1000).optional(),
10:   modelId: z.enum(MODEL_IDS),
11:   userId: z.string().uuid(),
12:   isArchived: z.boolean().default(false),
13:   metadata: sessionMetadataSchema.optional(),
14:   createdAt: z.date(),
15:   updatedAt: z.date(),
16:   deletedAt: z.date().nullable(),
17: });
18: 
19: // Create session request
20: export const createSessionRequestSchema = z.object({
21:   title: z.string().min(1).max(255),
22:   description: z.string().max(1000).optional(),
23:   modelId: z.enum(MODEL_IDS),
24:   metadata: sessionMetadataSchema.optional(),
25: });
26: 
27: // Create session response
28: export const createSessionResponseSchema = baseResponseSchema.extend({
29:   data: chatSessionSchema.optional(),
30: });
31: 
32: // List sessions request
33: export const listSessionsRequestSchema = z.object({
34:   page: z.number().int().positive(),
35:   limit: z.number().int().min(1).max(100),
36:   search: z.string().max(255).optional(),
37:   modelId: z.enum(MODEL_IDS).optional(),
38:   isArchived: z.boolean().optional(),
39:   includeDeleted: z.boolean().default(false),
40:   sortBy: z.enum(['createdAt', 'updatedAt', 'title']).default('updatedAt'),
41:   sortOrder: z.enum(['asc', 'desc']).default('desc'),
42: });
43: 
44: // List sessions response
45: export const listSessionsResponseSchema = baseResponseSchema.extend({
46:   data: z
47:     .object({
48:       sessions: z.array(chatSessionSchema),
49:       pagination: z.object({
50:         page: z.number(),
51:         limit: z.number(),
52:         totalPages: z.number(),
53:         totalItems: z.number(),
54:       }),
55:     })
56:     .optional(),
57: });
58: 
59: // Update session request
60: export const updateSessionRequestSchema = z.object({
61:   id: z.string().uuid(),
62:   title: z.string().min(1).max(255).optional(),
63:   description: z.string().max(1000).optional(),
64:   modelId: z.enum(MODEL_IDS).optional(),
65:   isArchived: z.boolean().optional(),
66:   metadata: sessionMetadataSchema.optional(),
67: });
68: 
69: // Update session response
70: export const updateSessionResponseSchema = baseResponseSchema.extend({
71:   data: chatSessionSchema.optional(),
72: });
73: 
74: // Delete session request
75: export const deleteSessionRequestSchema = z.object({
76:   id: z.string().uuid(),
77:   permanent: z.boolean().default(false),
78: });
79: 
80: // Delete session response
81: export const deleteSessionResponseSchema = baseResponseSchema.extend({
82:   data: z
83:     .object({
84:       id: z.string(),
85:       deletedAt: z.date(),
86:     })
87:     .optional(),
88: });
89: 
90: // Restore session request
91: export const restoreSessionRequestSchema = z.object({
92:   id: z.string().uuid(),
93: });
94: 
95: // Restore session response
96: export const restoreSessionResponseSchema = baseResponseSchema.extend({
97:   data: chatSessionSchema.optional(),
98: });
```

## File: packages/schema/src/chat.ts
```typescript
 1: import { z } from 'zod';
 2: import { baseResponseSchema } from './types';
 3: import { messageMetadataSchema, messageContentSchema } from './metadata';
 4: 
 5: // Message role schema
 6: export const messageRoleSchema = z.enum(['user', 'assistant', 'system', 'tool', 'function']);
 7: 
 8: // Chat message schema
 9: export const chatMessageSchema = z.object({
10:   id: z.string().uuid(),
11:   role: messageRoleSchema,
12:   content: z.array(messageContentSchema).min(1),
13:   sessionId: z.string().uuid(),
14:   metadata: messageMetadataSchema.optional(),
15:   createdAt: z.date(),
16:   updatedAt: z.date(),
17:   deletedAt: z.date().nullable(),
18: });
19: 
20: // Create message request
21: export const createMessageRequestSchema = z.object({
22:   sessionId: z.string().uuid(),
23:   role: messageRoleSchema,
24:   content: z.array(messageContentSchema).min(1),
25:   metadata: messageMetadataSchema.optional(),
26: });
27: 
28: // Create message response
29: export const createMessageResponseSchema = baseResponseSchema.extend({
30:   data: chatMessageSchema.optional(),
31: });
32: 
33: // List messages request
34: export const listMessagesRequestSchema = z.object({
35:   sessionId: z.string().uuid(),
36:   page: z.number().int().positive(),
37:   limit: z.number().int().min(1).max(100),
38:   includeDeleted: z.boolean().default(false),
39:   sortOrder: z.enum(['asc', 'desc']).default('asc'),
40: });
41: 
42: // List messages response
43: export const listMessagesResponseSchema = baseResponseSchema.extend({
44:   data: z.object({
45:     messages: z.array(chatMessageSchema),
46:     pagination: z.object({
47:       page: z.number(),
48:       limit: z.number(),
49:       totalPages: z.number(),
50:       totalItems: z.number(),
51:     }),
52:   }).optional(),
53: });
54: 
55: // Delete message request
56: export const deleteMessageRequestSchema = z.object({
57:   id: z.string().uuid(),
58:   permanent: z.boolean().default(false),
59: });
60: 
61: // Delete message response
62: export const deleteMessageResponseSchema = baseResponseSchema.extend({
63:   data: z.object({
64:     id: z.string(),
65:     deletedAt: z.date(),
66:   }).optional(),
67: });
68: 
69: // Restore message request
70: export const restoreMessageRequestSchema = z.object({
71:   id: z.string().uuid(),
72: });
73: 
74: // Restore message response
75: export const restoreMessageResponseSchema = baseResponseSchema.extend({
76:   data: chatMessageSchema.optional(),
77: });
```

## File: packages/schema/src/index.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: // Export base types
 4: export * from './types';
 5: export * from './metadata';
 6: 
 7: // Export vector schemas
 8: export * from './vector';
 9: 
10: // Export message schemas
11: export * from './chat';
12: 
13: // Export session schemas
14: export * from './chat-session';
15: 
16: // Export batch schemas
17: export * from './chat-batch';
18: 
19: // Base schemas
20: export const messageContentSchema = z.object({
21:   type: z.enum(['text', 'code', 'image']),
22:   content: z.string(),
23:   language: z.string().optional(),
24: });
25: 
26: export const messageSchema = z.object({
27:   id: z.string(),
28:   role: z.enum(['user', 'assistant', 'system']),
29:   content: z.array(messageContentSchema),
30:   sessionId: z.string(),
31:   metadata: z.record(z.unknown()).optional(),
32:   createdAt: z.date(),
33:   updatedAt: z.date(),
34: });
35: 
36: export const sessionSchema = z.object({
37:   id: z.string(),
38:   title: z.string(),
39:   modelId: z.string(),
40:   description: z.string().optional(),
41:   metadata: z.record(z.unknown()).optional(),
42:   createdAt: z.date(),
43:   updatedAt: z.date(),
44: });
45: 
46: // Request/Response schemas
47: export const createSessionRequestSchema = z.object({
48:   title: z.string(),
49:   modelId: z.string(),
50:   description: z.string().optional(),
51:   metadata: z.record(z.unknown()).optional(),
52: });
53: 
54: export const createSessionResponseSchema = z.object({
55:   success: z.boolean(),
56:   data: sessionSchema.optional(),
57:   error: z.string().optional(),
58: });
59: 
60: // Export types
61: export type Message = z.infer<typeof messageSchema>;
62: export type Session = z.infer<typeof sessionSchema>;
```

## File: packages/schema/src/metadata.ts
```typescript
  1: import { z } from 'zod';
  2: 
  3: // Model configuration metadata
  4: export const modelConfigSchema = z.object({
  5:   temperature: z.number().min(0).max(2).optional(),
  6:   topP: z.number().min(0).max(1).optional(),
  7:   frequencyPenalty: z.number().min(-2).max(2).optional(),
  8:   presencePenalty: z.number().min(-2).max(2).optional(),
  9:   maxTokens: z.number().positive().max(32000).optional(),
 10:   stop: z.array(z.string()).max(4).optional(),
 11: });
 12: 
 13: // Valid model IDs
 14: export const MODEL_IDS = [
 15:   'gpt-4-turbo-preview',
 16:   'gpt-4',
 17:   'gpt-3.5-turbo',
 18:   'claude-3-opus',
 19:   'claude-3-sonnet',
 20:   'claude-2',
 21:   'gemini-pro',
 22:   'mistral-medium',
 23:   'mixtral-8x7b',
 24: ] as const;
 25: 
 26: // Message metadata
 27: export const messageMetadataSchema = z.object({
 28:   tokens: z.object({
 29:     prompt: z.number().nonnegative(),
 30:     completion: z.number().nonnegative(),
 31:     total: z.number().nonnegative(),
 32:   }).optional(),
 33:   model: z.object({
 34:     id: z.enum(MODEL_IDS),
 35:     provider: z.enum(['openai', 'anthropic', 'google', 'mistral']),
 36:     config: modelConfigSchema.optional(),
 37:   }).optional(),
 38:   timing: z.object({
 39:     startedAt: z.date(),
 40:     completedAt: z.date(),
 41:     latencyMs: z.number().nonnegative(),
 42:   }).optional(),
 43:   error: z.object({
 44:     code: z.string(),
 45:     message: z.string(),
 46:     type: z.enum(['rate_limit', 'token_limit', 'context_length', 'invalid_request', 'server_error']),
 47:   }).optional(),
 48:   tools: z.array(z.object({
 49:     name: z.string(),
 50:     args: z.record(z.unknown()),
 51:     result: z.unknown(),
 52:     error: z.string().optional(),
 53:   })).optional(),
 54: });
 55: 
 56: // Session metadata
 57: export const sessionMetadataSchema = z.object({
 58:   model: z.object({
 59:     id: z.enum(MODEL_IDS),
 60:     provider: z.enum(['openai', 'anthropic', 'google', 'mistral']),
 61:     config: modelConfigSchema,
 62:   }),
 63:   purpose: z.enum(['chat', 'completion', 'analysis', 'coding', 'other']),
 64:   tags: z.array(z.string()).max(10).optional(),
 65:   language: z.string().optional(), // For coding sessions
 66:   framework: z.string().optional(), // For coding sessions
 67:   context: z.object({
 68:     systemPrompt: z.string().optional(),
 69:     documents: z.array(z.object({
 70:       id: z.string(),
 71:       type: z.enum(['file', 'url', 'text']),
 72:       name: z.string(),
 73:       summary: z.string().optional(),
 74:     })).optional(),
 75:   }).optional(),
 76:   stats: z.object({
 77:     messageCount: z.number().nonnegative(),
 78:     totalTokens: z.number().nonnegative(),
 79:     averageLatencyMs: z.number().nonnegative(),
 80:     lastActive: z.date(),
 81:   }).optional(),
 82: });
 83: 
 84: // Content validation
 85: export const textContentSchema = z.object({
 86:   type: z.literal('text'),
 87:   content: z.string().max(32000), // OpenAI's max token limit
 88: });
 89: 
 90: export const codeContentSchema = z.object({
 91:   type: z.literal('code'),
 92:   content: z.string().max(32000),
 93:   language: z.string(),
 94:   fileName: z.string().optional(),
 95:   lineNumbers: z.boolean().optional(),
 96: });
 97: 
 98: export const imageContentSchema = z.object({
 99:   type: z.literal('image'),
100:   content: z.string().url(),
101:   mimeType: z.enum(['image/png', 'image/jpeg', 'image/gif', 'image/webp']),
102:   width: z.number().positive().optional(),
103:   height: z.number().positive().optional(),
104:   altText: z.string().optional(),
105: });
106: 
107: export const fileContentSchema = z.object({
108:   type: z.literal('file'),
109:   content: z.string().url(),
110:   mimeType: z.string(),
111:   fileName: z.string(),
112:   fileSize: z.number().positive(),
113:   checksum: z.string().optional(),
114: });
115: 
116: // Combined content schema
117: export const messageContentSchema = z.discriminatedUnion('type', [
118:   textContentSchema,
119:   codeContentSchema,
120:   imageContentSchema,
121:   fileContentSchema,
122: ]);
```

## File: packages/schema/src/test-eslint.ts
```typescript
1: // Test file to verify ESLint rules
2: export function testFunction(): boolean {
3:   return true;
4: }
```

## File: packages/schema/src/types.ts
```typescript
 1: import { z } from 'zod';
 2: 
 3: // Base response schema for API endpoints
 4: export const baseResponseSchema = z.object({
 5:   success: z.boolean(),
 6:   message: z.string().optional(),
 7:   error: z.string().optional(),
 8: });
 9: 
10: // Base pagination schema
11: export const paginationSchema = z.object({
12:   page: z.number().int().positive(),
13:   limit: z.number().int().positive().max(100),
14:   totalPages: z.number().int().positive().optional(),
15:   totalItems: z.number().int().nonnegative().optional(),
16: });
17: 
18: // Base timestamp fields
19: export const timestampFields = {
20:   createdAt: z.date(),
21:   updatedAt: z.date(),
22: };
23: 
24: // Base ID field
25: export const idField = {
26:   id: z.string().uuid(),
27: };
28: 
29: // Base soft delete field
30: export const softDeleteField = {
31:   deletedAt: z.date().nullable(),
32: };
```

## File: packages/schema/src/vector.ts
```typescript
 1: import { z } from 'zod';
 2: import { idField, timestampFields } from './types';
 3: 
 4: // Base vector schema
 5: export const vectorSchema = z.object({
 6:   ...idField,
 7:   contentId: z.string().uuid(),
 8:   contentType: z.string().min(1),
 9:   embedding: z.array(z.number()), // We convert to/from pgvector at the DB layer
10:   metadata: z.record(z.unknown()).optional(),
11:   ...timestampFields,
12: });
13: 
14: // Request schemas
15: export const createVectorRequestSchema = z.object({
16:   contentId: z.string().uuid(),
17:   contentType: z.string().min(1),
18:   embedding: z.array(z.number()),
19:   metadata: z.record(z.unknown()).optional(),
20: });
21: 
22: export const searchVectorRequestSchema = z.object({
23:   embedding: z.array(z.number()),
24:   contentType: z.string().min(1).optional(),
25:   limit: z.number().int().positive().max(100).default(10),
26:   threshold: z.number().min(0).max(1).default(0.8),
27: });
28: 
29: // Response schemas
30: export const vectorResponseSchema = z.object({
31:   success: z.boolean(),
32:   data: vectorSchema.optional(),
33:   error: z.string().optional(),
34: });
35: 
36: export const searchVectorResponseSchema = z.object({
37:   success: z.boolean(),
38:   results: z
39:     .array(
40:       z.object({
41:         vector: vectorSchema,
42:         similarity: z.number(),
43:       })
44:     )
45:     .optional(),
46:   error: z.string().optional(),
47: });
48: 
49: // Export types
50: export type Vector = z.infer<typeof vectorSchema>;
51: export type CreateVectorRequest = z.infer<typeof createVectorRequestSchema>;
52: export type SearchVectorRequest = z.infer<typeof searchVectorRequestSchema>;
53: export type VectorResponse = z.infer<typeof vectorResponseSchema>;
54: export type SearchVectorResponse = z.infer<typeof searchVectorResponseSchema>;
```

## File: packages/schema/eslint.config.js
```javascript
1: import { baseConfig } from '@danky/eslint-config';
2: 
3: export default baseConfig;
```

## File: packages/schema/package.json
```json
 1: {
 2:   "name": "@danky/schema",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.mjs",
 8:   "types": "./dist/index.d.ts",
 9:   "exports": {
10:     ".": {
11:       "types": "./dist/index.d.ts",
12:       "import": "./dist/index.js",
13:       "require": "./dist/index.cjs"
14:     }
15:   },
16:   "scripts": {
17:     "build": "tsup",
18:     "dev": "tsup --watch",
19:     "lint": "eslint .",
20:     "type-check": "tsc --noEmit",
21:     "clean": "rimraf .turbo node_modules dist"
22:   },
23:   "dependencies": {
24:     "@h1deya/langchain-mcp-tools": "^0.1.4",
25:     "langchain": "0.3.11",
26:     "zod": "^3.24.1"
27:   },
28:   "devDependencies": {
29:     "@danky/eslint-config": "workspace:*",
30:     "@danky/typescript-config": "workspace:*",
31:     "eslint": "^9.18.0",
32:     "rimraf": "^6.0.1",
33:     "tsup": "^8.3.5",
34:     "typescript": "^5.4.5"
35:   }
36: }
```

## File: packages/schema/README.md
```markdown
  1: # @danky/schema
  2: 
  3: Shared type definitions and validation schemas for the Danky AI Chatbot platform, built with Zod.
  4: 
  5: ## Overview
  6: 
  7: The schema package provides centralized type definitions, validation schemas, and utilities for ensuring type safety and data validation across the platform. It uses Zod for runtime type checking and validation.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13: ├── ai/              # AI-related schemas
 14: ├── chat/            # Chat-related schemas
 15: ├── db/              # Database schemas
 16: ├── api/             # API schemas
 17: ├── config/          # Configuration schemas
 18: └── types/           # Shared TypeScript types
 19: ```
 20: 
 21: ## Key Features
 22: 
 23: - **Type Safety**: Full TypeScript coverage
 24: - **Runtime Validation**: Zod schemas
 25: - **Error Messages**: Customizable validation errors
 26: - **Composability**: Reusable schema components
 27: - **Documentation**: Type and schema docs
 28: - **Testing**: Validation test utilities
 29: 
 30: ## Usage
 31: 
 32: ### Basic Validation
 33: 
 34: ```typescript
 35: import { userSchema } from '@danky/schema'
 36: 
 37: // Validate data
 38: const result = userSchema.safeParse(data)
 39: if (!result.success) {
 40:   console.error(result.error.format())
 41:   return
 42: }
 43: 
 44: // Use validated data
 45: const user = result.data
 46: ```
 47: 
 48: ### Type Usage
 49: 
 50: ```typescript
 51: import type { User, Message } from '@danky/schema'
 52: 
 53: function processUser(user: User) {
 54:   // TypeScript knows the shape of User
 55: }
 56: 
 57: function processMessage(message: Message) {
 58:   // TypeScript knows the shape of Message
 59: }
 60: ```
 61: 
 62: ## AI Development Notes
 63: 
 64: ### Key Concepts
 65: 
 66: 1. **Schema Organization**
 67:    - Domain-specific schemas
 68:    - Shared base schemas
 69:    - Type exports
 70:    - Error messages
 71: 
 72: 2. **Validation Patterns**
 73:    - Input validation
 74:    - API responses
 75:    - Database records
 76:    - Configuration
 77: 
 78: 3. **Type System**
 79:    - Branded types
 80:    - Union types
 81:    - Utility types
 82:    - Type inference
 83: 
 84: ### Common Patterns
 85: 
 86: #### Schema Definition
 87: ```typescript
 88: import { z } from 'zod'
 89: 
 90: export const userSchema = z.object({
 91:   id: z.string().uuid(),
 92:   name: z.string().min(1),
 93:   email: z.string().email(),
 94:   role: z.enum(['user', 'admin']),
 95:   metadata: z.record(z.unknown()).optional(),
 96: })
 97: 
 98: export type User = z.infer<typeof userSchema>
 99: ```
100: 
101: #### Branded Types
102: ```typescript
103: import { z } from 'zod'
104: 
105: export const UserId = z.string().uuid().brand('UserId')
106: export type UserId = z.infer<typeof UserId>
107: 
108: export const MessageId = z.string().uuid().brand('MessageId')
109: export type MessageId = z.infer<typeof MessageId>
110: ```
111: 
112: #### API Schemas
113: ```typescript
114: import { z } from 'zod'
115: 
116: export const createUserRequest = z.object({
117:   name: z.string().min(1),
118:   email: z.string().email(),
119: })
120: 
121: export const createUserResponse = z.object({
122:   user: userSchema,
123:   token: z.string(),
124: })
125: 
126: export type CreateUserRequest = z.infer<typeof createUserRequest>
127: export type CreateUserResponse = z.infer<typeof createUserResponse>
128: ```
129: 
130: ## Schema Library
131: 
132: ### Core Schemas
133: - User
134: - Message
135: - Session
136: - Tool
137: - Config
138: - Error
139: 
140: ### Domain Schemas
141: - Chat
142: - MCP
143: - Database
144: - API
145: - Events
146: 
147: ## Development
148: 
149: ### Adding New Schemas
150: 
151: 1. Create schema file:
152: ```typescript
153: // src/chat/message.ts
154: import { z } from 'zod'
155: 
156: export const messageSchema = z.object({
157:   id: z.string().uuid(),
158:   content: z.string(),
159:   timestamp: z.date(),
160: })
161: 
162: export type Message = z.infer<typeof messageSchema>
163: ```
164: 
165: 2. Export from index:
166: ```typescript
167: // src/index.ts
168: export * from './chat/message'
169: ```
170: 
171: ### Testing
172: ```bash
173: pnpm test
174: pnpm test:watch
175: ```
176: 
177: ### Linting
178: ```bash
179: pnpm lint
180: pnpm type-check
181: ```
182: 
183: ## Validation Utilities
184: 
185: ### Type Guards
186: ```typescript
187: import { isUser, isMessage } from '@danky/schema'
188: 
189: if (isUser(data)) {
190:   // data is typed as User
191: }
192: 
193: if (isMessage(data)) {
194:   // data is typed as Message
195: }
196: ```
197: 
198: ### Error Formatting
199: ```typescript
200: import { formatZodError } from '@danky/schema'
201: 
202: try {
203:   schema.parse(data)
204: } catch (error) {
205:   const formatted = formatZodError(error)
206:   console.error(formatted)
207: }
208: ```
209: 
210: ## Troubleshooting
211: 
212: ### Common Issues
213: 1. **Type Errors**: Check schema definitions
214: 2. **Validation Errors**: Check input data
215: 3. **Circular Dependencies**: Check imports
216: 4. **Performance**: Check schema complexity
217: 
218: ### Debug Tools
219: - Type checkers
220: - Schema validators
221: - Error formatters
222: - Test utilities
223: 
224: ## Additional Resources
225: 
226: - [Type System Guide](../../docs/TYPES.md)
227: - [Validation Guide](../../docs/VALIDATION.md)
228: - [Schema Best Practices](../../docs/SCHEMAS.md)
229: - [Error Handling Guide](../../docs/ERRORS.md)
```

## File: packages/schema/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "paths": {
 8:       "@/*": ["./src/*"]
 9:     }
10:   },
11:   "include": ["src/**/*.ts"],
12:   "exclude": ["node_modules", "dist"]
13: }
```

## File: packages/schema/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm', 'cjs'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: ['zod'],
10:   treeshake: true,
11: });
```

## File: packages/tailwind-config/src/applications.ts
```typescript
 1: import type { Config } from 'tailwindcss';
 2: import { baseConfig, type BaseOptions } from './base';
 3: 
 4: export interface ApplicationsOptions extends BaseOptions {
 5:   content?: string[];
 6: }
 7: 
 8: export const applicationsConfig = ({
 9:   content = [
10:     './src/**/*.{js,ts,jsx,tsx}',
11:     './app/**/*.{js,ts,jsx,tsx}',
12:     './components/**/*.{js,ts,jsx,tsx}',
13:   ],
14:   ...rest
15: }: ApplicationsOptions = {}): Config => {
16:   return baseConfig({
17:     content,
18:     plugins: [require('tailwindcss-animate'), ...((rest.plugins as any[]) || [])],
19:     ...rest,
20:   });
21: };
```

## File: packages/tailwind-config/src/base.ts
```typescript
 1: import type { Config } from 'tailwindcss';
 2: 
 3: export interface BaseOptions {
 4:   content?: string[];
 5:   darkMode?: 'class' | 'media';
 6:   plugins?: any[];
 7: }
 8: 
 9: export const baseConfig = ({
10:   content = [],
11:   darkMode = 'class',
12:   plugins = [],
13: }: BaseOptions = {}): Config => ({
14:   darkMode,
15:   content,
16:   theme: {
17:     container: {
18:       center: true,
19:       padding: '2rem',
20:       screens: {
21:         '2xl': '1400px',
22:       },
23:     },
24:     extend: {
25:       colors: {
26:         border: 'hsl(var(--border))',
27:         input: 'hsl(var(--input))',
28:         ring: 'hsl(var(--ring))',
29:         background: 'hsl(var(--background))',
30:         foreground: 'hsl(var(--foreground))',
31:         primary: {
32:           DEFAULT: 'hsl(var(--primary))',
33:           foreground: 'hsl(var(--primary-foreground))',
34:         },
35:         secondary: {
36:           DEFAULT: 'hsl(var(--secondary))',
37:           foreground: 'hsl(var(--secondary-foreground))',
38:         },
39:         destructive: {
40:           DEFAULT: 'hsl(var(--destructive))',
41:           foreground: 'hsl(var(--destructive-foreground))',
42:         },
43:         muted: {
44:           DEFAULT: 'hsl(var(--muted))',
45:           foreground: 'hsl(var(--muted-foreground))',
46:         },
47:         accent: {
48:           DEFAULT: 'hsl(var(--accent))',
49:           foreground: 'hsl(var(--accent-foreground))',
50:         },
51:         popover: {
52:           DEFAULT: 'hsl(var(--popover))',
53:           foreground: 'hsl(var(--popover-foreground))',
54:         },
55:         card: {
56:           DEFAULT: 'hsl(var(--card))',
57:           foreground: 'hsl(var(--card-foreground))',
58:         },
59:       },
60:       borderRadius: {
61:         lg: 'var(--radius)',
62:         md: 'calc(var(--radius) - 2px)',
63:         sm: 'calc(var(--radius) - 4px)',
64:       },
65:       keyframes: {
66:         'accordion-down': {
67:           from: { height: '0' },
68:           to: { height: 'var(--radix-accordion-content-height)' },
69:         },
70:         'accordion-up': {
71:           from: { height: 'var(--radix-accordion-content-height)' },
72:           to: { height: '0' },
73:         },
74:       },
75:       animation: {
76:         'accordion-down': 'accordion-down 0.2s ease-out',
77:         'accordion-up': 'accordion-up 0.2s ease-out',
78:       },
79:     },
80:   },
81:   plugins: [...plugins],
82: });
```

## File: packages/tailwind-config/src/components.ts
```typescript
 1: import type { Config } from 'tailwindcss';
 2: import { baseConfig, type BaseOptions } from './base';
 3: 
 4: export interface ComponentsOptions extends BaseOptions {
 5:   content?: string[];
 6: }
 7: 
 8: export const componentsConfig = ({
 9:   content = ['./src/**/*.{ts,tsx}'],
10:   ...rest
11: }: ComponentsOptions = {}): Config => {
12:   return baseConfig({
13:     content,
14:     plugins: [require('tailwindcss-animate'), ...((rest.plugins as any[]) || [])],
15:     ...rest,
16:   });
17: };
```

## File: packages/tailwind-config/src/index.ts
```typescript
1: export { baseConfig, type BaseOptions } from './base';
2: export { componentsConfig, type ComponentsOptions } from './components';
3: export { applicationsConfig, type ApplicationsOptions } from './applications';
```

## File: packages/tailwind-config/package.json
```json
 1: {
 2:   "name": "@danky/tailwind-config",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.js",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "clean": "rimraf .turbo node_modules dist",
15:     "dev": "tsup --watch",
16:     "lint": "eslint .",
17:     "type-check": "tsc --noEmit"
18:   },
19:   "dependencies": {
20:     "tailwindcss": "^3.4.1",
21:     "tailwindcss-animate": "^1.0.7"
22:   },
23:   "devDependencies": {
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^20.11.24",
27:     "eslint": "^8.57.0",
28:     "rimraf": "^5.0.5",
29:     "tsup": "^8.0.2",
30:     "typescript": "^5.3.3"
31:   }
32: }
```

## File: packages/tailwind-config/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/base.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": "."
 7:   },
 8:   "include": ["src/**/*.ts"],
 9:   "exclude": ["node_modules", "dist"]
10: }
```

## File: packages/typescript-config/base.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "Default",
 4:   "compilerOptions": {
 5:     "composite": false,
 6:     "declaration": true,
 7:     "declarationMap": true,
 8:     "esModuleInterop": true,
 9:     "forceConsistentCasingInFileNames": true,
10:     "inlineSources": false,
11:     "isolatedModules": true,
12:     "moduleResolution": "bundler",
13:     "noUnusedLocals": false,
14:     "noUnusedParameters": false,
15:     "preserveWatchOutput": true,
16:     "skipLibCheck": true,
17:     "strict": true,
18:     "strictNullChecks": true,
19:     "noImplicitAny": true,
20:     "noImplicitThis": true,
21:     "noImplicitReturns": true,
22:     "noFallthroughCasesInSwitch": true,
23:     "allowJs": true,
24:     "module": "ESNext",
25:     "target": "ES2022",
26:     "lib": ["ES2022"],
27:     "verbatimModuleSyntax": true,
28:     "moduleDetection": "force",
29:     "sourceMap": true,
30:     "types": ["node"],
31:     "noEmit": true
32:   },
33:   "exclude": ["node_modules", "dist"]
34: }
```

## File: packages/typescript-config/nextjs.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "Next.js",
 4:   "extends": "./base.json",
 5:   "compilerOptions": {
 6:     "allowJs": true,
 7:     "declaration": false,
 8:     "declarationMap": false,
 9:     "incremental": true,
10:     "jsx": "preserve",
11:     "lib": ["dom", "dom.iterable", "esnext"],
12:     "noEmit": true,
13:     "plugins": [{ "name": "next" }],
14:     "resolveJsonModule": true,
15:     "types": ["node", "react", "react-dom"],
16:     "paths": {
17:       "@/*": ["./src/*"]
18:     }
19:   },
20:   "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
21:   "exclude": ["node_modules", ".next", "dist"]
22: }
```

## File: packages/typescript-config/package.json
```json
 1: {
 2:   "name": "@danky/typescript-config",
 3:   "version": "0.0.1",
 4:   "private": true,
 5:   "files": [
 6:     "base.json",
 7:     "react-library.json",
 8:     "nextjs.json"
 9:   ],
10:   "exports": {
11:     "./base.json": "./base.json",
12:     "./react-library.json": "./react-library.json",
13:     "./nextjs.json": "./nextjs.json"
14:   }
15: }
```

## File: packages/typescript-config/react-library.json
```json
 1: {
 2:   "$schema": "https://json.schemastore.org/tsconfig",
 3:   "display": "React Library",
 4:   "extends": "./base.json",
 5:   "compilerOptions": {
 6:     "jsx": "react-jsx",
 7:     "jsxImportSource": "react",
 8:     "lib": ["dom", "dom.iterable", "esnext"],
 9:     "noEmit": true,
10:     "types": ["node", "react", "react-dom"],
11:     "paths": {
12:       "@/*": ["./src/*"]
13:     }
14:   },
15:   "include": ["src", "*.ts", "*.tsx"],
16:   "exclude": ["node_modules", "dist"]
17: }
```

## File: packages/ui/@danky/ui/components/accordion.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AccordionPrimitive from "@radix-ui/react-accordion"
 5: import { ChevronDown } from "lucide-react"
 6: 
 7: import { cn } from "@danky/lib/utils"
 8: 
 9: const Accordion = AccordionPrimitive.Root
10: 
11: const AccordionItem = React.forwardRef<
12:   React.ElementRef<typeof AccordionPrimitive.Item>,
13:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
14: >(({ className, ...props }, ref) => (
15:   <AccordionPrimitive.Item
16:     ref={ref}
17:     className={cn("border-b", className)}
18:     {...props}
19:   />
20: ))
21: AccordionItem.displayName = "AccordionItem"
22: 
23: const AccordionTrigger = React.forwardRef<
24:   React.ElementRef<typeof AccordionPrimitive.Trigger>,
25:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
26: >(({ className, children, ...props }, ref) => (
27:   <AccordionPrimitive.Header className="flex">
28:     <AccordionPrimitive.Trigger
29:       ref={ref}
30:       className={cn(
31:         "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
32:         className
33:       )}
34:       {...props}
35:     >
36:       {children}
37:       <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
38:     </AccordionPrimitive.Trigger>
39:   </AccordionPrimitive.Header>
40: ))
41: AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName
42: 
43: const AccordionContent = React.forwardRef<
44:   React.ElementRef<typeof AccordionPrimitive.Content>,
45:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
46: >(({ className, children, ...props }, ref) => (
47:   <AccordionPrimitive.Content
48:     ref={ref}
49:     className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
50:     {...props}
51:   >
52:     <div className={cn("pb-4 pt-0", className)}>{children}</div>
53:   </AccordionPrimitive.Content>
54: ))
55: 
56: AccordionContent.displayName = AccordionPrimitive.Content.displayName
57: 
58: export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
```

## File: packages/ui/@danky/ui/components/alert-dialog.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"
  5: 
  6: import { cn } from "@danky/lib/utils"
  7: import { buttonVariants } from "@danky/ui/components/button"
  8: 
  9: const AlertDialog = AlertDialogPrimitive.Root
 10: 
 11: const AlertDialogTrigger = AlertDialogPrimitive.Trigger
 12: 
 13: const AlertDialogPortal = AlertDialogPrimitive.Portal
 14: 
 15: const AlertDialogOverlay = React.forwardRef<
 16:   React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
 17:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
 18: >(({ className, ...props }, ref) => (
 19:   <AlertDialogPrimitive.Overlay
 20:     className={cn(
 21:       "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
 22:       className
 23:     )}
 24:     {...props}
 25:     ref={ref}
 26:   />
 27: ))
 28: AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName
 29: 
 30: const AlertDialogContent = React.forwardRef<
 31:   React.ElementRef<typeof AlertDialogPrimitive.Content>,
 32:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
 33: >(({ className, ...props }, ref) => (
 34:   <AlertDialogPortal>
 35:     <AlertDialogOverlay />
 36:     <AlertDialogPrimitive.Content
 37:       ref={ref}
 38:       className={cn(
 39:         "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
 40:         className
 41:       )}
 42:       {...props}
 43:     />
 44:   </AlertDialogPortal>
 45: ))
 46: AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName
 47: 
 48: const AlertDialogHeader = ({
 49:   className,
 50:   ...props
 51: }: React.HTMLAttributes<HTMLDivElement>) => (
 52:   <div
 53:     className={cn(
 54:       "flex flex-col space-y-2 text-center sm:text-left",
 55:       className
 56:     )}
 57:     {...props}
 58:   />
 59: )
 60: AlertDialogHeader.displayName = "AlertDialogHeader"
 61: 
 62: const AlertDialogFooter = ({
 63:   className,
 64:   ...props
 65: }: React.HTMLAttributes<HTMLDivElement>) => (
 66:   <div
 67:     className={cn(
 68:       "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
 69:       className
 70:     )}
 71:     {...props}
 72:   />
 73: )
 74: AlertDialogFooter.displayName = "AlertDialogFooter"
 75: 
 76: const AlertDialogTitle = React.forwardRef<
 77:   React.ElementRef<typeof AlertDialogPrimitive.Title>,
 78:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
 79: >(({ className, ...props }, ref) => (
 80:   <AlertDialogPrimitive.Title
 81:     ref={ref}
 82:     className={cn("text-lg font-semibold", className)}
 83:     {...props}
 84:   />
 85: ))
 86: AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName
 87: 
 88: const AlertDialogDescription = React.forwardRef<
 89:   React.ElementRef<typeof AlertDialogPrimitive.Description>,
 90:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
 91: >(({ className, ...props }, ref) => (
 92:   <AlertDialogPrimitive.Description
 93:     ref={ref}
 94:     className={cn("text-sm text-muted-foreground", className)}
 95:     {...props}
 96:   />
 97: ))
 98: AlertDialogDescription.displayName =
 99:   AlertDialogPrimitive.Description.displayName
100: 
101: const AlertDialogAction = React.forwardRef<
102:   React.ElementRef<typeof AlertDialogPrimitive.Action>,
103:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
104: >(({ className, ...props }, ref) => (
105:   <AlertDialogPrimitive.Action
106:     ref={ref}
107:     className={cn(buttonVariants(), className)}
108:     {...props}
109:   />
110: ))
111: AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName
112: 
113: const AlertDialogCancel = React.forwardRef<
114:   React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
115:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
116: >(({ className, ...props }, ref) => (
117:   <AlertDialogPrimitive.Cancel
118:     ref={ref}
119:     className={cn(
120:       buttonVariants({ variant: "outline" }),
121:       "mt-2 sm:mt-0",
122:       className
123:     )}
124:     {...props}
125:   />
126: ))
127: AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName
128: 
129: export {
130:   AlertDialog,
131:   AlertDialogPortal,
132:   AlertDialogOverlay,
133:   AlertDialogTrigger,
134:   AlertDialogContent,
135:   AlertDialogHeader,
136:   AlertDialogFooter,
137:   AlertDialogTitle,
138:   AlertDialogDescription,
139:   AlertDialogAction,
140:   AlertDialogCancel,
141: }
```

## File: packages/ui/@danky/ui/components/alert.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@danky/lib/utils"
 5: 
 6: const alertVariants = cva(
 7:   "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
 8:   {
 9:     variants: {
10:       variant: {
11:         default: "bg-background text-foreground",
12:         destructive:
13:           "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
14:       },
15:     },
16:     defaultVariants: {
17:       variant: "default",
18:     },
19:   }
20: )
21: 
22: const Alert = React.forwardRef<
23:   HTMLDivElement,
24:   React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
25: >(({ className, variant, ...props }, ref) => (
26:   <div
27:     ref={ref}
28:     role="alert"
29:     className={cn(alertVariants({ variant }), className)}
30:     {...props}
31:   />
32: ))
33: Alert.displayName = "Alert"
34: 
35: const AlertTitle = React.forwardRef<
36:   HTMLParagraphElement,
37:   React.HTMLAttributes<HTMLHeadingElement>
38: >(({ className, ...props }, ref) => (
39:   <h5
40:     ref={ref}
41:     className={cn("mb-1 font-medium leading-none tracking-tight", className)}
42:     {...props}
43:   />
44: ))
45: AlertTitle.displayName = "AlertTitle"
46: 
47: const AlertDescription = React.forwardRef<
48:   HTMLParagraphElement,
49:   React.HTMLAttributes<HTMLParagraphElement>
50: >(({ className, ...props }, ref) => (
51:   <div
52:     ref={ref}
53:     className={cn("text-sm [&_p]:leading-relaxed", className)}
54:     {...props}
55:   />
56: ))
57: AlertDescription.displayName = "AlertDescription"
58: 
59: export { Alert, AlertTitle, AlertDescription }
```

## File: packages/ui/@danky/ui/components/aspect-ratio.tsx
```typescript
1: "use client"
2: 
3: import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"
4: 
5: const AspectRatio = AspectRatioPrimitive.Root
6: 
7: export { AspectRatio }
```

## File: packages/ui/@danky/ui/components/avatar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AvatarPrimitive from "@radix-ui/react-avatar"
 5: 
 6: import { cn } from "@danky/lib/utils"
 7: 
 8: const Avatar = React.forwardRef<
 9:   React.ElementRef<typeof AvatarPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
11: >(({ className, ...props }, ref) => (
12:   <AvatarPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
16:       className
17:     )}
18:     {...props}
19:   />
20: ))
21: Avatar.displayName = AvatarPrimitive.Root.displayName
22: 
23: const AvatarImage = React.forwardRef<
24:   React.ElementRef<typeof AvatarPrimitive.Image>,
25:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
26: >(({ className, ...props }, ref) => (
27:   <AvatarPrimitive.Image
28:     ref={ref}
29:     className={cn("aspect-square h-full w-full", className)}
30:     {...props}
31:   />
32: ))
33: AvatarImage.displayName = AvatarPrimitive.Image.displayName
34: 
35: const AvatarFallback = React.forwardRef<
36:   React.ElementRef<typeof AvatarPrimitive.Fallback>,
37:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
38: >(({ className, ...props }, ref) => (
39:   <AvatarPrimitive.Fallback
40:     ref={ref}
41:     className={cn(
42:       "flex h-full w-full items-center justify-center rounded-full bg-muted",
43:       className
44:     )}
45:     {...props}
46:   />
47: ))
48: AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName
49: 
50: export { Avatar, AvatarImage, AvatarFallback }
```

## File: packages/ui/@danky/ui/components/badge.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@danky/lib/utils"
 5: 
 6: const badgeVariants = cva(
 7:   "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
 8:   {
 9:     variants: {
10:       variant: {
11:         default:
12:           "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
13:         secondary:
14:           "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
15:         destructive:
16:           "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
17:         outline: "text-foreground",
18:       },
19:     },
20:     defaultVariants: {
21:       variant: "default",
22:     },
23:   }
24: )
25: 
26: export interface BadgeProps
27:   extends React.HTMLAttributes<HTMLDivElement>,
28:     VariantProps<typeof badgeVariants> {}
29: 
30: function Badge({ className, variant, ...props }: BadgeProps) {
31:   return (
32:     <div className={cn(badgeVariants({ variant }), className)} {...props} />
33:   )
34: }
35: 
36: export { Badge, badgeVariants }
```

## File: packages/ui/@danky/ui/components/button.tsx
```typescript
 1: import * as React from "react"
 2: import { Slot } from "@radix-ui/react-slot"
 3: import { cva, type VariantProps } from "class-variance-authority"
 4: 
 5: import { cn } from "@danky/lib/utils"
 6: 
 7: const buttonVariants = cva(
 8:   "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
 9:   {
10:     variants: {
11:       variant: {
12:         default: "bg-primary text-primary-foreground hover:bg-primary/90",
13:         destructive:
14:           "bg-destructive text-destructive-foreground hover:bg-destructive/90",
15:         outline:
16:           "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
17:         secondary:
18:           "bg-secondary text-secondary-foreground hover:bg-secondary/80",
19:         ghost: "hover:bg-accent hover:text-accent-foreground",
20:         link: "text-primary underline-offset-4 hover:underline",
21:       },
22:       size: {
23:         default: "h-10 px-4 py-2",
24:         sm: "h-9 rounded-md px-3",
25:         lg: "h-11 rounded-md px-8",
26:         icon: "h-10 w-10",
27:       },
28:     },
29:     defaultVariants: {
30:       variant: "default",
31:       size: "default",
32:     },
33:   }
34: )
35: 
36: export interface ButtonProps
37:   extends React.ButtonHTMLAttributes<HTMLButtonElement>,
38:     VariantProps<typeof buttonVariants> {
39:   asChild?: boolean
40: }
41: 
42: const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
43:   ({ className, variant, size, asChild = false, ...props }, ref) => {
44:     const Comp = asChild ? Slot : "button"
45:     return (
46:       <Comp
47:         className={cn(buttonVariants({ variant, size, className }))}
48:         ref={ref}
49:         {...props}
50:       />
51:     )
52:   }
53: )
54: Button.displayName = "Button"
55: 
56: export { Button, buttonVariants }
```

## File: packages/ui/@danky/ui/components/calendar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { ChevronLeft, ChevronRight } from "lucide-react"
 5: import { DayPicker } from "react-day-picker"
 6: 
 7: import { cn } from "@danky/lib/utils"
 8: import { buttonVariants } from "@danky/ui/components/button"
 9: 
10: export type CalendarProps = React.ComponentProps<typeof DayPicker>
11: 
12: function Calendar({
13:   className,
14:   classNames,
15:   showOutsideDays = true,
16:   ...props
17: }: CalendarProps) {
18:   return (
19:     <DayPicker
20:       showOutsideDays={showOutsideDays}
21:       className={cn("p-3", className)}
22:       classNames={{
23:         months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
24:         month: "space-y-4",
25:         caption: "flex justify-center pt-1 relative items-center",
26:         caption_label: "text-sm font-medium",
27:         nav: "space-x-1 flex items-center",
28:         nav_button: cn(
29:           buttonVariants({ variant: "outline" }),
30:           "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
31:         ),
32:         nav_button_previous: "absolute left-1",
33:         nav_button_next: "absolute right-1",
34:         table: "w-full border-collapse space-y-1",
35:         head_row: "flex",
36:         head_cell:
37:           "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
38:         row: "flex w-full mt-2",
39:         cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
40:         day: cn(
41:           buttonVariants({ variant: "ghost" }),
42:           "h-9 w-9 p-0 font-normal aria-selected:opacity-100"
43:         ),
44:         day_range_end: "day-range-end",
45:         day_selected:
46:           "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
47:         day_today: "bg-accent text-accent-foreground",
48:         day_outside:
49:           "day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",
50:         day_disabled: "text-muted-foreground opacity-50",
51:         day_range_middle:
52:           "aria-selected:bg-accent aria-selected:text-accent-foreground",
53:         day_hidden: "invisible",
54:         ...classNames,
55:       }}
56:       components={{
57:         IconLeft: ({ className, ...props }) => (
58:           <ChevronLeft className={cn("h-4 w-4", className)} {...props} />
59:         ),
60:         IconRight: ({ className, ...props }) => (
61:           <ChevronRight className={cn("h-4 w-4", className)} {...props} />
62:         ),
63:       }}
64:       {...props}
65:     />
66:   )
67: }
68: Calendar.displayName = "Calendar"
69: 
70: export { Calendar }
```

## File: packages/ui/src/components/ui/accordion.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AccordionPrimitive from "@radix-ui/react-accordion"
 5: import { ChevronDown } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const Accordion = AccordionPrimitive.Root
10: 
11: const AccordionItem = React.forwardRef<
12:   React.ElementRef<typeof AccordionPrimitive.Item>,
13:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
14: >(({ className, ...props }, ref) => (
15:   <AccordionPrimitive.Item
16:     ref={ref}
17:     className={cn("border-b", className)}
18:     {...props}
19:   />
20: ))
21: AccordionItem.displayName = "AccordionItem"
22: 
23: const AccordionTrigger = React.forwardRef<
24:   React.ElementRef<typeof AccordionPrimitive.Trigger>,
25:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
26: >(({ className, children, ...props }, ref) => (
27:   <AccordionPrimitive.Header className="flex">
28:     <AccordionPrimitive.Trigger
29:       ref={ref}
30:       className={cn(
31:         "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
32:         className
33:       )}
34:       {...props}
35:     >
36:       {children}
37:       <ChevronDown className="h-4 w-4 transition-transform duration-200" />
38:     </AccordionPrimitive.Trigger>
39:   </AccordionPrimitive.Header>
40: ))
41: AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName
42: 
43: const AccordionContent = React.forwardRef<
44:   React.ElementRef<typeof AccordionPrimitive.Content>,
45:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
46: >(({ className, children, ...props }, ref) => (
47:   <AccordionPrimitive.Content
48:     ref={ref}
49:     className={cn(
50:       "overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",
51:       className
52:     )}
53:     {...props}
54:   >
55:     <div className="pb-4 pt-0">{children}</div>
56:   </AccordionPrimitive.Content>
57: ))
58: AccordionContent.displayName = AccordionPrimitive.Content.displayName
59: 
60: export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
```

## File: packages/ui/src/components/ui/alert-dialog.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog';
  5: 
  6: import { cn } from '@/lib/utils';
  7: import { buttonVariants } from '@/components/ui/button';
  8: 
  9: const AlertDialog = AlertDialogPrimitive.Root;
 10: 
 11: const AlertDialogTrigger = AlertDialogPrimitive.Trigger;
 12: 
 13: const AlertDialogPortal = AlertDialogPrimitive.Portal;
 14: 
 15: const AlertDialogOverlay = React.forwardRef<
 16:   React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
 17:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
 18: >(({ className, ...props }, ref) => (
 19:   <AlertDialogPrimitive.Overlay
 20:     className={cn(
 21:       'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80',
 22:       className
 23:     )}
 24:     {...props}
 25:     ref={ref}
 26:   />
 27: ));
 28: AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;
 29: 
 30: const AlertDialogContent = React.forwardRef<
 31:   React.ElementRef<typeof AlertDialogPrimitive.Content>,
 32:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
 33: >(({ className, ...props }, ref) => (
 34:   <AlertDialogPortal>
 35:     <AlertDialogOverlay />
 36:     <AlertDialogPrimitive.Content
 37:       ref={ref}
 38:       className={cn(
 39:         'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border p-6 shadow-lg duration-200 sm:rounded-lg',
 40:         className
 41:       )}
 42:       {...props}
 43:     />
 44:   </AlertDialogPortal>
 45: ));
 46: AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;
 47: 
 48: const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 49:   <div className={cn('flex flex-col space-y-2 text-center sm:text-left', className)} {...props} />
 50: );
 51: AlertDialogHeader.displayName = 'AlertDialogHeader';
 52: 
 53: const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 54:   <div
 55:     className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
 56:     {...props}
 57:   />
 58: );
 59: AlertDialogFooter.displayName = 'AlertDialogFooter';
 60: 
 61: const AlertDialogTitle = React.forwardRef<
 62:   React.ElementRef<typeof AlertDialogPrimitive.Title>,
 63:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
 64: >(({ className, ...props }, ref) => (
 65:   <AlertDialogPrimitive.Title
 66:     ref={ref}
 67:     className={cn('text-lg font-semibold', className)}
 68:     {...props}
 69:   />
 70: ));
 71: AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;
 72: 
 73: const AlertDialogDescription = React.forwardRef<
 74:   React.ElementRef<typeof AlertDialogPrimitive.Description>,
 75:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
 76: >(({ className, ...props }, ref) => (
 77:   <AlertDialogPrimitive.Description
 78:     ref={ref}
 79:     className={cn('text-muted-foreground text-sm', className)}
 80:     {...props}
 81:   />
 82: ));
 83: AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;
 84: 
 85: const AlertDialogAction = React.forwardRef<
 86:   React.ElementRef<typeof AlertDialogPrimitive.Action>,
 87:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
 88: >(({ className, ...props }, ref) => (
 89:   <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />
 90: ));
 91: AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;
 92: 
 93: const AlertDialogCancel = React.forwardRef<
 94:   React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
 95:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
 96: >(({ className, ...props }, ref) => (
 97:   <AlertDialogPrimitive.Cancel
 98:     ref={ref}
 99:     className={cn(buttonVariants({ variant: 'outline' }), 'mt-2 sm:mt-0', className)}
100:     {...props}
101:   />
102: ));
103: AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;
104: 
105: export {
106:   AlertDialog,
107:   AlertDialogPortal,
108:   AlertDialogOverlay,
109:   AlertDialogTrigger,
110:   AlertDialogContent,
111:   AlertDialogHeader,
112:   AlertDialogFooter,
113:   AlertDialogTitle,
114:   AlertDialogDescription,
115:   AlertDialogAction,
116:   AlertDialogCancel,
117: };
```

## File: packages/ui/src/components/ui/alert.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const alertVariants = cva(
 7:   "relative w-full rounded-lg border p-4 [&>svg]:absolute [&>svg]:text-foreground [&>svg]:left-4 [&>svg]:top-4 [&>svg+div]:translate-y-[-3px] [&>svg~*]:pl-7",
 8:   {
 9:     variants: {
10:       variant: {
11:         default: "bg-background text-foreground",
12:         destructive:
13:           "text-destructive border-destructive/50 dark:border-destructive [&>svg]:text-destructive text-destructive",
14:       },
15:     },
16:     defaultVariants: {
17:       variant: "default",
18:     },
19:   }
20: )
21: 
22: const Alert = React.forwardRef<
23:   HTMLDivElement,
24:   React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
25: >(({ className, variant, ...props }, ref) => (
26:   <div
27:     ref={ref}
28:     role="alert"
29:     className={cn(alertVariants({ variant }), className)}
30:     {...props}
31:   />
32: ))
33: Alert.displayName = "Alert"
34: 
35: const AlertTitle = React.forwardRef<
36:   HTMLParagraphElement,
37:   React.HTMLAttributes<HTMLHeadingElement>
38: >(({ className, ...props }, ref) => (
39:   <h5
40:     ref={ref}
41:     className={cn("mb-1 font-medium leading-none tracking-tight", className)}
42:     {...props}
43:   />
44: ))
45: AlertTitle.displayName = "AlertTitle"
46: 
47: const AlertDescription = React.forwardRef<
48:   HTMLParagraphElement,
49:   React.HTMLAttributes<HTMLParagraphElement>
50: >(({ className, ...props }, ref) => (
51:   <div
52:     ref={ref}
53:     className={cn("text-sm [&_p]:leading-relaxed", className)}
54:     {...props}
55:   />
56: ))
57: AlertDescription.displayName = "AlertDescription"
58: 
59: export { Alert, AlertTitle, AlertDescription }
```

## File: packages/ui/src/components/ui/aspect-ratio.tsx
```typescript
1: "use client"
2: 
3: import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"
4: 
5: const AspectRatio = AspectRatioPrimitive.Root
6: 
7: export { AspectRatio }
```

## File: packages/ui/src/components/ui/avatar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AvatarPrimitive from "@radix-ui/react-avatar"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Avatar = React.forwardRef<
 9:   React.ElementRef<typeof AvatarPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
11: >(({ className, ...props }, ref) => (
12:   <AvatarPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
16:       className
17:     )}
18:     {...props}
19:   />
20: ))
21: Avatar.displayName = AvatarPrimitive.Root.displayName
22: 
23: const AvatarImage = React.forwardRef<
24:   React.ElementRef<typeof AvatarPrimitive.Image>,
25:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
26: >(({ className, ...props }, ref) => (
27:   <AvatarPrimitive.Image
28:     ref={ref}
29:     className={cn("aspect-square h-full w-full", className)}
30:     {...props}
31:   />
32: ))
33: AvatarImage.displayName = AvatarPrimitive.Image.displayName
34: 
35: const AvatarFallback = React.forwardRef<
36:   React.ElementRef<typeof AvatarPrimitive.Fallback>,
37:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
38: >(({ className, ...props }, ref) => (
39:   <AvatarPrimitive.Fallback
40:     ref={ref}
41:     className={cn(
42:       "flex h-full w-full items-center justify-center rounded-full bg-muted",
43:       className
44:     )}
45:     {...props}
46:   />
47: ))
48: AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName
49: 
50: export { Avatar, AvatarImage, AvatarFallback }
```

## File: packages/ui/src/components/ui/badge.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const badgeVariants = cva(
 7:   "inline-flex items-center border rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
 8:   {
 9:     variants: {
10:       variant: {
11:         default:
12:           "bg-primary hover:bg-primary/80 border-transparent text-primary-foreground",
13:         secondary:
14:           "bg-secondary hover:bg-secondary/80 border-transparent text-secondary-foreground",
15:         destructive:
16:           "bg-destructive hover:bg-destructive/80 border-transparent text-destructive-foreground",
17:         outline: "text-foreground",
18:       },
19:     },
20:     defaultVariants: {
21:       variant: "default",
22:     },
23:   }
24: )
25: 
26: export interface BadgeProps
27:   extends React.HTMLAttributes<HTMLDivElement>,
28:     VariantProps<typeof badgeVariants> {}
29: 
30: function Badge({ className, variant, ...props }: BadgeProps) {
31:   return (
32:     <div className={cn(badgeVariants({ variant }), className)} {...props} />
33:   )
34: }
35: 
36: export { Badge, badgeVariants }
```

## File: packages/ui/src/components/ui/button.tsx
```typescript
 1: import * as React from "react"
 2: import { Slot } from "@radix-ui/react-slot"
 3: import { cva, type VariantProps } from "class-variance-authority"
 4: 
 5: import { cn } from "@/lib/utils"
 6: 
 7: const buttonVariants = cva(
 8:   "inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",
 9:   {
10:     variants: {
11:       variant: {
12:         default: "bg-primary text-primary-foreground hover:bg-primary/90",
13:         destructive:
14:           "bg-destructive text-destructive-foreground hover:bg-destructive/90",
15:         outline:
16:           "border border-input hover:bg-accent hover:text-accent-foreground",
17:         secondary:
18:           "bg-secondary text-secondary-foreground hover:bg-secondary/80",
19:         ghost: "hover:bg-accent hover:text-accent-foreground",
20:         link: "underline-offset-4 hover:underline text-primary",
21:       },
22:       size: {
23:         default: "h-10 py-2 px-4",
24:         sm: "h-9 px-3 rounded-md",
25:         lg: "h-11 px-8 rounded-md",
26:       },
27:     },
28:     defaultVariants: {
29:       variant: "default",
30:       size: "default",
31:     },
32:   }
33: )
34: 
35: export interface ButtonProps
36:   extends React.ButtonHTMLAttributes<HTMLButtonElement>,
37:     VariantProps<typeof buttonVariants> {
38:   asChild?: boolean
39: }
40: 
41: const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
42:   ({ className, variant, size, asChild = false, ...props }, ref) => {
43:     const Comp = asChild ? Slot : "button"
44:     return (
45:       <Comp
46:         className={cn(buttonVariants({ variant, size, className }))}
47:         ref={ref}
48:         {...props}
49:       />
50:     )
51:   }
52: )
53: Button.displayName = "Button"
54: 
55: export { Button, buttonVariants }
```

## File: packages/ui/src/components/ui/calendar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { ChevronLeft, ChevronRight } from "lucide-react"
 5: import { DayPicker } from "react-day-picker"
 6: 
 7: import { cn } from "@/lib/utils"
 8: import { buttonVariants } from "@/components/ui/button"
 9: 
10: export type CalendarProps = React.ComponentProps<typeof DayPicker>
11: 
12: function Calendar({
13:   className,
14:   classNames,
15:   showOutsideDays = true,
16:   ...props
17: }: CalendarProps) {
18:   return (
19:     <DayPicker
20:       showOutsideDays={showOutsideDays}
21:       className={cn("p-3", className)}
22:       classNames={{
23:         months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
24:         month: "space-y-4",
25:         caption: "flex justify-center pt-1 relative items-center",
26:         caption_label: "text-sm font-medium",
27:         nav: "space-x-1 flex items-center",
28:         nav_button: cn(
29:           buttonVariants({ variant: "outline" }),
30:           "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
31:         ),
32:         nav_button_previous: "absolute left-1",
33:         nav_button_next: "absolute right-1",
34:         table: "w-full border-collapse space-y-1",
35:         head_row: "flex",
36:         head_cell:
37:           "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
38:         row: "flex w-full mt-2",
39:         cell: "text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
40:         day: cn(
41:           buttonVariants({ variant: "ghost" }),
42:           "h-9 w-9 p-0 font-normal aria-selected:opacity-100"
43:         ),
44:         day_selected:
45:           "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
46:         day_today: "bg-accent text-accent-foreground",
47:         day_outside: "text-muted-foreground opacity-50",
48:         day_disabled: "text-muted-foreground opacity-50",
49:         day_range_middle:
50:           "aria-selected:bg-accent aria-selected:text-accent-foreground",
51:         day_hidden: "invisible",
52:         ...classNames,
53:       }}
54:       components={{
55:         IconLeft: ({ ...props }) => <ChevronLeft className="h-4 w-4" />,
56:         IconRight: ({ ...props }) => <ChevronRight className="h-4 w-4" />,
57:       }}
58:       {...props}
59:     />
60:   )
61: }
62: Calendar.displayName = "Calendar"
63: 
64: export { Calendar }
```

## File: packages/ui/src/components/accordion.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AccordionPrimitive from "@radix-ui/react-accordion"
 5: import { ChevronDown } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const Accordion = AccordionPrimitive.Root
10: 
11: const AccordionItem = React.forwardRef<
12:   React.ElementRef<typeof AccordionPrimitive.Item>,
13:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
14: >(({ className, ...props }, ref) => (
15:   <AccordionPrimitive.Item
16:     ref={ref}
17:     className={cn("border-b", className)}
18:     {...props}
19:   />
20: ))
21: AccordionItem.displayName = "AccordionItem"
22: 
23: const AccordionTrigger = React.forwardRef<
24:   React.ElementRef<typeof AccordionPrimitive.Trigger>,
25:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
26: >(({ className, children, ...props }, ref) => (
27:   <AccordionPrimitive.Header className="flex">
28:     <AccordionPrimitive.Trigger
29:       ref={ref}
30:       className={cn(
31:         "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
32:         className
33:       )}
34:       {...props}
35:     >
36:       {children}
37:       <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
38:     </AccordionPrimitive.Trigger>
39:   </AccordionPrimitive.Header>
40: ))
41: AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName
42: 
43: const AccordionContent = React.forwardRef<
44:   React.ElementRef<typeof AccordionPrimitive.Content>,
45:   React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
46: >(({ className, children, ...props }, ref) => (
47:   <AccordionPrimitive.Content
48:     ref={ref}
49:     className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
50:     {...props}
51:   >
52:     <div className={cn("pb-4 pt-0", className)}>{children}</div>
53:   </AccordionPrimitive.Content>
54: ))
55: 
56: AccordionContent.displayName = AccordionPrimitive.Content.displayName
57: 
58: export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
```

## File: packages/ui/src/components/alert-dialog.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog';
  4: import * as React from 'react';
  5: 
  6: import { buttonVariants } from '@/components/ui/button';
  7: import { cn } from '@/lib/utils';
  8: 
  9: const AlertDialog = AlertDialogPrimitive.Root;
 10: 
 11: const AlertDialogTrigger = AlertDialogPrimitive.Trigger;
 12: 
 13: const AlertDialogPortal = AlertDialogPrimitive.Portal;
 14: 
 15: const AlertDialogOverlay = React.forwardRef<
 16:   React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
 17:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
 18: >(({ className, ...props }, ref) => (
 19:   <AlertDialogPrimitive.Overlay
 20:     className={cn(
 21:       'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80',
 22:       className
 23:     )}
 24:     {...props}
 25:     ref={ref}
 26:   />
 27: ));
 28: AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;
 29: 
 30: const AlertDialogContent = React.forwardRef<
 31:   React.ElementRef<typeof AlertDialogPrimitive.Content>,
 32:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
 33: >(({ className, ...props }, ref) => (
 34:   <AlertDialogPortal>
 35:     <AlertDialogOverlay />
 36:     <AlertDialogPrimitive.Content
 37:       ref={ref}
 38:       className={cn(
 39:         'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border p-6 shadow-lg duration-200 sm:rounded-lg',
 40:         className
 41:       )}
 42:       {...props}
 43:     />
 44:   </AlertDialogPortal>
 45: ));
 46: AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;
 47: 
 48: const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 49:   <div className={cn('flex flex-col space-y-2 text-center sm:text-left', className)} {...props} />
 50: );
 51: AlertDialogHeader.displayName = 'AlertDialogHeader';
 52: 
 53: const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 54:   <div
 55:     className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
 56:     {...props}
 57:   />
 58: );
 59: AlertDialogFooter.displayName = 'AlertDialogFooter';
 60: 
 61: const AlertDialogTitle = React.forwardRef<
 62:   React.ElementRef<typeof AlertDialogPrimitive.Title>,
 63:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
 64: >(({ className, ...props }, ref) => (
 65:   <AlertDialogPrimitive.Title
 66:     ref={ref}
 67:     className={cn('text-lg font-semibold', className)}
 68:     {...props}
 69:   />
 70: ));
 71: AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;
 72: 
 73: const AlertDialogDescription = React.forwardRef<
 74:   React.ElementRef<typeof AlertDialogPrimitive.Description>,
 75:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
 76: >(({ className, ...props }, ref) => (
 77:   <AlertDialogPrimitive.Description
 78:     ref={ref}
 79:     className={cn('text-muted-foreground text-sm', className)}
 80:     {...props}
 81:   />
 82: ));
 83: AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;
 84: 
 85: const AlertDialogAction = React.forwardRef<
 86:   React.ElementRef<typeof AlertDialogPrimitive.Action>,
 87:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
 88: >(({ className, ...props }, ref) => (
 89:   <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />
 90: ));
 91: AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;
 92: 
 93: const AlertDialogCancel = React.forwardRef<
 94:   React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
 95:   React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
 96: >(({ className, ...props }, ref) => (
 97:   <AlertDialogPrimitive.Cancel
 98:     ref={ref}
 99:     className={cn(buttonVariants({ variant: 'outline' }), 'mt-2 sm:mt-0', className)}
100:     {...props}
101:   />
102: ));
103: AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;
104: 
105: export {
106:   AlertDialog,
107:   AlertDialogPortal,
108:   AlertDialogOverlay,
109:   AlertDialogTrigger,
110:   AlertDialogContent,
111:   AlertDialogHeader,
112:   AlertDialogFooter,
113:   AlertDialogTitle,
114:   AlertDialogDescription,
115:   AlertDialogAction,
116:   AlertDialogCancel,
117: };
```

## File: packages/ui/src/components/alert.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const alertVariants = cva(
 7:   "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
 8:   {
 9:     variants: {
10:       variant: {
11:         default: "bg-background text-foreground",
12:         destructive:
13:           "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
14:       },
15:     },
16:     defaultVariants: {
17:       variant: "default",
18:     },
19:   }
20: )
21: 
22: const Alert = React.forwardRef<
23:   HTMLDivElement,
24:   React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
25: >(({ className, variant, ...props }, ref) => (
26:   <div
27:     ref={ref}
28:     role="alert"
29:     className={cn(alertVariants({ variant }), className)}
30:     {...props}
31:   />
32: ))
33: Alert.displayName = "Alert"
34: 
35: const AlertTitle = React.forwardRef<
36:   HTMLParagraphElement,
37:   React.HTMLAttributes<HTMLHeadingElement>
38: >(({ className, ...props }, ref) => (
39:   <h5
40:     ref={ref}
41:     className={cn("mb-1 font-medium leading-none tracking-tight", className)}
42:     {...props}
43:   />
44: ))
45: AlertTitle.displayName = "AlertTitle"
46: 
47: const AlertDescription = React.forwardRef<
48:   HTMLParagraphElement,
49:   React.HTMLAttributes<HTMLParagraphElement>
50: >(({ className, ...props }, ref) => (
51:   <div
52:     ref={ref}
53:     className={cn("text-sm [&_p]:leading-relaxed", className)}
54:     {...props}
55:   />
56: ))
57: AlertDescription.displayName = "AlertDescription"
58: 
59: export { Alert, AlertTitle, AlertDescription }
```

## File: packages/ui/src/components/aspect-ratio.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as AspectRatioPrimitive from '@radix-ui/react-aspect-ratio';
 4: import type { ComponentPropsWithoutRef, ElementRef } from 'react';
 5: 
 6: const AspectRatio = AspectRatioPrimitive.Root;
 7: type AspectRatioElement = ElementRef<typeof AspectRatioPrimitive.Root>;
 8: type AspectRatioProps = ComponentPropsWithoutRef<typeof AspectRatioPrimitive.Root>;
 9: 
10: export { AspectRatio };
11: export type { AspectRatioElement, AspectRatioProps };
```

## File: packages/ui/src/components/avatar.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as AvatarPrimitive from "@radix-ui/react-avatar"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Avatar = React.forwardRef<
 9:   React.ElementRef<typeof AvatarPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
11: >(({ className, ...props }, ref) => (
12:   <AvatarPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
16:       className
17:     )}
18:     {...props}
19:   />
20: ))
21: Avatar.displayName = AvatarPrimitive.Root.displayName
22: 
23: const AvatarImage = React.forwardRef<
24:   React.ElementRef<typeof AvatarPrimitive.Image>,
25:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
26: >(({ className, ...props }, ref) => (
27:   <AvatarPrimitive.Image
28:     ref={ref}
29:     className={cn("aspect-square h-full w-full", className)}
30:     {...props}
31:   />
32: ))
33: AvatarImage.displayName = AvatarPrimitive.Image.displayName
34: 
35: const AvatarFallback = React.forwardRef<
36:   React.ElementRef<typeof AvatarPrimitive.Fallback>,
37:   React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
38: >(({ className, ...props }, ref) => (
39:   <AvatarPrimitive.Fallback
40:     ref={ref}
41:     className={cn(
42:       "flex h-full w-full items-center justify-center rounded-full bg-muted",
43:       className
44:     )}
45:     {...props}
46:   />
47: ))
48: AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName
49: 
50: export { Avatar, AvatarImage, AvatarFallback }
```

## File: packages/ui/src/components/badge.tsx
```typescript
 1: import * as React from "react"
 2: import { cva, type VariantProps } from "class-variance-authority"
 3: 
 4: import { cn } from "@/lib/utils"
 5: 
 6: const badgeVariants = cva(
 7:   "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
 8:   {
 9:     variants: {
10:       variant: {
11:         default:
12:           "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
13:         secondary:
14:           "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
15:         destructive:
16:           "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
17:         outline: "text-foreground",
18:       },
19:     },
20:     defaultVariants: {
21:       variant: "default",
22:     },
23:   }
24: )
25: 
26: export interface BadgeProps
27:   extends React.HTMLAttributes<HTMLDivElement>,
28:     VariantProps<typeof badgeVariants> {}
29: 
30: function Badge({ className, variant, ...props }: BadgeProps) {
31:   return (
32:     <div className={cn(badgeVariants({ variant }), className)} {...props} />
33:   )
34: }
35: 
36: export { Badge, badgeVariants }
```

## File: packages/ui/src/components/breadcrumb.tsx
```typescript
  1: 'use client';
  2: 
  3: import { Slot } from '@radix-ui/react-slot';
  4: import { ChevronRight, MoreHorizontal } from 'lucide-react';
  5: import * as React from 'react';
  6: 
  7: import { cn } from '@/lib/utils';
  8: 
  9: const Breadcrumb = React.forwardRef<
 10:   HTMLElement,
 11:   React.ComponentPropsWithoutRef<'nav'> & {
 12:     separator?: React.ReactNode;
 13:   }
 14: >(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
 15: Breadcrumb.displayName = 'Breadcrumb';
 16: 
 17: const BreadcrumbList = React.forwardRef<HTMLOListElement, React.ComponentPropsWithoutRef<'ol'>>(
 18:   ({ className, ...props }, ref) => (
 19:     <ol
 20:       ref={ref}
 21:       className={cn(
 22:         'text-muted-foreground flex flex-wrap items-center gap-1.5 break-words text-sm',
 23:         className
 24:       )}
 25:       {...props}
 26:     />
 27:   )
 28: );
 29: BreadcrumbList.displayName = 'BreadcrumbList';
 30: 
 31: const BreadcrumbItem = React.forwardRef<HTMLLIElement, React.ComponentPropsWithoutRef<'li'>>(
 32:   ({ className, ...props }, ref) => (
 33:     <li ref={ref} className={cn('inline-flex items-center gap-1.5', className)} {...props} />
 34:   )
 35: );
 36: BreadcrumbItem.displayName = 'BreadcrumbItem';
 37: 
 38: const BreadcrumbLink = React.forwardRef<
 39:   HTMLAnchorElement,
 40:   React.ComponentPropsWithoutRef<'a'> & {
 41:     asChild?: boolean;
 42:   }
 43: >(({ asChild, className, ...props }, ref) => {
 44:   const Comp = asChild ? Slot : 'a';
 45: 
 46:   return (
 47:     <Comp
 48:       ref={ref}
 49:       className={cn('hover:text-foreground transition-colors', className)}
 50:       {...props}
 51:     />
 52:   );
 53: });
 54: BreadcrumbLink.displayName = 'BreadcrumbLink';
 55: 
 56: const BreadcrumbPage = React.forwardRef<HTMLSpanElement, React.ComponentPropsWithoutRef<'span'>>(
 57:   ({ className, ...props }, ref) => (
 58:     <span
 59:       ref={ref}
 60:       role="link"
 61:       aria-disabled="true"
 62:       aria-current="page"
 63:       className={cn('text-foreground font-normal', className)}
 64:       {...props}
 65:     />
 66:   )
 67: );
 68: BreadcrumbPage.displayName = 'BreadcrumbPage';
 69: 
 70: const BreadcrumbSeparator = ({ children, className, ...props }: React.ComponentProps<'li'>) => (
 71:   <li
 72:     role="presentation"
 73:     aria-hidden="true"
 74:     className={cn('[&>svg]:size-3.5', className)}
 75:     {...props}
 76:   >
 77:     {children || <ChevronRight />}
 78:   </li>
 79: );
 80: BreadcrumbSeparator.displayName = 'BreadcrumbSeparator';
 81: 
 82: const BreadcrumbEllipsis = ({ className, ...props }: React.ComponentProps<'span'>) => (
 83:   <span
 84:     role="presentation"
 85:     aria-hidden="true"
 86:     className={cn('flex h-9 w-9 items-center justify-center', className)}
 87:     {...props}
 88:   >
 89:     <MoreHorizontal className="h-4 w-4" />
 90:     <span className="sr-only">More</span>
 91:   </span>
 92: );
 93: BreadcrumbEllipsis.displayName = 'BreadcrumbEllipsis';
 94: 
 95: export {
 96:   Breadcrumb,
 97:   BreadcrumbList,
 98:   BreadcrumbItem,
 99:   BreadcrumbLink,
100:   BreadcrumbPage,
101:   BreadcrumbSeparator,
102:   BreadcrumbEllipsis,
103: };
```

## File: packages/ui/src/components/button.tsx
```typescript
 1: import * as React from 'react';
 2: import { Slot } from '@radix-ui/react-slot';
 3: import { cva, type VariantProps } from 'class-variance-authority';
 4: 
 5: import { cn } from '@/lib/utils';
 6: 
 7: const buttonVariants = cva(
 8:   'inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',
 9:   {
10:     variants: {
11:       variant: {
12:         default: 'bg-primary text-primary-foreground hover:bg-primary/90',
13:         destructive: 'bg-destructive text-destructive-foreground hover:bg-destructive/90',
14:         outline: 'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
15:         secondary: 'bg-secondary text-secondary-foreground hover:bg-secondary/80',
16:         ghost: 'hover:bg-accent hover:text-accent-foreground',
17:         link: 'text-primary underline-offset-4 hover:underline',
18:       },
19:       size: {
20:         default: 'h-10 px-4 py-2',
21:         sm: 'h-9 rounded-md px-3',
22:         lg: 'h-11 rounded-md px-8',
23:         icon: 'h-10 w-10',
24:       },
25:     },
26:     defaultVariants: {
27:       variant: 'default',
28:       size: 'default',
29:     },
30:   }
31: );
32: 
33: export interface ButtonProps
34:   extends React.ButtonHTMLAttributes<HTMLButtonElement>,
35:     VariantProps<typeof buttonVariants> {
36:   asChild?: boolean;
37: }
38: 
39: export type ButtonElement = HTMLButtonElement;
40: 
41: export const Button = React.forwardRef<ButtonElement, ButtonProps>(
42:   ({ className, variant, size, asChild = false, ...props }, ref) => {
43:     const Comp = asChild ? Slot : 'button';
44:     return (
45:       <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />
46:     );
47:   }
48: );
49: Button.displayName = 'Button';
50: 
51: export { buttonVariants };
```

## File: packages/ui/src/components/calendar.tsx
```typescript
 1: 'use client';
 2: 
 3: import { ChevronLeft, ChevronRight } from 'lucide-react';
 4: import * as React from 'react';
 5: import { DayPicker } from 'react-day-picker';
 6: 
 7: import { buttonVariants } from '@/components/ui/button';
 8: import { cn } from '@/lib/utils';
 9: 
10: export type CalendarProps = React.ComponentProps<typeof DayPicker>;
11: 
12: function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
13:   return (
14:     <DayPicker
15:       showOutsideDays={showOutsideDays}
16:       className={cn('p-3', className)}
17:       classNames={{
18:         months: 'flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0',
19:         month: 'space-y-4',
20:         caption: 'flex justify-center pt-1 relative items-center',
21:         caption_label: 'text-sm font-medium',
22:         nav: 'space-x-1 flex items-center',
23:         nav_button: cn(
24:           buttonVariants({ variant: 'outline' }),
25:           'h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100'
26:         ),
27:         nav_button_previous: 'absolute left-1',
28:         nav_button_next: 'absolute right-1',
29:         table: 'w-full border-collapse space-y-1',
30:         head_row: 'flex',
31:         head_cell: 'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
32:         row: 'flex w-full mt-2',
33:         cell: 'h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
34:         day: cn(
35:           buttonVariants({ variant: 'ghost' }),
36:           'h-9 w-9 p-0 font-normal aria-selected:opacity-100'
37:         ),
38:         day_range_end: 'day-range-end',
39:         day_selected:
40:           'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
41:         day_today: 'bg-accent text-accent-foreground',
42:         day_outside:
43:           'day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30',
44:         day_disabled: 'text-muted-foreground opacity-50',
45:         day_range_middle: 'aria-selected:bg-accent aria-selected:text-accent-foreground',
46:         day_hidden: 'invisible',
47:         ...classNames,
48:       }}
49:       components={{
50:         IconLeft: () => <ChevronLeft className="h-4 w-4" />,
51:         IconRight: () => <ChevronRight className="h-4 w-4" />,
52:       }}
53:       {...props}
54:     />
55:   );
56: }
57: Calendar.displayName = 'Calendar';
58: 
59: export { Calendar };
```

## File: packages/ui/src/components/card.tsx
```typescript
 1: import * as React from "react"
 2: 
 3: import { cn } from "@/lib/utils"
 4: 
 5: const Card = React.forwardRef<
 6:   HTMLDivElement,
 7:   React.HTMLAttributes<HTMLDivElement>
 8: >(({ className, ...props }, ref) => (
 9:   <div
10:     ref={ref}
11:     className={cn(
12:       "rounded-lg border bg-card text-card-foreground shadow-sm",
13:       className
14:     )}
15:     {...props}
16:   />
17: ))
18: Card.displayName = "Card"
19: 
20: const CardHeader = React.forwardRef<
21:   HTMLDivElement,
22:   React.HTMLAttributes<HTMLDivElement>
23: >(({ className, ...props }, ref) => (
24:   <div
25:     ref={ref}
26:     className={cn("flex flex-col space-y-1.5 p-6", className)}
27:     {...props}
28:   />
29: ))
30: CardHeader.displayName = "CardHeader"
31: 
32: const CardTitle = React.forwardRef<
33:   HTMLDivElement,
34:   React.HTMLAttributes<HTMLDivElement>
35: >(({ className, ...props }, ref) => (
36:   <div
37:     ref={ref}
38:     className={cn(
39:       "text-2xl font-semibold leading-none tracking-tight",
40:       className
41:     )}
42:     {...props}
43:   />
44: ))
45: CardTitle.displayName = "CardTitle"
46: 
47: const CardDescription = React.forwardRef<
48:   HTMLDivElement,
49:   React.HTMLAttributes<HTMLDivElement>
50: >(({ className, ...props }, ref) => (
51:   <div
52:     ref={ref}
53:     className={cn("text-sm text-muted-foreground", className)}
54:     {...props}
55:   />
56: ))
57: CardDescription.displayName = "CardDescription"
58: 
59: const CardContent = React.forwardRef<
60:   HTMLDivElement,
61:   React.HTMLAttributes<HTMLDivElement>
62: >(({ className, ...props }, ref) => (
63:   <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
64: ))
65: CardContent.displayName = "CardContent"
66: 
67: const CardFooter = React.forwardRef<
68:   HTMLDivElement,
69:   React.HTMLAttributes<HTMLDivElement>
70: >(({ className, ...props }, ref) => (
71:   <div
72:     ref={ref}
73:     className={cn("flex items-center p-6 pt-0", className)}
74:     {...props}
75:   />
76: ))
77: CardFooter.displayName = "CardFooter"
78: 
79: export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
```

## File: packages/ui/src/components/carousel.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import useEmblaCarousel, { type UseEmblaCarouselType } from 'embla-carousel-react';
  5: import { ArrowLeft, ArrowRight } from 'lucide-react';
  6: 
  7: import { cn } from '@/lib/utils';
  8: import { Button } from '@/components/button';
  9: 
 10: type CarouselApi = UseEmblaCarouselType[1];
 11: type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
 12: type CarouselOptions = UseCarouselParameters[0];
 13: type CarouselPlugin = UseCarouselParameters[1];
 14: 
 15: type CarouselProps = {
 16:   opts?: CarouselOptions;
 17:   plugins?: CarouselPlugin;
 18:   orientation?: 'horizontal' | 'vertical';
 19:   setApi?: (api: CarouselApi) => void;
 20: };
 21: 
 22: type CarouselContextProps = {
 23:   carouselRef: ReturnType<typeof useEmblaCarousel>[0];
 24:   api: ReturnType<typeof useEmblaCarousel>[1];
 25:   scrollPrev: () => void;
 26:   scrollNext: () => void;
 27:   canScrollPrev: boolean;
 28:   canScrollNext: boolean;
 29: } & CarouselProps;
 30: 
 31: const CarouselContext = React.createContext<CarouselContextProps | null>(null);
 32: 
 33: function useCarousel() {
 34:   const context = React.useContext(CarouselContext);
 35: 
 36:   if (!context) {
 37:     throw new Error('useCarousel must be used within a <Carousel />');
 38:   }
 39: 
 40:   return context;
 41: }
 42: 
 43: const Carousel = React.forwardRef<
 44:   HTMLDivElement,
 45:   React.HTMLAttributes<HTMLDivElement> & CarouselProps
 46: >(({ orientation = 'horizontal', opts, setApi, plugins, className, children, ...props }, ref) => {
 47:   const [carouselRef, api] = useEmblaCarousel(
 48:     {
 49:       ...opts,
 50:       axis: orientation === 'horizontal' ? 'x' : 'y',
 51:     },
 52:     plugins
 53:   );
 54:   const [canScrollPrev, setCanScrollPrev] = React.useState(false);
 55:   const [canScrollNext, setCanScrollNext] = React.useState(false);
 56: 
 57:   const onSelect = React.useCallback((api: CarouselApi) => {
 58:     if (!api) return;
 59: 
 60:     setCanScrollPrev(api.canScrollPrev());
 61:     setCanScrollNext(api.canScrollNext());
 62:   }, []);
 63: 
 64:   const scrollPrev = React.useCallback(() => {
 65:     api?.scrollPrev();
 66:   }, [api]);
 67: 
 68:   const scrollNext = React.useCallback(() => {
 69:     api?.scrollNext();
 70:   }, [api]);
 71: 
 72:   const handleKeyDown = React.useCallback(
 73:     (event: React.KeyboardEvent<HTMLDivElement>) => {
 74:       if (event.key === 'ArrowLeft') {
 75:         event.preventDefault();
 76:         scrollPrev();
 77:       } else if (event.key === 'ArrowRight') {
 78:         event.preventDefault();
 79:         scrollNext();
 80:       }
 81:     },
 82:     [scrollPrev, scrollNext]
 83:   );
 84: 
 85:   React.useEffect(() => {
 86:     if (!api || !setApi) return;
 87: 
 88:     setApi(api);
 89:   }, [api, setApi]);
 90: 
 91:   React.useEffect(() => {
 92:     if (!api) return;
 93: 
 94:     onSelect(api);
 95:     api.on('select', onSelect);
 96:     api.on('reInit', onSelect);
 97: 
 98:     return () => {
 99:       api.off('select', onSelect);
100:       api.off('reInit', onSelect);
101:     };
102:   }, [api, onSelect]);
103: 
104:   return (
105:     <CarouselContext.Provider
106:       value={{
107:         carouselRef,
108:         api,
109:         opts,
110:         orientation,
111:         scrollPrev,
112:         scrollNext,
113:         canScrollPrev,
114:         canScrollNext,
115:       }}
116:     >
117:       <div
118:         ref={ref}
119:         onKeyDownCapture={handleKeyDown}
120:         className={cn('relative', className)}
121:         role="region"
122:         aria-roledescription="carousel"
123:         {...props}
124:       >
125:         {children}
126:       </div>
127:     </CarouselContext.Provider>
128:   );
129: });
130: Carousel.displayName = 'Carousel';
131: 
132: const CarouselContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
133:   ({ className, ...props }, ref) => {
134:     const { carouselRef, orientation } = useCarousel();
135: 
136:     return (
137:       <div ref={carouselRef} className="overflow-hidden">
138:         <div
139:           ref={ref}
140:           className={cn(
141:             'flex',
142:             orientation === 'horizontal' ? '-ml-4' : '-mt-4 flex-col',
143:             className
144:           )}
145:           {...props}
146:         />
147:       </div>
148:     );
149:   }
150: );
151: CarouselContent.displayName = 'CarouselContent';
152: 
153: const CarouselItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
154:   ({ className, ...props }, ref) => {
155:     const { orientation } = useCarousel();
156: 
157:     return (
158:       <div
159:         ref={ref}
160:         role="group"
161:         aria-roledescription="slide"
162:         className={cn(
163:           'min-w-0 shrink-0 grow-0 basis-full',
164:           orientation === 'horizontal' ? 'pl-4' : 'pt-4',
165:           className
166:         )}
167:         {...props}
168:       />
169:     );
170:   }
171: );
172: CarouselItem.displayName = 'CarouselItem';
173: 
174: const CarouselPrevious = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
175:   ({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
176:     const { orientation, scrollPrev, canScrollPrev } = useCarousel();
177: 
178:     return (
179:       <Button
180:         ref={ref}
181:         variant={variant}
182:         size={size}
183:         className={cn(
184:           'absolute h-8 w-8 rounded-full',
185:           orientation === 'horizontal'
186:             ? '-left-12 top-1/2 -translate-y-1/2'
187:             : '-top-12 left-1/2 -translate-x-1/2 rotate-90',
188:           className
189:         )}
190:         disabled={!canScrollPrev}
191:         onClick={scrollPrev}
192:         {...props}
193:       >
194:         <ArrowLeft className="h-4 w-4" />
195:         <span className="sr-only">Previous slide</span>
196:       </Button>
197:     );
198:   }
199: );
200: CarouselPrevious.displayName = 'CarouselPrevious';
201: 
202: const CarouselNext = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
203:   ({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
204:     const { orientation, scrollNext, canScrollNext } = useCarousel();
205: 
206:     return (
207:       <Button
208:         ref={ref}
209:         variant={variant}
210:         size={size}
211:         className={cn(
212:           'absolute h-8 w-8 rounded-full',
213:           orientation === 'horizontal'
214:             ? '-right-12 top-1/2 -translate-y-1/2'
215:             : '-bottom-12 left-1/2 -translate-x-1/2 rotate-90',
216:           className
217:         )}
218:         disabled={!canScrollNext}
219:         onClick={scrollNext}
220:         {...props}
221:       >
222:         <ArrowRight className="h-4 w-4" />
223:         <span className="sr-only">Next slide</span>
224:       </Button>
225:     );
226:   }
227: );
228: CarouselNext.displayName = 'CarouselNext';
229: 
230: export {
231:   type CarouselApi,
232:   Carousel,
233:   CarouselContent,
234:   CarouselItem,
235:   CarouselPrevious,
236:   CarouselNext,
237: };
```

## File: packages/ui/src/components/chart.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as RechartsPrimitive from 'recharts';
  5: 
  6: import { cn } from '@/lib/utils';
  7: 
  8: // Format: { THEME_NAME: CSS_SELECTOR }
  9: const THEMES = { light: '', dark: '.dark' } as const;
 10: 
 11: export type ChartConfig = {
 12:   [k in string]: {
 13:     label?: React.ReactNode;
 14:     icon?: React.ComponentType;
 15:   } & (
 16:     | { color?: string; theme?: never }
 17:     | { color?: never; theme: Record<keyof typeof THEMES, string> }
 18:   );
 19: };
 20: 
 21: type ChartContextProps = {
 22:   config: ChartConfig;
 23: };
 24: 
 25: const ChartContext = React.createContext<ChartContextProps | null>(null);
 26: 
 27: function useChart() {
 28:   const context = React.useContext(ChartContext);
 29: 
 30:   if (context === null) {
 31:     throw new Error('useChart must be used within a <ChartContainer />');
 32:   }
 33: 
 34:   return context;
 35: }
 36: 
 37: const ChartContainer = React.forwardRef<
 38:   HTMLDivElement,
 39:   React.ComponentProps<'div'> & {
 40:     config: ChartConfig;
 41:     children: React.ComponentProps<typeof RechartsPrimitive.ResponsiveContainer>['children'];
 42:   }
 43: >(({ id, className, children, config, ...props }, ref) => {
 44:   const uniqueId = React.useId();
 45:   const chartId = `chart-${id || uniqueId.replace(/:/g, '')}`;
 46: 
 47:   return (
 48:     <ChartContext.Provider value={{ config }}>
 49:       <div
 50:         data-chart={chartId}
 51:         ref={ref}
 52:         className={cn(
 53:           "[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
 54:           className
 55:         )}
 56:         {...props}
 57:       >
 58:         <ChartStyle id={chartId} config={config} />
 59:         <RechartsPrimitive.ResponsiveContainer>{children}</RechartsPrimitive.ResponsiveContainer>
 60:       </div>
 61:     </ChartContext.Provider>
 62:   );
 63: });
 64: ChartContainer.displayName = 'Chart';
 65: 
 66: const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
 67:   const colorConfig = Object.entries(config).filter(
 68:     ([, config]) => config.theme !== undefined || config.color !== undefined
 69:   );
 70: 
 71:   if (colorConfig.length === 0) {
 72:     return null;
 73:   }
 74: 
 75:   return (
 76:     <style
 77:       dangerouslySetInnerHTML={{
 78:         __html: Object.entries(THEMES)
 79:           .map(
 80:             ([theme, prefix]) => `
 81: ${prefix} [data-chart=${id}] {
 82: ${colorConfig
 83:   .map(([key, itemConfig]) => {
 84:     const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;
 85:     if (color === undefined) return null;
 86:     return `  --color-${key}: ${color};`;
 87:   })
 88:   .filter(Boolean)
 89:   .join('\n')}
 90: }
 91: `
 92:           )
 93:           .join('\n'),
 94:       }}
 95:     />
 96:   );
 97: };
 98: 
 99: const ChartTooltip = RechartsPrimitive.Tooltip;
100: 
101: const ChartTooltipContent = React.forwardRef<
102:   HTMLDivElement,
103:   React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
104:     React.ComponentProps<'div'> & {
105:       hideLabel?: boolean;
106:       hideIndicator?: boolean;
107:       indicator?: 'line' | 'dot' | 'dashed';
108:       nameKey?: string;
109:       labelKey?: string;
110:     }
111: >(
112:   (
113:     {
114:       active,
115:       payload,
116:       className,
117:       indicator = 'dot',
118:       hideLabel = false,
119:       hideIndicator = false,
120:       label,
121:       labelFormatter,
122:       labelClassName,
123:       formatter,
124:       color,
125:       nameKey,
126:       labelKey,
127:     },
128:     ref
129:   ) => {
130:     const { config } = useChart();
131: 
132:     const tooltipLabel = React.useMemo(() => {
133:       if (hideLabel || !Array.isArray(payload) || payload.length === 0) {
134:         return null;
135:       }
136: 
137:       const [item] = payload;
138:       const key = labelKey ?? item.dataKey ?? item.name ?? 'value';
139:       const itemConfig = getPayloadConfigFromPayload(config, item, key);
140:       const value =
141:         !labelKey && typeof label === 'string' ? config[label].label || label : itemConfig.label;
142: 
143:       if (labelFormatter !== undefined) {
144:         return (
145:           <div className={cn('font-medium', labelClassName)}>{labelFormatter(value, payload)}</div>
146:         );
147:       }
148: 
149:       if (value === undefined) {
150:         return null;
151:       }
152: 
153:       return <div className={cn('font-medium', labelClassName)}>{value}</div>;
154:     }, [label, labelFormatter, payload, hideLabel, labelClassName, config, labelKey]);
155: 
156:     if (!active || !Array.isArray(payload) || payload.length === 0) {
157:       return null;
158:     }
159: 
160:     const nestLabel = payload.length === 1 && indicator !== 'dot';
161: 
162:     return (
163:       <div
164:         ref={ref}
165:         className={cn(
166:           'border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl',
167:           className
168:         )}
169:       >
170:         {!nestLabel ? tooltipLabel : null}
171:         <div className="grid gap-1.5">
172:           {payload.map((item, index) => {
173:             const key = nameKey ?? item.name ?? item.dataKey ?? 'value';
174:             const itemConfig = getPayloadConfigFromPayload(config, item, key);
175:             const indicatorColor = color || item.payload?.fill || item.color;
176: 
177:             return (
178:               <div
179:                 key={item.dataKey}
180:                 className={cn(
181:                   '[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5',
182:                   indicator === 'dot' && 'items-center'
183:                 )}
184:               >
185:                 {formatter !== undefined && item.value !== undefined && item.name !== undefined ? (
186:                   formatter(item.value, item.name, item, index, item.payload)
187:                 ) : (
188:                   <>
189:                     {itemConfig.icon ? (
190:                       <itemConfig.icon />
191:                     ) : (
192:                       !hideIndicator && (
193:                         <div
194:                           className={cn(
195:                             'shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]',
196:                             {
197:                               'h-2.5 w-2.5': indicator === 'dot',
198:                               'w-1': indicator === 'line',
199:                               'w-0 border-[1.5px] border-dashed bg-transparent':
200:                                 indicator === 'dashed',
201:                               'my-0.5': nestLabel && indicator === 'dashed',
202:                             }
203:                           )}
204:                           style={
205:                             {
206:                               '--color-bg': indicatorColor,
207:                               '--color-border': indicatorColor,
208:                             } as React.CSSProperties
209:                           }
210:                         />
211:                       )
212:                     )}
213:                     <div
214:                       className={cn(
215:                         'flex flex-1 justify-between leading-none',
216:                         nestLabel ? 'items-end' : 'items-center'
217:                       )}
218:                     >
219:                       <div className="grid gap-1.5">
220:                         {nestLabel ? tooltipLabel : null}
221:                         <span className="text-muted-foreground">
222:                           {itemConfig.label || item.name}
223:                         </span>
224:                       </div>
225:                       {item.value !== undefined && (
226:                         <span className="text-foreground font-mono font-medium tabular-nums">
227:                           {item.value.toLocaleString()}
228:                         </span>
229:                       )}
230:                     </div>
231:                   </>
232:                 )}
233:               </div>
234:             );
235:           })}
236:         </div>
237:       </div>
238:     );
239:   }
240: );
241: ChartTooltipContent.displayName = 'ChartTooltip';
242: 
243: const ChartLegend = RechartsPrimitive.Legend;
244: 
245: const ChartLegendContent = React.forwardRef<
246:   HTMLDivElement,
247:   React.ComponentProps<'div'> &
248:     Pick<RechartsPrimitive.LegendProps, 'payload' | 'verticalAlign'> & {
249:       hideIcon?: boolean;
250:       nameKey?: string;
251:     }
252: >(({ className, hideIcon = false, payload, verticalAlign = 'bottom', nameKey }, ref) => {
253:   const { config } = useChart();
254:   return (
255:     <div
256:       ref={ref}
257:       className={cn(
258:         'flex flex-wrap gap-4',
259:         verticalAlign === 'top' && 'mb-4',
260:         verticalAlign === 'bottom' && 'mt-4',
261:         className
262:       )}
263:     >
264:       {Array.isArray(payload) &&
265:         payload.map(entry => {
266:           const key = `${nameKey ?? entry.value ?? entry.id}`;
267:           const itemConfig = getPayloadConfigFromPayload(config, entry, key);
268: 
269:           return (
270:             <div key={entry.value} className="flex items-center gap-1.5">
271:               {!hideIcon &&
272:                 (itemConfig.icon ? (
273:                   <itemConfig.icon />
274:                 ) : (
275:                   <div
276:                     className="h-2.5 w-2.5 rounded-[2px]"
277:                     style={{ backgroundColor: entry.color }}
278:                   />
279:                 ))}
280:               <span className="text-muted-foreground text-xs">
281:                 {itemConfig.label ?? entry.value}
282:               </span>
283:             </div>
284:           );
285:         })}
286:     </div>
287:   );
288: });
289: ChartLegendContent.displayName = 'ChartLegendContent';
290: 
291: function getPayloadConfigFromPayload(
292:   config: ChartConfig,
293:   payload: { value?: string; dataKey?: string; name?: string },
294:   key: string
295: ) {
296:   return (
297:     config[key] ??
298:     config[payload.dataKey as keyof typeof config] ??
299:     config[payload.name as keyof typeof config]
300:   );
301: }
302: 
303: export {
304:   ChartContainer as Chart,
305:   ChartTooltip,
306:   ChartTooltipContent,
307:   ChartLegend,
308:   ChartLegendContent,
309:   type ChartConfig,
310: };
```

## File: packages/ui/src/components/checkbox.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
 5: import { Check } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const Checkbox = React.forwardRef<
10:   React.ElementRef<typeof CheckboxPrimitive.Root>,
11:   React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
12: >(({ className, ...props }, ref) => (
13:   <CheckboxPrimitive.Root
14:     ref={ref}
15:     className={cn(
16:       "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
17:       className
18:     )}
19:     {...props}
20:   >
21:     <CheckboxPrimitive.Indicator
22:       className={cn("flex items-center justify-center text-current")}
23:     >
24:       <Check className="h-4 w-4" />
25:     </CheckboxPrimitive.Indicator>
26:   </CheckboxPrimitive.Root>
27: ))
28: Checkbox.displayName = CheckboxPrimitive.Root.displayName
29: 
30: export { Checkbox }
```

## File: packages/ui/src/components/collapsible.tsx
```typescript
 1: "use client"
 2: 
 3: import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"
 4: 
 5: const Collapsible = CollapsiblePrimitive.Root
 6: 
 7: const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger
 8: 
 9: const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent
10: 
11: export { Collapsible, CollapsibleTrigger, CollapsibleContent }
```

## File: packages/ui/src/components/command.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import { type DialogProps } from '@radix-ui/react-dialog';
  5: import { Command as CommandPrimitive } from 'cmdk';
  6: import { Search } from 'lucide-react';
  7: import { cn } from '@/lib/utils';
  8: import { Dialog, DialogContent } from '@/components/dialog';
  9: 
 10: const Command = React.forwardRef<
 11:   React.ElementRef<typeof CommandPrimitive>,
 12:   React.ComponentPropsWithoutRef<typeof CommandPrimitive>
 13: >(({ className, ...props }, ref) => (
 14:   <CommandPrimitive
 15:     ref={ref}
 16:     className={cn(
 17:       'bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md',
 18:       className
 19:     )}
 20:     {...props}
 21:   />
 22: ));
 23: Command.displayName = CommandPrimitive.displayName;
 24: 
 25: type CommandDialogProps = DialogProps;
 26: 
 27: const CommandDialog = ({ children, ...props }: CommandDialogProps) => (
 28:   <Dialog {...props}>
 29:     <DialogContent className="overflow-hidden p-0 shadow-lg">
 30:       <Command className="[&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
 31:         {children}
 32:       </Command>
 33:     </DialogContent>
 34:   </Dialog>
 35: );
 36: 
 37: const CommandInput = React.forwardRef<
 38:   React.ElementRef<typeof CommandPrimitive.Input>,
 39:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
 40: >(({ className, ...props }, ref) => (
 41:   <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
 42:     <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
 43:     <CommandPrimitive.Input
 44:       ref={ref}
 45:       className={cn(
 46:         'placeholder:text-muted-foreground flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none disabled:cursor-not-allowed disabled:opacity-50',
 47:         className
 48:       )}
 49:       {...props}
 50:     />
 51:   </div>
 52: ));
 53: CommandInput.displayName = CommandPrimitive.Input.displayName;
 54: 
 55: const CommandList = React.forwardRef<
 56:   React.ElementRef<typeof CommandPrimitive.List>,
 57:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
 58: >(({ className, ...props }, ref) => (
 59:   <CommandPrimitive.List
 60:     ref={ref}
 61:     className={cn('max-h-[300px] overflow-y-auto overflow-x-hidden', className)}
 62:     {...props}
 63:   />
 64: ));
 65: CommandList.displayName = CommandPrimitive.List.displayName;
 66: 
 67: const CommandEmpty = React.forwardRef<
 68:   React.ElementRef<typeof CommandPrimitive.Empty>,
 69:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
 70: >((props, ref) => (
 71:   <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />
 72: ));
 73: CommandEmpty.displayName = CommandPrimitive.Empty.displayName;
 74: 
 75: const CommandGroup = React.forwardRef<
 76:   React.ElementRef<typeof CommandPrimitive.Group>,
 77:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
 78: >(({ className, ...props }, ref) => (
 79:   <CommandPrimitive.Group
 80:     ref={ref}
 81:     className={cn(
 82:       'text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium',
 83:       className
 84:     )}
 85:     {...props}
 86:   />
 87: ));
 88: CommandGroup.displayName = CommandPrimitive.Group.displayName;
 89: 
 90: const CommandSeparator = React.forwardRef<
 91:   React.ElementRef<typeof CommandPrimitive.Separator>,
 92:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
 93: >(({ className, ...props }, ref) => (
 94:   <CommandPrimitive.Separator
 95:     ref={ref}
 96:     className={cn('bg-border -mx-1 h-px', className)}
 97:     {...props}
 98:   />
 99: ));
100: CommandSeparator.displayName = CommandPrimitive.Separator.displayName;
101: 
102: const CommandItem = React.forwardRef<
103:   React.ElementRef<typeof CommandPrimitive.Item>,
104:   React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
105: >(({ className, ...props }, ref) => (
106:   <CommandPrimitive.Item
107:     ref={ref}
108:     className={cn(
109:       'aria-selected:bg-accent aria-selected:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
110:       className
111:     )}
112:     {...props}
113:   />
114: ));
115: CommandItem.displayName = CommandPrimitive.Item.displayName;
116: 
117: const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => (
118:   <span
119:     className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
120:     {...props}
121:   />
122: );
123: CommandShortcut.displayName = 'CommandShortcut';
124: 
125: export {
126:   Command,
127:   CommandDialog,
128:   CommandInput,
129:   CommandList,
130:   CommandEmpty,
131:   CommandGroup,
132:   CommandItem,
133:   CommandShortcut,
134:   CommandSeparator,
135: };
```

## File: packages/ui/src/components/context-menu.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as ContextMenuPrimitive from '@radix-ui/react-context-menu';
  4: import { Check, ChevronRight, Circle } from 'lucide-react';
  5: import * as React from 'react';
  6: 
  7: import { cn } from '@/lib/utils';
  8: 
  9: const ContextMenu = ContextMenuPrimitive.Root;
 10: 
 11: const ContextMenuTrigger = ContextMenuPrimitive.Trigger;
 12: 
 13: const ContextMenuGroup = ContextMenuPrimitive.Group;
 14: 
 15: const ContextMenuPortal = ContextMenuPrimitive.Portal;
 16: 
 17: const ContextMenuSub = ContextMenuPrimitive.Sub;
 18: 
 19: const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;
 20: 
 21: const ContextMenuSubTrigger = React.forwardRef<
 22:   React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
 23:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
 24:     inset?: boolean;
 25:   }
 26: >(({ className, inset, children, ...props }, ref) => (
 27:   <ContextMenuPrimitive.SubTrigger
 28:     ref={ref}
 29:     className={cn(
 30:       'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none',
 31:       inset && 'pl-8',
 32:       className
 33:     )}
 34:     {...props}
 35:   >
 36:     {children}
 37:     <ChevronRight className="ml-auto h-4 w-4" />
 38:   </ContextMenuPrimitive.SubTrigger>
 39: ));
 40: ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;
 41: 
 42: const ContextMenuSubContent = React.forwardRef<
 43:   React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
 44:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
 45: >(({ className, ...props }, ref) => (
 46:   <ContextMenuPrimitive.SubContent
 47:     ref={ref}
 48:     className={cn(
 49:       'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md',
 50:       className
 51:     )}
 52:     {...props}
 53:   />
 54: ));
 55: ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;
 56: 
 57: const ContextMenuContent = React.forwardRef<
 58:   React.ElementRef<typeof ContextMenuPrimitive.Content>,
 59:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
 60: >(({ className, ...props }, ref) => (
 61:   <ContextMenuPrimitive.Portal>
 62:     <ContextMenuPrimitive.Content
 63:       ref={ref}
 64:       className={cn(
 65:         'bg-popover text-popover-foreground animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md',
 66:         className
 67:       )}
 68:       {...props}
 69:     />
 70:   </ContextMenuPrimitive.Portal>
 71: ));
 72: ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;
 73: 
 74: const ContextMenuItem = React.forwardRef<
 75:   React.ElementRef<typeof ContextMenuPrimitive.Item>,
 76:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
 77:     inset?: boolean;
 78:   }
 79: >(({ className, inset, ...props }, ref) => (
 80:   <ContextMenuPrimitive.Item
 81:     ref={ref}
 82:     className={cn(
 83:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
 84:       inset && 'pl-8',
 85:       className
 86:     )}
 87:     {...props}
 88:   />
 89: ));
 90: ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;
 91: 
 92: const ContextMenuCheckboxItem = React.forwardRef<
 93:   React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
 94:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
 95: >(({ className, children, checked, ...props }, ref) => (
 96:   <ContextMenuPrimitive.CheckboxItem
 97:     ref={ref}
 98:     className={cn(
 99:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
100:       className
101:     )}
102:     checked={checked}
103:     {...props}
104:   >
105:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
106:       <ContextMenuPrimitive.ItemIndicator>
107:         <Check className="h-4 w-4" />
108:       </ContextMenuPrimitive.ItemIndicator>
109:     </span>
110:     {children}
111:   </ContextMenuPrimitive.CheckboxItem>
112: ));
113: ContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;
114: 
115: const ContextMenuRadioItem = React.forwardRef<
116:   React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
117:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
118: >(({ className, children, ...props }, ref) => (
119:   <ContextMenuPrimitive.RadioItem
120:     ref={ref}
121:     className={cn(
122:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
123:       className
124:     )}
125:     {...props}
126:   >
127:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
128:       <ContextMenuPrimitive.ItemIndicator>
129:         <Circle className="h-2 w-2 fill-current" />
130:       </ContextMenuPrimitive.ItemIndicator>
131:     </span>
132:     {children}
133:   </ContextMenuPrimitive.RadioItem>
134: ));
135: ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;
136: 
137: const ContextMenuLabel = React.forwardRef<
138:   React.ElementRef<typeof ContextMenuPrimitive.Label>,
139:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
140:     inset?: boolean;
141:   }
142: >(({ className, inset, ...props }, ref) => (
143:   <ContextMenuPrimitive.Label
144:     ref={ref}
145:     className={cn('text-foreground px-2 py-1.5 text-sm font-semibold', inset && 'pl-8', className)}
146:     {...props}
147:   />
148: ));
149: ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;
150: 
151: const ContextMenuSeparator = React.forwardRef<
152:   React.ElementRef<typeof ContextMenuPrimitive.Separator>,
153:   React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
154: >(({ className, ...props }, ref) => (
155:   <ContextMenuPrimitive.Separator
156:     ref={ref}
157:     className={cn('bg-border -mx-1 my-1 h-px', className)}
158:     {...props}
159:   />
160: ));
161: ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;
162: 
163: const ContextMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => (
164:   <span
165:     className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
166:     {...props}
167:   />
168: );
169: ContextMenuShortcut.displayName = 'ContextMenuShortcut';
170: 
171: export {
172:   ContextMenu,
173:   ContextMenuTrigger,
174:   ContextMenuContent,
175:   ContextMenuItem,
176:   ContextMenuCheckboxItem,
177:   ContextMenuRadioItem,
178:   ContextMenuLabel,
179:   ContextMenuSeparator,
180:   ContextMenuShortcut,
181:   ContextMenuGroup,
182:   ContextMenuPortal,
183:   ContextMenuSub,
184:   ContextMenuSubContent,
185:   ContextMenuSubTrigger,
186:   ContextMenuRadioGroup,
187: };
```

## File: packages/ui/src/components/dialog.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as DialogPrimitive from '@radix-ui/react-dialog';
  5: import { X } from 'lucide-react';
  6: 
  7: import { cn } from '@/lib/utils';
  8: 
  9: const Dialog = DialogPrimitive.Root;
 10: 
 11: const DialogTrigger = DialogPrimitive.Trigger;
 12: 
 13: const DialogPortal = DialogPrimitive.Portal;
 14: 
 15: const DialogClose = DialogPrimitive.Close;
 16: 
 17: const DialogOverlay = React.forwardRef<
 18:   React.ElementRef<typeof DialogPrimitive.Overlay>,
 19:   React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
 20: >(({ className, ...props }, ref) => (
 21:   <DialogPrimitive.Overlay
 22:     ref={ref}
 23:     className={cn(
 24:       'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80',
 25:       className
 26:     )}
 27:     {...props}
 28:   />
 29: ));
 30: DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;
 31: 
 32: const DialogContent = React.forwardRef<
 33:   React.ElementRef<typeof DialogPrimitive.Content>,
 34:   React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
 35: >(({ className, children, ...props }, ref) => (
 36:   <DialogPortal>
 37:     <DialogOverlay />
 38:     <DialogPrimitive.Content
 39:       ref={ref}
 40:       className={cn(
 41:         'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border p-6 shadow-lg duration-200 sm:rounded-lg',
 42:         className
 43:       )}
 44:       {...props}
 45:     >
 46:       {children}
 47:       <DialogPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none">
 48:         <X className="h-4 w-4" />
 49:         <span className="sr-only">Close</span>
 50:       </DialogPrimitive.Close>
 51:     </DialogPrimitive.Content>
 52:   </DialogPortal>
 53: ));
 54: DialogContent.displayName = DialogPrimitive.Content.displayName;
 55: 
 56: const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 57:   <div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)} {...props} />
 58: );
 59: DialogHeader.displayName = 'DialogHeader';
 60: 
 61: const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
 62:   <div
 63:     className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
 64:     {...props}
 65:   />
 66: );
 67: DialogFooter.displayName = 'DialogFooter';
 68: 
 69: const DialogTitle = React.forwardRef<
 70:   React.ElementRef<typeof DialogPrimitive.Title>,
 71:   React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
 72: >(({ className, ...props }, ref) => (
 73:   <DialogPrimitive.Title
 74:     ref={ref}
 75:     className={cn('text-lg font-semibold leading-none tracking-tight', className)}
 76:     {...props}
 77:   />
 78: ));
 79: DialogTitle.displayName = DialogPrimitive.Title.displayName;
 80: 
 81: const DialogDescription = React.forwardRef<
 82:   React.ElementRef<typeof DialogPrimitive.Description>,
 83:   React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
 84: >(({ className, ...props }, ref) => (
 85:   <DialogPrimitive.Description
 86:     ref={ref}
 87:     className={cn('text-muted-foreground text-sm', className)}
 88:     {...props}
 89:   />
 90: ));
 91: DialogDescription.displayName = DialogPrimitive.Description.displayName;
 92: 
 93: export {
 94:   Dialog,
 95:   DialogPortal,
 96:   DialogOverlay,
 97:   DialogClose,
 98:   DialogTrigger,
 99:   DialogContent,
100:   DialogHeader,
101:   DialogFooter,
102:   DialogTitle,
103:   DialogDescription,
104: };
```

## File: packages/ui/src/components/drawer.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import { Drawer as DrawerPrimitive } from "vaul"
  5: 
  6: import { cn } from "@/lib/utils"
  7: 
  8: const Drawer = ({
  9:   shouldScaleBackground = true,
 10:   ...props
 11: }: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
 12:   <DrawerPrimitive.Root
 13:     shouldScaleBackground={shouldScaleBackground}
 14:     {...props}
 15:   />
 16: )
 17: Drawer.displayName = "Drawer"
 18: 
 19: const DrawerTrigger = DrawerPrimitive.Trigger
 20: 
 21: const DrawerPortal = DrawerPrimitive.Portal
 22: 
 23: const DrawerClose = DrawerPrimitive.Close
 24: 
 25: const DrawerOverlay = React.forwardRef<
 26:   React.ElementRef<typeof DrawerPrimitive.Overlay>,
 27:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
 28: >(({ className, ...props }, ref) => (
 29:   <DrawerPrimitive.Overlay
 30:     ref={ref}
 31:     className={cn("fixed inset-0 z-50 bg-black/80", className)}
 32:     {...props}
 33:   />
 34: ))
 35: DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName
 36: 
 37: const DrawerContent = React.forwardRef<
 38:   React.ElementRef<typeof DrawerPrimitive.Content>,
 39:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
 40: >(({ className, children, ...props }, ref) => (
 41:   <DrawerPortal>
 42:     <DrawerOverlay />
 43:     <DrawerPrimitive.Content
 44:       ref={ref}
 45:       className={cn(
 46:         "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
 47:         className
 48:       )}
 49:       {...props}
 50:     >
 51:       <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
 52:       {children}
 53:     </DrawerPrimitive.Content>
 54:   </DrawerPortal>
 55: ))
 56: DrawerContent.displayName = "DrawerContent"
 57: 
 58: const DrawerHeader = ({
 59:   className,
 60:   ...props
 61: }: React.HTMLAttributes<HTMLDivElement>) => (
 62:   <div
 63:     className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
 64:     {...props}
 65:   />
 66: )
 67: DrawerHeader.displayName = "DrawerHeader"
 68: 
 69: const DrawerFooter = ({
 70:   className,
 71:   ...props
 72: }: React.HTMLAttributes<HTMLDivElement>) => (
 73:   <div
 74:     className={cn("mt-auto flex flex-col gap-2 p-4", className)}
 75:     {...props}
 76:   />
 77: )
 78: DrawerFooter.displayName = "DrawerFooter"
 79: 
 80: const DrawerTitle = React.forwardRef<
 81:   React.ElementRef<typeof DrawerPrimitive.Title>,
 82:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
 83: >(({ className, ...props }, ref) => (
 84:   <DrawerPrimitive.Title
 85:     ref={ref}
 86:     className={cn(
 87:       "text-lg font-semibold leading-none tracking-tight",
 88:       className
 89:     )}
 90:     {...props}
 91:   />
 92: ))
 93: DrawerTitle.displayName = DrawerPrimitive.Title.displayName
 94: 
 95: const DrawerDescription = React.forwardRef<
 96:   React.ElementRef<typeof DrawerPrimitive.Description>,
 97:   React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
 98: >(({ className, ...props }, ref) => (
 99:   <DrawerPrimitive.Description
100:     ref={ref}
101:     className={cn("text-sm text-muted-foreground", className)}
102:     {...props}
103:   />
104: ))
105: DrawerDescription.displayName = DrawerPrimitive.Description.displayName
106: 
107: export {
108:   Drawer,
109:   DrawerPortal,
110:   DrawerOverlay,
111:   DrawerTrigger,
112:   DrawerClose,
113:   DrawerContent,
114:   DrawerHeader,
115:   DrawerFooter,
116:   DrawerTitle,
117:   DrawerDescription,
118: }
```

## File: packages/ui/src/components/dropdown-menu.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';
  5: import { Check, ChevronRight, Circle } from 'lucide-react';
  6: 
  7: import { cn } from '@/lib/utils';
  8: 
  9: const DropdownMenu = DropdownMenuPrimitive.Root;
 10: 
 11: const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;
 12: 
 13: const DropdownMenuGroup = DropdownMenuPrimitive.Group;
 14: 
 15: const DropdownMenuPortal = DropdownMenuPrimitive.Portal;
 16: 
 17: const DropdownMenuSub = DropdownMenuPrimitive.Sub;
 18: 
 19: const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;
 20: 
 21: const DropdownMenuSubTrigger = React.forwardRef<
 22:   React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
 23:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
 24:     inset?: boolean;
 25:   }
 26: >(({ className, inset = false, children, ...props }, ref) => (
 27:   <DropdownMenuPrimitive.SubTrigger
 28:     ref={ref}
 29:     className={cn(
 30:       'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none',
 31:       inset && 'pl-8',
 32:       className
 33:     )}
 34:     {...props}
 35:   >
 36:     {children}
 37:     <ChevronRight className="ml-auto h-4 w-4" />
 38:   </DropdownMenuPrimitive.SubTrigger>
 39: ));
 40: DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;
 41: 
 42: const DropdownMenuSubContent = React.forwardRef<
 43:   React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
 44:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
 45: >(({ className, ...props }, ref) => (
 46:   <DropdownMenuPrimitive.SubContent
 47:     ref={ref}
 48:     className={cn(
 49:       'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md',
 50:       className
 51:     )}
 52:     {...props}
 53:   />
 54: ));
 55: DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;
 56: 
 57: const DropdownMenuContent = React.forwardRef<
 58:   React.ElementRef<typeof DropdownMenuPrimitive.Content>,
 59:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
 60: >(({ className, sideOffset = 4, ...props }, ref) => (
 61:   <DropdownMenuPrimitive.Portal>
 62:     <DropdownMenuPrimitive.Content
 63:       ref={ref}
 64:       sideOffset={sideOffset}
 65:       className={cn(
 66:         'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md',
 67:         className
 68:       )}
 69:       {...props}
 70:     />
 71:   </DropdownMenuPrimitive.Portal>
 72: ));
 73: DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;
 74: 
 75: const DropdownMenuItem = React.forwardRef<
 76:   React.ElementRef<typeof DropdownMenuPrimitive.Item>,
 77:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
 78:     inset?: boolean;
 79:   }
 80: >(({ className, inset = false, ...props }, ref) => (
 81:   <DropdownMenuPrimitive.Item
 82:     ref={ref}
 83:     className={cn(
 84:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
 85:       inset && 'pl-8',
 86:       className
 87:     )}
 88:     {...props}
 89:   />
 90: ));
 91: DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;
 92: 
 93: const DropdownMenuCheckboxItem = React.forwardRef<
 94:   React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
 95:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
 96: >(({ className, children, checked, ...props }, ref) => (
 97:   <DropdownMenuPrimitive.CheckboxItem
 98:     ref={ref}
 99:     className={cn(
100:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
101:       className
102:     )}
103:     checked={checked ?? false}
104:     {...props}
105:   >
106:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
107:       <DropdownMenuPrimitive.ItemIndicator>
108:         <Check className="h-4 w-4" />
109:       </DropdownMenuPrimitive.ItemIndicator>
110:     </span>
111:     {children}
112:   </DropdownMenuPrimitive.CheckboxItem>
113: ));
114: DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;
115: 
116: const DropdownMenuRadioItem = React.forwardRef<
117:   React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
118:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
119: >(({ className, children, ...props }, ref) => (
120:   <DropdownMenuPrimitive.RadioItem
121:     ref={ref}
122:     className={cn(
123:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
124:       className
125:     )}
126:     {...props}
127:   >
128:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
129:       <DropdownMenuPrimitive.ItemIndicator>
130:         <Circle className="h-2 w-2 fill-current" />
131:       </DropdownMenuPrimitive.ItemIndicator>
132:     </span>
133:     {children}
134:   </DropdownMenuPrimitive.RadioItem>
135: ));
136: DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;
137: 
138: const DropdownMenuLabel = React.forwardRef<
139:   React.ElementRef<typeof DropdownMenuPrimitive.Label>,
140:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
141:     inset?: boolean;
142:   }
143: >(({ className, inset = false, ...props }, ref) => (
144:   <DropdownMenuPrimitive.Label
145:     ref={ref}
146:     className={cn('px-2 py-1.5 text-sm font-semibold', inset && 'pl-8', className)}
147:     {...props}
148:   />
149: ));
150: DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;
151: 
152: const DropdownMenuSeparator = React.forwardRef<
153:   React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
154:   React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
155: >(({ className, ...props }, ref) => (
156:   <DropdownMenuPrimitive.Separator
157:     ref={ref}
158:     className={cn('bg-border -mx-1 my-1 h-px', className)}
159:     {...props}
160:   />
161: ));
162: DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;
163: 
164: const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
165:   return (
166:     <span
167:       className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
168:       {...props}
169:     />
170:   );
171: };
172: DropdownMenuShortcut.displayName = 'DropdownMenuShortcut';
173: 
174: export {
175:   DropdownMenu,
176:   DropdownMenuTrigger,
177:   DropdownMenuContent,
178:   DropdownMenuItem,
179:   DropdownMenuCheckboxItem,
180:   DropdownMenuRadioItem,
181:   DropdownMenuLabel,
182:   DropdownMenuSeparator,
183:   DropdownMenuShortcut,
184:   DropdownMenuGroup,
185:   DropdownMenuPortal,
186:   DropdownMenuSub,
187:   DropdownMenuSubContent,
188:   DropdownMenuSubTrigger,
189:   DropdownMenuRadioGroup,
190: };
```

## File: packages/ui/src/components/form.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import type * as LabelPrimitive from '@radix-ui/react-label';
 5: import type { ControllerProps, FieldPath, FieldValues } from 'react-hook-form';
 6: import { Controller } from 'react-hook-form';
 7: 
 8: import { cn } from '@/lib/utils';
 9: import { Label } from '@/components/label';
10: 
11: const Form = React.forwardRef<HTMLFormElement, React.ComponentProps<'form'>>(
12:   ({ className, ...props }, ref) => (
13:     <form ref={ref} className={cn('space-y-8', className)} {...props} />
14:   )
15: );
16: Form.displayName = 'Form';
17: 
18: const FormField = <
19:   TFieldValues extends FieldValues = FieldValues,
20:   TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
21: >({
22:   ...props
23: }: ControllerProps<TFieldValues, TName>) => {
24:   return <Controller {...props} />;
25: };
26: 
27: const FormItem = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(
28:   ({ className, ...props }, ref) => (
29:     <div ref={ref} className={cn('space-y-2', className)} {...props} />
30:   )
31: );
32: FormItem.displayName = 'FormItem';
33: 
34: const FormLabel = React.forwardRef<
35:   React.ElementRef<typeof LabelPrimitive.Root>,
36:   React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
37: >(({ className, ...props }, ref) => <Label ref={ref} className={cn('', className)} {...props} />);
38: FormLabel.displayName = 'FormLabel';
39: 
40: const FormControl = React.forwardRef<HTMLDivElement, React.ComponentPropsWithoutRef<'div'>>(
41:   ({ ...props }, ref) => <div ref={ref} className="mt-2" {...props} />
42: );
43: FormControl.displayName = 'FormControl';
44: 
45: const FormDescription = React.forwardRef<HTMLParagraphElement, React.ComponentPropsWithoutRef<'p'>>(
46:   ({ className, ...props }, ref) => (
47:     <p ref={ref} className={cn('text-muted-foreground text-sm', className)} {...props} />
48:   )
49: );
50: FormDescription.displayName = 'FormDescription';
51: 
52: const FormMessage = React.forwardRef<HTMLParagraphElement, React.ComponentPropsWithoutRef<'p'>>(
53:   ({ className, children, ...props }, ref) => (
54:     <p ref={ref} className={cn('text-destructive text-sm font-medium', className)} {...props}>
55:       {children}
56:     </p>
57:   )
58: );
59: FormMessage.displayName = 'FormMessage';
60: 
61: export { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage };
```

## File: packages/ui/src/components/hover-card.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import type { JSX } from 'react';
 5: import * as HoverCardPrimitive from '@radix-ui/react-hover-card';
 6: 
 7: import { cn } from '../lib/utils';
 8: 
 9: const HoverCard = HoverCardPrimitive.Root;
10: 
11: const HoverCardTrigger = HoverCardPrimitive.Trigger;
12: 
13: const HoverCardContent = React.forwardRef<
14:   React.ElementRef<typeof HoverCardPrimitive.Content>,
15:   React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
16: >(
17:   ({ className, align = 'center', sideOffset = 4, ...props }, ref): JSX.Element => (
18:     <HoverCardPrimitive.Content
19:       ref={ref}
20:       align={align}
21:       sideOffset={sideOffset}
22:       className={cn(
23:         'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 rounded-md border p-4 shadow-md outline-none',
24:         className
25:       )}
26:       {...props}
27:     />
28:   )
29: );
30: HoverCardContent.displayName = HoverCardPrimitive.Content.displayName;
31: 
32: export { HoverCard, HoverCardTrigger, HoverCardContent };
```

## File: packages/ui/src/components/input-otp.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import { OTPInput, OTPInputContext } from "input-otp"
 5: import { Dot } from "lucide-react"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const InputOTP = React.forwardRef<
10:   React.ElementRef<typeof OTPInput>,
11:   React.ComponentPropsWithoutRef<typeof OTPInput>
12: >(({ className, containerClassName, ...props }, ref) => (
13:   <OTPInput
14:     ref={ref}
15:     containerClassName={cn(
16:       "flex items-center gap-2 has-[:disabled]:opacity-50",
17:       containerClassName
18:     )}
19:     className={cn("disabled:cursor-not-allowed", className)}
20:     {...props}
21:   />
22: ))
23: InputOTP.displayName = "InputOTP"
24: 
25: const InputOTPGroup = React.forwardRef<
26:   React.ElementRef<"div">,
27:   React.ComponentPropsWithoutRef<"div">
28: >(({ className, ...props }, ref) => (
29:   <div ref={ref} className={cn("flex items-center", className)} {...props} />
30: ))
31: InputOTPGroup.displayName = "InputOTPGroup"
32: 
33: const InputOTPSlot = React.forwardRef<
34:   React.ElementRef<"div">,
35:   React.ComponentPropsWithoutRef<"div"> & { index: number }
36: >(({ index, className, ...props }, ref) => {
37:   const inputOTPContext = React.useContext(OTPInputContext)
38:   const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]
39: 
40:   return (
41:     <div
42:       ref={ref}
43:       className={cn(
44:         "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
45:         isActive && "z-10 ring-2 ring-ring ring-offset-background",
46:         className
47:       )}
48:       {...props}
49:     >
50:       {char}
51:       {hasFakeCaret && (
52:         <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
53:           <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
54:         </div>
55:       )}
56:     </div>
57:   )
58: })
59: InputOTPSlot.displayName = "InputOTPSlot"
60: 
61: const InputOTPSeparator = React.forwardRef<
62:   React.ElementRef<"div">,
63:   React.ComponentPropsWithoutRef<"div">
64: >(({ ...props }, ref) => (
65:   <div ref={ref} role="separator" {...props}>
66:     <Dot />
67:   </div>
68: ))
69: InputOTPSeparator.displayName = "InputOTPSeparator"
70: 
71: export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }
```

## File: packages/ui/src/components/input.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: 
 5: import { cn } from '@/lib/utils';
 6: 
 7: const Input = React.forwardRef<HTMLInputElement, React.InputHTMLAttributes<HTMLInputElement>>(
 8:   ({ className, type = 'text', ...props }, ref) => (
 9:     <input
10:       type={type}
11:       className={cn(
12:         'border-input placeholder:text-muted-foreground focus-visible:ring-ring flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 disabled:cursor-not-allowed disabled:opacity-50',
13:         className
14:       )}
15:       ref={ref}
16:       {...props}
17:     />
18:   )
19: );
20: Input.displayName = 'Input';
21: 
22: export { Input };
```

## File: packages/ui/src/components/label.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import type { JSX } from 'react';
 5: import * as LabelPrimitive from '@radix-ui/react-label';
 6: import { cva, type VariantProps } from 'class-variance-authority';
 7: 
 8: import { cn } from '../lib/utils';
 9: 
10: const labelVariants = cva(
11:   'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'
12: );
13: 
14: export interface LabelProps
15:   extends React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>,
16:     VariantProps<typeof labelVariants> {}
17: 
18: const Label = React.forwardRef<React.ElementRef<typeof LabelPrimitive.Root>, LabelProps>(
19:   ({ className, ...props }, ref): JSX.Element => (
20:     <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />
21:   )
22: );
23: Label.displayName = LabelPrimitive.Root.displayName;
24: 
25: export { Label };
```

## File: packages/ui/src/components/loading-spinner.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import { cn } from '../lib/utils';
 5: 
 6: interface LoadingSpinnerProps extends React.HTMLAttributes<HTMLDivElement> {
 7:   size?: 'sm' | 'md' | 'lg';
 8: }
 9: 
10: export function LoadingSpinner({ size = 'md', className, ...props }: LoadingSpinnerProps) {
11:   const sizeClasses = {
12:     sm: 'h-4 w-4',
13:     md: 'h-8 w-8',
14:     lg: 'h-12 w-12',
15:   };
16: 
17:   return (
18:     <div className={cn('flex items-center justify-center', className)} {...props}>
19:       <div className={cn('border-primary animate-spin rounded-full border-t-2', sizeClasses[size])}>
20:         <span className="sr-only">Loading...</span>
21:       </div>
22:     </div>
23:   );
24: }
```

## File: packages/ui/src/components/menubar.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as MenubarPrimitive from '@radix-ui/react-menubar';
  5: import { Check, ChevronRight, Circle } from 'lucide-react';
  6: 
  7: import { cn } from '../lib/utils';
  8: 
  9: const MenubarMenu = MenubarPrimitive.Menu;
 10: 
 11: const MenubarGroup = MenubarPrimitive.Group;
 12: 
 13: const MenubarPortal = MenubarPrimitive.Portal;
 14: 
 15: const MenubarSub = MenubarPrimitive.Sub;
 16: 
 17: const MenubarRadioGroup = MenubarPrimitive.RadioGroup;
 18: 
 19: const Menubar = React.forwardRef<
 20:   React.ElementRef<typeof MenubarPrimitive.Root>,
 21:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
 22: >(
 23:   ({ className, ...props }, ref): JSX.Element => (
 24:     <MenubarPrimitive.Root
 25:       ref={ref}
 26:       className={cn(
 27:         'bg-background flex h-10 items-center space-x-1 rounded-md border p-1',
 28:         className
 29:       )}
 30:       {...props}
 31:     />
 32:   )
 33: );
 34: Menubar.displayName = MenubarPrimitive.Root.displayName;
 35: 
 36: const MenubarTrigger = React.forwardRef<
 37:   React.ElementRef<typeof MenubarPrimitive.Trigger>,
 38:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
 39: >(({ className, ...props }, ref) => (
 40:   <MenubarPrimitive.Trigger
 41:     ref={ref}
 42:     className={cn(
 43:       'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none',
 44:       className
 45:     )}
 46:     {...props}
 47:   />
 48: ));
 49: MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;
 50: 
 51: const MenubarSubTrigger = React.forwardRef<
 52:   React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
 53:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
 54:     inset?: boolean;
 55:   }
 56: >(({ className, inset, children, ...props }, ref) => (
 57:   <MenubarPrimitive.SubTrigger
 58:     ref={ref}
 59:     className={cn(
 60:       'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none',
 61:       inset && 'pl-8',
 62:       className
 63:     )}
 64:     {...props}
 65:   >
 66:     {children}
 67:     <ChevronRight className="ml-auto h-4 w-4" />
 68:   </MenubarPrimitive.SubTrigger>
 69: ));
 70: MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;
 71: 
 72: const MenubarSubContent = React.forwardRef<
 73:   React.ElementRef<typeof MenubarPrimitive.SubContent>,
 74:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
 75: >(({ className, ...props }, ref) => (
 76:   <MenubarPrimitive.SubContent
 77:     ref={ref}
 78:     className={cn(
 79:       'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1',
 80:       className
 81:     )}
 82:     {...props}
 83:   />
 84: ));
 85: MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;
 86: 
 87: const MenubarContent = React.forwardRef<
 88:   React.ElementRef<typeof MenubarPrimitive.Content>,
 89:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
 90: >(({ className, align = 'start', alignOffset = -4, sideOffset = 8, ...props }, ref) => (
 91:   <MenubarPrimitive.Portal>
 92:     <MenubarPrimitive.Content
 93:       ref={ref}
 94:       align={align}
 95:       alignOffset={alignOffset}
 96:       sideOffset={sideOffset}
 97:       className={cn(
 98:         'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] overflow-hidden rounded-md border p-1 shadow-md',
 99:         className
100:       )}
101:       {...props}
102:     />
103:   </MenubarPrimitive.Portal>
104: ));
105: MenubarContent.displayName = MenubarPrimitive.Content.displayName;
106: 
107: const MenubarItem = React.forwardRef<
108:   React.ElementRef<typeof MenubarPrimitive.Item>,
109:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
110:     inset?: boolean;
111:   }
112: >(({ className, inset, ...props }, ref) => (
113:   <MenubarPrimitive.Item
114:     ref={ref}
115:     className={cn(
116:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
117:       inset && 'pl-8',
118:       className
119:     )}
120:     {...props}
121:   />
122: ));
123: MenubarItem.displayName = MenubarPrimitive.Item.displayName;
124: 
125: const MenubarCheckboxItem = React.forwardRef<
126:   React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
127:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
128: >(({ className, children, checked, ...props }, ref) => (
129:   <MenubarPrimitive.CheckboxItem
130:     ref={ref}
131:     className={cn(
132:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
133:       className
134:     )}
135:     checked={checked}
136:     {...props}
137:   >
138:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
139:       <MenubarPrimitive.ItemIndicator>
140:         <Check className="h-4 w-4" />
141:       </MenubarPrimitive.ItemIndicator>
142:     </span>
143:     {children}
144:   </MenubarPrimitive.CheckboxItem>
145: ));
146: MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;
147: 
148: const MenubarRadioItem = React.forwardRef<
149:   React.ElementRef<typeof MenubarPrimitive.RadioItem>,
150:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
151: >(({ className, children, ...props }, ref) => (
152:   <MenubarPrimitive.RadioItem
153:     ref={ref}
154:     className={cn(
155:       'focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
156:       className
157:     )}
158:     {...props}
159:   >
160:     <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
161:       <MenubarPrimitive.ItemIndicator>
162:         <Circle className="h-2 w-2 fill-current" />
163:       </MenubarPrimitive.ItemIndicator>
164:     </span>
165:     {children}
166:   </MenubarPrimitive.RadioItem>
167: ));
168: MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;
169: 
170: const MenubarLabel = React.forwardRef<
171:   React.ElementRef<typeof MenubarPrimitive.Label>,
172:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
173:     inset?: boolean;
174:   }
175: >(({ className, inset, ...props }, ref) => (
176:   <MenubarPrimitive.Label
177:     ref={ref}
178:     className={cn('px-2 py-1.5 text-sm font-semibold', inset && 'pl-8', className)}
179:     {...props}
180:   />
181: ));
182: MenubarLabel.displayName = MenubarPrimitive.Label.displayName;
183: 
184: const MenubarSeparator = React.forwardRef<
185:   React.ElementRef<typeof MenubarPrimitive.Separator>,
186:   React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
187: >(({ className, ...props }, ref) => (
188:   <MenubarPrimitive.Separator
189:     ref={ref}
190:     className={cn('bg-muted -mx-1 my-1 h-px', className)}
191:     {...props}
192:   />
193: ));
194: MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;
195: 
196: const MenubarShortcut = ({
197:   className,
198:   ...props
199: }: React.HTMLAttributes<HTMLSpanElement>): JSX.Element => {
200:   return (
201:     <span
202:       className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
203:       {...props}
204:     />
205:   );
206: };
207: MenubarShortcut.displayName = 'MenubarShortcut';
208: 
209: export {
210:   Menubar,
211:   MenubarMenu,
212:   MenubarTrigger,
213:   MenubarContent,
214:   MenubarItem,
215:   MenubarSeparator,
216:   MenubarLabel,
217:   MenubarCheckboxItem,
218:   MenubarRadioGroup,
219:   MenubarRadioItem,
220:   MenubarPortal,
221:   MenubarSubContent,
222:   MenubarSubTrigger,
223:   MenubarGroup,
224:   MenubarSub,
225:   MenubarShortcut,
226: };
```

## File: packages/ui/src/components/navigation-menu.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as NavigationMenuPrimitive from '@radix-ui/react-navigation-menu';
  5: import { cva } from 'class-variance-authority';
  6: import { ChevronDown } from 'lucide-react';
  7: 
  8: import { cn } from '../lib/utils';
  9: 
 10: const NavigationMenu = React.forwardRef<
 11:   React.ElementRef<typeof NavigationMenuPrimitive.Root>,
 12:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
 13: >(
 14:   ({ className, children, ...props }, ref): JSX.Element => (
 15:     <NavigationMenuPrimitive.Root
 16:       ref={ref}
 17:       className={cn('relative z-10 flex max-w-max flex-1 items-center justify-center', className)}
 18:       {...props}
 19:     >
 20:       {children}
 21:       <NavigationMenuViewport />
 22:     </NavigationMenuPrimitive.Root>
 23:   )
 24: );
 25: NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;
 26: 
 27: const NavigationMenuList = React.forwardRef<
 28:   React.ElementRef<typeof NavigationMenuPrimitive.List>,
 29:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
 30: >(
 31:   ({ className, ...props }, ref): JSX.Element => (
 32:     <NavigationMenuPrimitive.List
 33:       ref={ref}
 34:       className={cn('group flex flex-1 list-none items-center justify-center space-x-1', className)}
 35:       {...props}
 36:     />
 37:   )
 38: );
 39: NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;
 40: 
 41: const NavigationMenuItem = NavigationMenuPrimitive.Item;
 42: 
 43: const navigationMenuTriggerStyle = cva(
 44:   'group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50'
 45: );
 46: 
 47: const NavigationMenuTrigger = React.forwardRef<
 48:   React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
 49:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
 50: >(
 51:   ({ className, children, ...props }, ref): JSX.Element => (
 52:     <NavigationMenuPrimitive.Trigger
 53:       ref={ref}
 54:       className={cn(navigationMenuTriggerStyle(), 'group', className)}
 55:       {...props}
 56:     >
 57:       {children}{' '}
 58:       <ChevronDown
 59:         className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
 60:         aria-hidden="true"
 61:       />
 62:     </NavigationMenuPrimitive.Trigger>
 63:   )
 64: );
 65: NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;
 66: 
 67: const NavigationMenuContent = React.forwardRef<
 68:   React.ElementRef<typeof NavigationMenuPrimitive.Content>,
 69:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
 70: >(
 71:   ({ className, ...props }, ref): JSX.Element => (
 72:     <NavigationMenuPrimitive.Content
 73:       ref={ref}
 74:       className={cn(
 75:         'data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 left-0 top-0 w-full md:absolute md:w-auto',
 76:         className
 77:       )}
 78:       {...props}
 79:     />
 80:   )
 81: );
 82: NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;
 83: 
 84: const NavigationMenuLink = NavigationMenuPrimitive.Link;
 85: 
 86: const NavigationMenuViewport = React.forwardRef<
 87:   React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
 88:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
 89: >(
 90:   ({ className, ...props }, ref): JSX.Element => (
 91:     <div className={cn('absolute left-0 top-full flex justify-center')}>
 92:       <NavigationMenuPrimitive.Viewport
 93:         className={cn(
 94:           'origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow-lg md:w-[var(--radix-navigation-menu-viewport-width)]',
 95:           className
 96:         )}
 97:         ref={ref}
 98:         {...props}
 99:       />
100:     </div>
101:   )
102: );
103: NavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;
104: 
105: const NavigationMenuIndicator = React.forwardRef<
106:   React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
107:   React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
108: >(
109:   ({ className, ...props }, ref): JSX.Element => (
110:     <NavigationMenuPrimitive.Indicator
111:       ref={ref}
112:       className={cn(
113:         'data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden',
114:         className
115:       )}
116:       {...props}
117:     >
118:       <div className="bg-border relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm shadow-md" />
119:     </NavigationMenuPrimitive.Indicator>
120:   )
121: );
122: NavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;
123: 
124: export {
125:   navigationMenuTriggerStyle,
126:   NavigationMenu,
127:   NavigationMenuList,
128:   NavigationMenuItem,
129:   NavigationMenuContent,
130:   NavigationMenuTrigger,
131:   NavigationMenuLink,
132:   NavigationMenuIndicator,
133:   NavigationMenuViewport,
134: };
```

## File: packages/ui/src/components/pagination.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import { ChevronLeft, ChevronRight, MoreHorizontal } from 'lucide-react';
  5: 
  6: import { cn } from '@/lib/utils';
  7: import { type ButtonProps, buttonVariants } from '@/components/button';
  8: 
  9: const Pagination = ({ className, ...props }: React.ComponentProps<'nav'>) => (
 10:   <nav
 11:     role="navigation"
 12:     aria-label="pagination"
 13:     className={cn('mx-auto flex w-full justify-center', className)}
 14:     {...props}
 15:   />
 16: );
 17: Pagination.displayName = 'Pagination';
 18: 
 19: const PaginationContent = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(
 20:   ({ className, ...props }, ref) => (
 21:     <ul ref={ref} className={cn('flex flex-row items-center gap-1', className)} {...props} />
 22:   )
 23: );
 24: PaginationContent.displayName = 'PaginationContent';
 25: 
 26: const PaginationItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(
 27:   ({ className, ...props }, ref) => <li ref={ref} className={cn('', className)} {...props} />
 28: );
 29: PaginationItem.displayName = 'PaginationItem';
 30: 
 31: type PaginationLinkProps = {
 32:   isActive?: boolean;
 33: } & Pick<ButtonProps, 'size'> &
 34:   React.ComponentProps<'a'>;
 35: 
 36: const PaginationLink = ({
 37:   className,
 38:   isActive = false,
 39:   size = 'icon',
 40:   ...props
 41: }: PaginationLinkProps) => (
 42:   <a
 43:     aria-current={isActive ? 'page' : undefined}
 44:     className={cn(
 45:       buttonVariants({
 46:         variant: isActive ? 'outline' : 'ghost',
 47:         size,
 48:       }),
 49:       className
 50:     )}
 51:     {...props}
 52:   />
 53: );
 54: PaginationLink.displayName = 'PaginationLink';
 55: 
 56: const PaginationPrevious = ({
 57:   className,
 58:   ...props
 59: }: React.ComponentProps<typeof PaginationLink>) => (
 60:   <PaginationLink
 61:     aria-label="Go to previous page"
 62:     size="default"
 63:     className={cn('gap-1 pl-2.5', className)}
 64:     {...props}
 65:   >
 66:     <ChevronLeft className="h-4 w-4" />
 67:     <span>Previous</span>
 68:   </PaginationLink>
 69: );
 70: PaginationPrevious.displayName = 'PaginationPrevious';
 71: 
 72: const PaginationNext = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
 73:   <PaginationLink
 74:     aria-label="Go to next page"
 75:     size="default"
 76:     className={cn('gap-1 pr-2.5', className)}
 77:     {...props}
 78:   >
 79:     <span>Next</span>
 80:     <ChevronRight className="h-4 w-4" />
 81:   </PaginationLink>
 82: );
 83: PaginationNext.displayName = 'PaginationNext';
 84: 
 85: const PaginationEllipsis = ({ className, ...props }: React.ComponentProps<'span'>) => (
 86:   <span
 87:     aria-hidden
 88:     className={cn('flex h-9 w-9 items-center justify-center', className)}
 89:     {...props}
 90:   >
 91:     <MoreHorizontal className="h-4 w-4" />
 92:     <span className="sr-only">More pages</span>
 93:   </span>
 94: );
 95: PaginationEllipsis.displayName = 'PaginationEllipsis';
 96: 
 97: export {
 98:   Pagination,
 99:   PaginationContent,
100:   PaginationEllipsis,
101:   PaginationItem,
102:   PaginationLink,
103:   PaginationNext,
104:   PaginationPrevious,
105: };
```

## File: packages/ui/src/components/popover.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import * as PopoverPrimitive from '@radix-ui/react-popover';
 5: 
 6: import { cn } from '../lib/utils';
 7: 
 8: const Popover = PopoverPrimitive.Root;
 9: const PopoverTrigger = PopoverPrimitive.Trigger;
10: 
11: interface PopoverContentProps
12:   extends React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content> {
13:   className?: string;
14:   align?: 'start' | 'center' | 'end';
15:   sideOffset?: number;
16: }
17: 
18: const PopoverContent = React.forwardRef<
19:   React.ElementRef<typeof PopoverPrimitive.Content>,
20:   PopoverContentProps
21: >(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
22:   <PopoverPrimitive.Portal>
23:     <PopoverPrimitive.Content
24:       ref={ref}
25:       align={align}
26:       sideOffset={sideOffset}
27:       className={cn(
28:         'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-none',
29:         className
30:       )}
31:       {...props}
32:     />
33:   </PopoverPrimitive.Portal>
34: ));
35: 
36: PopoverContent.displayName = PopoverPrimitive.Content.displayName;
37: 
38: export { Popover, PopoverTrigger, PopoverContent };
```

## File: packages/ui/src/components/progress.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import * as ProgressPrimitive from '@radix-ui/react-progress';
 5: 
 6: import { cn } from '@/lib/utils';
 7: 
 8: const Progress = React.forwardRef<
 9:   React.ElementRef<typeof ProgressPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
11: >(({ className, value = 0, ...props }, ref) => (
12:   <ProgressPrimitive.Root
13:     ref={ref}
14:     className={cn('bg-primary/20 relative h-2 w-full overflow-hidden rounded-full', className)}
15:     {...props}
16:   >
17:     <ProgressPrimitive.Indicator
18:       className="bg-primary h-full w-full flex-1 transition-all"
19:       style={{ transform: `translateX(-${100 - (value ?? 0)}%)` }}
20:     />
21:   </ProgressPrimitive.Root>
22: ));
23: Progress.displayName = ProgressPrimitive.Root.displayName;
24: 
25: export { Progress };
```

## File: packages/ui/src/components/radio-group.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import * as RadioGroupPrimitive from '@radix-ui/react-radio-group';
 5: import { Circle } from 'lucide-react';
 6: 
 7: import { cn } from '../lib/utils';
 8: 
 9: interface RadioGroupProps extends React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root> {
10:   className?: string;
11: }
12: 
13: const RadioGroup = React.forwardRef<
14:   React.ElementRef<typeof RadioGroupPrimitive.Root>,
15:   RadioGroupProps
16: >(
17:   ({ className, ...props }, ref): JSX.Element => (
18:     <RadioGroupPrimitive.Root className={cn('grid gap-2', className)} {...props} ref={ref} />
19:   )
20: );
21: 
22: RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;
23: 
24: interface RadioGroupItemProps
25:   extends React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item> {
26:   className?: string;
27: }
28: 
29: const RadioGroupItem = React.forwardRef<
30:   React.ElementRef<typeof RadioGroupPrimitive.Item>,
31:   RadioGroupItemProps
32: >(
33:   ({ className, ...props }, ref): JSX.Element => (
34:     <RadioGroupPrimitive.Item
35:       ref={ref}
36:       className={cn(
37:         'border-primary text-primary ring-offset-background focus-visible:ring-ring aspect-square h-4 w-4 rounded-full border focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
38:         className
39:       )}
40:       {...props}
41:     >
42:       <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
43:         <Circle className="h-2.5 w-2.5 fill-current text-current" />
44:       </RadioGroupPrimitive.Indicator>
45:     </RadioGroupPrimitive.Item>
46:   )
47: );
48: 
49: RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;
50: 
51: export { RadioGroup, RadioGroupItem };
```

## File: packages/ui/src/components/resizable.tsx
```typescript
 1: "use client"
 2: 
 3: import { GripVertical } from "lucide-react"
 4: import * as ResizablePrimitive from "react-resizable-panels"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const ResizablePanelGroup = ({
 9:   className,
10:   ...props
11: }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
12:   <ResizablePrimitive.PanelGroup
13:     className={cn(
14:       "flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
15:       className
16:     )}
17:     {...props}
18:   />
19: )
20: 
21: const ResizablePanel = ResizablePrimitive.Panel
22: 
23: const ResizableHandle = ({
24:   withHandle,
25:   className,
26:   ...props
27: }: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
28:   withHandle?: boolean
29: }) => (
30:   <ResizablePrimitive.PanelResizeHandle
31:     className={cn(
32:       "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
33:       className
34:     )}
35:     {...props}
36:   >
37:     {withHandle && (
38:       <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
39:         <GripVertical className="h-2.5 w-2.5" />
40:       </div>
41:     )}
42:   </ResizablePrimitive.PanelResizeHandle>
43: )
44: 
45: export { ResizablePanelGroup, ResizablePanel, ResizableHandle }
```

## File: packages/ui/src/components/scroll-area.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area';
 5: 
 6: import { cn } from '../lib/utils';
 7: 
 8: interface ScrollAreaProps extends React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root> {
 9:   className?: string;
10:   children: React.ReactNode;
11: }
12: 
13: const ScrollArea = React.forwardRef<
14:   React.ElementRef<typeof ScrollAreaPrimitive.Root>,
15:   ScrollAreaProps
16: >(
17:   ({ className, children, ...props }, ref): JSX.Element => (
18:     <ScrollAreaPrimitive.Root
19:       ref={ref}
20:       className={cn('relative overflow-hidden', className)}
21:       {...props}
22:     >
23:       <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
24:         {children}
25:       </ScrollAreaPrimitive.Viewport>
26:       <ScrollBar />
27:       <ScrollAreaPrimitive.Corner />
28:     </ScrollAreaPrimitive.Root>
29:   )
30: );
31: 
32: ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;
33: 
34: interface ScrollBarProps
35:   extends React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar> {
36:   className?: string;
37:   orientation?: 'vertical' | 'horizontal';
38: }
39: 
40: const ScrollBar = React.forwardRef<
41:   React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
42:   ScrollBarProps
43: >(
44:   ({ className, orientation = 'vertical', ...props }, ref): JSX.Element => (
45:     <ScrollAreaPrimitive.ScrollAreaScrollbar
46:       ref={ref}
47:       orientation={orientation}
48:       className={cn(
49:         'flex touch-none select-none transition-colors',
50:         orientation === 'vertical' && 'h-full w-2.5 border-l border-l-transparent p-[1px]',
51:         orientation === 'horizontal' && 'h-2.5 flex-col border-t border-t-transparent p-[1px]',
52:         className
53:       )}
54:       {...props}
55:     >
56:       <ScrollAreaPrimitive.ScrollAreaThumb className="bg-border relative flex-1 rounded-full" />
57:     </ScrollAreaPrimitive.ScrollAreaScrollbar>
58:   )
59: );
60: 
61: ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;
62: 
63: export { ScrollArea, ScrollBar };
```

## File: packages/ui/src/components/select.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as SelectPrimitive from '@radix-ui/react-select';
  5: import { Check, ChevronDown, ChevronUp } from 'lucide-react';
  6: 
  7: import { cn } from '../lib/utils';
  8: 
  9: const Select = SelectPrimitive.Root;
 10: 
 11: const SelectGroup = SelectPrimitive.Group;
 12: 
 13: const SelectValue = SelectPrimitive.Value;
 14: 
 15: interface SelectTriggerProps
 16:   extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger> {
 17:   className?: string;
 18:   children: React.ReactNode;
 19: }
 20: 
 21: const SelectTrigger = React.forwardRef<
 22:   React.ElementRef<typeof SelectPrimitive.Trigger>,
 23:   SelectTriggerProps
 24: >(
 25:   ({ className, children, ...props }, ref): JSX.Element => (
 26:     <SelectPrimitive.Trigger
 27:       ref={ref}
 28:       className={cn(
 29:         'border-input bg-background ring-offset-background placeholder:text-muted-foreground focus:ring-ring flex h-10 w-full items-center justify-between rounded-md border px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
 30:         className
 31:       )}
 32:       {...props}
 33:     >
 34:       {children}
 35:       <SelectPrimitive.Icon asChild>
 36:         <ChevronDown className="h-4 w-4 opacity-50" />
 37:       </SelectPrimitive.Icon>
 38:     </SelectPrimitive.Trigger>
 39:   )
 40: );
 41: 
 42: SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;
 43: 
 44: interface SelectScrollUpButtonProps
 45:   extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton> {
 46:   className?: string;
 47: }
 48: 
 49: const SelectScrollUpButton = React.forwardRef<
 50:   React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
 51:   SelectScrollUpButtonProps
 52: >(
 53:   ({ className, ...props }, ref): JSX.Element => (
 54:     <SelectPrimitive.ScrollUpButton
 55:       ref={ref}
 56:       className={cn('flex cursor-default items-center justify-center py-1', className)}
 57:       {...props}
 58:     >
 59:       <ChevronUp className="h-4 w-4" />
 60:     </SelectPrimitive.ScrollUpButton>
 61:   )
 62: );
 63: 
 64: SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;
 65: 
 66: interface SelectScrollDownButtonProps
 67:   extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton> {
 68:   className?: string;
 69: }
 70: 
 71: const SelectScrollDownButton = React.forwardRef<
 72:   React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
 73:   SelectScrollDownButtonProps
 74: >(
 75:   ({ className, ...props }, ref): JSX.Element => (
 76:     <SelectPrimitive.ScrollDownButton
 77:       ref={ref}
 78:       className={cn('flex cursor-default items-center justify-center py-1', className)}
 79:       {...props}
 80:     >
 81:       <ChevronDown className="h-4 w-4" />
 82:     </SelectPrimitive.ScrollDownButton>
 83:   )
 84: );
 85: 
 86: SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;
 87: 
 88: interface SelectContentProps
 89:   extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content> {
 90:   className?: string;
 91:   children: React.ReactNode;
 92:   position?: 'popper' | 'item-aligned';
 93: }
 94: 
 95: const SelectContent = React.forwardRef<
 96:   React.ElementRef<typeof SelectPrimitive.Content>,
 97:   SelectContentProps
 98: >(
 99:   ({ className, children, position = 'popper', ...props }, ref): JSX.Element => (
100:     <SelectPrimitive.Portal>
101:       <SelectPrimitive.Content
102:         ref={ref}
103:         className={cn(
104:           'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md',
105:           position === 'popper' &&
106:             'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
107:           className
108:         )}
109:         position={position}
110:         {...props}
111:       >
112:         <SelectScrollUpButton />
113:         <SelectPrimitive.Viewport
114:           className={cn(
115:             'p-1',
116:             position === 'popper' &&
117:               'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]'
118:           )}
119:         >
120:           {children}
121:         </SelectPrimitive.Viewport>
122:         <SelectScrollDownButton />
123:       </SelectPrimitive.Content>
124:     </SelectPrimitive.Portal>
125:   )
126: );
127: 
128: SelectContent.displayName = SelectPrimitive.Content.displayName;
129: 
130: interface SelectLabelProps extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label> {
131:   className?: string;
132: }
133: 
134: const SelectLabel = React.forwardRef<
135:   React.ElementRef<typeof SelectPrimitive.Label>,
136:   SelectLabelProps
137: >(
138:   ({ className, ...props }, ref): JSX.Element => (
139:     <SelectPrimitive.Label
140:       ref={ref}
141:       className={cn('py-1.5 pl-8 pr-2 text-sm font-semibold', className)}
142:       {...props}
143:     />
144:   )
145: );
146: 
147: SelectLabel.displayName = SelectPrimitive.Label.displayName;
148: 
149: interface SelectItemProps extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item> {
150:   className?: string;
151:   children: React.ReactNode;
152: }
153: 
154: const SelectItem = React.forwardRef<React.ElementRef<typeof SelectPrimitive.Item>, SelectItemProps>(
155:   ({ className, children, ...props }, ref): JSX.Element => (
156:     <SelectPrimitive.Item
157:       ref={ref}
158:       className={cn(
159:         'focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
160:         className
161:       )}
162:       {...props}
163:     >
164:       <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
165:         <SelectPrimitive.ItemIndicator>
166:           <Check className="h-4 w-4" />
167:         </SelectPrimitive.ItemIndicator>
168:       </span>
169: 
170:       <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
171:     </SelectPrimitive.Item>
172:   )
173: );
174: 
175: SelectItem.displayName = SelectPrimitive.Item.displayName;
176: 
177: interface SelectSeparatorProps
178:   extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator> {
179:   className?: string;
180: }
181: 
182: const SelectSeparator = React.forwardRef<
183:   React.ElementRef<typeof SelectPrimitive.Separator>,
184:   SelectSeparatorProps
185: >(
186:   ({ className, ...props }, ref): JSX.Element => (
187:     <SelectPrimitive.Separator
188:       ref={ref}
189:       className={cn('bg-muted -mx-1 my-1 h-px', className)}
190:       {...props}
191:     />
192:   )
193: );
194: 
195: SelectSeparator.displayName = SelectPrimitive.Separator.displayName;
196: 
197: export {
198:   Select,
199:   SelectGroup,
200:   SelectValue,
201:   SelectTrigger,
202:   SelectContent,
203:   SelectLabel,
204:   SelectItem,
205:   SelectSeparator,
206:   SelectScrollUpButton,
207:   SelectScrollDownButton,
208: };
```

## File: packages/ui/src/components/separator.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as SeparatorPrimitive from "@radix-ui/react-separator"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Separator = React.forwardRef<
 9:   React.ElementRef<typeof SeparatorPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
11: >(
12:   (
13:     { className, orientation = "horizontal", decorative = true, ...props },
14:     ref
15:   ) => (
16:     <SeparatorPrimitive.Root
17:       ref={ref}
18:       decorative={decorative}
19:       orientation={orientation}
20:       className={cn(
21:         "shrink-0 bg-border",
22:         orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
23:         className
24:       )}
25:       {...props}
26:     />
27:   )
28: )
29: Separator.displayName = SeparatorPrimitive.Root.displayName
30: 
31: export { Separator }
```

## File: packages/ui/src/components/sheet.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import * as SheetPrimitive from '@radix-ui/react-dialog';
  5: import { cva, type VariantProps } from 'class-variance-authority';
  6: import { X } from 'lucide-react';
  7: 
  8: import { cn } from '@/lib/utils';
  9: 
 10: const Sheet = SheetPrimitive.Root;
 11: 
 12: const SheetTrigger = SheetPrimitive.Trigger;
 13: 
 14: const SheetClose = SheetPrimitive.Close;
 15: 
 16: const SheetPortal = SheetPrimitive.Portal;
 17: 
 18: interface SheetOverlayProps extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay> {
 19:   className?: string;
 20: }
 21: 
 22: const SheetOverlay = React.forwardRef<
 23:   React.ElementRef<typeof SheetPrimitive.Overlay>,
 24:   SheetOverlayProps
 25: >(
 26:   ({ className, ...props }, ref): JSX.Element => (
 27:     <SheetPrimitive.Overlay
 28:       className={cn(
 29:         'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80',
 30:         className
 31:       )}
 32:       {...props}
 33:       ref={ref}
 34:     />
 35:   )
 36: );
 37: SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;
 38: 
 39: const sheetVariants = cva(
 40:   'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
 41:   {
 42:     variants: {
 43:       side: {
 44:         top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
 45:         bottom:
 46:           'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
 47:         left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
 48:         right:
 49:           'inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
 50:       },
 51:     },
 52:     defaultVariants: {
 53:       side: 'right',
 54:     },
 55:   }
 56: );
 57: 
 58: interface SheetContentProps
 59:   extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
 60:     VariantProps<typeof sheetVariants> {
 61:   className?: string;
 62: }
 63: 
 64: const SheetContent = React.forwardRef<
 65:   React.ElementRef<typeof SheetPrimitive.Content>,
 66:   SheetContentProps
 67: >(
 68:   ({ side = 'right', className, children, ...props }, ref): JSX.Element => (
 69:     <SheetPortal>
 70:       <SheetOverlay />
 71:       <SheetPrimitive.Content
 72:         ref={ref}
 73:         className={cn(sheetVariants({ side }), className)}
 74:         {...props}
 75:       >
 76:         {children}
 77:         <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none">
 78:           <X className="h-4 w-4" />
 79:           <span className="sr-only">Close</span>
 80:         </SheetPrimitive.Close>
 81:       </SheetPrimitive.Content>
 82:     </SheetPortal>
 83:   )
 84: );
 85: SheetContent.displayName = SheetPrimitive.Content.displayName;
 86: 
 87: interface SheetHeaderProps extends React.HTMLAttributes<HTMLDivElement> {
 88:   className?: string;
 89: }
 90: 
 91: const SheetHeader = ({ className, ...props }: SheetHeaderProps): JSX.Element => (
 92:   <div className={cn('flex flex-col space-y-2 text-center sm:text-left', className)} {...props} />
 93: );
 94: SheetHeader.displayName = 'SheetHeader';
 95: 
 96: interface SheetFooterProps extends React.HTMLAttributes<HTMLDivElement> {
 97:   className?: string;
 98: }
 99: 
100: const SheetFooter = ({ className, ...props }: SheetFooterProps): JSX.Element => (
101:   <div
102:     className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}
103:     {...props}
104:   />
105: );
106: SheetFooter.displayName = 'SheetFooter';
107: 
108: interface SheetTitleProps extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title> {
109:   className?: string;
110: }
111: 
112: const SheetTitle = React.forwardRef<React.ElementRef<typeof SheetPrimitive.Title>, SheetTitleProps>(
113:   ({ className, ...props }, ref): JSX.Element => (
114:     <SheetPrimitive.Title
115:       ref={ref}
116:       className={cn('text-foreground text-lg font-semibold', className)}
117:       {...props}
118:     />
119:   )
120: );
121: SheetTitle.displayName = SheetPrimitive.Title.displayName;
122: 
123: interface SheetDescriptionProps
124:   extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description> {
125:   className?: string;
126: }
127: 
128: const SheetDescription = React.forwardRef<
129:   React.ElementRef<typeof SheetPrimitive.Description>,
130:   SheetDescriptionProps
131: >(
132:   ({ className, ...props }, ref): JSX.Element => (
133:     <SheetPrimitive.Description
134:       ref={ref}
135:       className={cn('text-muted-foreground text-sm', className)}
136:       {...props}
137:     />
138:   )
139: );
140: SheetDescription.displayName = SheetPrimitive.Description.displayName;
141: 
142: export {
143:   Sheet,
144:   SheetPortal,
145:   SheetOverlay,
146:   SheetTrigger,
147:   SheetClose,
148:   SheetContent,
149:   SheetHeader,
150:   SheetFooter,
151:   SheetTitle,
152:   SheetDescription,
153: };
```

## File: packages/ui/src/components/sidebar.tsx
```typescript
  1: 'use client';
  2: 
  3: import * as React from 'react';
  4: import { ChevronDown, ChevronRight } from 'lucide-react';
  5: 
  6: import { cn } from '@/lib/utils';
  7: 
  8: type SidebarContextValue = {
  9:   expanded: boolean;
 10:   setExpanded: (expanded: boolean) => void;
 11:   toggleExpanded: () => void;
 12: };
 13: 
 14: const SidebarContext = React.createContext<SidebarContextValue | null>(null);
 15: 
 16: const useSidebar = () => {
 17:   const context = React.useContext(SidebarContext);
 18:   if (context === null) {
 19:     throw new Error('useSidebar must be used within a SidebarProvider');
 20:   }
 21:   return context;
 22: };
 23: 
 24: const SidebarProvider = ({ children }: { children: React.ReactNode }) => {
 25:   const [expanded, setExpanded] = React.useState(true);
 26:   const toggleExpanded = () => setExpanded(!expanded);
 27: 
 28:   return (
 29:     <SidebarContext.Provider value={{ expanded, setExpanded, toggleExpanded }}>
 30:       {children}
 31:     </SidebarContext.Provider>
 32:   );
 33: };
 34: 
 35: const Sidebar = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
 36:   ({ className, children, ...props }, ref) => {
 37:     const { expanded } = useSidebar();
 38: 
 39:     return (
 40:       <div
 41:         ref={ref}
 42:         className={cn(
 43:           'flex h-screen w-64 flex-col overflow-hidden transition-all duration-300',
 44:           expanded ? 'translate-x-0' : '-translate-x-full',
 45:           className
 46:         )}
 47:         {...props}
 48:       >
 49:         {children}
 50:       </div>
 51:     );
 52:   }
 53: );
 54: Sidebar.displayName = 'Sidebar';
 55: 
 56: const SidebarSection = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
 57:   ({ className, children, ...props }, ref) => (
 58:     <div ref={ref} className={cn('flex flex-col space-y-4 p-4', className)} {...props}>
 59:       {children}
 60:     </div>
 61:   )
 62: );
 63: SidebarSection.displayName = 'SidebarSection';
 64: 
 65: const SidebarItem = React.forwardRef<
 66:   HTMLDivElement,
 67:   React.HTMLAttributes<HTMLDivElement> & {
 68:     icon?: React.ComponentType<{ className?: string }>;
 69:     active?: boolean;
 70:   }
 71: >(({ className, children, icon: Icon, active = false, ...props }, ref) => (
 72:   <div
 73:     ref={ref}
 74:     className={cn(
 75:       'hover:bg-accent hover:text-accent-foreground flex cursor-pointer items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors',
 76:       { 'bg-accent text-accent-foreground': active },
 77:       className
 78:     )}
 79:     {...props}
 80:   >
 81:     {Icon && <Icon className="h-4 w-4" />}
 82:     <span>{children}</span>
 83:   </div>
 84: ));
 85: SidebarItem.displayName = 'SidebarItem';
 86: 
 87: const SidebarGroup = React.forwardRef<
 88:   HTMLDivElement,
 89:   React.HTMLAttributes<HTMLDivElement> & {
 90:     title: string;
 91:     icon?: React.ComponentType<{ className?: string }>;
 92:     defaultExpanded?: boolean;
 93:   }
 94: >(({ className, children, title, icon: Icon, defaultExpanded = false, ...props }, ref) => {
 95:   const [expanded, setExpanded] = React.useState(defaultExpanded);
 96:   const toggleExpanded = () => setExpanded(!expanded);
 97: 
 98:   return (
 99:     <div ref={ref} className={cn('space-y-1', className)} {...props}>
100:       <div
101:         className="hover:bg-accent hover:text-accent-foreground flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium transition-colors"
102:         onClick={toggleExpanded}
103:       >
104:         <div className="flex items-center space-x-2">
105:           {Icon && <Icon className="h-4 w-4" />}
106:           <span>{title}</span>
107:         </div>
108:         {expanded ? <ChevronDown className="h-4 w-4" /> : <ChevronRight className="h-4 w-4" />}
109:       </div>
110:       {expanded && <div className="ml-4 space-y-1 border-l pl-4">{children}</div>}
111:     </div>
112:   );
113: });
114: SidebarGroup.displayName = 'SidebarGroup';
115: 
116: export { Sidebar, SidebarProvider, SidebarSection, SidebarItem, SidebarGroup, useSidebar };
```

## File: packages/ui/src/components/skeleton.tsx
```typescript
 1: import { cn } from "@/lib/utils"
 2: 
 3: function Skeleton({
 4:   className,
 5:   ...props
 6: }: React.HTMLAttributes<HTMLDivElement>) {
 7:   return (
 8:     <div
 9:       className={cn("animate-pulse rounded-md bg-muted", className)}
10:       {...props}
11:     />
12:   )
13: }
14: 
15: export { Skeleton }
```

## File: packages/ui/src/components/slider.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as SliderPrimitive from "@radix-ui/react-slider"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Slider = React.forwardRef<
 9:   React.ElementRef<typeof SliderPrimitive.Root>,
10:   React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
11: >(({ className, ...props }, ref) => (
12:   <SliderPrimitive.Root
13:     ref={ref}
14:     className={cn(
15:       "relative flex w-full touch-none select-none items-center",
16:       className
17:     )}
18:     {...props}
19:   >
20:     <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
21:       <SliderPrimitive.Range className="absolute h-full bg-primary" />
22:     </SliderPrimitive.Track>
23:     <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
24:   </SliderPrimitive.Root>
25: ))
26: Slider.displayName = SliderPrimitive.Root.displayName
27: 
28: export { Slider }
```

## File: packages/ui/src/components/sonner.tsx
```typescript
 1: "use client"
 2: 
 3: import { useTheme } from "next-themes"
 4: import { Toaster as Sonner } from "sonner"
 5: 
 6: type ToasterProps = React.ComponentProps<typeof Sonner>
 7: 
 8: const Toaster = ({ ...props }: ToasterProps) => {
 9:   const { theme = "system" } = useTheme()
10: 
11:   return (
12:     <Sonner
13:       theme={theme as ToasterProps["theme"]}
14:       className="toaster group"
15:       toastOptions={{
16:         classNames: {
17:           toast:
18:             "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
19:           description: "group-[.toast]:text-muted-foreground",
20:           actionButton:
21:             "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
22:           cancelButton:
23:             "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
24:         },
25:       }}
26:       {...props}
27:     />
28:   )
29: }
30: 
31: export { Toaster }
```

## File: packages/ui/src/components/switch.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as SwitchPrimitives from "@radix-ui/react-switch"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Switch = React.forwardRef<
 9:   React.ElementRef<typeof SwitchPrimitives.Root>,
10:   React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
11: >(({ className, ...props }, ref) => (
12:   <SwitchPrimitives.Root
13:     className={cn(
14:       "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
15:       className
16:     )}
17:     {...props}
18:     ref={ref}
19:   >
20:     <SwitchPrimitives.Thumb
21:       className={cn(
22:         "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"
23:       )}
24:     />
25:   </SwitchPrimitives.Root>
26: ))
27: Switch.displayName = SwitchPrimitives.Root.displayName
28: 
29: export { Switch }
```

## File: packages/ui/src/components/table.tsx
```typescript
  1: import * as React from "react"
  2: 
  3: import { cn } from "@/lib/utils"
  4: 
  5: const Table = React.forwardRef<
  6:   HTMLTableElement,
  7:   React.HTMLAttributes<HTMLTableElement>
  8: >(({ className, ...props }, ref) => (
  9:   <div className="relative w-full overflow-auto">
 10:     <table
 11:       ref={ref}
 12:       className={cn("w-full caption-bottom text-sm", className)}
 13:       {...props}
 14:     />
 15:   </div>
 16: ))
 17: Table.displayName = "Table"
 18: 
 19: const TableHeader = React.forwardRef<
 20:   HTMLTableSectionElement,
 21:   React.HTMLAttributes<HTMLTableSectionElement>
 22: >(({ className, ...props }, ref) => (
 23:   <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
 24: ))
 25: TableHeader.displayName = "TableHeader"
 26: 
 27: const TableBody = React.forwardRef<
 28:   HTMLTableSectionElement,
 29:   React.HTMLAttributes<HTMLTableSectionElement>
 30: >(({ className, ...props }, ref) => (
 31:   <tbody
 32:     ref={ref}
 33:     className={cn("[&_tr:last-child]:border-0", className)}
 34:     {...props}
 35:   />
 36: ))
 37: TableBody.displayName = "TableBody"
 38: 
 39: const TableFooter = React.forwardRef<
 40:   HTMLTableSectionElement,
 41:   React.HTMLAttributes<HTMLTableSectionElement>
 42: >(({ className, ...props }, ref) => (
 43:   <tfoot
 44:     ref={ref}
 45:     className={cn(
 46:       "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
 47:       className
 48:     )}
 49:     {...props}
 50:   />
 51: ))
 52: TableFooter.displayName = "TableFooter"
 53: 
 54: const TableRow = React.forwardRef<
 55:   HTMLTableRowElement,
 56:   React.HTMLAttributes<HTMLTableRowElement>
 57: >(({ className, ...props }, ref) => (
 58:   <tr
 59:     ref={ref}
 60:     className={cn(
 61:       "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
 62:       className
 63:     )}
 64:     {...props}
 65:   />
 66: ))
 67: TableRow.displayName = "TableRow"
 68: 
 69: const TableHead = React.forwardRef<
 70:   HTMLTableCellElement,
 71:   React.ThHTMLAttributes<HTMLTableCellElement>
 72: >(({ className, ...props }, ref) => (
 73:   <th
 74:     ref={ref}
 75:     className={cn(
 76:       "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
 77:       className
 78:     )}
 79:     {...props}
 80:   />
 81: ))
 82: TableHead.displayName = "TableHead"
 83: 
 84: const TableCell = React.forwardRef<
 85:   HTMLTableCellElement,
 86:   React.TdHTMLAttributes<HTMLTableCellElement>
 87: >(({ className, ...props }, ref) => (
 88:   <td
 89:     ref={ref}
 90:     className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
 91:     {...props}
 92:   />
 93: ))
 94: TableCell.displayName = "TableCell"
 95: 
 96: const TableCaption = React.forwardRef<
 97:   HTMLTableCaptionElement,
 98:   React.HTMLAttributes<HTMLTableCaptionElement>
 99: >(({ className, ...props }, ref) => (
100:   <caption
101:     ref={ref}
102:     className={cn("mt-4 text-sm text-muted-foreground", className)}
103:     {...props}
104:   />
105: ))
106: TableCaption.displayName = "TableCaption"
107: 
108: export {
109:   Table,
110:   TableHeader,
111:   TableBody,
112:   TableFooter,
113:   TableHead,
114:   TableRow,
115:   TableCell,
116:   TableCaption,
117: }
```

## File: packages/ui/src/components/tabs.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as TabsPrimitive from "@radix-ui/react-tabs"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const Tabs = TabsPrimitive.Root
 9: 
10: const TabsList = React.forwardRef<
11:   React.ElementRef<typeof TabsPrimitive.List>,
12:   React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
13: >(({ className, ...props }, ref) => (
14:   <TabsPrimitive.List
15:     ref={ref}
16:     className={cn(
17:       "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
18:       className
19:     )}
20:     {...props}
21:   />
22: ))
23: TabsList.displayName = TabsPrimitive.List.displayName
24: 
25: const TabsTrigger = React.forwardRef<
26:   React.ElementRef<typeof TabsPrimitive.Trigger>,
27:   React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
28: >(({ className, ...props }, ref) => (
29:   <TabsPrimitive.Trigger
30:     ref={ref}
31:     className={cn(
32:       "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
33:       className
34:     )}
35:     {...props}
36:   />
37: ))
38: TabsTrigger.displayName = TabsPrimitive.Trigger.displayName
39: 
40: const TabsContent = React.forwardRef<
41:   React.ElementRef<typeof TabsPrimitive.Content>,
42:   React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
43: >(({ className, ...props }, ref) => (
44:   <TabsPrimitive.Content
45:     ref={ref}
46:     className={cn(
47:       "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
48:       className
49:     )}
50:     {...props}
51:   />
52: ))
53: TabsContent.displayName = TabsPrimitive.Content.displayName
54: 
55: export { Tabs, TabsList, TabsTrigger, TabsContent }
```

## File: packages/ui/src/components/textarea.tsx
```typescript
 1: import * as React from "react"
 2: 
 3: import { cn } from "@/lib/utils"
 4: 
 5: const Textarea = React.forwardRef<
 6:   HTMLTextAreaElement,
 7:   React.ComponentProps<"textarea">
 8: >(({ className, ...props }, ref) => {
 9:   return (
10:     <textarea
11:       className={cn(
12:         "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
13:         className
14:       )}
15:       ref={ref}
16:       {...props}
17:     />
18:   )
19: })
20: Textarea.displayName = "Textarea"
21: 
22: export { Textarea }
```

## File: packages/ui/src/components/toast.tsx
```typescript
  1: "use client"
  2: 
  3: import * as React from "react"
  4: import * as ToastPrimitives from "@radix-ui/react-toast"
  5: import { cva, type VariantProps } from "class-variance-authority"
  6: import { X } from "lucide-react"
  7: 
  8: import { cn } from "@/lib/utils"
  9: 
 10: const ToastProvider = ToastPrimitives.Provider
 11: 
 12: const ToastViewport = React.forwardRef<
 13:   React.ElementRef<typeof ToastPrimitives.Viewport>,
 14:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
 15: >(({ className, ...props }, ref) => (
 16:   <ToastPrimitives.Viewport
 17:     ref={ref}
 18:     className={cn(
 19:       "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
 20:       className
 21:     )}
 22:     {...props}
 23:   />
 24: ))
 25: ToastViewport.displayName = ToastPrimitives.Viewport.displayName
 26: 
 27: const toastVariants = cva(
 28:   "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
 29:   {
 30:     variants: {
 31:       variant: {
 32:         default: "border bg-background text-foreground",
 33:         destructive:
 34:           "destructive group border-destructive bg-destructive text-destructive-foreground",
 35:       },
 36:     },
 37:     defaultVariants: {
 38:       variant: "default",
 39:     },
 40:   }
 41: )
 42: 
 43: const Toast = React.forwardRef<
 44:   React.ElementRef<typeof ToastPrimitives.Root>,
 45:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
 46:     VariantProps<typeof toastVariants>
 47: >(({ className, variant, ...props }, ref) => {
 48:   return (
 49:     <ToastPrimitives.Root
 50:       ref={ref}
 51:       className={cn(toastVariants({ variant }), className)}
 52:       {...props}
 53:     />
 54:   )
 55: })
 56: Toast.displayName = ToastPrimitives.Root.displayName
 57: 
 58: const ToastAction = React.forwardRef<
 59:   React.ElementRef<typeof ToastPrimitives.Action>,
 60:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
 61: >(({ className, ...props }, ref) => (
 62:   <ToastPrimitives.Action
 63:     ref={ref}
 64:     className={cn(
 65:       "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
 66:       className
 67:     )}
 68:     {...props}
 69:   />
 70: ))
 71: ToastAction.displayName = ToastPrimitives.Action.displayName
 72: 
 73: const ToastClose = React.forwardRef<
 74:   React.ElementRef<typeof ToastPrimitives.Close>,
 75:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
 76: >(({ className, ...props }, ref) => (
 77:   <ToastPrimitives.Close
 78:     ref={ref}
 79:     className={cn(
 80:       "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
 81:       className
 82:     )}
 83:     toast-close=""
 84:     {...props}
 85:   >
 86:     <X className="h-4 w-4" />
 87:   </ToastPrimitives.Close>
 88: ))
 89: ToastClose.displayName = ToastPrimitives.Close.displayName
 90: 
 91: const ToastTitle = React.forwardRef<
 92:   React.ElementRef<typeof ToastPrimitives.Title>,
 93:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
 94: >(({ className, ...props }, ref) => (
 95:   <ToastPrimitives.Title
 96:     ref={ref}
 97:     className={cn("text-sm font-semibold", className)}
 98:     {...props}
 99:   />
100: ))
101: ToastTitle.displayName = ToastPrimitives.Title.displayName
102: 
103: const ToastDescription = React.forwardRef<
104:   React.ElementRef<typeof ToastPrimitives.Description>,
105:   React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
106: >(({ className, ...props }, ref) => (
107:   <ToastPrimitives.Description
108:     ref={ref}
109:     className={cn("text-sm opacity-90", className)}
110:     {...props}
111:   />
112: ))
113: ToastDescription.displayName = ToastPrimitives.Description.displayName
114: 
115: type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>
116: 
117: type ToastActionElement = React.ReactElement<typeof ToastAction>
118: 
119: export {
120:   type ToastProps,
121:   type ToastActionElement,
122:   ToastProvider,
123:   ToastViewport,
124:   Toast,
125:   ToastTitle,
126:   ToastDescription,
127:   ToastClose,
128:   ToastAction,
129: }
```

## File: packages/ui/src/components/toaster.tsx
```typescript
 1: 'use client';
 2: 
 3: import { Toaster as Sonner } from 'sonner';
 4: 
 5: type ToasterProps = React.ComponentProps<typeof Sonner>;
 6: 
 7: const Toaster = ({ ...props }: ToasterProps) => {
 8:   return (
 9:     <Sonner
10:       className="toaster group"
11:       toastOptions={{
12:         classNames: {
13:           toast:
14:             'group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg',
15:           description: 'group-[.toast]:text-muted-foreground',
16:           actionButton: 'group-[.toast]:bg-primary group-[.toast]:text-primary-foreground',
17:           cancelButton: 'group-[.toast]:bg-muted group-[.toast]:text-muted-foreground',
18:         },
19:       }}
20:       {...props}
21:     />
22:   );
23: };
24: 
25: export { Toaster };
```

## File: packages/ui/src/components/toggle-group.tsx
```typescript
 1: 'use client';
 2: 
 3: import * as React from 'react';
 4: import * as ToggleGroupPrimitive from '@radix-ui/react-toggle-group';
 5: 
 6: import { cn } from '@/lib/utils';
 7: import { toggleVariants } from '@/components/toggle';
 8: 
 9: const ToggleGroupContext = React.createContext<{
10:   size?: 'default' | 'sm' | 'lg';
11:   variant?: 'default' | 'outline';
12: }>({});
13: 
14: const ToggleGroup = React.forwardRef<
15:   React.ElementRef<typeof ToggleGroupPrimitive.Root>,
16:   React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> & {
17:     size?: 'default' | 'sm' | 'lg';
18:     variant?: 'default' | 'outline';
19:   }
20: >(({ className, variant, size, children, ...props }, ref) => (
21:   <ToggleGroupPrimitive.Root
22:     ref={ref}
23:     className={cn('flex items-center justify-center gap-1', className)}
24:     {...props}
25:   >
26:     <ToggleGroupContext.Provider value={{ variant, size }}>{children}</ToggleGroupContext.Provider>
27:   </ToggleGroupPrimitive.Root>
28: ));
29: 
30: ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;
31: 
32: const ToggleGroupItem = React.forwardRef<
33:   React.ElementRef<typeof ToggleGroupPrimitive.Item>,
34:   React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> & {
35:     size?: 'default' | 'sm' | 'lg';
36:     variant?: 'default' | 'outline';
37:   }
38: >(({ className, children, variant, size, ...props }, ref) => {
39:   const context = React.useContext(ToggleGroupContext);
40: 
41:   return (
42:     <ToggleGroupPrimitive.Item
43:       ref={ref}
44:       className={cn(
45:         toggleVariants({
46:           variant: context.variant ?? variant,
47:           size: context.size ?? size,
48:         }),
49:         className
50:       )}
51:       {...props}
52:     >
53:       {children}
54:     </ToggleGroupPrimitive.Item>
55:   );
56: });
57: 
58: ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;
59: 
60: export { ToggleGroup, ToggleGroupItem };
```

## File: packages/ui/src/components/toggle.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as TogglePrimitive from "@radix-ui/react-toggle"
 5: import { cva, type VariantProps } from "class-variance-authority"
 6: 
 7: import { cn } from "@/lib/utils"
 8: 
 9: const toggleVariants = cva(
10:   "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",
11:   {
12:     variants: {
13:       variant: {
14:         default: "bg-transparent",
15:         outline:
16:           "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
17:       },
18:       size: {
19:         default: "h-10 px-3 min-w-10",
20:         sm: "h-9 px-2.5 min-w-9",
21:         lg: "h-11 px-5 min-w-11",
22:       },
23:     },
24:     defaultVariants: {
25:       variant: "default",
26:       size: "default",
27:     },
28:   }
29: )
30: 
31: const Toggle = React.forwardRef<
32:   React.ElementRef<typeof TogglePrimitive.Root>,
33:   React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
34:     VariantProps<typeof toggleVariants>
35: >(({ className, variant, size, ...props }, ref) => (
36:   <TogglePrimitive.Root
37:     ref={ref}
38:     className={cn(toggleVariants({ variant, size, className }))}
39:     {...props}
40:   />
41: ))
42: 
43: Toggle.displayName = TogglePrimitive.Root.displayName
44: 
45: export { Toggle, toggleVariants }
```

## File: packages/ui/src/components/tooltip.tsx
```typescript
 1: "use client"
 2: 
 3: import * as React from "react"
 4: import * as TooltipPrimitive from "@radix-ui/react-tooltip"
 5: 
 6: import { cn } from "@/lib/utils"
 7: 
 8: const TooltipProvider = TooltipPrimitive.Provider
 9: 
10: const Tooltip = TooltipPrimitive.Root
11: 
12: const TooltipTrigger = TooltipPrimitive.Trigger
13: 
14: const TooltipContent = React.forwardRef<
15:   React.ElementRef<typeof TooltipPrimitive.Content>,
16:   React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
17: >(({ className, sideOffset = 4, ...props }, ref) => (
18:   <TooltipPrimitive.Content
19:     ref={ref}
20:     sideOffset={sideOffset}
21:     className={cn(
22:       "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
23:       className
24:     )}
25:     {...props}
26:   />
27: ))
28: TooltipContent.displayName = TooltipPrimitive.Content.displayName
29: 
30: export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }
```

## File: packages/ui/src/hooks/use-mobile.ts
```typescript
 1: "use client"
 2: 
 3: import { useEffect, useState } from "react"
 4: 
 5: export function useMobile() {
 6:   const [isMobile, setIsMobile] = useState(false)
 7: 
 8:   useEffect(() => {
 9:     const checkMobile = () => {
10:       setIsMobile(window.innerWidth < 768)
11:     }
12: 
13:     checkMobile()
14:     window.addEventListener("resize", checkMobile)
15: 
16:     return () => window.removeEventListener("resize", checkMobile)
17:   }, [])
18: 
19:   return isMobile
20: }
```

## File: packages/ui/src/hooks/use-toast.ts
```typescript
1: import { toast } from "sonner"
2: 
3: export { toast }
4: 
5: export function useToast() {
6:   return {
7:     toast,
8:   }
9: }
```

## File: packages/ui/src/lib/utils.ts
```typescript
1: import { clsx, type ClassValue } from "clsx"
2: import { twMerge } from "tailwind-merge"
3: 
4: export function cn(...inputs: ClassValue[]) {
5:   return twMerge(clsx(inputs))
6: }
```

## File: packages/ui/src/styles/fonts.ts
```typescript
 1: // Define CSS variables for fonts
 2: export const fontVariables = {
 3:   '--font-sans': 'Inter, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif',
 4:   '--font-mono': '"JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',
 5: }
 6: 
 7: // Export font class names for direct usage
 8: export const fontClasses = {
 9:   sans: 'font-sans',
10:   mono: 'font-mono',
11: }
```

## File: packages/ui/src/styles/globals.css
```css
 1: @tailwind base;
 2: @tailwind components;
 3: @tailwind utilities;
 4: 
 5: @layer base {
 6:   :root {
 7:     --font-sans: "Inter", system-ui, -apple-system;
 8:     --font-mono: "JetBrains Mono", monospace;
 9: 
10:     --background: 0 0% 100%;
11:     --foreground: 222.2 84% 4.9%;
12: 
13:     --card: 0 0% 100%;
14:     --card-foreground: 222.2 84% 4.9%;
15: 
16:     --popover: 0 0% 100%;
17:     --popover-foreground: 222.2 84% 4.9%;
18: 
19:     --primary: 222.2 47.4% 11.2%;
20:     --primary-foreground: 210 40% 98%;
21: 
22:     --secondary: 210 40% 96.1%;
23:     --secondary-foreground: 222.2 47.4% 11.2%;
24: 
25:     --muted: 210 40% 96.1%;
26:     --muted-foreground: 215.4 16.3% 46.9%;
27: 
28:     --accent: 210 40% 96.1%;
29:     --accent-foreground: 222.2 47.4% 11.2%;
30: 
31:     --destructive: 0 84.2% 60.2%;
32:     --destructive-foreground: 210 40% 98%;
33: 
34:     --border: 214.3 31.8% 91.4%;
35:     --input: 214.3 31.8% 91.4%;
36:     --ring: 222.2 84% 4.9%;
37: 
38:     --radius: 0.5rem;
39:   }
40: 
41:   .dark {
42:     --background: 222.2 84% 4.9%;
43:     --foreground: 210 40% 98%;
44: 
45:     --card: 222.2 84% 4.9%;
46:     --card-foreground: 210 40% 98%;
47: 
48:     --popover: 222.2 84% 4.9%;
49:     --popover-foreground: 210 40% 98%;
50: 
51:     --primary: 210 40% 98%;
52:     --primary-foreground: 222.2 47.4% 11.2%;
53: 
54:     --secondary: 217.2 32.6% 17.5%;
55:     --secondary-foreground: 210 40% 98%;
56: 
57:     --muted: 217.2 32.6% 17.5%;
58:     --muted-foreground: 215 20.2% 65.1%;
59: 
60:     --accent: 217.2 32.6% 17.5%;
61:     --accent-foreground: 210 40% 98%;
62: 
63:     --destructive: 0 62.8% 30.6%;
64:     --destructive-foreground: 210 40% 98%;
65: 
66:     --border: 217.2 32.6% 17.5%;
67:     --input: 217.2 32.6% 17.5%;
68:     --ring: 212.7 26.8% 83.9%;
69:   }
70: 
71:   * {
72:     @apply border-border;
73:   }
74: 
75:   body {
76:     @apply bg-background text-foreground font-sans antialiased;
77:   }
78: 
79:   pre, code {
80:     @apply font-mono;
81:   }
82: }
```

## File: packages/ui/src/button.tsx
```typescript
 1: "use client";
 2: 
 3: import { type ReactNode } from "react";
 4: 
 5: interface ButtonProps {
 6:   children: ReactNode;
 7:   className?: string;
 8:   appName: string;
 9: }
10: 
11: export const Button = ({ children, className, appName }: ButtonProps) => {
12:   return (
13:     <button
14:       className={className}
15:       onClick={() => alert(`Hello from your ${appName} app!`)}
16:     >
17:       {children}
18:     </button>
19:   );
20: };
```

## File: packages/ui/src/card.tsx
```typescript
 1: import { type JSX } from "react";
 2: 
 3: export function Card({
 4:   className,
 5:   title,
 6:   children,
 7:   href,
 8: }: {
 9:   className?: string;
10:   title: string;
11:   children: React.ReactNode;
12:   href: string;
13: }): JSX.Element {
14:   return (
15:     <a
16:       className={className}
17:       href={`${href}?utm_source=create-turbo&utm_medium=basic&utm_campaign=create-turbo"`}
18:       rel="noopener noreferrer"
19:       target="_blank"
20:     >
21:       <h2>
22:         {title} <span>-&gt;</span>
23:       </h2>
24:       <p>{children}</p>
25:     </a>
26:   );
27: }
```

## File: packages/ui/src/code.tsx
```typescript
 1: import { type JSX } from "react";
 2: 
 3: export function Code({
 4:   children,
 5:   className,
 6: }: {
 7:   children: React.ReactNode;
 8:   className?: string;
 9: }): JSX.Element {
10:   return <code className={className}>{children}</code>;
11: }
```

## File: packages/ui/src/index.ts
```typescript
 1: // Components
 2: export * from './components/accordion';
 3: export * from './components/alert';
 4: export * from './components/alert-dialog';
 5: export * from './components/aspect-ratio';
 6: export * from './components/avatar';
 7: export * from './components/badge';
 8: export * from './components/button';
 9: export * from './components/calendar';
10: export * from './components/card';
11: export * from './components/carousel';
12: export * from './components/checkbox';
13: export * from './components/collapsible';
14: export * from './components/command';
15: export * from './components/context-menu';
16: export * from './components/dialog';
17: export * from './components/dropdown-menu';
18: export * from './components/form';
19: export * from './components/hover-card';
20: export * from './components/input';
21: export * from './components/label';
22: export * from './components/menubar';
23: export * from './components/navigation-menu';
24: export * from './components/popover';
25: export * from './components/progress';
26: export * from './components/radio-group';
27: export * from './components/scroll-area';
28: export * from './components/select';
29: export * from './components/separator';
30: export * from './components/sheet';
31: export * from './components/skeleton';
32: export * from './components/slider';
33: export * from './components/switch';
34: export * from './components/table';
35: export * from './components/tabs';
36: export * from './components/textarea';
37: export * from './components/toast';
38: export * from './components/toggle';
39: export * from './components/tooltip';
40: export * from './components/resizable';
41: export * from './components/loading-spinner';
42: export * from './components/toaster';
43: 
44: // Hooks
45: export * from './hooks/use-toast';
46: export * from './hooks/use-mobile';
47: 
48: // Styles
49: export * from './styles/fonts';
50: 
51: // Utils
52: export * from './lib/utils';
53: 
54: // Types
55: export * from './types';
56: export type { ToastActionElement, ToastProps } from './components/toast';
```

## File: packages/ui/src/types.ts
```typescript
 1: import type { ComponentPropsWithoutRef, ElementRef } from 'react';
 2: import type * as RadixTooltip from '@radix-ui/react-tooltip';
 3: import type * as RadixDialog from '@radix-ui/react-dialog';
 4: 
 5: import type { Input } from './components/input';
 6: import type { Separator } from './components/separator';
 7: import type { Sheet } from './components/sheet';
 8: import type { Skeleton } from './components/skeleton';
 9: import type {
10:   Tooltip,
11:   TooltipContent,
12:   TooltipProvider,
13:   TooltipTrigger,
14: } from './components/tooltip';
15: 
16: export type InputElement = ElementRef<typeof Input>;
17: export type InputProps = ComponentPropsWithoutRef<typeof Input>;
18: 
19: export type SeparatorElement = ElementRef<typeof Separator>;
20: export type SeparatorProps = ComponentPropsWithoutRef<typeof Separator>;
21: 
22: export type SheetElement = ElementRef<typeof Sheet>;
23: export type SheetProps = ComponentPropsWithoutRef<typeof Sheet>;
24: 
25: export type SkeletonElement = ElementRef<typeof Skeleton>;
26: export type SkeletonProps = ComponentPropsWithoutRef<typeof Skeleton>;
27: 
28: export type TooltipElement = ElementRef<typeof Tooltip>;
29: export type TooltipProps = ComponentPropsWithoutRef<typeof Tooltip>;
30: 
31: export type TooltipContentElement = ElementRef<typeof TooltipContent>;
32: export type TooltipContentProps = ComponentPropsWithoutRef<typeof TooltipContent>;
33: 
34: export type TooltipProviderElement = ElementRef<typeof TooltipProvider>;
35: export type TooltipProviderProps = ComponentPropsWithoutRef<typeof TooltipProvider>;
36: 
37: export type TooltipTriggerElement = ElementRef<typeof TooltipTrigger>;
38: export type TooltipTriggerProps = ComponentPropsWithoutRef<typeof TooltipTrigger>;
```

## File: packages/ui/turbo/generators/templates/component.hbs
```
1: export const {{ pascalCase name }} = ({ children }: { children: React.ReactNode }) => {
2:   return (
3:     <div>
4:       <h1>{{ pascalCase name }} Component</h1>
5:       {children}
6:     </div>
7:   );
8: };
```

## File: packages/ui/turbo/generators/config.ts
```typescript
 1: import type { PlopTypes } from "@turbo/gen";
 2: 
 3: // Learn more about Turborepo Generators at https://turbo.build/repo/docs/core-concepts/monorepos/code-generation
 4: 
 5: export default function generator(plop: PlopTypes.NodePlopAPI): void {
 6:   // A simple generator to add a new React component to the internal UI library
 7:   plop.setGenerator("react-component", {
 8:     description: "Adds a new react component",
 9:     prompts: [
10:       {
11:         type: "input",
12:         name: "name",
13:         message: "What is the name of the component?",
14:       },
15:     ],
16:     actions: [
17:       {
18:         type: "add",
19:         path: "src/{{kebabCase name}}.tsx",
20:         templateFile: "templates/component.hbs",
21:       },
22:       {
23:         type: "append",
24:         path: "package.json",
25:         pattern: /"exports": {(?<insertion>)/g,
26:         template: '    "./{{kebabCase name}}": "./src/{{kebabCase name}}.tsx",',
27:       },
28:     ],
29:   });
30: }
```

## File: packages/ui/components.json
```json
 1: {
 2:   "$schema": "https://ui.shadcn.com/schema.json",
 3:   "style": "default",
 4:   "rsc": true,
 5:   "tsx": true,
 6:   "tailwind": {
 7:     "config": "tailwind.config.js",
 8:     "css": "src/styles/globals.css",
 9:     "baseColor": "slate",
10:     "cssVariables": true
11:   },
12:   "iconLibrary": "lucide",
13:   "aliases": {
14:     "components": "@danky/ui/components",
15:     "utils": "@danky/ui/lib/utils",
16:     "hooks": "@danky/ui/hooks",
17:     "lib": "@danky/ui/lib",
18:     "ui": "@danky/ui/components"
19:   }
20: }
```

## File: packages/ui/eslint.config.js
```javascript
1: import { reactInternalConfig } from '@danky/eslint-config';
2: 
3: export default reactInternalConfig;
```

## File: packages/ui/package.json
```json
 1: {
 2:   "name": "@danky/ui",
 3:   "version": "0.1.0",
 4:   "private": true,
 5:   "type": "module",
 6:   "main": "./dist/index.js",
 7:   "module": "./dist/index.js",
 8:   "types": "./dist/index.d.ts",
 9:   "files": [
10:     "dist/**"
11:   ],
12:   "scripts": {
13:     "build": "tsup",
14:     "dev": "tsup --watch",
15:     "lint": "eslint .",
16:     "type-check": "tsc --noEmit",
17:     "clean": "rimraf .turbo node_modules dist"
18:   },
19:   "peerDependencies": {
20:     "react": "^19.0.0",
21:     "react-dom": "^19.0.0",
22:     "date-fns": "^4.1.0"
23:   },
24:   "dependencies": {
25:     "@radix-ui/react-accordion": "^1.1.2",
26:     "@radix-ui/react-alert-dialog": "^1.0.5",
27:     "@radix-ui/react-aspect-ratio": "^1.0.3",
28:     "@radix-ui/react-avatar": "^1.0.4",
29:     "@radix-ui/react-checkbox": "^1.0.4",
30:     "@radix-ui/react-collapsible": "^1.0.3",
31:     "@radix-ui/react-context-menu": "^2.1.5",
32:     "@radix-ui/react-dialog": "^1.0.5",
33:     "@radix-ui/react-dropdown-menu": "^2.0.6",
34:     "@radix-ui/react-hover-card": "^1.0.7",
35:     "@radix-ui/react-label": "^2.0.2",
36:     "@radix-ui/react-menubar": "^1.0.4",
37:     "@radix-ui/react-navigation-menu": "^1.1.4",
38:     "@radix-ui/react-popover": "^1.0.7",
39:     "@radix-ui/react-progress": "^1.0.3",
40:     "@radix-ui/react-radio-group": "^1.1.3",
41:     "@radix-ui/react-scroll-area": "^1.0.5",
42:     "@radix-ui/react-select": "^2.0.0",
43:     "@radix-ui/react-separator": "^1.0.3",
44:     "@radix-ui/react-slider": "^1.1.2",
45:     "@radix-ui/react-slot": "^1.0.2",
46:     "@radix-ui/react-switch": "^1.0.3",
47:     "@radix-ui/react-tabs": "^1.0.4",
48:     "@radix-ui/react-toast": "^1.1.5",
49:     "@radix-ui/react-toggle": "^1.0.3",
50:     "@radix-ui/react-tooltip": "^1.0.7",
51:     "class-variance-authority": "^0.7.0",
52:     "embla-carousel-react": "^8.0.0",
53:     "react-day-picker": "^8.10.0",
54:     "react-resizable-panels": "^2.0.9"
55:   },
56:   "devDependencies": {
57:     "@danky/eslint-config": "workspace:*",
58:     "@danky/typescript-config": "workspace:*",
59:     "@types/react": "^19.0.4",
60:     "@types/react-dom": "^19.0.2",
61:     "autoprefixer": "^10.4.17",
62:     "eslint": "^8.56.0",
63:     "postcss": "^8.4.35",
64:     "rimraf": "^5.0.5",
65:     "tailwindcss": "^3.4.1",
66:     "tsup": "^8.0.2",
67:     "typescript": "^5.3.3"
68:   }
69: }
```

## File: packages/ui/README.md
```markdown
  1: # @danky/ui
  2: 
  3: Shared UI components for the Danky AI Chatbot platform, built with shadcn/ui and Tailwind CSS.
  4: 
  5: ## Overview
  6: 
  7: The UI package provides a collection of reusable, accessible, and customizable components that follow our design system. It's built on top of shadcn/ui and uses Tailwind CSS for styling.
  8: 
  9: ## Directory Structure
 10: 
 11: ```
 12: src/
 13: ├── components/       # UI components
 14: │   ├── ui/          # Base components (shadcn)
 15: │   └── custom/      # Custom components
 16: ├── hooks/           # Shared hooks
 17: ├── styles/          # Global styles
 18: │   └── globals.css  # Global CSS
 19: ├── lib/             # Utilities
 20: │   └── utils.ts     # Helper functions
 21: └── types/           # TypeScript types
 22: ```
 23: 
 24: ## Key Features
 25: 
 26: - **Accessibility**: ARIA compliant components
 27: - **Theme Support**: Dark/light mode
 28: - **Type Safety**: Full TypeScript coverage
 29: - **Customization**: Tailwind CSS + CSS variables
 30: - **Documentation**: Component stories
 31: - **Testing**: Unit and integration tests
 32: 
 33: ## Usage
 34: 
 35: ### Installation
 36: 
 37: ```bash
 38: pnpm add @danky/ui
 39: ```
 40: 
 41: ### Basic Usage
 42: 
 43: ```typescript
 44: import { Button } from '@danky/ui'
 45: 
 46: export function MyComponent() {
 47:   return (
 48:     <Button variant="primary">
 49:       Click me
 50:     </Button>
 51:   )
 52: }
 53: ```
 54: 
 55: ### Theme Setup
 56: 
 57: ```typescript
 58: import '@danky/ui/styles/globals.css'
 59: 
 60: export function RootLayout({ children }) {
 61:   return (
 62:     <html lang="en" suppressHydrationWarning>
 63:       <body className="min-h-screen bg-background">
 64:         {children}
 65:       </body>
 66:     </html>
 67:   )
 68: }
 69: ```
 70: 
 71: ## AI Development Notes
 72: 
 73: ### Key Concepts
 74: 
 75: 1. **Component Architecture**
 76:    - Base components from shadcn/ui
 77:    - Custom components extend base
 78:    - Composition over inheritance
 79:    - Props for customization
 80: 
 81: 2. **Styling System**
 82:    - Tailwind CSS classes
 83:    - CSS variables for theming
 84:    - Component variants
 85:    - Responsive design
 86: 
 87: 3. **Type System**
 88:    - Props interfaces
 89:    - Variant types
 90:    - Event handlers
 91:    - Ref forwarding
 92: 
 93: ### Common Patterns
 94: 
 95: #### Component Structure
 96: ```typescript
 97: import * as React from 'react'
 98: import { cn } from '../lib/utils'
 99: 
100: interface Props extends React.ComponentPropsWithoutRef<'div'> {
101:   variant?: 'default' | 'primary'
102: }
103: 
104: export const Component = React.forwardRef<HTMLDivElement, Props>(
105:   ({ className, variant = 'default', ...props }, ref) => {
106:     return (
107:       <div
108:         ref={ref}
109:         className={cn(
110:           'base-styles',
111:           variant === 'primary' && 'primary-styles',
112:           className
113:         )}
114:         {...props}
115:       />
116:     )
117:   }
118: )
119: Component.displayName = 'Component'
120: ```
121: 
122: #### Hook Pattern
123: ```typescript
124: import { useState, useCallback } from 'react'
125: 
126: export function useComponent() {
127:   const [state, setState] = useState(false)
128: 
129:   const toggle = useCallback(() => {
130:     setState(prev => !prev)
131:   }, [])
132: 
133:   return { state, toggle }
134: }
135: ```
136: 
137: #### Theme Variants
138: ```typescript
139: import { cva } from 'class-variance-authority'
140: 
141: export const componentVariants = cva(
142:   'base-styles',
143:   {
144:     variants: {
145:       variant: {
146:         default: 'default-styles',
147:         primary: 'primary-styles',
148:       },
149:       size: {
150:         sm: 'small-styles',
151:         md: 'medium-styles',
152:         lg: 'large-styles',
153:       },
154:     },
155:     defaultVariants: {
156:       variant: 'default',
157:       size: 'md',
158:     },
159:   }
160: )
161: ```
162: 
163: ## Component Library
164: 
165: ### Base Components
166: - Button
167: - Input
168: - Select
169: - Checkbox
170: - Radio
171: - Switch
172: - Textarea
173: - Dialog
174: - Popover
175: - Tooltip
176: - Tabs
177: - Card
178: - Badge
179: 
180: ### Custom Components
181: - MessageInput
182: - LoadingSpinner
183: - ThemeToggle
184: - ErrorBoundary
185: - CodeBlock
186: - IconButton
187: 
188: ## Development
189: 
190: ### Adding New Components
191: 
192: 1. Use shadcn CLI:
193: ```bash
194: pnpm dlx shadcn@latest add [component-name]
195: ```
196: 
197: 2. Create wrapper (if needed):
198: ```typescript
199: // src/components/custom/my-component.tsx
200: import { Button } from '../ui/button'
201: 
202: export function MyComponent() {
203:   return <Button>Custom Button</Button>
204: }
205: ```
206: 
207: ### Testing
208: ```bash
209: pnpm test
210: pnpm test:watch
211: ```
212: 
213: ### Storybook
214: ```bash
215: pnpm storybook
216: pnpm build-storybook
217: ```
218: 
219: ### Linting
220: ```bash
221: pnpm lint
222: pnpm type-check
223: ```
224: 
225: ## Troubleshooting
226: 
227: ### Common Issues
228: 1. **Style Conflicts**: Check Tailwind class order
229: 2. **Type Errors**: Verify prop types
230: 3. **Theme Issues**: Check CSS variables
231: 4. **Build Errors**: Check dependencies
232: 
233: ### Debug Tools
234: - React DevTools
235: - Tailwind CSS Inspector
236: - Chrome DevTools
237: - Storybook
238: 
239: ## Additional Resources
240: 
241: - [Component Documentation](../../docs/COMPONENTS.md)
242: - [Design System Guide](../../docs/DESIGN_SYSTEM.md)
243: - [Theme Customization](../../docs/THEMING.md)
244: - [Accessibility Guide](../../docs/ACCESSIBILITY.md)
```

## File: packages/ui/tailwind.config.js
```javascript
 1: /** @type {import('tailwindcss').Config} */
 2: module.exports = {
 3:   darkMode: ["class"],
 4:   content: ["./src/**/*.{ts,tsx}"],
 5:   prefix: "",
 6:   theme: {
 7:   	container: {
 8:   		center: true,
 9:   		padding: '2rem',
10:   		screens: {
11:   			'2xl': '1400px'
12:   		}
13:   	},
14:   	extend: {
15:   		fontFamily: {
16:   			sans: [
17:   				'var(--font-sans)'
18:   			],
19:   			mono: [
20:   				'var(--font-mono)'
21:   			]
22:   		},
23:   		colors: {
24:   			border: 'hsl(var(--border))',
25:   			input: 'hsl(var(--input))',
26:   			ring: 'hsl(var(--ring))',
27:   			background: 'hsl(var(--background))',
28:   			foreground: 'hsl(var(--foreground))',
29:   			primary: {
30:   				DEFAULT: 'hsl(var(--primary))',
31:   				foreground: 'hsl(var(--primary-foreground))'
32:   			},
33:   			secondary: {
34:   				DEFAULT: 'hsl(var(--secondary))',
35:   				foreground: 'hsl(var(--secondary-foreground))'
36:   			},
37:   			destructive: {
38:   				DEFAULT: 'hsl(var(--destructive))',
39:   				foreground: 'hsl(var(--destructive-foreground))'
40:   			},
41:   			muted: {
42:   				DEFAULT: 'hsl(var(--muted))',
43:   				foreground: 'hsl(var(--muted-foreground))'
44:   			},
45:   			accent: {
46:   				DEFAULT: 'hsl(var(--accent))',
47:   				foreground: 'hsl(var(--accent-foreground))'
48:   			},
49:   			popover: {
50:   				DEFAULT: 'hsl(var(--popover))',
51:   				foreground: 'hsl(var(--popover-foreground))'
52:   			},
53:   			card: {
54:   				DEFAULT: 'hsl(var(--card))',
55:   				foreground: 'hsl(var(--card-foreground))'
56:   			},
57:   			sidebar: {
58:   				DEFAULT: 'hsl(var(--sidebar-background))',
59:   				foreground: 'hsl(var(--sidebar-foreground))',
60:   				primary: 'hsl(var(--sidebar-primary))',
61:   				'primary-foreground': 'hsl(var(--sidebar-primary-foreground))',
62:   				accent: 'hsl(var(--sidebar-accent))',
63:   				'accent-foreground': 'hsl(var(--sidebar-accent-foreground))',
64:   				border: 'hsl(var(--sidebar-border))',
65:   				ring: 'hsl(var(--sidebar-ring))'
66:   			}
67:   		},
68:   		borderRadius: {
69:   			lg: 'var(--radius)',
70:   			md: 'calc(var(--radius) - 2px)',
71:   			sm: 'calc(var(--radius) - 4px)'
72:   		},
73:   		keyframes: {
74:   			'accordion-down': {
75:   				from: {
76:   					height: '0'
77:   				},
78:   				to: {
79:   					height: 'var(--radix-accordion-content-height)'
80:   				}
81:   			},
82:   			'accordion-up': {
83:   				from: {
84:   					height: 'var(--radix-accordion-content-height)'
85:   				},
86:   				to: {
87:   					height: '0'
88:   				}
89:   			}
90:   		},
91:   		animation: {
92:   			'accordion-down': 'accordion-down 0.2s ease-out',
93:   			'accordion-up': 'accordion-up 0.2s ease-out'
94:   		}
95:   	}
96:   },
97:   plugins: [require("tailwindcss-animate")],
98: }
```

## File: packages/ui/tsconfig.json
```json
 1: {
 2:   "extends": "../typescript-config/react-library.json",
 3:   "compilerOptions": {
 4:     "outDir": "./dist",
 5:     "rootDir": "./src",
 6:     "baseUrl": ".",
 7:     "jsx": "react-jsx",
 8:     "paths": {
 9:       "@/*": ["./src/*"]
10:     },
11:     "types": ["react"]
12:   },
13:   "include": ["src/**/*.ts", "src/**/*.tsx"],
14:   "exclude": ["node_modules", "dist"]
15: }
```

## File: packages/ui/tsup.config.ts
```typescript
 1: import { defineConfig } from 'tsup';
 2: 
 3: export default defineConfig({
 4:   entry: ['src/index.ts'],
 5:   format: ['esm'],
 6:   dts: true,
 7:   sourcemap: true,
 8:   clean: true,
 9:   external: [
10:     'react',
11:     'react-dom',
12:     '@radix-ui/*',
13:     'class-variance-authority',
14:     'clsx',
15:     'tailwind-merge',
16:   ],
17: });
```

## File: .env.example
```
 1: # Database Configuration
 2: POSTGRES_USER=postgres
 3: POSTGRES_PASSWORD=postgres
 4: POSTGRES_DB=danky
 5: DATABASE_URL=postgresql://postgres:postgres@localhost:6432/danky
 6: 
 7: # Redis Configuration
 8: REDIS_HOST=localhost
 9: REDIS_PORT=6379
10: REDIS_PASSWORD=redis
11: REDIS_URL=redis://:redis@localhost:6379
12: 
13: # Qdrant Configuration
14: QDRANT_HOST=localhost
15: QDRANT_PORT=6333
16: QDRANT_GRPC_PORT=6334
17: QDRANT_URL=http://localhost:6333
18: 
19: # PgBouncer Configuration
20: PGBOUNCER_PORT=6432
21: PGBOUNCER_MAX_CLIENT_CONN=1000
22: PGBOUNCER_DEFAULT_POOL_SIZE=20
23: 
24: # API Keys
25: ANTHROPIC_API_KEY=your-anthropic-api-key
26: BRAVE_API_KEY=your-brave-api-key
```

## File: .npmrc
```
 1: auto-install-peers=true
 2: dedupe-peer-dependents=true
 3: enable-pre-post-scripts=true
 4: node-linker=hoisted
 5: public-hoist-pattern[]=*eslint*
 6: public-hoist-pattern[]=*prettier*
 7: shamefully-hoist=false
 8: strict-peer-dependencies=false
 9: use-node-version=20.11.1
10: 
11: # Prevent accidental package.json modifications
12: save-workspace-protocol=false
13: save-prefix=""
14: 
15: # Prevent accidental publishing
16: publish-branch=false
17: 
18: # Prevent installing from non-workspace packages
19: prefer-workspace-packages=true
20: link-workspace-packages=true
21: 
22: # Prevent direct package installations in packages/*
23: shell-emulator=true
24: ignore-workspace-root-check=false
```

## File: ARCHITECTURE.md
```markdown
  1: # Danky AI Chatbot - Architecture Guide
  2: 
  3: ## Project Structure
  4: 
  5: ```
  6: danky/
  7: ├── apps/
  8: │   └── web/              # Next.js web application
  9: │       ├── src/
 10: │       │   ├── app/      # Next.js App Router pages
 11: │       │   ├── components/
 12: │       │   │   ├── chat/     # Chat-specific components
 13: │       │   │   ├── mcp/      # MCP (Model Context Protocol) components
 14: │       │   │   ├── sidebar/  # Navigation and layout components
 15: │       │   │   └── theme/    # Theme-related components
 16: │       │   ├── hooks/    # React hooks
 17: │       │   └── lib/      # Shared utilities
 18: │       │       ├── actions/   # Server actions
 19: │       │       ├── config/    # App configuration
 20: │       │       ├── db/        # Database utilities
 21: │       │       ├── services/  # Service layer
 22: │       │       ├── stores/    # Client-side state
 23: │       │       └── validations/ # Schema validations
 24: │       └── docs/         # Component and feature documentation
 25: ├── packages/
 26: │   ├── ui/              # Shared UI components (shadcn/ui)
 27: │   ├── mcp/             # Model Context Protocol implementation
 28: │   ├── db/              # Database schema and utilities
 29: │   ├── schema/          # Shared type definitions and validations
 30: │   ├── logger/          # Structured logging utilities
 31: │   ├── eslint-config/   # Shared ESLint configurations
 32: │   └── typescript-config/ # Shared TypeScript configurations
 33: └── docs/                # Project-wide documentation
 34: ```
 35: 
 36: ## Package Responsibilities
 37: 
 38: ### Core Packages
 39: - **@danky/ui**: Reusable UI components built with shadcn/ui
 40: - **@danky/mcp**: Model Context Protocol for AI interactions
 41: - **@danky/db**: Database schema, migrations, and type definitions
 42: - **@danky/schema**: Shared type definitions and Zod schemas
 43: - **@danky/logger**: Structured logging with Pino
 44: 
 45: ### Infrastructure Packages
 46: - **@danky/eslint-config**: Shared ESLint rules
 47: - **@danky/typescript-config**: Base TypeScript configurations
 48: 
 49: ## Key Concepts
 50: 
 51: ### Component Organization
 52: - **Feature-based Structure**: Components are organized by feature (chat, mcp, etc.)
 53: - **Shared vs App-specific**: Common components live in `packages/ui`, app-specific in `apps/web/src/components`
 54: - **Server vs Client**: Server components are default, marked with 'use client' when needed
 55: 
 56: ### State Management
 57: - **Server State**: Handled through Server Components and Server Actions
 58: - **Client State**: Managed with Zustand stores in `lib/stores`
 59: - **Form State**: Uses react-hook-form with zod validation
 60: 
 61: ### Styling
 62: - **Tailwind CSS**: Primary styling solution
 63: - **CSS Variables**: Theme values in `globals.css`
 64: - **shadcn/ui**: Component library with consistent styling
 65: - **CSS Modules**: Used for component-specific styles when needed
 66: 
 67: ### Type Safety
 68: - **TypeScript**: Strict mode enabled
 69: - **Zod**: Runtime type validation
 70: - **Path Aliases**: Configured for clean imports
 71: 
 72: ## Development Guidelines
 73: 
 74: ### Adding New Features
 75: 1. Determine if the feature belongs in `packages/` or `apps/`
 76: 2. Create a new directory under appropriate location
 77: 3. Add documentation in the feature's directory
 78: 4. Update this guide if architecture changes
 79: 
 80: ### Component Guidelines
 81: - Keep components under 200 lines
 82: - Split large components into smaller ones
 83: - Use composition over inheritance
 84: - Document complex components with comments
 85: - Add `.md` files for component documentation
 86: 
 87: ### File Naming Conventions
 88: - React components: `component-name.tsx`
 89: - Utilities: `utility-name.ts`
 90: - Types: `types.ts` in feature directories
 91: - Constants: `constants.ts`
 92: - Hooks: `use-feature-name.ts`
 93: 
 94: ### Import Organization
 95: ```typescript
 96: // External imports
 97: import { useState } from 'react'
 98: import { useQuery } from '@tanstack/react-query'
 99: 
100: // Internal package imports
101: import { Button } from '@danky/ui'
102: import { type Tool } from '@danky/mcp'
103: 
104: // Local imports
105: import { useChat } from '@/hooks/use-chat'
106: import { cn } from '@/lib/utils'
107: ```
108: 
109: ## AI Assistant Guidelines
110: 
111: ### Key Files for Context
112: - `apps/web/src/app/layout.tsx` - Root layout and providers
113: - `apps/web/src/components/chat/types.ts` - Chat-related types
114: - `packages/mcp/src/types.ts` - MCP core types
115: - `apps/web/src/lib/stores/chat-store.ts` - Chat state management
116: 
117: ### Common Operations
118: - Adding UI components: `pnpm ui:add [component-name]`
119: - Linting: `pnpm lint`
120: - Type checking: `pnpm type-check`
121: 
122: ### Feature Locations
123: - Chat functionality: `apps/web/src/components/chat`
124: - MCP tools: `apps/web/src/components/mcp`
125: - UI components: `packages/ui/src/components`
126: - Server actions: `apps/web/src/lib/actions`
127: 
128: ### Configuration Files
129: - ESLint: `apps/web/eslint.config.js`
130: - TypeScript: `apps/web/tsconfig.json`
131: - Tailwind: `apps/web/tailwind.config.js`
132: - Next.js: `apps/web/next.config.js`
133: 
134: ## Best Practices
135: 
136: ### Performance
137: - Use React Suspense boundaries
138: - Implement proper loading states
139: - Optimize images and assets
140: - Use proper caching strategies
141: 
142: ### Accessibility
143: - Follow ARIA best practices
144: - Use semantic HTML
145: - Ensure keyboard navigation
146: - Maintain proper contrast ratios
147: 
148: ### Security
149: - Validate all inputs
150: - Use proper auth checks
151: - Handle errors gracefully
152: - Sanitize user content
153: 
154: ### Testing
155: - Write unit tests for utilities
156: - Add component tests for complex features
157: - Use proper mocking strategies
158: - Test error scenarios
159: 
160: ## Troubleshooting
161: 
162: ### Common Issues
163: 1. **Type Errors**: Check `tsconfig.json` and path aliases
164: 2. **Build Errors**: Verify package versions in `package.json`
165: 3. **Style Issues**: Check Tailwind classes and CSS modules
166: 4. **State Issues**: Verify store implementations
167: 
168: ### Debug Tools
169: - React DevTools
170: - Next.js DevTools
171: - Chrome DevTools
172: - VSCode Debugger
173: 
174: ## Contributing
175: 
176: 1. Follow the file organization
177: 2. Add proper documentation
178: 3. Use conventional commits
179: 4. Update relevant docs
180: 5. Add tests for new features
181: 
182: ## AI Development Guidelines
183: 
184: ### Type Resolution
185: When working with types, check these locations in order:
186: 1. Local `types.ts` in feature directory
187: 2. `@danky/schema` package for shared types
188: 3. `@danky/db` for database types
189: 4. `@danky/mcp` for AI interaction types
190: 
191: ### Component Resolution
192: When adding/modifying components:
193: 1. Check `packages/ui` for existing components
194: 2. Use `pnpm ui:add` for new shadcn/ui components
195: 3. Create in feature directory if specific to one feature
196: 4. Create in `packages/ui` if shared across features
197: 
198: ### Database Operations
199: All database operations should:
200: 1. Use types from `@danky/db`
201: 2. Validate input with `@danky/schema`
202: 3. Include proper error handling
203: 4. Log operations with `@danky/logger`
204: 
205: ### AI Integration Points
206: Key areas for AI functionality:
207: 1. `packages/mcp/src/tools/` - Tool implementations
208: 2. `apps/web/src/components/chat/` - Chat interface
209: 3. `apps/web/src/lib/actions/` - Server actions
210: 4. `packages/schema/src/ai/` - AI-related types
211: 
212: ## Code Organization
213: 
214: ### Feature Structure
215: A typical feature should follow this structure:
216: ```
217: feature/
218: ├── components/     # UI components
219: │   ├── index.ts   # Public exports
220: │   └── types.ts   # Component types
221: ├── hooks/         # Feature-specific hooks
222: ├── utils/         # Helper functions
223: ├── constants.ts   # Feature constants
224: ├── types.ts       # Feature-wide types
225: └── README.md      # Feature documentation
226: ```
227: 
228: ### Component Structure
229: Components should follow this pattern:
230: ```typescript
231: // Type imports
232: import type { ComponentProps } from '@/types'
233: import type { Tool } from '@danky/mcp'
234: 
235: // External imports
236: import { useState } from 'react'
237: 
238: // Internal package imports
239: import { Button } from '@danky/ui'
240: 
241: // Local imports
242: import { useFeature } from '../hooks/use-feature'
243: 
244: // Component definition
245: export function FeatureComponent({ prop }: ComponentProps) {
246:   // Implementation
247: }
248: ```
249: 
250: ## Common Patterns
251: 
252: ### Error Handling
253: ```typescript
254: import { logger } from '@danky/logger'
255: import { DatabaseError } from '@danky/db'
256: 
257: try {
258:   // Operation
259: } catch (error) {
260:   if (error instanceof DatabaseError) {
261:     logger.error({ error }, 'Database operation failed')
262:     // Handle database error
263:   }
264:   // Re-throw unknown errors
265:   throw error
266: }
267: ```
268: 
269: ### Data Validation
270: ```typescript
271: import { userSchema } from '@danky/schema'
272: import { logger } from '@danky/logger'
273: 
274: export async function createUser(data: unknown) {
275:   const parsed = userSchema.parse(data)
276:   logger.info({ userId: parsed.id }, 'Creating user')
277:   // Proceed with validated data
278: }
279: ```
280: 
281: ### State Management
282: ```typescript
283: import { create } from 'zustand'
284: import type { FeatureState } from '@danky/schema'
285: 
286: export const useFeatureStore = create<FeatureState>((set) => ({
287:   // State implementation
288: }))
289: ```
290: 
291: ## AI Assistance Notes
292: 
293: ### Key Type Locations
294: - Database types: `packages/db/src/types.ts`
295: - Schema types: `packages/schema/src/types.ts`
296: - MCP types: `packages/mcp/src/types.ts`
297: - Component types: `packages/ui/src/types.ts`
298: 
299: ### Common Operations
300: - Adding UI components: `pnpm ui:add [component-name]`
301: - Database migrations: `pnpm db:migrate`
302: - Type checking: `pnpm type-check`
303: - Linting: `pnpm lint`
304: 
305: ### Important Context Files
306: - `apps/web/src/app/layout.tsx` - Root layout
307: - `packages/mcp/src/config.ts` - MCP configuration
308: - `packages/db/src/schema.ts` - Database schema
309: - `packages/schema/src/index.ts` - Shared types
```

## File: package.json
```json
 1: {
 2:   "name": "danky",
 3:   "private": true,
 4:   "type": "module",
 5:   "scripts": {
 6:     "build": "turbo build",
 7:     "dev": "turbo dev",
 8:     "lint": "turbo lint",
 9:     "type-check": "turbo type-check",
10:     "clean": "rm -rf node_modules && rm -rf .turbo && find . -type d \\( -name \".next\" -o -name \"dist\" -o -name \".cache\" -o -name \"node_modules\" -o -name \".turbo\" \\) -o -name \".eslintcache\" -o -name \"*.tsbuildinfo\" -o -name \"pnpm-lock.yaml\" | xargs rm -rf && rm -rf ~/.cache/typescript/",
11:     "clean:cache": "rm -rf .turbo && find . -type d \\( -name \".next\" -o -name \".cache\" \\) -o -name \".eslintcache\" -o -name \"*.tsbuildinfo\" | xargs rm -rf && rm -rf ~/.cache/typescript/",
12:     "clean:deps": "rm -rf node_modules && find . -name \"node_modules\" -type d -o -name \"pnpm-lock.yaml\" | xargs rm -rf",
13:     "clean:build": "find . -type d \\( -name \".next\" -o -name \"dist\" \\) | xargs rm -rf",
14:     "format": "prettier --write \"**/*.{ts,tsx,md,json,js,jsx}\"",
15:     "format:check": "prettier --check \"**/*.{ts,tsx,md,json,js,jsx}\"",
16:     "changeset": "changeset",
17:     "version-packages": "changeset version",
18:     "release": "turbo build --filter=docs^... && changeset publish",
19:     "lint:fix": "turbo lint -- --fix",
20:     "prepare": "husky install"
21:   },
22:   "devDependencies": {
23:     "@changesets/cli": "^2.27.11",
24:     "@danky/eslint-config": "workspace:*",
25:     "@danky/typescript-config": "workspace:*",
26:     "@types/node": "^22.10.5",
27:     "@types/react": "^19.0.4",
28:     "@types/react-dom": "^19.0.2",
29:     "@types/ws": "^8.5.13",
30:     "@typescript-eslint/eslint-plugin": "^8.19.0",
31:     "@typescript-eslint/parser": "^8.19.0",
32:     "eslint": "^9.18.0",
33:     "husky": "^9.1.7",
34:     "lint-staged": "^15.3.0",
35:     "prettier": "^3.4.2",
36:     "prettier-plugin-tailwindcss": "^0.6.9",
37:     "turbo": "^2.3.3",
38:     "typescript": "^5.4.5",
39:     "@radix-ui/react-accordion": "^1.2.2",
40:     "@radix-ui/react-alert-dialog": "^1.1.4",
41:     "@radix-ui/react-avatar": "^1.1.2",
42:     "@radix-ui/react-checkbox": "^1.1.3",
43:     "@radix-ui/react-context-menu": "^2.2.4",
44:     "@radix-ui/react-dialog": "^1.1.4",
45:     "@radix-ui/react-dropdown-menu": "^2.1.4",
46:     "@radix-ui/react-hover-card": "^1.1.4",
47:     "@radix-ui/react-label": "^2.1.1",
48:     "@radix-ui/react-menubar": "^1.1.4",
49:     "@radix-ui/react-navigation-menu": "^1.2.3",
50:     "@radix-ui/react-popover": "^1.1.4",
51:     "@radix-ui/react-progress": "^1.1.1",
52:     "@radix-ui/react-radio-group": "^1.2.2",
53:     "@radix-ui/react-scroll-area": "^1.2.2",
54:     "@radix-ui/react-select": "^2.1.4",
55:     "@radix-ui/react-separator": "^1.1.1",
56:     "@radix-ui/react-slider": "^1.2.2",
57:     "@radix-ui/react-slot": "^1.1.1",
58:     "@radix-ui/react-switch": "^1.1.2",
59:     "@radix-ui/react-tabs": "^1.1.2",
60:     "@radix-ui/react-toast": "^1.2.4",
61:     "@radix-ui/react-toggle": "^1.1.1",
62:     "@radix-ui/react-toggle-group": "^1.1.1",
63:     "@radix-ui/react-tooltip": "^1.1.6",
64:     "react": "^19.0.0",
65:     "react-dom": "^19.0.0",
66:     "zustand": "^5.0.3"
67:   },
68:   "packageManager": "pnpm@8.15.4",
69:   "engines": {
70:     "node": ">=20.11.1"
71:   },
72:   "dependencies": {
73:     "@anthropic-ai/sdk": "^0.33.1",
74:     "@h1deya/langchain-mcp-tools": "^0.1.4",
75:     "@langchain/core": "^0.3.29",
76:     "@langchain/openai": "^0.3.16",
77:     "@qdrant/js-client-rest": "^1.12.0",
78:     "ioredis": "^5.4.2",
79:     "langchain": "0.3.11",
80:     "pino": "^9.6.0",
81:     "pino-pretty": "^13.0.0",
82:     "ws": "^8.18.0"
83:   },
84:   "lint-staged": {
85:     "*.{js,jsx,ts,tsx}": [
86:       "prettier --write",
87:       "eslint --fix"
88:     ],
89:     "*.{json,md}": [
90:       "prettier --write"
91:     ]
92:   },
93:   "workspaces": [
94:     "apps/*",
95:     "packages/*"
96:   ]
97: }
```

## File: pnpm-workspace.yaml
```yaml
1: packages:
2:   - "apps/web"
3:   - "apps/bot/mcp"
4:   - "packages/*"
```

## File: README.md
```markdown
  1: # Danky AI Chatbot
  2: 
  3: A modern, extensible AI chatbot platform built with TypeScript, Next.js, and the Model Context Protocol (MCP).
  4: 
  5: ## Overview
  6: 
  7: Danky is a sophisticated AI chatbot platform that leverages the power of various language models (OpenAI, Anthropic, Groq) through a unified interface. It features a modern web interface built with Next.js and shadcn/ui components, while utilizing the Model Context Protocol (MCP) for robust AI model integration.
  8: 
  9: ## Features
 10: 
 11: - 🤖 Multi-model support (OpenAI, Anthropic, Groq)
 12: - 🎨 Modern UI with shadcn/ui components
 13: - 🔄 Real-time chat interactions
 14: - 📁 File system integration
 15: - 🛠️ Extensible tool system
 16: - 🔒 Secure credential management
 17: - 📊 Built-in logging and monitoring
 18: - 🌙 Dark/Light mode support
 19: 
 20: ## Tech Stack
 21: 
 22: - **Frontend**: Next.js, React, TypeScript
 23: - **UI Components**: shadcn/ui, Tailwind CSS
 24: - **State Management**: Zustand
 25: - **AI Integration**: Model Context Protocol (MCP)
 26: - **Package Management**: pnpm
 27: - **Development Tools**: ESLint, Prettier, TypeScript
 28: 
 29: ## Project Structure
 30: 
 31: ```
 32: .
 33: ├── apps/
 34: │   ├── web/               # Main web application
 35: │   ├── bot/              # MCP bot implementation
 36: │   └── docs/             # Documentation site
 37: ├── packages/
 38: │   ├── ui/               # Shared UI components
 39: │   ├── eslint-config/    # Shared ESLint configuration
 40: │   ├── typescript-config/ # Shared TypeScript configuration
 41: │   └── types/            # Shared TypeScript types
 42: ```
 43: 
 44: ## Getting Started
 45: 
 46: ### Prerequisites
 47: 
 48: - Node.js 20.11.0 or higher
 49: - pnpm 8.x or higher
 50: - Git
 51: 
 52: ### Installation
 53: 
 54: 1. Clone the repository:
 55:    ```bash
 56:    git clone https://github.com/jmagar/danky.git
 57:    cd danky
 58:    ```
 59: 
 60: 2. Install dependencies:
 61:    ```bash
 62:    pnpm install
 63:    ```
 64: 
 65: 3. Copy the environment template and configure your environment variables:
 66:    ```bash
 67:    cp .env.template .env
 68:    ```
 69: 
 70: 4. Start the development server:
 71:    ```bash
 72:    pnpm dev
 73:    ```
 74: 
 75: ### Environment Variables
 76: 
 77: Required environment variables:
 78: 
 79: - `OPENAI_API_KEY`: OpenAI API key
 80: - `ANTHROPIC_API_KEY`: Anthropic API key
 81: - `GROQ_API_KEY`: Groq API key
 82: 
 83: Optional environment variables:
 84: - `BRAVE_API_KEY`: Brave Search API key
 85: 
 86: ## Development
 87: 
 88: ### Commands
 89: 
 90: - `pnpm dev` - Start development server
 91: - `pnpm build` - Build for production
 92: - `pnpm lint` - Run ESLint
 93: - `pnpm type-check` - Run TypeScript checks
 94: - `pnpm test` - Run tests
 95: 
 96: ### Adding New Components
 97: 
 98: 1. Use the shadcn CLI to add new components:
 99:    ```bash
100:    pnpm dlx shadcn@latest add [component-name]
101:    ```
102: 
103: 2. Create wrapper components for customizations in `packages/ui/src/components/`
104: 
105: ### Code Style
106: 
107: - Follow the TypeScript guidelines in `.cursorrules`
108: - Keep components focused and small
109: - Use Server Components by default
110: - Add 'use client' only when necessary
111: - Follow the monorepo package boundaries
112: 
113: ## Contributing
114: 
115: 1. Fork the repository
116: 2. Create your feature branch (`git checkout -b feature/amazing-feature`)
117: 3. Commit your changes (`git commit -m 'Add some amazing feature'`)
118: 4. Push to the branch (`git push origin feature/amazing-feature`)
119: 5. Open a Pull Request
120: 
121: ## License
122: 
123: This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
124: 
125: ## Acknowledgments
126: 
127: - [Model Context Protocol](https://modelcontextprotocol.io)
128: - [shadcn/ui](https://ui.shadcn.com)
129: - [Next.js](https://nextjs.org)
130: - [Tailwind CSS](https://tailwindcss.com)
```

## File: repomix.config.json
```json
 1: {
 2:   "output": {
 3:     "filePath": "dank-context.md",
 4:     "style": "markdown",
 5:     "headerText": "# Danky AI Chatbot Codebase\nThis is a Next.js monorepo project using TypeScript, Drizzle, and MCP for AI interactions.",
 6:     "removeComments": false,
 7:     "removeEmptyLines": false,
 8:     "showLineNumbers": true,
 9:     "copyToClipboard": false,
10:     "topFilesLength": 10,
11:     "includeEmptyDirectories": true
12:   },
13:   "include": [
14:     "apps/**/*",
15:     "packages/**/*",
16:     "*.json",
17:     "*.md",
18:     ".env.example",
19:     ".npmrc",
20:     "pnpm-workspace.yaml",
21:     "turbo.json"
22:   ],
23:   "ignore": {
24:     "useGitignore": true,
25:     "useDefaultPatterns": true,
26:     "customPatterns": [
27:       "**/node_modules/**",
28:       "**/.next/**",
29:       "**/.turbo/**",
30:       "**/dist/**",
31:       "**/.env",
32:       "**/coverage/**",
33:       "**/test-results/**",
34:       "**/*.log",
35:       "**/.DS_Store"
36:     ]
37:   },
38:   "security": {
39:     "enableSecurityCheck": true
40:   }
41: }
```

## File: turbo.json
```json
 1: {
 2:   "$schema": "https://turbo.build/schema.json",
 3:   "tasks": {
 4:     "build": {
 5:       "dependsOn": ["^build"],
 6:       "inputs": ["$TURBO_DEFAULT$", ".env*"],
 7:       "outputs": [".next/**", "!.next/cache/**", "dist/**"]
 8:     },
 9:     "lint": {
10:       "dependsOn": ["^lint"]
11:     },
12:     "type-check": {
13:       "dependsOn": ["^type-check"]
14:     },
15:     "dev": {
16:       "cache": false,
17:       "persistent": true
18:     },
19:     "clean": {
20:       "cache": false
21:     }
22:   }
23: }
```

## File: VERSION_REQUIREMENTS.md
```markdown
 1: # Version Requirements
 2: 
 3: This document outlines the version requirements for key dependencies in the project.
 4: 
 5: ## Core Dependencies
 6: 
 7: - React: `^19.0.0` (Current: 19.0.0, can upgrade but never downgrade)
 8: - Next.js: `^15.1.4` (Current: 15.1.4, can upgrade but never downgrade)
 9:   - `@next/eslint-plugin-next`: `^15.1.4`
10:   - `eslint-config-next`: `^15.1.4`
11: - ESLint: `^9.17.0` (Current: 9.17.0, can upgrade but never downgrade)
12: 
13: ## Rationale
14: 
15: - **React 19**: Required for latest features and performance improvements including pre-warming for suspended trees and new React DOM static APIs
16: - **Next.js 15.1**: Required for compatibility with React 19 and latest features including improved performance and stability. All Next.js related packages (including ESLint plugins) must match this version
17: - **ESLint 9**: Required for modern JavaScript/TypeScript linting capabilities
18: 
19: ## Upgrade Policy
20: 
21: These versions are minimum requirements. You can:
22: 
23: - ✅ Upgrade to newer versions
24: - ❌ Never downgrade below these versions
25: 
26: Downgrading will break functionality and compatibility within the project.
```
